ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее %DISC   DOC                   280FORTH      Ђ       	  280FORTH     Ђ
         280FORTH     Ђ         280FORTH     _           280FORTH280   Ђ  ! " # $ % & '  280FORTH280  Ђ( ) * + , - . /  280FORTH280  Ђ0 1 2 3 4 5 6 7  280FORTH280  _8 9 : ; < =      280FORTHCOM   6> ? @ A          280FORTHHEX   ЂB C D E F G H I  280FORTHMAC   ЂJ K L M N O P Q  280FORTHMAC  ЂR S T U V W X Y  280FORTHMAC  ЂZ [ \ ] ^ _ ` a  280FORTHMAC  Ђb c d e f g h i  280FORTHMAC  .j k l            280FORTHOCM   6m n o p          280FORTHOZ8   Ђq r s t u v w x  280FORTHOZ8  Ђy z { | } ~  Ђ  280FORTHOZ8  ЂЃ ‚ ѓ „ … † ‡ €  280FORTHOZ8  l‰ Љ ‹ Њ Ќ Ћ Џ    280FORTHUPD   ђ                280FORTHZ80   Ђ‘ ’ “ ” • – —   280FORTHZ80  Ђ™ љ › њ ќ ћ џ    280FORTHZ80  ЂЎ ў Ј ¤ Ґ ¦ § Ё  280FORTHZ80  Ђ© Є « ¬ ­ ® Ї °  280FORTHZ80  .± І і            CONPRTIO280   ґ µ              CONPRTIOZ80   ¶ ·              DISCIO  280   1ё № є »          DISCIO  Z80   8ј Ѕ ѕ ї          EDITOR  DOC   А Б              PIP     COM   :В Г Д Е          SCREENS FRT   ЂЖ З И Й К Л М Н  SCREENS FRT  ЂО П Р С Т У Ф Х  SCREENS FRT  ЂЦ Ч Ш Щ Ъ Ы Ь Э  SCREENS FRT  hЮ Я а б в г д    SETGETCL280   е                STARTUP FRT   @ж з и й          STAT    COM   *к л м            XDIR    COM   н о              Z280    MAC   п р             ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее Size  Recs  Bytes  Ext Acc
    0     0     0k    1 R/W E:%DISC.DOC
   17    17     3k    1 R/O E:CONPRTIO.280
   38    38     5k    1 R/O E:DISCIO.280
   18    18     3k    1 R/O E:EDITOR.DOC
 1441   537    58k    6 R/O E:SCREENS.FRT
   64    64     8k    1 R/O E:STARTUP.FRT
   52    52     7k    1 R/O E:280FORTH.COM
   16    16     2k    1 R/O E:280FORTH.UPD
  425   425    54k    4 R/O E:280FORTH.280



%DISC   .DOC	this text
CONPRTIO.280	Z280 fig-FORTH console driver   (*include file)
DISCIO  .280	Z280 fig-FORTH  disc   driver   (*include file)
EDITOR  .DOC	fig-FORTH editor commands
SCREENS .FRT	misc. screens, EDITOR from SCR #7. ASSEMBLER from SCR #13.
		MODEM7 from SCR # 18.
		Random access file, copy to empty disc before use.
STARTUP .FRT	more screens
280FORTH.COM	Z280 fig-FORTH 1.1a
280FORTH.UPD	Deviations from Installation Manual
280FORTH.280	Source, *include-s CONPRTIO.FTH & DISCIO.FTH

Invoke the desired screens file at CCP level, e.g. A>280FORTH B:SCREENS.FRT
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	title	< Z280 fig-FORTH 1.1 a >
	subttl	Adaptive version
;
;
; Modified from Z80 fig-FORTH 1.1h by EHR 880830
; Modified frm FIG document keyed by Dennis L. Wilson 800907
; Converted frm "8080 FIG-FORTH VERSION A0 15SEP79"
;
; fig-FORTH release 1.1 for the 8080 processor.
;
; ALL PUBLICATIONS OF THE FORTH INTEREST GROUP
; ARE PUBLIC DOMAIN. THEY MAY BE FURTHER
; DISTRIBUTED BY THE INCLUSION OF THIS CREDIT NOTICE:
;
; This publication has been made available by the
;	Forth Interest Group
;	P.O.Box 1105
;	San Carlos, CA 94070
;	U.S.A.
;
; Implementation on 8080 by:
;	John Cassady
;	339 15th Street
;	Oakland, CA 94612
;	U.S.A
;	on 790528
; Modified by:
;	Kim Harris
; Acknowledgements:
;	George Flammer
;	Robt. D. Villwock
; ----------------------------------------------------------------------
; Z80 Version for Cromemco CDOS & Digital Research CP/M by:
;	Dennis Lee Wilson c/o
;	Aristotelian Logicians
;	2631 East Pinchot Avenue
;	Phoenix, AZ 85016
;	U.S.A.
; ----------------------------------------------------------------------
; The 2 byte Z80 code for Jump Relative (JR) has been substituted for
; the 3 byte Jump (JP) wherever practical. The port I/O words P@ & P!
; have been made ROMable by use of Z80 instructions.
; ----------------------------------------------------------------------
; Further modifications (marked ;/) by:
;	Edmund Ramm
;	P.O.Box 38
;	2358 Kaltenkirchen
;	Fed. Rep. of Germany	840418
;
; 850419	changed * (star)
; 850507	added   0<>, 0>, TUCK, NIP, -ROT, CSWAP, PICK
; 850511	added	-CMOVE
;
; -----------------------------------------------------------------------------
; Disc I/O has been modified a la Albert van der Horst (HCCH) to employ
; CP/M 2.x's random access feature.
; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------
;
; Z280 specifics
;
;
iopreg		equ	08h		; i/o page register
;
config0		equ	0e0h		; c/t 0 configuration register
cntrl0		equ	0e1h		; c/t 0 command/status register
tcon0		equ	0e2h		; c/t 0 time constatnt register
count0		equ	0e3h		; c/t 0 count-time register
config1		equ	0e8h		; c/t 1 configuration register
cntrl1		equ	0e9h		; c/t 1 command/status register
tcon1		equ	0eah		; c/t 1 time constant register
count1		equ	0ebh		; c/t 1 count-time register
;
; -----------------------------------------------------------------------------
;
;	Release & Version numbers
;
figrel		equ	1		;FIG RELEASE #
figrev		equ	1		;FIG REVISION #
usrver		equ	61h		;USER VERSION # a by EHR
;
;Console & printer drivers are in external source named
;CONPRTIO.FTH & disc drivers in DISCIO.FTH. It has 4 screen
;buffers & end of memory is set to FBASE from locn. 0007H.
	page
;	ASCII characters used
;
abl		equ	20h		;BLANK
acr		equ	0dh		;CR
adot		equ	2eh		;.
bell		equ	07h		;^G
bsin		equ	08h		;backspace chr = ^H
bsout		equ	08h
dle		equ	10h		;^P
lf		equ	0ah		;^J
ff		equ	0ch		;^L
;
;	Memory allocation
;
bdoss		equ	0005h		;/ system entry
nscr		equ	4		;  # of 1024 byte screens
kbbuf		equ	128		;  bytes/disc buffer
us		equ	40h		;  user variables space
rts		equ	400h		;  Return Stack & term buff space
co		equ	kbbuf+4		;  Disc buff + 2 header + 2 tail
nbuf		equ	nscr*400h/kbbuf	;  # of buffers
bufsiz		equ	co*nbuf		;/ total disc buffer size
	page
	aseg
	.z280
;
	org	0100h
;
orig:
	nop
	jp	cld			; vector to cold start
	nop
	jp	wrm			; vector to warm start
	defb	figrel			; fig release #
	defb	figrev			; fig revision #
	defb	usrver			; user version #
	defb	0eh			; implementation attributes
;
;
;
;	0eh = 0000:1110
;	      ---------
; B +ORIGIN   ...W:IEBA
;
; W: 0=above sufficient
;    1=other differences exist
; I: Interpreter is	0=pre-
;			1=post incrementing
; E: Addr must be even: 0 yes
;			1 no
; B: High byte @	0=low addr.
;			1=high addr.
; A: CPU Addr.		0=BYTE
;			1=WORD
;
;
;
	defw	task-7			;  topmost word in FORTH vocabulary
	defw	bsin			;  backspace chr
upinit:	defw	0			;/ init (up)
;
; * Following used by COLD; must be in same order as user variables *
;
s0init:	defw	0			;/ init (s0)
r0init:	defw	0			;/ init (r0)
tibini:	defw	0			;/ init (TIB)
	defw	1fh			;  init (WIDTH)
	defw	0			;  init (WARNING)
	defw	initdp			;  init (FENCE)
	defw	initdp			;  init (dp)
	defw	forth+8			;  init (VOC-LINK)
;
; *  END DATA USED BY COLD *
;
	defw	0018h,0f600h		; Z280 CPU name (hw,lw)
					; (32 bit base 36 integer)
	page
;	REGISTERS
;
;	FORTH	Z80	FORTH PRESERVATION RULES
;	-----	---	-----------------------
;	IP	BC	should be preserved
;			accross FORTH words.
;	W	DE	sometimes output from
;			NEXT, may be altered
;			b4 JP'ing to NEXT,
;			input only when 
;			"DPUSH" called.
;	SP	SP	should be used only as
;			Data Stack accross
;			FORTH words, may be
;			used within FORTH
;			words if restored
;			b4 "NEXT"
;		HL	Never output frm NEXT
;			input only when
;			"HPUSH" called
;
;
up:	defw	0			;/ user area ptr
rpp:	defw	0			;/ return stack ptr
buf1:	defw	0			;/ address of 1st disc buffer
;
;
;	COMMENT CONVENTIONS:
;
;	==	means "is equal to"
;	<--	means assignment
;	#NAME	=     value of name
;	NAME    =     contents @ name
;	(NAME)  =     contents of cell addressed by name
;	cfa	=     code field address
;	lfa	=     link field address
;	nfa	=     name field address
;	pfa	=     parameter field address
;	s1	=     1st word of parameter stack
;	s2	=     2nd -"-  of    -"-     -"-
;	r1	=     1st -"-  of return stack
;	r2	=     2nd -"-  of  -"-    -"-
; ( above Stack posn. valid b4 & after execution of any word, not during)
;
;	lsb	=     least significant bit
;	msb	=     most  significant bit
;	lb	=     low  byte
;	hb	=     high byte
;	lw	=     low  word
;	hw	=     high word
; (May be used as suffix to above names)
	page
;	FORTH ADDRESS INTERPRETER
;	POST INCREMENTING VERSION
;
;
;
dpush:
	push	de
hpush:
	push	hl			; iy points here
next:
	ld	h,b			;/ w <-- (ip)    ix points here
	ld	l,c			;/
	ldw	hl,(hl)			;/ (hl) --> cfa
	inc	bc
	inc	bc			;/ ip += 2
next1:
	ldw	de,(hl)			;/ pc <-- (w)
	ex	de,hl
	inc	de
	jp	(hl)			; note: de <-- cfa + 1
;
;
jnext	macro
	jp	(ix)
	endm
;
jhpush	macro
	jp	(iy)
	endm
;
	page
;	FORTH DICTIONARY
;	DICTIONARY FORMAT:
;
;				BYTE
;	ADDRESS NAME		CONTENTS
;	------- ----		--------
;						(MSB=1
;						(P=PRECEDENCE BIT
;						(S=SMUDGE BIT
;	NFA	NAME FIELD	1PS<LEN>	<NAME LENGTH
;				0<1CHAR>	MSB=0, NAME'S 1st CHAR
;				0<2CHAR>
;				  ...
;				1<LCHAR>	MSB=1, NAME'S LAST CHAR
;	LFA	LINK FIELD	<LINKLB>	=PREVIOUS WORD'S NFA
;				<LINKHB>
;LABEL:	CFA	CODE FIELD	<CODELB>	=ADDR CPU CODE
;				<CODEHB>
;	PFA	PARAMETER	<1PARAM>	1st PARAMETER BYTE
;		FIELD		<2PARAM>
;				  ...
;
;
;
dp0:
	defb	83h			; LIT
	defc	'LIT'
	defw	0			; lfa == 0 marks end of dictionary 
lit:
	defw	$+2			; s1 <-- (ip)
	ld	h,b
	ld	l,c
	ldw	hl,(hl)			; hl <-- (ip) = literal
	inc	bc			;/
	inc	bc			;/ ip += 2
	jhpush				; s1 <-- hl
;
;
	defb	87h			; EXECUTE
	defc	'EXECUTE'
	defw	lit-6
exec:
	defw	$+2
	pop	hl
	jp	next1
;
;
	defb	86h			; BRANCH
	defc	'BRANCH'
	defw	exec-0ah
bran:
	defw	$+2			; ip += (ip)
bran1:
	ld	h,b
	ld	l,c			; hl <-- ip
	addw	hl,(hl)			; hl <-- ip + branch offset
	ld	c,l
	ld	b,h			; ip += branch offset
	jnext
;
;
	defb	87h			; 0BRANCH
	defc	'0BRANCH'
	defw	bran-9
zbran:
	defw	$+2
	pop	hl
	ld	a,l
	or	h
	jr	z,bran1			; branch if if s1 == 0
	inc	bc			; else skip branch offset
	inc	bc
	jnext
;
;
	defb	86h			; (LOOP)
	defc	'(LOOP)'
	defw	zbran-0ah
xloop:
	defw	$+2
	ld	hl,(rpp)		; (hl) --> index = r1
	incw	(hl)			;/ index += 1
	ldw	de,(hl)			;/ de <-- new index
	inc	hl			;/
	inc	hl			;/ hl --> limit(lb)
	ld	a,e
	sub	(hl)
	ld	a,d
	inc	hl			; hl --> limit(hb)
	sbc	a,(hl)			; index < limit?
	jp	m,bran1			; yes, loop again
	inc	hl			; no, done
	ld	(rpp),hl		; discard r1 & r2
	inc	bc
	inc	bc			; skip branch offset
	jnext
;
;
	defb	87h			; (+LOOP)
	defc	'(+LOOP)'
	defw	xloop-9
xploo:
	defw	$+2
	pop	de			; de <-- increment
	ld	hl,(rpp)		; hl --> index
	ld	a,(hl)			; index += increment
	add	a,e
	ld	(hl),a
	ld	e,a
	inc	hl
	ld	a,(hl)
	adc	a,d
	ld	(hl),a
	inc	hl			; (hl) --> limit
	inc	d
	dec	d
	ld	d,a			; de <-- new index
	jp	m,xloo2			; if incr > 0
	ld	a,e
	sub	(hl)			; then a <-- index - limit
	ld	a,d
	inc	hl
	sbc	a,(hl)
	jp	xloo3

xloo2:
	ld	a,(hl)			; else  a <-- limit - index
	sub	e
	inc	hl
	ld	a,(hl)
	sbc	a,d
;					; if a < 0
xloo3:
	jp	m,bran1			; then loop again
	inc	hl			; else done
	ld	(rpp),hl		; discard r1 & r2
	inc	bc			; skip branch offset
	inc	bc
	jnext
;
;
	defb	84h			;  (DO)
	defc	'(DO)'
	defw	xploo-0ah
xdo:
	defw	$+2
	pop	de			;  de <-- initial index
	ld	hl,(rpp)		;  hl <-- rp
	dec	hl
	dec	hl
	pop	(hl)			;/ r2 <-- limit
	dec	hl
	dec	hl
	ldw	(hl),de			;/ r1 <-- initial index
	ld	(rpp),hl		;  rp -= 4
	jnext
;
;
	defb	81h			; I
	defc	'I'
	defw	xdo-7
ido:
	defw	$+2
	ld	hl,(rpp)
	push	(hl)			;/ s1 <-- r1, r1 unchanged
	jnext
;
;
	defb	85h			; DIGIT
	defc	'DIGIT'
	defw	ido-4
digit:
	defw	$+2
	pop	hl			; l <-- s1.lb = base value
	pop	de			; e <-- s2.lb = chr to be converted
	ld	a,e			; a <-- chr
	sub	'0'			; >= 0?
	jr	c,digi2			;/ < 0 is invalid
	cp	0ah			; > 9?
	jr	c,digi1			;/ no, test base value
	sub	07h			; gap between '9' & 'A', nw 'A'=0ah
	cp	0ah			; >= 'A'?
	jr	c,digi2			;/ chrs btwn '9' & 'A' are invalid
digi1:
	cp	l			; < base value?
	jr	nc,digi2		;/ no, invalid
	ld	e,a			; s2 <-- de = converted digit
	ld	hl,0001h		; s1 <-- true
	jp	dpush
;
digi2:
	ld	l,h			; hl <-- false
	jhpush				; s1 <-- false
;
;
	defb	86h			; (FIND) (2-1)FAILURE
	defc	'(FIND)'		;        (2-3)SUCCESS
	defw	digit-8
pfind:
	defw	$+2
	pop	de			; de <-- nfa
pfin1:
	pop	hl			; hl <-- string addr
	push	hl			; save for next iteration
	ld	a,(de)
	xor	(hl)			; filter differences
	and	3fh			; mask msb & precedence bit
	jr	nz,pfin4		; lengths differ
pfin2:
	inc	hl			; hl --> next string chr
	inc	de			; de --> next name field chr
	ld	a,(de)
	xor	(hl)			; filter differences
	add	a,a			; shift msbit into carry
	jr	nz,pfin3		; no match
	jr	nc,pfin2		; match so far, loop agn
	ld	hl,0005h		; string matches
	add	hl,de			; (sp) <-- pfa
	ex	(sp),hl
pfin6:
	dec	de			; de --> nfa
	ld	a,(de)
	or	a			; msb=1? =length byte
	jp	p,pfin6			; no, try next chr
	ld	e,a			; e <-- length byte
	ld	d,00h
	ld	hl,0001h		; hl <-- true
	jp	dpush			; name field found, return
;
; above name field not a match, try next one
;
pfin3:
	jr	c,pfin5			; carry=end of name field
pfin4:
	inc	de			; find name field end
	ld	a,(de)
	or	a			; msb=1?
	jp	p,pfin4			; no, loop
pfin5:
	inc	de			; de <-- lfa
	ex	de,hl
	ldw	de,(hl)			;/ de <-- lfa
	ld	a,d
	or	e			; end of dictionary (lfa = 0)?
	jr	nz,pfin1		; no, try previous definition
	pop	hl			; drop string address
	ld	hl,0			; hl <-- false
	jhpush				; no match found, return
;
;
	defb	87h			; ENCLOSE
	defc	'ENCLOSE'
	defw	pfind-9
encl:
	defw	$+2
	pop	de			; de <-- s1 = delimiter chr
	pop	hl			; hl <-- s2 = addr of text to scan
	push	hl			; s4 <-- addr
	ld	a,e
	ld	d,a			; d <-- delim chr
	ld	e,-1			; init chr offset counter
	dec	hl			; hl <-- addr - 1
encl1:
	inc	hl			; skip over leading delim chrs
	inc	e
	cp	(hl)			; delim chr?
	jr	z,encl1			; yes, loop
	ld	d,0
	push	de			; s3 <-- e = offset to 1st non delim
	ld	d,a			; d <-- delim chr
	ld	a,(hl)
	and	a			; 1st non-delim=null?
	jr	nz,encl2		; no
	ld	d,0			; yes
	inc	e
	push	de			; s2 <-- offset to byte following null
	dec	e
	push	de			; s1 <-- offset to null
	jnext
;
encl2:
	ld	a,d			; A <-- delim chr
	inc	hl			; hl <-- next chr's address
	inc	e			; e <-- offset to next chr
	cp	(hl)			; delim chr?
	jr	z,encl4			; yes
	ld	a,(hl)
	and	a			; null?
	jr	nz,encl2		; no, continue scan
encl3:
	ld	d,0
	push	de			; s2 <-- offset to null
	push	de			; s1 <-- offset to null
	jnext
;
encl4:
	ld	d,0
	push	de			; s2 <-- offset to byte following text
	inc	e
	push	de			; s1 <-- offset 2 bytes aft end of word
	jnext
;
;
	defb	84h			; EMIT
	defc	'EMIT'
	defw	encl-0ah
emit:
	defw	docol
	defw	pemit
	defw	one,outt
	defw	pstor,semis
;
;
	defb	83h			; KEY
	defc	'KEY'
	defw	emit-7
key:
	defw	$+2
	jp	pkey
;
;
	defb	89h			; ?TERMINAL
	defc	'?TERMINAL'
	defw	key-6
qterm:
	defw	$+2
	ld	hl,0
	jp	pqter
;
;
	defb	82h			; CR
	defc	'CR'
	defw	qterm-0ch
cr:
	defw	$+2
	jp	pcr
;
;
	defb	85h			; CMOVE
	defc	'CMOVE'
	defw	cr-5
cmove:
	defw	$+2
	exx				;/ save ip
	pop	bc			;  bc <-- s1 = # of chrs
	pop	de			;  de <-- s2 = dest addr
	pop	hl			;/ hl <-- s3 = source addr
	ld	a,b
	or	c			;  bc=0?
	jr	z,cmove1		;  yes, nothing to move
	ldir				;/ xfer string
cmove1:
	exx				;/ restore ip
	jnext
;
;
	defb	86h			;/   -CMOVE    ( from to count --- )
	defc	'-CMOVE'
	defw	cmove-8
bcmov:
	defw	$+2
	exx				; save ip
	pop	bc			; bc <-- count
	pop	de			; de <-- destination
	pop	hl			; hl <-- source
	ld	a,b
	or	c			; bc =0?
	jr	z,bcmov1		; yes, nothing to move
	add	hl,bc
	dec	hl			; hl --> hi end of source block
	ex	de,hl
	add	hl,bc
	dec	hl
	ex	de,hl			; de --> hi end of dest. block
	lddr				; (de) <-- (hl), --hl,bc until bc=0
bcmov1:
	exx				; restore ip
	jnext
;
;
	defb	82h			; U*   16*16 unsigned multiply
	defc	'U*'			;      with 32 bit result
	defw	bcmov-9
ustar:
	defw	$+2
	pop	de			; de <-- multiplier
	pop	hl			; hl <-- multiplicant
	multuw	hl,de			;/
	ex	de,hl			;/ de <-- product.lw, hl <-- product.hw
	jp	dpush			; s2,s1 <-- product.lw,hw
;
;
	defb	82h			; U/   ( ud u1 -- urem uq )
	defc	'U/'
	defw	ustar-5
uslas:
	defw	$+2
	exx				;/ save ip
	pop	bc			; bc <-- divisor
	pop	hl			; hl <-- dividend.hw
	pop	de			; de <-- dividend.lw
	cpw	hl,bc			;/ dividend.hw >= divisor?
	jr	c,usla1			; no, go ahead
	ld	hl,0ffffh		; yes, overflow
	ld	d,h
	ld	e,l			;/ set rem & quot to max
	jr	usla2
usla1:
	ex	de,hl			;/ de,hl <-- dividend.hw,lw
	divuw	dehl,bc			;/ de <-- remainder, hl <-- quotient
usla2:
	push	de			;/ s2 <-- remainder
	push	hl			;/ s1 <-- quotient
	exx				;/ restore ip
	jnext
;
;
	defb	83h			; AND
	defc	'AND'
	defw	uslas-5
andd:
	defw	$+2			; s1 <-- s1 AND s2
	pop	de
	pop	hl
	ld	a,e
	and	l
	ld	l,a
	ld	a,d
	and	h
	ld	h,a
	jhpush
;
;
	defb	82h			; OR
	defc	'OR'
	defw	andd-6
orr:
	defw	$+2			; s1 <-- s1 OR s2
	pop	de
	pop	hl
	ld	a,e
	or	l
	ld	l,a
	ld	a,d
	or	h
	ld	h,a
	jhpush
;
;
	defb	83h			; XOR
	defc	'XOR'
	defw	orr-5
xorr:
	defw	$+2			; s1 <-- s1 XOR s2
	pop	de
	pop	hl
	ld	a,e
	xor	l
	ld	l,a
	ld	a,d
	xor	h
	ld	h,a
	jhpush
;
;
	defb	83h			; SP@
	defc	'SP@'
	defw	xorr-6
spat:
	defw	$+2
	ld	hl,0
	add	hl,sp			; hl <-- sp
	jhpush				; s1 <-- sp
;
;
	defb	83h			; SP!
	defc	'SP!'
	defw	spat-6
spsto:
	defw	$+2			; sp <-- s0  (user variable)
	ld	hl,(up)			; hl <-- user variables base address
	ld	de,6
	add	hl,de			; hl --> s0
	ldw	sp,(hl)			;/ sp <-- s0
	jnext
;
;
	defb	83h			; RP@
	defc	'RP@'
	defw	spsto-6
rpat:
	defw	$+2
	ld	hl,(rpp)
	jhpush				; s1 <-- rp
;
;
	defb	83h			; RP!
	defc	'RP!'
	defw	rpat-6
rpsto:
	defw	$+2			; rp <-- r0 (user variable)
	ld	hl,(up)			; hl <-- user variables base address
	ld	de,0008h
	add	hl,de			; hl --> r0
	ldw	hl,(hl)			;/ hl <-- r0
	ld	(rpp),hl		;/ rp <-- r0
	jnext
;
;
	defb	82h			; ;S
	defc	';S'
	defw	rpsto-6
semis:
	defw	$+2			; ip <-- r1 
	ld	hl,(rpp)
	ldw	bc,(hl)			;/ bc <-- r1
	inc	hl
	inc	hl
	ld	(rpp),hl		; rp += 2
	jnext
;
;
	defb	85h			; LEAVE
	defc	'LEAVE'
	defw	semis-5
leave:
	defw	$+2			; limit <-- index
	ld	hl,(rpp)
	ldw	de,(hl)			;/ de <-- r1 (= index)
	inc	hl
	inc	hl
	ldw	(hl),de			;/ r2 (= limit) <-- index
	jnext
;
;
	defb	82h			; >R
	defc	'>R'
	defw	leave-8
tor:
	defw	$+2
	ld	hl,(rpp)
	dec	hl
	dec	hl
	pop	(hl)			;/ r1 <-- s1
	ld	(rpp),hl		;  rp -= 2
	jnext
;
;
	defb	82h			; R>
	defc	'R>'
	defw	tor-5
fromr:
	defw	$+2
	ld	hl,(rpp)
	push	(hl)			;/ s1 <-- r1
	inc	hl
	inc	hl
	ld	(rpp),hl		; rp += 2
	jnext
;
;
	defb	81h			; R
	defc	'R'
	defw	fromr-5
rr:
	defw	ido+2
;
;
	defb	82h			; 0=
	defc	'0='
	defw	rr-4
zequ:
	defw	$+2
	pop	de
	ld	hl,0
	cpw	hl,de			;/
	jr	nz,zequ1
	inc	l			; hl <-- true
zequ1:
	jhpush
;
;
	defb	83h			;/ 0<>
	defc	'0<>'
	defw	zequ-5
znequ:
	defw	$+2
	pop	de
	ld	hl,0
	cpw	hl,de			;/
	jr	z,znequ1
	inc	l			; hl <-- true
znequ1:
	jhpush
;
;
	defb	82h			; 0<
	defc	'0<'
	defw	znequ-6
zless:
	defw	$+2
	pop	af			;/ a <-- s1.hb
	rla				;/ carry <-- bit 7
	ld	hl,0			;  hl <-- false
	rl	l			;/ bit 0 <-- carry
	jhpush
;
;
	defb	82h			;/ 0>
	defc	'0>'
	defw	zless-5
zgt:
	defw	$+2
	pop	de
	ld	hl,0
	cpw	hl,de			;/
	jp	p,zgt1			;/ <= 0
	jp	pe,zgt1			;/ 8000h special case
	inc	l			;/ hl <-- true
zgt1:
	jhpush
;
;
	defb	81h		;+
	defc	'+'
	defw	zgt-5
plus:
	defw	$+2
	pop	de
	pop	hl
	add	hl,de
	jhpush
;
;
	defb	82h			; D+ ( d1l d1h d2l d2h -- d3l d3h)
	defc	'D+'
	defw	plus-4
dplus:
	defw	$+2
	exx				;/ save ip
	pop	bc			;  bc <-- d2.hw
	pop	hl			;  hl <-- d2.lw
	pop	af			;d af <-- d1.hw
	pop	de			;  de <-- d1.lw
	push	af			;/ s1 <-- d1.hw
	add	hl,de			;  hl <-- d2.lw + d1.lw (= d3.lw)
	ex	de,hl			;  de <-- d3.lw
	pop	hl			;  hl <-- d1.hw
	adc	hl,bc			;/ hl <-- d1.hw + d2.hw +carry (=d3.hw)
	push	de			;  s2 <-- d3.lw
	push	hl			;/ s1 <-- d3.hw
	exx				;/ restore ip
	jnext
;
;
	defb	85h			; MINUS
	defc	'MINUS'
	defw	dplus-5
minus:
	defw	$+2
	pop	hl			;/
	neg	hl			;/
	jhpush
;
;
	defb	86h			; DMINUS
	defc	'DMINUS'
	defw	minus-8
dminu:
	defw	$+2
	exx				;/ save ip
	pop	de			;/ de <-- d1.hw
	pop	bc			;/ bc <-- d1.lw
	ld	hl,0			;/
	subw	hl,bc			;/
	push	hl			; s2 <-- d2.lw
	ld	hl,0			;/
	sbc	hl,de			;/
	push	hl			; s1 <-- d2.hw
	exx				;/
	jnext
;
;
	defb	84h			; OVER
	defc	'OVER'
	defw	dminu-9
over:
	defw	$+2
	ldw	hl,(sp+2)		;/
	jhpush				;/
;
;
	defb	84h			; DROP
	defc	'DROP'
	defw	over-7
drop:
	defw	$+2
	inc	sp
	inc	sp			;/ faster on z280 than dummy pop
	jnext
;
;
	defb	84h			; SWAP
	defc	'SWAP'
	defw	drop-7
swap:
	defw	$+2
	pop	hl
	ex	(sp),hl
	jhpush
;
;
	defb	83h			; DUP
	defc	'DUP'
	defw	swap-7
dup:
	defw	$+2
	ldw	hl,(sp+0)		;/
	jhpush
;
;
	defb	84h			;/ TUCK     ( n1 n2 --- n2 n1 n2)
	defc	'TUCK'
	defw	dup-6
tuck:
	defw	$+2
	pop	hl			;/ hl <-- s1
	pop	de			;/ de <-- s2
	push	hl			;/ s3 <-- hl
	jp	dpush
;
;
	defb	83h			;/ NIP      ( n1 n2 --- n2)
	defc	'NIP'
	defw	tuck-7
nip:
	defw	$+2
	pop	hl			; hl <-- s1
	ldw	(sp+0),hl		;/ s1 <-- hl
	jnext
;
;
	defb	84h			;/ -ROT     ( n1 n2 n3 --- n3 n1 n2)
	defc	'-ROT'
	defw	nip-6
mrot:
	defw	$+2
	pop	hl
	pop	de
	ex	(sp),hl
	ex	de,hl
	jp	dpush
;
;
	defb	85h			;/ CSWAP   ( n1 --- n1, bytes swapped)
	defc	'CSWAP'
	defw	mrot-7
cswap:
	defw	$+2
	pop	hl
	ex	h,l			;/
	jhpush
;
;
	defb	84h			;/ PICK   ( nn...n0 k --- nn..n0 nk)
	defc	'PICK'
	defw	cswap-8
pick:
	defw	$+2
	pop	hl			; hl <-- depth
	add	hl,hl			; adjust to word size
	add	hl,sp			; offset into stack
	push	(hl)			;/
	jnext
;
;
	defb	84h			; 2DUP
	defc	'2DUP'
	defw	pick-7
tdup:
	defw	$+2
	pop	hl
	pop	de
	push	de
	push	hl
	jp	dpush
;
;
	defb	82h			; +!
	defc	'+!'
	defw	tdup-7
pstor:
	defw	$+2
	pop	hl			; hl --> variable
	pop	de			; de <-- number
	ld	a,(hl)
	add	a,e
	ld	(hl),a
	inc	hl
	ld	a,(hl)
	adc	a,d
	ld	(hl),a			; (hl) += number
	jnext
;
;
	defb	86h			; TOGGLE
	defc	'TOGGLE'
	defw	pstor-5
toggl:
	defw	$+2
	pop	de			; e <-- bit pattern
	pop	hl			; hl --> address
	ld	a,(hl)
	xor	e
	ld	(hl),a
	jnext
;
;
	defb	81h			; @
	defc	'@'
	defw	toggl-9
at:
	defw	$+2
	pop	hl
	push	(hl)			;/
	jnext
;
;
	defb	82h			; C@
	defc	'C@'
	defw	at-4
cat:
	defw	$+2
	pop	hl
	ld	l,(hl)
	ld	h,0
	jhpush
;
;
	defb	82h			; 2@
	defc	'2@'
	defw	cat-5
tat:
	defw	$+2
	pop	hl			;  hl --> address
	ldw	de,(hl)			;/ de <-- d.hw
	inc	hl
	inc	hl			;  hl --> d.lw
	push	(hl)			;/ s2 <-- d.lw
	push	de			;/ s1 <-- d.hw
	jnext
;
;
	defb	81h			; !
	defc	'!'
	defw	tat-5
store:
	defw	$+2
	pop	hl			; hl --> address
	pop	(hl)			;/
	jnext
;
;
	defb	82h			; C!
	defc	'C!'
	defw	store-4
cstor:
	defw	$+2
	pop	hl			; hl --> address
	pop	de			; e <-- char
	ld	(hl),e
	jnext
;
;
	defb	82h			; 2!
	defc	'2!'
	defw	cstor-5
tstor:
	defw	$+2
	pop	hl			; hl --> address
	pop	(hl)			;/ store d.hw
	inc	hl
	inc	hl
	pop	(hl)			;/ store d.lw
	jnext
;
;
	defb	0c1h			; :
	defc	':'
	defw	tstor-5
colon:
	defw	docol
	defw	qexec
	defw	scsp
	defw	curr
	defw	at
	defw	cont
	defw	store
	defw	creat
	defw	rbrac
	defw	pscod
docol:
	ld	hl,(rpp)
	dec	hl
	dec	hl
	ldw	(hl),bc			;/ save return address
	ld	(rpp),hl
	inc	de
	ld	c,e
	ld	b,d
	jnext
;
;
	defb	0c1h			; ;
	defc	';'
	defw	colon-4
semi:
	defw	docol
	defw	qcsp
	defw	comp
	defw	semis
	defw	smudg
	defw	lbrac
	defw	semis
;
;
	defb	84h			; NOOP
	defc	'NOOP'
	defw	semi-4
noop:
	defw	docol
	defw	semis
;
;
	defb	88h			; CONSTANT
	defc	'CONSTANT'
	defw	noop-7
con:
	defw	docol
	defw	creat
	defw	smudg
	defw	comma
	defw	pscod
docon:
	inc	de
	ex	de,hl
	push	(hl)			;/
	jnext
;
;
	defb	88h			; VARIABLE
	defc	'VARIABLE'
	defw	con-0bh
var:
	defw	docol
	defw	con
	defw	pscod
dovar:
	inc	de
	push	de
	jnext
;
;
	defb	84h			; USER
	defc	'USER'
	defw	var-0bh
user:
	defw	docol
	defw	con
	defw	pscod
douse:
	inc	de
	ex	de,hl
	ld	l,(hl)			;/
	ld	h,0			;/
	addw	hl,(up)			;/
	jhpush
;
;
	defb	81h			; 0
	defc	'0'
	defw	user-7
zero:
	defw	$+2			;/
	push	0000h			;/
	jnext
;
;
	defb	81h			; 1
	defc	'1'
	defw	zero-4
one:
	defw	$+2			;/
	push	0001h			;/
	jnext
;
;
	defb	81h			; 2
	defc	'2'
	defw	one-4
two:
	defw	$+2			;/
	push	0002h			;/
	jnext
;
;
	defb	81h			; 3
	defc	'3'
	defw	two-4
three:
	defw	$+2			;/
	push	0003h			;/
	jnext
;
;
	defb	82h			; BL
	defc	'BL'
	defw	three-4
bl:
	defw	docon
	defw	20h
;
;
	defb	83h			; C/L
	defc	'C/L'
	defw	bl-5
csll:
	defw	docon
	defw	64
;
;
	defb	85h			; FIRST
	defc	'FIRST'
	defw	csll-6
first:
	defw	docon
	defw	0			;/ set by CLD
;
;
	defb	85h			; LIMIT
	defc	'LIMIT'
	defw	first-8
limit:
	defw	docon
	defw	0			;/ set by CLD
;
;
	defb	85h			; B/BUF
	defc	'B/BUF'
	defw	limit-8
bbuf:
	defw	docon
	defw	kbbuf
;
;
	defb	85h			; B/SCR
	defc	'B/SCR'
	defw	bbuf-8
bscr:
	defw	docon
	defw	400h/kbbuf
;
;
	defb	87h			; +ORIGIN
	defc	'+ORIGIN'
	defw	bscr-8
porig:
	defw	docol
	defw	lit
	defw	orig
	defw	plus
	defw	semis
;
;	USER VARIABLES
;
	defb	82h			; S0
	defc	'S0'
	defw	porig-0ah
szero:
	defw	douse
	defw	6
;
;
	defb	82h			; R0
	defc	'R0'
	defw	szero-5
rzero:
	defw	douse
	defw	8
;
;
	defb	83h			; TIB
	defc	'TIB'
	defw	rzero-5
tib:
	defw	douse
	defb	0ah
;
;
	defb	85h			; WIDTH
	defc	'WIDTH'
	defw	tib-6
width:
	defw	douse
	defb	0ch
;
;
	defb	87h			; WARNING
	defc	'WARNING'
	defw	width-8
warn:
	defw	douse
	defb	0eh
;
;
	defb	85h			; FENCE
	defc	'FENCE'
	defw	warn-0ah
fence:
	defw	douse
	defb	10h
;
;
	defb	82h			; DP
	defc	'DP'
	defw	fence-8
dp:
	defw	douse
	defb	12h
;
;
	defb	88h			; VOC-LINK
	defc	'VOC-LINK'
	defw	dp-5
vocl:
	defw	douse
	defw	14h
;
;
	defb	83h			; BLK
	defc	'BLK'
	defw	vocl-0bh
blk:
	defw	douse
	defb	16h
;
;
	defb	82h			; IN
	defc	'IN'
	defw	blk-6
inn:
	defw	douse
	defb	18h
;
;
	defb	83h			; OUT
	defc	'OUT'
	defw	inn-5
outt:
	defw	douse
	defb	1ah
;
;
	defb	83h			; SCR
	defc	'SCR'
	defw	outt-6
scr:
	defw	douse
	defb	1ch
;
;
	defb	86h			; OFFSET
	defc	'OFFSET'
	defw	scr-6
ofset:
	defw	douse
	defb	1eh
;
;
	defb	87h			; CONTEXT
	defc	'CONTEXT'
	defw	ofset-9
cont:
	defw	douse
	defb	20h
;
;
	defb	87h			; CURRENT
	defc	'CURRENT'
	defw	cont-0ah
curr:
	defw	douse
	defb	22h
;
;
	defb	85h			; STATE
	defc	'STATE'
	defw	curr-0ah
state:
	defw	douse
	defb	24h
;
;
	defb	84h			; BASE
	defc	'BASE'
	defw	state-8
base:
	defw	douse
	defb	26h
;
;
	defb	83h			; DPL
	defc	'DPL'
	defw	base-7
dpl:
	defw	douse
	defb	28h
;
;
	defb	83h			; FLD
	defc	'FLD'
	defw	dpl-6
fld:
	defw	douse
	defb	2ah
;
;
	defb	83h			; CSP
	defc	'CSP'
	defw	fld-6
cspp:
	defw	douse
	defb	2ch
;

	defb	82h			; R#
	defc	'R#'
	defw	cspp-6
rnum:
	defw	douse
	defb	2eh
;

	defb	83h			; HLD
	defc	'HLD'
	defw	rnum-5
hld:
	defw	douse
	defw	30h
;
;	END OF USER VARIABLES
;
	defb	82h			; 1+
	defc	'1+'
	defw	hld-6
onep:
	defw	$+2			;/
	pop	hl			;/
	inc	hl			;/
	jhpush				;/
;
;
	defb	82h			; 2+
	defc	'2+'
	defw	onep-5
twop:
	defw	$+2			;/
	pop	hl			;/
	inc	hl			;/
	inc	hl			;/
	jhpush				;/
;
;
	defb	82h			;/ 1-
	defc	'1-'			;/
	defw	twop-5			;/
onemin:
	defw	$+2			;/
	pop	hl			;/
	dec	hl			;/
	jhpush				;/
;
;
	defb	82h			;/ 2-
	defc	'2-'			;/
	defw	onemin-5		;/
twomin:
	defw	$+2			;/
	pop	hl			;/
	dec	hl			;/
	dec	hl			;/
	jhpush				;/
;
;
	defb	82h			;/ 2*
	defc	'2*'			;/
	defw	twomin-5		;/
twosta:
	defw	$+2			;/
	pop	hl			;/
	add	hl,hl			;/ asl hl
	jhpush				;/
;
;
	defb	82h			;/ 2/
	defc	'2/'			;/
	defw	twosta-5		;/
twosla:
	defw	$+2			;/
	pop	hl			;/
	bit	7,h			;/ negative?
	jr	z,twosl1		;/ no
	inc	hl			;/ yes, add 1
twosl1:
	sra	h			;/
	rr	l			;/ asr hl
	jhpush				;/
;
;
	defb	84h			; HERE
	defc	'HERE'
	defw	twosla-5
here:
	defw	docol
	defw	dp
	defw	at
	defw	semis
;
;
	defb	85h			; ALLOT
	defc	'ALLOT'
	defw	here-7
allot:
	defw	docol
	defw	dp
	defw	pstor
	defw	semis
;
;
	defb	81h			; ,
	defc	','
	defw	allot-8
comma:
	defw	docol
	defw	here
	defw	store
	defw	two
	defw	allot
	defw	semis
;

	defb	82h			; C,
	defc	'C,'
	defw	comma-4
ccomm:
	defw	docol
	defw	here
	defw	cstor
	defw	one
	defw	allot
	defw	semis
;
;
	defb	81h			; -
	defc	'-'
	defw	ccomm-5
subb:
	defw	$+2
	pop	de
	pop	hl
	subw	hl,de			;/
	jhpush
;
;
	defb	81h			; =
	defc	'='
	defw	subb-4
equal:
	defw	$+2			;/
	pop	de			;/
	pop	hl			;/
	subw	hl,de			;/
	ld	hl,0			;  hl <-- false
	jr	nz,equal1
	inc	l			;/ hl <-- true
equal1:
	jhpush
;
;
	defb	81h			;  <
	defc	'<'
	defw	equal-4
less:
	defw	$+2
	pop	de
	pop	hl			; hl de <
	ld	a,d
	xor	h			; one operand negative?
	jp	m,less1			; yes, determine which
	subw	hl,de			;/
less1:
	bit	7,h			;/ h negative?
	ld	hl,0			; hl <-- false
	jr	z,less2
	inc	l			;/ hl <-- true
less2:
	jhpush
;
;
	defb	82h			; U<
	defc	'U<'
	defw	less-4
uless:
	defw	$+2
	pop	de
	pop	hl			;/ hl de U<
	subw	hl,de			;/
	ld	hl,0			; hl <-- false
	rl	l			;/ bit 0 <-- carry
uless1:
	jhpush
;
;
	defb	81h			; >
	defc	'>'
	defw	uless-5
great:
	defw	$+2
	pop	hl			;/
	pop	de			;/ hl de >    (= de hl < )
	ld	a,d
	xor	h			; one operand negative?
	jp	m,great1		; yes, determine which
	subw	hl,de			;/
great1:
	bit	7,h			;/ h negative?
	ld	hl,0			; hl <-- false
	jr	z,great2
	inc	l			;/ hl <-- true
great2:
	jhpush
;
;
	defb	83h			; ROT     ( n1 n2 n3 --- n2 n3 n1)
	defc	'ROT'
	defw	great-4
rot:
	defw	$+2
	pop	de			; de <-- n3
	pop	hl			; hl <-- n2
	ex	(sp),hl			; s1 <-- n2, hl <-- n1
	jp	dpush			; s2 <-- n3, s3 <-- n1
;
;
	defb	85h			; SPACE
	defc	'SPACE'
	defw	rot-6
space:
	defw	docol
	defw	bl
	defw	emit
	defw	semis
;
;
	defb	84h			; -DUP
	defc	'-DUP'
	defw	space-8
ddup:
	defw	$+2			;/
	ldw	hl,(sp+0)		;/
	ld	a,h			;/
	or	l			;/ hl = 0?
	jr	z,ddup1			;/ yes, don't dup
	push	hl			;/
ddup1:
	jnext
;
;
	defb	88h			; TRAVERSE
	defc	'TRAVERSE'
	defw	ddup-7
trav:
	defw	docol
	defw	swap
trav1:
	defw	over			; begin
	defw	plus
	defw	lit
	defw	7fh
	defw	over
	defw	cat
	defw	less
	defw	zbran			; until
	defw	trav1-$
	defw	swap
	defw	drop
	defw	semis
;
;
	defb	86h			; LATEST
	defc	'LATEST'
	defw	trav-0bh
lates:
	defw	docol
	defw	curr
	defw	at
	defw	at
	defw	semis
;
;
	defb	83h			; LFA
	defc	'LFA'
	defw	lates-9
lfa:
	defw	$+2
	pop	hl			;/ hl <-- pfa
	subw	hl,4			;/
	jhpush				;/ s1 <-- lfa
;
;
	defb	83h			; CFA
	defc	'CFA'
	defw	lfa-6
cfa:
	defw	docol
	defw	twomin			;/
	defw	semis
;
;
	defb	83h			; NFA
	defc	'NFA'
	defw	cfa-6
nfa:
	defw	docol
	defw	lit
	defw	5
	defw	subb
	defw	lit
	defw	-1
	defw	trav
	defw	semis
;
;
	defb	83h			; PFA
	defc	'PFA'
	defw	nfa-6
pfa:
	defw	docol
	defw	one
	defw	trav
	defw	lit
	defw	5
	defw	plus
	defw	semis
;
;
	defb	84h			; !CSP
	defc	'!CSP'
	defw	pfa-6
scsp:
	defw	docol
	defw	spat
	defw	cspp
	defw	store
	defw	semis
;
;
	defb	86h			; ?ERROR
	defc	'?ERROR'
	defw	scsp-7
qerr:
	defw	docol
	defw	swap
	defw	zbran			; if
	defw	qerr1-$
	defw	error
	defw	bran			; else
	defw	qerr2-$
qerr1:
	defw	drop			; endif
qerr2:
	defw	semis
;
;
	defb	85h			; ?COMP
	defc	'?COMP'
	defw	qerr-9
qcomp:
	defw	docol
	defw	state
	defw	at
	defw	zequ
	defw	lit
	defw	11h
	defw	qerr
	defw	semis
;
;
	defb	85h			; ?EXEC
	defc	'?EXEC'
	defw	qcomp-8
qexec:
	defw	docol
	defw	state
	defw	at
	defw	lit
	defw	12h
	defw	qerr
	defw	semis
;
;
	defb	86h			; ?PAIRS
	defc	'?PAIRS'
	defw	qexec-8
qpair:
	defw	docol
	defw	subb
	defw	lit
	defw	13h
	defw	qerr
	defw	semis
;
;
	defb	84h			; ?CSP
	defc	'?CSP'
	defw	qpair-9
qcsp:
	defw	docol
	defw	spat
	defw	cspp
	defw	at
	defw	subb
	defw	lit
	defw	14h
	defw	qerr
	defw	semis
;
;
	defb	88h			; ?LOADING
	defc	'?LOADING'
	defw	qcsp-7
qload:
	defw	docol
	defw	blk
	defw	at
	defw	zequ
	defw	lit
	defw	16h
	defw	qerr
	defw	semis
;
;
	defb	87h			; COMPILE
	defc	'COMPILE'
	defw	qload-0bh
comp:
	defw	docol
	defw	qcomp
	defw	fromr
	defw	dup
	defw	twop
	defw	tor
	defw	at
	defw	comma
	defw	semis
;
;
	defb	0c1h			; [
	defc	'['
	defw	comp-0ah
lbrac:
	defw	docol
	defw	zero
	defw	state
	defw	store
	defw	semis
;
;
	defb	81h			; ]
	defc	']'
	defw	lbrac-4
rbrac:
	defw	docol
	defw	lit,0c0h
	defw	state,store
	defw	semis
;
;
	defb	86h			; SMUDGE
	defc	'SMUDGE'
	defw	rbrac-4
smudg:
	defw	docol
	defw	lates
	defw	lit
	defw	20h
	defw	toggl
	defw	semis
;
;
	defb	83h			; HEX
	defc	'HEX'
	defw	smudg-9
hex:
	defw	docol
	defw	lit
	defw	10h
	defw	base
	defw	store
	defw	semis
;
;
	defb	87h			; DECIMAL
	defc	'DECIMAL'
	defw	hex-6
dec:
	defw	docol
	defw	lit
	defw	0ah
	defw	base
	defw	store
	defw	semis
;
;
	defb	87h			; (;CODE)
	defc	'(;CODE)'
	defw	dec-0ah
pscod:
	defw	docol
	defw	fromr
	defw	lates
	defw	pfa
	defw	cfa
	defw	store
	defw	semis
;
;
	defb	0c5h			; ;CODE
	defc	';CODE'
	defw	pscod-0ah
semic:
	defw	docol
	defw	qcsp
	defw	comp
	defw	pscod
	defw	lbrac
semi1:
	defw	noop			; assembler
	defw	semis
;
;
	defb	87h			; <BUILDS
	defc	'<BUILDS'
	defw	semic-8
build:
	defw	docol
	defw	zero
	defw	con
	defw	semis
;
;
	defb	85h			; DOES>
	defc	'DOES>'
	defw	build-0ah
does:
	defw	docol
	defw	fromr
	defw	lates
	defw	pfa
	defw	store
	defw	pscod
dodoe:
	ld	hl,(rpp)
	dec	hl
	dec	hl
	ldw	(hl),bc			;/
	ld	(rpp),hl
	inc	de
	ex	de,hl
	ldw	bc,(hl)			;/
	inc	hl
	inc	hl
	jhpush
;
;
	defb	85h			; COUNT
	defc	'COUNT'
	defw	does-8
count:
	defw	docol
	defw	dup
	defw	onep
	defw	swap
	defw	cat
	defw	semis
;
;
	defb	84h			; TYPE
	defc	'TYPE'
	defw	count-8
type:
	defw	docol
	defw	ddup
	defw	zbran			; if
	defw	type1-$
	defw	over
	defw	plus
	defw	swap
	defw	xdo			; do
type2:
	defw	ido
	defw	cat
	defw	emit
	defw	xloop			; loop
	defw	type2-$
	defw	bran			; else
	defw	type3-$
type1:
	defw	drop			; endif
type3:
	defw	semis
;
;
	defb	89h			; -TRAILING
	defc	'-TRAILING'
	defw	type-7
dtrai:
	defw	docol
	defw	dup
	defw	zero
	defw	xdo			; do
dtra1:
	defw	tdup			;/
	defw	plus
	defw	onemin			;/
	defw	cat
	defw	bl
	defw	subb
	defw	zbran			; if
	defw	dtra2-$
	defw	leave
	defw	bran			; else
	defw	dtra3-$
dtra2:
	defw	onemin			;/
dtra3:
	defw	xloop			; loop
	defw	dtra1-$
	defw	semis
;
;
	defb	84h			; (.")
	defc	'(.")'
	defw	dtrai-0ch
pdotq:
	defw	docol
	defw	rr
	defw	count
	defw	dup
	defw	onep
	defw	fromr
	defw	plus
	defw	tor
	defw	type
	defw	semis
;
;
	defb	0c2h			; ."
	defc	'."'
	defw	pdotq-7
dotq:
	defw	docol
	defw	lit
	defw	22h
	defw	state
	defw	at
	defw	zbran			; if
	defw	dotq1-$
	defw	comp
	defw	pdotq
	defw	word
	defw	here
	defw	cat
	defw	onep
	defw	allot
	defw	bran			; else
	defw	dotq2-$
dotq1:
	defw	word
	defw	here
	defw	count
	defw	type			; endif
dotq2:
	defw	semis
;
;
	defb	86h			; EXPECT
	defc	'EXPECT'
	defw	dotq-5
expec:
	defw	docol
	defw	over
	defw	plus
	defw	over
	defw	xdo			; do
expe1:
	defw	key
	defw	dup
	defw	lit
	defw	0eh
	defw	porig
	defw	at
	defw	equal
	defw	zbran			; if
	defw	expe2-$
	defw	drop
	defw	dup
	defw	ido
	defw	equal
	defw	dup
	defw	fromr
	defw	twomin			;/
	defw	plus
	defw	tor
	defw	zbran			; if
	defw	expe6-$
	defw	lit
	defw	bell
	defw	bran			; else
	defw	expe7-$
expe6:
	defw	lit
	defw	bsout			; endif
expe7:
	defw	bran			; else
	defw	expe3-$
expe2:
	defw	dup
	defw	lit
	defw	acr			;/
	defw	equal
	defw	zbran			; if
	defw	expe4-$
	defw	leave
	defw	drop
	defw	bl
	defw	zero
	defw	bran			; else
	defw	expe5-$
expe4:
	defw	dup			; endif
expe5:
	defw	ido
	defw	cstor
	defw	zero
	defw	ido
	defw	onep
	defw	store			; endif
expe3:
	defw	emit
	defw	xloop			; loop
	defw	expe1-$
	defw	drop
	defw	semis
;
;
	defb	85h			; QUERY
	defc	'QUERY'
	defw	expec-9
query:
	defw	docol
	defw	tib
	defw	at
	defw	lit
	defw	50h
	defw	expec
	defw	zero
	defw	inn
	defw	store
	defw	semis
;
;
	defb	0c1h			; NULL
	defb	80h
	defw	query-8
null:
	defw	docol
	defw	blk
	defw	at
	defw	zbran			; if
	defw	null1-$
	defw	one
	defw	blk
	defw	pstor
	defw	zero
	defw	inn
	defw	store
	defw	blk
	defw	at
	defw	bscr
	defw	onemin			;/
	defw	andd
	defw	zequ
	defw	zbran			; if
	defw	null2-$
	defw	qexec
	defw	fromr
	defw	drop			; endif
null2:
	defw	bran			; else
	defw	null3-$
null1:
	defw	fromr
	defw	drop			; endif
null3:
	defw	semis
;
	defb	84h			; FILL
	defc	'FILL'
	defw	null-4
fill:
	defw	$+2
	exx				;/ save ip
	pop	de			;/ e <-- byte
	pop	bc			;  bc <-- quantity
	pop	hl			;/ hl <-- address
fill1:
	ld	a,b
	or	c			;  qty == 0?
	jr	z,fill2			;  yes, nothing (more) to fill
	ld	(hl),e			;/ (hl) <-- byte
	inc	hl			;  inc pointer
	dec	bc			;  dec counter
	jp	fill1			;/
fill2:
	exx				;/ restore ip
	jnext
;
;
	defb	85h			; ERASE
	defc	'ERASE'
	defw	fill-7
erasee:
	defw	docol
	defw	zero
	defw	fill
	defw	semis
;
;
	defb	86h			; BLANKS
	defc	'BLANKS'
	defw	erasee-8
blank:
	defw	docol
	defw	bl
	defw	fill
	defw	semis
;
;
	defb	84h			; HOLD
	defc	'HOLD'
	defw	blank-9
hold:
	defw	docol
	defw	lit
	defw	-1
	defw	hld
	defw	pstor
	defw	hld
	defw	at
	defw	cstor
	defw	semis
;
;
	defb	83h			; PAD
	defc	'PAD'
	defw	hold-7
pad:
	defw	docol
	defw	here
	defw	lit
	defw	44h
	defw	plus
	defw	semis
;
;
	defb	84h			; WORD
	defc	'WORD'
	defw	pad-6
word:
	defw	docol
	defw	blk
	defw	at
	defw	zbran			; if
	defw	word1-$
	defw	blk
	defw	at
	defw	block
	defw	bran			; else
	defw	word2-$
word1:
	defw	tib
	defw	at			; endif
word2:
	defw	inn
	defw	at
	defw	plus
	defw	swap
	defw	encl
	defw	here
	defw	lit
	defw	22h
	defw	blank
	defw	inn
	defw	pstor
	defw	over
	defw	subb
	defw	tor
	defw	rr
	defw	here
	defw	cstor
	defw	plus
	defw	here
	defw	onep
	defw	fromr
	defw	cmove
	defw	semis
;
;
	defb	88h			; (NUMBER)
	defc	'(NUMBER)'
	defw	word-7
pnumb:
	defw	docol
pnum1:
	defw	onep			; begin
	defw	dup
	defw	tor
	defw	cat
	defw	base
	defw	at
	defw	digit
	defw	zbran			; while
	defw	pnum2-$
	defw	swap
	defw	base
	defw	at
	defw	ustar
	defw	drop
	defw	rot
	defw	base
	defw	at
	defw	ustar
	defw	dplus
	defw	dpl
	defw	at
	defw	onep
	defw	zbran			; if
	defw	pnum3-$
	defw	one
	defw	dpl
	defw	pstor			; endif
pnum3:
	defw	fromr
	defw	bran			; repeat
	defw	pnum1-$
pnum2:
	defw	fromr
	defw	semis
;
;
	defb	86h			; NUMBER
	defc	'NUMBER'
	defw	pnumb-0bh
numb:
	defw	docol
	defw	zero
	defw	zero
	defw	rot
	defw	dup
	defw	onep
	defw	cat
	defw	lit
	defw	2dh
	defw	equal
	defw	dup
	defw	tor
	defw	plus
	defw	lit
	defw	-1
numb1:
	defw	dpl			; begin
	defw	store
	defw	pnumb
	defw	dup
	defw	cat
	defw	bl
	defw	subb
	defw	zbran			; while
	defw	numb2-$
	defw	dup
	defw	cat
	defw	lit
	defw	2eh
	defw	subb
	defw	zero
	defw	qerr
	defw	zero
	defw	bran			; repeat
	defw	numb1-$
numb2:
	defw	drop
	defw	fromr
	defw	zbran			; if
	defw	numb3-$
	defw	dminu			; endif
numb3:
	defw	semis
;
;
	defb	85h			; -FIND (0-3) SUCCESS
	defc	'-FIND'			;       (0-1) FAILURE
	defw	numb-9
dfind:
	defw	docol
	defw	bl
	defw	word
	defw	here
	defw	cont
	defw	at
	defw	at
	defw	pfind
	defw	dup
	defw	zequ
	defw	zbran			; if
	defw	dfin1-$
	defw	drop
	defw	here
	defw	lates
	defw	pfind			; endif
dfin1:
	defw	semis
;
;
	defb	87h			; (ABORT)
	defc	'(ABORT)'
	defw	dfind-8
pabor:
	defw	docol
	defw	abort
	defw	semis
;
	defb	85h			; ERROR
	defc	'ERROR'
	defw	pabor-0ah
error:
	defw	docol
	defw	warn
	defw	at
	defw	zless
	defw	zbran			; if
	defw	erro1-$
	defw	pabor			; endif
erro1:
	defw	here
	defw	count
	defw	type
	defw	pdotq
	defb	2
	db	'? '
	defw	mess
	defw	spsto
;	CHANGE FROM fig MODEL
;	defw	inn,at,blk,at
	defw	blk,at
	defw	ddup
	defw	zbran,erro2-$		; if
	defw	inn,at
	defw	swap			; endif
erro2:
	defw	quit
;
;
	defb	83h			; ID.
	defc	'ID.'
	defw	error-8
iddot:
	defw	docol
	defw	pad
	defw	lit
	defw	20h
	defw	blank			;/
	defw	dup
	defw	pfa
	defw	lfa
	defw	over
	defw	subb
	defw	dup			;/ change frm MODEL
	defw	tor			;/ to suppress BIT 7
	defw	pad
	defw	swap
	defw	cmove
	defw	pad
	defw	fromr			;/ for terminals
	defw	pad			;/ with an 8 bit
	defw	plus			;/ ASCII character set.
	defw	onemin			;/
	defw	dup			;/
	defw	at			;/
	defw	lit			;/
	defw	7fh			;/
	defw	andd			;/
	defw	swap			;/
	defw	store			;/
	defw	count
	defw	lit
	defw	1fh			;  WIDTH
	defw	andd
	defw	type
	defw	space
	defw	semis
;
	defb	86h			; CREATE
	defc	'CREATE'
	defw	iddot-6
creat:
	defw	docol
	defw	dfind
	defw	zbran			; if
	defw	crea1-$
	defw	drop
	defw	nfa
	defw	iddot
	defw	lit
	defw	4
	defw	mess
	defw	space			; endif
crea1:
	defw	here
	defw	dup
	defw	cat
	defw	width
	defw	at
	defw	min
	defw	onep
	defw	allot
	defw	dup
	defw	lit
	defw	0a0h
	defw	toggl
	defw	here
	defw	onemin
	defw	lit
	defw	80h
	defw	toggl
	defw	lates
	defw	comma
	defw	curr
	defw	at
	defw	store
	defw	here
	defw	twop
	defw	comma
	defw	semis
;
;
	defb	0c9h			; [COMPILE]
	defc	'[COMPILE]'
	defw	creat-9
bcomp:
	defw	docol
	defw	dfind
	defw	zequ
	defw	zero
	defw	qerr
	defw	drop
	defw	cfa
	defw	comma
	defw	semis
;
;
	defb	0c7h			; LITERAL
	defc	'LITERAL'
	defw	bcomp-0ch
liter:
	defw	docol
	defw	state
	defw	at
	defw	zbran			; if
	defw	lite1-$
	defw	comp
	defw	lit
	defw	comma			; endif
lite1:
	defw	semis
;
;
	defb	0c8h			; DLITERAL
	defc	'DLITERAL'
	defw	liter-0ah
dlite:
	defw	docol
	defw	state
	defw	at
	defw	zbran			; if
	defw	dlit1-$
	defw	swap
	defw	liter
	defw	liter			; endif
dlit1:
	defw	semis
;
;
	defb	86h			; ?STACK
	defc	'?STACK'
	defw	dlite-0bh
qstac:
	defw	docol
	defw	spat
	defw	szero
	defw	at
	defw	swap
	defw	uless
	defw	one
	defw	qerr
	defw	spat
	defw	here
	defw	lit
	defw	80h
	defw	plus
	defw	uless
	defw	lit
	defw	7
	defw	qerr
	defw	semis
;
;
	defb	89h			; INTERPRET
	defc	'INTERPRET'
	defw	qstac-9
inter:
	defw	docol
inte1:
	defw	dfind			; begin
	defw	zbran			; if
	defw	inte2-$
	defw	state
	defw	at
	defw	less
	defw	zbran			; if
	defw	inte3-$
	defw	cfa
	defw	comma
	defw	bran			; else
	defw	inte4-$
inte3:
	defw	cfa
	defw	exec			; endif
inte4:
	defw	qstac
	defw	bran			; else
	defw	inte5-$
inte2:
	defw	here
	defw	numb
	defw	dpl
	defw	at
	defw	onep
	defw	zbran			; if
	defw	inte6-$
	defw	dlite
	defw	bran			; else
	defw	inte7-$
inte6:
	defw	drop
	defw	liter			; endif
inte7:
	defw	qstac			; endif
inte5:
	defw	bran			; again
	defw	inte1-$
;
;
	defb	89h			; IMMEDIATE
	defc	'IMMEDIATE'
	defw	inter-0ch
immed:
	defw	docol
	defw	lates
	defw	lit
	defw	40h
	defw	toggl
	defw	semis
;
;
	defb	8ah			; VOCABULARY
	defc	'VOCABULARY'
	defw	immed-0ch
vocab:
	defw	docol
	defw	build
	defw	lit
	defw	0a081h
	defw	comma
	defw	curr
	defw	at
	defw	cfa
	defw	comma
	defw	here
	defw	vocl
	defw	at
	defw	comma
	defw	vocl
	defw	store
	defw	does
dovoc:
	defw	twop
	defw	cont
	defw	store
	defw	semis
;
;
	defb	0c5h			; FORTH
	defc	'FORTH'
	defw	vocab-0dh
forth:
	defw	dodoe
	defw	dovoc
	defw	0a081h
	defw	task-7			; cold start value only
;					  changed aech time a def is appended
;					  to the FORTH vocabulary
	defw	0			; end of vocabulary list
;
;
	defb	8bh			; DEFINITIONS
	defc	'DEFINITIONS'
	defw	forth-8
defin:
	defw	docol
	defw	cont
	defw	at
	defw	curr
	defw	store
	defw	semis
;
;
	defb	0c1h			; (
	defc	'('
	defw	defin-0eh
paren:
	defw	docol
	defw	lit
	defw	29h
	defw	word
	defw	semis
;
;
	defb	84h			; QUIT
	defc	'QUIT'
	defw	paren-4
quit:
	defw	docol
	defw	zero
	defw	blk
	defw	store
	defw	lbrac
quit1:
	defw	rpsto			; begin
	defw	cr
	defw	query
	defw	inter
	defw	state
	defw	at
	defw	zequ
	defw	zbran			; if
	defw	quit2-$
	defw	pdotq
	defb	2
	db	'ok'			; endif
quit2:
	defw	bran			; again
	defw	quit1-$
;
;
	defb	85h			; ABORT
	defc	'ABORT'
	defw	quit-7
abort:
	defw	docol
	defw	spsto
	defw	dec
	defw	qstac
	defw	cr
	defw	dotcpu
	defw	pdotq
	defb	0eh			; count of chrs to follow
	db	'fig-FORTH '
	defb	figrel+30h,adot,figrev+30h,usrver
	defw	forth
	defw	defin
	defw	quit
;
;
wrm:	ld	bc,wrm1
	jnext
wrm1:	defw	warm
;
;
	defb	84h			; WARM
	defc	'WARM'
	defw	abort-8
warm:
	defw	docol
	defw	mtbuf
	defw	abort
;
;
cld:
	ld	hl,(bdoss+1)		;/
	ld	l,0			;/ hl <-- fbase
	ld	(limit+2),hl		;/ set limit
	ld	de,bufsiz		;/ de <-- total disc buffer size
	subw	hl,de			;/ hl <-- addr. of 1st disc buffer
	ld	(first+2),hl		;/ set FIRST
	ld	(use+2),hl		;/ set USE
	ld	(prev+2),hl		;/ set PREV
	ld	(buf1),hl		;/
	ld	de,us			;/ de <-- user variable space
	subw	hl,de			;/ hl <-- initr0
	ld	(upinit),hl		;/
	ld	(r0init),hl		;/
	ld	(up),hl			;/
	ld	(rpp),hl		;/
	ld	de,rts			;/ de <-- rtn stack & term. buf space
	subw	hl,de			;/ hl <-- inits0
	ld	(s0init),hl		;/
	ld	(tibini),hl		;/
	ld	sp,hl			;/
	ld	bc,cld1
	ld	ix,next			; pointer to next
	ld	iy,hpush		; pointer to hpush
	jnext
;
;
cld1:	defw	cold
;
	defb	84h			; COLD
	defc	'COLD'
	defw	warm-7
cold:
	defw	docol
	defw	mtbuf
	defw	one,recadr		; AvdH
	defw	store
	defw	lit,buf1
	defw	at			;/
	defw	use,store
	defw	lit,buf1
	defw	at			;/
	defw	prev,store
	defw	drzer
	defw	zero			;/
	defw	lit,eprint
	defw	cstor			;/
;
	defw	lit
	defw	orig+12h
	defw	lit
	defw	up
	defw	at
	defw	lit
	defw	6
	defw	plus
	defw	lit
	defw	10h
	defw	cmove
	defw	lit
	defw	orig+0ch
	defw	at
	defw	lit
	defw	forth+6
	defw	store
	defw	fcb			;/A
	defw	lit,opnfil		;/A open mass storage
	defw	bdos			;/A
	defw	lit,0ffh		;/A
	defw	equal			;/A file present?
	defw	zbran,cld2-$		;/A
	defw	zero			;/A
	defw	warn,store		;/A
	defw	cr,pdotq		;/A
	defb	7			;/A
	db	'No file'		;/A
cld2:
	defw	abort
;
;
	defb	84h			; S->D
	defc	'S->D'
	defw	cold-7
stod:	defw	$+2
	pop	hl			;/
	exts	hl			;/ de <-- h(7)
	ex	de,hl			;/
	jp	dpush			; ( n1 -- d1L d1H)
;
;
	defb	82h			; +-
	defc	'+-'
	defw	STOD-7
pm:
	defw	docol
	defw	zless
	defw	zbran			; if
	defw	pm1-$
	defw	minus			; endif
pm1:
	defw	semis
;
;
	defb	83h			; D+-
	defc	'D+-'
	defw	pm-5
dpm:
	defw	docol
	defw	zless
	defw	zbran			; if
	defw	dpm1-$
	defw	dminu			; endif
dpm1:
	defw	semis
;
;
	defb	83h			; ABS
	defc	'ABS'
	defw	dpm-6
abs:
	defw	docol
	defw	dup
	defw	pm
	defw	semis
;
;
	defb	84h			; DABS
	defc	'DABS'
	defw	abs-6
dabs:
	defw	docol
	defw	dup
	defw	dpm
	defw	semis
;
;
	defb	83h			; MIN
	defc	'MIN'
	defw	dabs-7
min:
	defw	docol
	defw	tdup
	defw	great
	defw	zbran			; if
	defw	min1-$
	defw	swap			; endif
min1:
	defw	drop
	defw	semis
;
;
	defb	83h			; MAX
	defc	'MAX'
	defw	min-6
max:	defw	docol
	defw	tdup
	defw	less
	defw	zbran			; if
	defw	max1-$
	defw	swap			; endif
max1:
	defw	drop
	defw	semis
;
;
	defb	82h			; M*   ( n1 n2 --- d)
	defc	'M*'
	defw	max-6
mstar:
	defw	$+2			;/
	pop	de			; de <-- multiplicator
	pop	hl			; hl <-- multiplicant
	multw	hl,de			;/ dehl <-- hl * de
	ex	de,hl			;/
	jp	dpush			;/ ( n1 n2 --- d1l d1h)
;
;
	defb	82h			;/ M/   ( d n1 --- nrem nquot)
	defc	'M/'
	defw	mstar-5
mslas:
	defw	$+2			; ( d n1 --- n2 n3)
	exx				; save ip
	pop	hl			; divisor
	ld	a,h
	and	80h			; filter sign
	jr	z,mslas1		; positive
	neg	hl			; make positive
mslas1:
	ld	b,h
	ld	c,l			; bc <-- divisor
	pop	hl			; dividend.hw
	pop	de			; dividend.lw
	bit	7,h			; negative?
	jr	z,mslas2		; no
	inc	a			; dividend sign flag
	push	hl
	ld	hl,0
	subw	hl,de			; neg dividend.lw
	pop	de			; dividend.hw
	push	hl
	ld	hl,0
	sbc	hl,de			; neg dividend.hw
	pop	de			; dividend.lw
mslas2:
	cpw	hl,bc			; dividend.hw >= divisor
	jr	c,mslas3		; no overflow, continue
	ld	hl,0ffffh
	ld	d,h
	ld	e,l			; set rem & quot to max.
	jr	mslas5
;
mslas3:
	ex	de,hl			; dehl <-- dividend.hw,lw
	divuw	dehl,bc			; de <-- remainder, hl <-- quotient
	ex	de,hl			; hl <-- remainder
	bit	0,a			; was dividend negative
	jr	z,mslas4		; no
	neg	hl			;/ yes, negate remainder
mslas4:
	ex	de,hl			; hl <-- quotient
	or	a
	jr	z,mslas5		; neither operand negative
	cp	81h			; both operands negative?
	jr	z,mslas5		; yes, quotient stays positive
	neg	hl			;/ no, negate quotient
mslas5:
	push	de			; remainder
	push	hl			; quotient
	exx				; restore ip
	jnext
;
;
	defb	81h			; *   ( n1 n2 --- nproduct)
	defc	'*'
	defw	mslas-5
star:
	defw	$+2
	pop	de
	pop	hl
	multw	hl,de			;/ dehl <-- product
	jhpush
;
;
	defb	84h			; /MOD   ( n1 n2 --- nrem nquot)
	defc	'/MOD'
	defw	star-4
slmod:
	defw	$+2
	exx				;/ save ip
	pop	bc			;/ divisor
	pop	hl			;  dividend
	ld	a,b
	or	c			;/ div by 0?
	jr	nz,slmod1		;/ no, continue
	ld	de,0ffffh
	ld	h,d
	ld	l,e			;/ set remainder & quotient to max.
	jr	slmod3
slmod1:
	cpw	hl,8000h		;/ special case -32768 -1 /
	jr	nz,slmod2		;/ continue
	ld	a,b
	cp	0ffh
	jr	nz,slmod2
	cp	c			;/ lo byte also 0ffh?
	jr	nz,slmod2		;/ no, go & divide
	ld	de,0			;/ remainder
	jr	slmod3			;/ exit with dividend unchanged
slmod2:
	exts	hl			;/ de <-- dividend.hw
	divw	dehl,bc			;/ de <-- remainder, hl <-- quotient
slmod3:
	push	de
	push	hl
	exx				;/ restore ip
	jnext
;
;
	defb	81h			; /
	defc	'/'
	defw	slmod-7
slash:
	defw	$+2
	exx				;/ save ip
	pop	bc			;/ divisor
	pop	hl			;  dividend
	ld	a,b
	or	c			;/ division by 0?
	jr	nz,slash1		;/ no, continue
	ld	hl,0ffffh		;/ set quotient to max.
	jr	slash3
slash1:
	cpw	hl,8000h		;/ special case -32768 -1 /
	jr	nz,slash2		;/ dividend not -32768
	ld	a,b
	cp	0ffh
	jr	nz,slash2		;/ divisor not -1
	cp	c
	jr	z,slash3		;/ return with dividend unchanged
slash2:
	exts	hl			;/ de <-- dividend.hw
	divw	dehl,bc			;/ hl <-- quotient
slash3:
	push	hl			;/ quotient
	exx				;/ restore ip
	jnext
;
;
	defb	83h			;/ MOD
	defc	'MOD'
	defw	slash-4
modd:
	defw	$+2
	exx				; save ip
	pop	bc			; divisor
	pop	hl			;  dividend
	ld	a,b
	or	c			; division by 0?
	jr	nz,modd1		; no, continue
	ld	de,0ffffh		; set remainder to max
	jr	modd3
modd1:
	cpw	hl,8000h		;/ special case -32768 -1 /
	jr	nz,modd2		; dividend not -32768
	ld	a,b
	cp	0ffh
	jr	nz,modd2		; divisor not -1
	cp	c
	jr	nz,modd2		; go & divide
	ld	de,0			; remainder
	jr	modd3
modd2:
	exts	hl			; de <-- dividend.hw
	divw	dehl,bc			; de <-- remainder
modd3:
	push	de			; remainder
	exx				; restore ip
	jnext
;
;
	defb	85h			;/ */MOD
	defc	'*/MOD'
	defw	modd-6
ssmod:
	defw	$+2
	exx				; save ip
	pop	hl			; divisor
	ld	a,h
	and	80h			; filter sign
	jr	z,ssmod1		; positive
	neg	hl			; make positive
ssmod1:
	ld	b,h
	ld	c,l			; bc <-- divisor
	pop	hl			; multipicator
	pop	de			; multiplicant
	ex	af,af' 			; save sign flag
	multw	hl,de			; dehl <-- product (= dividend)
	ex	af,af' 			; restore sign flag
	ex	de,hl			; de <-- dividend.lw
	bit	7,h			; dividend negative?
	jr	z,ssmod2		; no
	inc	a			; dividend sign flag
	push	hl
	ld	hl,0
	subw	hl,de			; neg dividend.lw
	pop	de			; dividend.hw
	push	hl
	ld	hl,0
	sbc	hl,de			; neg dividend.hw
	pop	de			; dividend.lw
ssmod2:
	cpw	hl,bc			; dividend.hw >= divisor?
	jr	c,ssmod3		; no overflow, continue
	ld	hl,0ffffh
	ld	d,h
	ld	e,l			; set rem & quot to max
	jr	ssmod5
;
ssmod3:
	ex	de,hl			; dehl <-- dividend.hw,lw
	divuw	dehl,bc			; de <-- remainder, hl <-- quotient
	ex	de,hl			; hl <-- remainder
	bit	0,a			; was dividend negative?
	jr	z,ssmod4		; no
	neg	hl			; yes, negate remainder
ssmod4:
	ex	de,hl			; hl <-- quotient
	or	a
	jr	z,ssmod5		; neither operand negative
	cp	81h			; both operands negative?
	jr	z,ssmod5		; yes, quotient stays positive
	neg	hl			; no, negate quotient
ssmod5:
	push	de			; remainder
	push	hl			; quotient
	exx				; restore ip
	jnext
;
;
	defb	82h			; */
	defc	'*/'
	defw	ssmod-8
ssla:
	defw	$+2			;/
	exx				; save ip
	pop	hl			; divisor
	ld	a,h
	and	80h			; filter sign
	jr	z,ssla1			; positive
	neg	hl			; make positive
ssla1:
	ld	b,h
	ld	c,l			; bc <-- divisor
	pop	hl			; multipicator
	pop	de			; multiplicant
	ex	af,af' 			; save sign flag
	multw	hl,de			; dehl <-- product (= dividend)
	ex	af,af' 			; restore sign flag
	ex	de,hl			; de <-- dividend.lw
	bit	7,h			; dividend negative?
	jr	z,ssla2			; no
	inc	a			; dividend sign flag
	push	hl
	ld	hl,0
	subw	hl,de			; neg dividend.lw
	pop	de			; dividend.hw
	push	hl
	ld	hl,0
	sbc	hl,de			; neg dividend.hw
	pop	de			; dividend.lw
ssla2:
	cpw	hl,bc			; dividend.hw >= divisor?
	jr	c,ssla3			; no overflow, continue
	ld	hl,0ffffh		; set quotient to max
	jr	ssla4
;
ssla3:
	ex	de,hl			; dehl <-- dividend.hw,lw
	divuw	dehl,bc			; de <-- remainder, hl <-- quotient
	or	a
	jr	z,ssla4			; neither operand negative
	cp	81h			; both operands negative?
	jr	z,ssla4			; yes, quotient stays positive
	neg	hl			; no, negate quotient
ssla4:
	push	hl			; quotient
	exx				; restore ip
	jnext
;
;
	defb	85h			; M/MOD
	defc	'M/MOD'
	defw	ssla-5
msmod:
	defw	docol
	defw	tor
	defw	zero
	defw	rr
	defw	uslas
	defw	fromr
	defw	swap
	defw	tor
	defw	uslas
	defw	fromr
	defw	semis
;
;
;	Block moved down 2 pages
;
	defb	86h			; (LINE)
	defc	'(LINE)'
	defw	msmod-8
pline:
	defw	docol
	defw	tor
	defw	lit
	defw	40h
	defw	bbuf
	defw	ssmod
	defw	fromr
	defw	bscr
	defw	star
	defw	plus
	defw	block
	defw	plus
	defw	lit
	defw	40h
	defw	semis
;
;
	defb	85h			; .LINE
	defc	'.LINE'
	defw	pline-9
dline:
	defw	docol
	defw	pline
	defw	dtrai
	defw	type
	defw	semis
;
;
	defb	87h			; MESSAGE
	defc	'MESSAGE'
	defw	dline-8
mess:
	defw	docol
	defw	warn
	defw	at
	defw	zbran			; if
	defw	mess1-$
	defw	ddup
	defw	zbran			; if
	defw	mess2-$
	defw	lit
	defw	4			; 1st message screen
	defw	ofset
	defw	at
	defw	bscr
	defw	slash
	defw	subb
	defw	dline
	defw	space			; endif
mess2:
	defw	bran			; else
	defw	mess3-$
mess1:
	defw	pdotq
	defb	6
	db	'MSG # '
	defw	dot			; endif
mess3:	defw	semis
;
;
	defb	82h			; P@
	defc	'P@'
	defw	mess-0ah
ptat:
	defw	$+2
	exx				;d save registers
	pop	bc			;d bc <-- port#
	in	l,(c)			;d l <-- data byte
	ld	h,0
	push	hl
	exx				;d restore registers
	jnext
;
;
	defb	82h			; P!
	defc	'P!'
	defw	ptat-5
ptsto:
	defw	$+2
	exx				;d save registers
	pop	bc			;d c <-- port#
	pop	hl			;d L <-- date byte
	out	(c),l
	exx				;d restore registers
	jnext
;
;
	page
include	DISCIO.Z80
	page
include	CONPRTIO.Z80
	page
;
	defb	0c1h			; ' (tick)
	defb	0a7h
	defw	arrow-6
tick:
	defw	docol
	defw	dfind
	defw	zequ
	defw	zero
	defw	qerr
	defw	drop
	defw	liter
	defw	semis
;
;
	defb	86h			; FORGET
	defc	'FORGET'
	defw	tick-4
forg:
	defw	docol
	defw	curr
	defw	at
	defw	cont
	defw	at
	defw	subb
	defw	lit
	defw	18h
	defw	qerr
	defw	tick
	defw	dup
	defw	fence
	defw	at
	defw	uless			;/ FORGET >8000h nw o.k.
	defw	lit
	defw	15h
	defw	qerr
	defw	dup
	defw	nfa
	defw	dp
	defw	store
	defw	lfa
	defw	at
	defw	cont
	defw	at
	defw	store
	defw	semis
;
;
	defb	84h			; BACK
	defc	'BACK'
	defw	forg-9
back:
	defw	docol
	defw	here
	defw	subb
	defw	comma
	defw	semis
;
;
	defb	0c5h			; BEGIN
	defc	'BEGIN'
	defw	back-7
begin:
	defw	docol
	defw	qcomp
	defw	here
	defw	one
	defw	semis
;
;
	defb	0c5h			; ENDIF
	defc	'ENDIF'
	defw	begin-8
endiff:
	defw	docol
	defw	qcomp
	defw	two
	defw	qpair
	defw	here
	defw	over
	defw	subb
	defw	swap
	defw	store
	defw	semis
;
;
	defb	0c4h			; THEN
	defc	'THEN'
	defw	endiff-8
then:	defw	docol
	defw	endiff
	defw	semis
;
;
	defb	0c2h			; DO
	defc	'DO'
	defw	then-7
do:
	defw	docol
	defw	comp
	defw	xdo
	defw	here
	defw	three
	defw	semis
;
;
	defb	0c4h			; LOOP
	defc	'LOOP'
	defw	do-5
loop:
	defw	docol
	defw	three
	defw	qpair
	defw	comp
	defw	xloop
	defw	back
	defw	semis
;
;
	defb	0c5h			; +LOOP
	defc	'+LOOP'
	defw	loop-7
ploop:
	defw	docol
	defw	three
	defw	qpair
	defw	comp
	defw	xploo
	defw	back
	defw	semis
;
;
	defb	0c5h			; UNTIL
	defc	'UNTIL'
	defw	ploop-8
until:
	defw	docol
	defw	one
	defw	qpair
	defw	comp
	defw	zbran
	defw	back
	defw	semis
;
;
	defb	0c3h			; END
	defc	'END'
	defw	until-8
endd:
	defw	docol
	defw	until
	defw	semis
;
;
	defb	0c5h			; AGAIN
	defc	'AGAIN'
	defw	endd-6
again:
	defw	docol
	defw	one
	defw	qpair
	defw	comp
	defw	bran
	defw	back
	defw	semis
;
;
	defb	0c6h			; REPEAT
	defc	'REPEAT'
	defw	again-8
repea:
	defw	docol
	defw	tor
	defw	tor
	defw	again
	defw	fromr
	defw	fromr
	defw	twomin			;/
	defw	endiff
	defw	semis
;
;
	defb	0c2h			; IF
	defc	'IF'
	defw	repea-9
iff:
	defw	docol
	defw	comp
	defw	zbran
	defw	here
	defw	zero
	defw	comma
	defw	two
	defw	semis
;
;
	defb	0c4h			; ELSE
	defc	'ELSE'
	defw	iff-5
elsee:
	defw	docol
	defw	two
	defw	qpair
	defw	comp
	defw	bran
	defw	here
	defw	zero
	defw	comma
	defw	swap
	defw	two
	defw	endiff
	defw	two
	defw	semis
;
;
	defb	0c5h			; WHILE
	defc	'WHILE'
	defw	elsee-7
while:
	defw	docol
	defw	iff
	defw	twop
	defw	semis
;
;
	defb	86h			; SPACES
	defc	'SPACES'
	defw	while-8
spacs:
	defw	docol
	defw	zero
	defw	max
	defw	ddup
	defw	zbran			; if
	defw	spax1-$
	defw	zero
	defw	xdo			; do
spax2:
	defw	space
	defw	xloop			; loop endif
	defw	spax2-$
spax1:
	defw	semis
;
;
	defb	82h			; <#
	defc	'<#'
	defw	spacs-9
bdigs:
	defw	docol
	defw	pad
	defw	hld
	defw	store
	defw	semis
;
;
	defb	82h			; #>
	defc	'#>'
	defw	bdigs-5
edigs:
	defw	docol
	defw	drop
	defw	drop
	defw	hld
	defw	at
	defw	pad
	defw	over
	defw	subb
	defw	semis
;
;
	defb	84h			; SIGN
	defc	'SIGN'
	defw	edigs-5
sign:
	defw	docol
	defw	rot
	defw	zless
	defw	zbran			; if
	defw	sign1-$
	defw	lit
	defw	2dh
	defw	hold			; endif
sign1:
	defw	semis
;
;
	defb	81h			; #
	defc	'#'
	defw	sign-7
dig:
	defw	docol
	defw	base
	defw	at
	defw	msmod
	defw	rot
	defw	lit
	defw	9
	defw	over
	defw	less
	defw	zbran			; if
	defw	dig1-$
	defw	lit
	defw	7
	defw	plus			; endif
dig1:	defw	lit
	defw	30h
	defw	plus
	defw	hold
	defw	semis
;
;
	defb	82h			; #S
	defc	'#S'
	defw	dig-4
digs:
	defw	docol
digs1:
	defw	dig			; begin
	defw	tdup			;/
	defw	orr
	defw	zequ
	defw	zbran			; until
	defw	digs1-$
	defw	semis
;
;
	defb	83h			; D.R
	defc	'D.R'
	defw	digs-5
ddotr:
	defw	docol
	defw	tor
	defw	swap
	defw	over
	defw	dabs
	defw	bdigs
	defw	digs
	defw	sign
	defw	edigs
	defw	fromr
	defw	over
	defw	subb
	defw	spacs
	defw	type
	defw	semis
;
;
	defb	82h			; .R
	defc	'.R'
	defw	ddotr-6
dotr:
	defw	docol
	defw	tor
	defw	stod
	defw	fromr
	defw	ddotr
	defw	semis
;
;
	defb	82h			; D.
	defc	'D.'
	defw	dotr-5
ddot:
	defw	docol
	defw	zero
	defw	ddotr
	defw	space
	defw	semis
;
;
	defb	81h			; .
	defc	'.'
	defw	ddot-5
dot:
	defw	docol
	defw	stod
	defw	ddot
	defw	semis
;
;
	defb	81h			; ?
	defc	'?'
	defw	dot-4
ques:
	defw	docol
	defw	at
	defw	dot
	defw	semis
;
;
	defb	82h			; U.
	defc	'U.'
	defw	ques-4
udot:	defw	docol
	defw	zero
	defw	ddot
	defw	semis
;

	defb	85h			; VLIST
	defc	'VLIST'
	defw	udot-5
vlist:
	defw	docol
	defw	lit
	defw	80h
	defw	outt
	defw	store
	defw	cont
	defw	at
	defw	at
vlis1:
	defw	outt			; begin
	defw	at
	defw	csll
	defw	great
	defw	zbran			; if
	defw	vlis2-$
	defw	cr
	defw	zero
	defw	outt
	defw	store			; endif
vlis2:
	defw	dup
	defw	iddot
	defw	space
	defw	space
	defw	pfa
	defw	lfa
	defw	at
	defw	dup
	defw	zequ
	defw	qterm
	defw	orr
	defw	zbran			; until
	defw	vlis1-$
	defw	drop
	defw	semis
;
;
	defb	83h			; BYE
	defc	'BYE'
	defw	vlist-8
bye:
	defw	docol			;/A
	defw	flush			;/A
	defw	fcb,lit			;/E
	defw	10h,bdos		;/E close file
	defw	drop			;/E discard directory code
	defw	zero,zero		;/A
	defw	bdos			;/A return to CP/M
	defw	semis			;/A won't get this far, just for pretty
;
;
	defb	84h			; LIST
	defc	'LIST'
	defw	bye-6
list:
	defw	docol,dec
	defw	cr,dup
	defw	scr,store
	defw	pdotq
	defb	6
	db	'SCR # '
	defw	dot
	defw	lit,10h
	defw	zero,xdo
list1:
	defw	cr,ido
	defw	three			;/ was lit,3
	defw	dotr,space
	defw	ido,scr
	defw	at,dline
	defw	qterm
	defw	zbran,list2-$		; if
	defw	leave
list2:
	defw	xloop,list1-$		; endif
	defw	cr
	defw	semis
;
;
	defb	85H		;INDEX
	defc	'INDEX'
	defw	list-7
index:
	defw	docol
	defw	lit,ff
	defw	emit
	defw	cr
	defw	onep,swap
	defw	xdo
inde1:
	defw	cr,ido
	defw	three			;/ was lit,3
	defw	dotr,space
	defw	zero,ido
	defw	dline,qterm
	defw	zbran,inde2-$		; if
	defw	leave			; endif
inde2:
	defw	xloop,inde1-$
	defw	semis
;
;
	defb	85h			; TRIAD
	defc	'TRIAD'
	defw	index-8
triad:
	defw	docol
	defw	lit,ff
	defw	emit
	defw	three			;/ was lit,3
	defw	slash
	defw	three			;/ was lit,3
	defw	star
	defw	three			;/ was lit,3
	defw	over,plus
	defw	swap,xdo
tria1:
	defw	cr,ido
	defw	list
	defw	qterm
	defw	zbran,tria2-$		; if
	defw	leave
tria2:
	defw	xloop,tria1-$		; endif
	defw	cr
	defw	lit,15
	defw	mess,cr
	defw	semis
;
;
	defb	84h			; .CPU
	defc	'.CPU'
	defw	triad-8
dotcpu:
	defw	docol
	defw	base,at
	defw	lit,36
	defw	base,store
	defw	lit,22h
	defw	porig,tat
	defw	ddot
	defw	base,store
	defw	semis
;
;
	defb	86h			; setclk
	defc	'setclk'
	defw	dotcpu-7
setclk:
	defw	$+2
	exx				; save ip
	ld	c,iopreg
	ldctl	hl,(c)			; l <-- current i/o page
	ld	a,l
	ex	af,af' 			; save i/o page
	ld	l,0feh
	ldctl	(c),hl			; select i/o page 0feh
	xor	a
	out	(cntrl0),a		; disable c/t 0
	out	(cntrl1),a		; disable c/t 1
	out	(config1),a
	ld	hl,0ffffh
	ld	a,10h
	out	(config0),a		; cascade c/t 0 - c/t 1
	ld	c,tcon0
	outw	(c),hl			; load c/t 0 time constant
	ld	c,tcon1
	outw	(c),hl			; load c/t 1 time constatnt
	ld	a,80h
	out	(config1),a		; continous mode
	ld	a,0e0h
	out	(cntrl1),a		; start 32bit counter
	ex	af,af' 			; std. accu
	ld	l,a			; l <-- previous i/o page
	ld	c,iopreg
	ldctl	(c),hl			; restore i/o page
	exx				; restore ip
	jnext
;
;
	defb	86h			; getclk
	defc	'getclk'
	defw	setclk-9
getclk:
	defw	$+2
	exx				; save ip
	ld	c,iopreg
	ldctl	hl,(c)			; l <-- current i/o page
	ld	a,l
	ex	af,af' 			; save current i/o page
	ld	l,0feh
	ldctl	(c),hl			; select i/o page 0feh
	ld	a,80h
	out	(cntrl1),a		; halt 32bit counter
	ld	c,count1
	inw	hl,(c)
	ld	d,h
	ld	e,l			; de <-- count1
	ld	c,count0
	inw	hl,(c)			; hl <-- count0
	ld	c,0
	ld	a,c			; a <-- 0
	sub	l			; 0 - l
	ld	l,a			; l <-- neg(l)
	ld	a,c			; a <-- 0
	sbc	a,h
	ld	h,a			; h <-- neg(h)
	ld	a,c			; a <-- 0
	sbc	a,e
	ld	e,a			; e <-- neg(e)
	ld	a,c			; a <-- 0
	sbc	a,d
	ld	d,a			; d <-- neg(d), dehl <-- neg(dehl)
	divuw	dehl,25000		; scale to 1/100 secs
	push	hl			; result
	ex	af,af' 			; std. accu
	ld	l,a			; l <-- previous i/o page
	ld	c,iopreg
	ldctl	(c),hl			; restore i/o page
	exx				; restore ip
	jnext
;
;
	defb	84h			; TASK
	defc	'TASK'
	defw	getclk-9
;	defw	dotcpu-7
task:
	defw	docol
	defw	semis
;
;
initdp:
	defw	0
;
	end	orig
                                                                                                                                	title	< Z280 fig-FORTH 1.1 a >
	subttl	Adaptive version
;
;
; Modified from Z80 fig-FORTH 1.1h by EHR 880830
; Modified frm FIG document keyed by Dennis L. Wilson 800907
; Converted frm "8080 FIG-FORTH VERSION A0 15SEP79"
;
; fig-FORTH release 1.1 for the 8080 processor.
;
; ALL PUBLICATIONS OF THE FORTH INTEREST GROUP
; ARE PUBLIC DOMAIN. THEY MAY BE FURTHER
; DISTRIBUTED BY THE INCLUSION OF THIS CREDIT NOTICE:
;
; This publication has been made available by the
;	Forth Interest Group
;	P.O.Box 1105
;	San Carlos, CA 94070
;	U.S.A.
;
; Implementation on 8080 by:
;	John Cassady
;	339 15th Street
;	Oakland, CA 94612
;	U.S.A
;	on 790528
; Modified by:
;	Kim Harris
; Acknowledgements:
;	George Flammer
;	Robt. D. Villwock
; ----------------------------------------------------------------------
; Z80 Version for Cromemco CDOS & Digital Research CP/M by:
;	Dennis Lee Wilson c/o
;	Aristotelian Logicians
;	2631 East Pinchot Avenue
;	Phoenix, AZ 85016
;	U.S.A.
; ----------------------------------------------------------------------
; The 2 byte Z80 code for Jump Relative (JR) has been substituted for
; the 3 byte Jump (JP) wherever practical. The port I/O words P@ & P!
; have been made ROMable by use of Z80 instructions.
; ----------------------------------------------------------------------
; Further modifications (marked ;/) by:
;	Edmund Ramm
;	P.O.Box 38
;	2358 Kaltenkirchen
;	Fed. Rep. of Germany	840418
;
; 850419	changed * (star)
; 850507	added   0<>, 0>, TUCK, NIP, -ROT, CSWAP, PICK
; 850511	added	-CMOVE
;
; -----------------------------------------------------------------------------
; Disc I/O has been modified a la Albert van der Horst (HCCH) to employ
; CP/M 2.x's random access feature.
; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------
;
; Z280 specifics
;
;
iopreg		equ	08h		; i/o page register
;
config0		equ	0e0h		; c/t 0 configuration register
cntrl0		equ	0e1h		; c/t 0 command/status register
tcon0		equ	0e2h		; c/t 0 time constatnt register
count0		equ	0e3h		; c/t 0 count-time register
config1		equ	0e8h		; c/t 1 configuration register
cntrl1		equ	0e9h		; c/t 1 command/status register
tcon1		equ	0eah		; c/t 1 time constant register
count1		equ	0ebh		; c/t 1 count-time register
;
; -----------------------------------------------------------------------------
;
;	Release & Version numbers
;
figrel		equ	1		;FIG RELEASE #
figrev		equ	1		;FIG REVISION #
usrver		equ	61h		;USER VERSION # a by EHR
;
;Console & printer drivers are in external source named
;CONPRTIO.FTH & disc drivers in DISCIO.FTH. It has 4 screen
;buffers & end of memory is set to FBASE from locn. 0007H.
	page
;	ASCII characters used
;
abl		equ	20h		;BLANK
acr		equ	0dh		;CR
adot		equ	2eh		;.
bell		equ	07h		;^G
bsin		equ	08h		;backspace chr = ^H
bsout		equ	08h
dle		equ	10h		;^P
lf		equ	0ah		;^J
ff		equ	0ch		;^L
;
;	Memory allocation
;
bdoss		equ	0005h		;/ system entry
nscr		equ	4		;  # of 1024 byte screens
kbbuf		equ	128		;  bytes/disc buffer
us		equ	40h		;  user variables space
rts		equ	400h		;  Return Stack & term buff space
co		equ	kbbuf+4		;  Disc buff + 2 header + 2 tail
nbuf		equ	nscr*400h/kbbuf	;  # of buffers
bufsiz		equ	co*nbuf		;/ total disc buffer size
	page
	aseg
	.z280
;
	org	0100h
;
orig:
	nop
	jp	cld			; vector to cold start
	nop
	jp	wrm			; vector to warm start
	defb	figrel			; fig release #
	defb	figrev			; fig revision #
	defb	usrver			; user version #
	defb	0eh			; implementation attributes
;
;
;
;	0eh = 0000:1110
;	      ---------
; B +ORIGIN   ...W:IEBA
;
; W: 0=above sufficient
;    1=other differences exist
; I: Interpreter is	0=pre-
;			1=post incrementing
; E: Addr must be even: 0 yes
;			1 no
; B: High byte @	0=low addr.
;			1=high addr.
; A: CPU Addr.		0=BYTE
;			1=WORD
;
;
;
	defw	task-7			;  topmost word in FORTH vocabulary
	defw	bsin			;  backspace chr
upinit:	defw	0			;/ init (up)
;
; * Following used by COLD; must be in same order as user variables *
;
s0init:	defw	0			;/ init (s0)
r0init:	defw	0			;/ init (r0)
tibini:	defw	0			;/ init (TIB)
	defw	1fh			;  init (WIDTH)
	defw	0			;  init (WARNING)
	defw	initdp			;  init (FENCE)
	defw	initdp			;  init (dp)
	defw	forth+8			;  init (VOC-LINK)
;
; *  END DATA USED BY COLD *
;
	defw	0018h,0f600h		; Z280 CPU name (hw,lw)
					; (32 bit base 36 integer)
	page
;	REGISTERS
;
;	FORTH	Z80	FORTH PRESERVATION RULES
;	-----	---	-----------------------
;	IP	BC	should be preserved
;			accross FORTH words.
;	W	DE	sometimes output from
;			NEXT, may be altered
;			b4 JP'ing to NEXT,
;			input only when 
;			"DPUSH" called.
;	SP	SP	should be used only as
;			Data Stack accross
;			FORTH words, may be
;			used within FORTH
;			words if restored
;			b4 "NEXT"
;		HL	Never output frm NEXT
;			input only when
;			"HPUSH" called
;
;
up:	defw	0			;/ user area ptr
rpp:	defw	0			;/ return stack ptr
buf1:	defw	0			;/ address of 1st disc buffer
;
;
;	COMMENT CONVENTIONS:
;
;	==	means "is equal to"
;	<--	means assignment
;	#NAME	=     value of name
;	NAME    =     contents @ name
;	(NAME)  =     contents of cell addressed by name
;	cfa	=     code field address
;	lfa	=     link field address
;	nfa	=     name field address
;	pfa	=     parameter field address
;	s1	=     1st word of parameter stack
;	s2	=     2nd -"-  of    -"-     -"-
;	r1	=     1st -"-  of return stack
;	r2	=     2nd -"-  of  -"-    -"-
; ( above Stack posn. valid b4 & after execution of any word, not during)
;
;	lsb	=     least significant bit
;	msb	=     most  significant bit
;	lb	=     low  byte
;	hb	=     high byte
;	lw	=     low  word
;	hw	=     high word
; (May be used as suffix to above names)
	page
;	FORTH ADDRESS INTERPRETER
;	POST INCREMENTING VERSION
;
;
;
dpush:
	push	de
hpush:
	push	hl			; iy points here
next:
	ld	h,b			;/ w <-- (ip)    ix points here
	ld	l,c			;/
	ldw	hl,(hl)			;/ (hl) --> cfa
	inc	bc
	inc	bc			;/ ip += 2
next1:
	ldw	de,(hl)			;/ pc <-- (w)
	ex	de,hl
	inc	de
	jp	(hl)			; note: de <-- cfa + 1
;
;
jnext	macro
	jp	(ix)
	endm
;
jhpush	macro
	jp	(iy)
	endm
;
	page
;	FORTH DICTIONARY
;	DICTIONARY FORMAT:
;
;				BYTE
;	ADDRESS NAME		CONTENTS
;	------- ----		--------
;						(MSB=1
;						(P=PRECEDENCE BIT
;						(S=SMUDGE BIT
;	NFA	NAME FIELD	1PS<LEN>	<NAME LENGTH
;				0<1CHAR>	MSB=0, NAME'S 1st CHAR
;				0<2CHAR>
;				  ...
;				1<LCHAR>	MSB=1, NAME'S LAST CHAR
;	LFA	LINK FIELD	<LINKLB>	=PREVIOUS WORD'S NFA
;				<LINKHB>
;LABEL:	CFA	CODE FIELD	<CODELB>	=ADDR CPU CODE
;				<CODEHB>
;	PFA	PARAMETER	<1PARAM>	1st PARAMETER BYTE
;		FIELD		<2PARAM>
;				  ...
;
;
;
dp0:
	defb	83h			; LIT
	defc	'LIT'
	defw	0			; lfa == 0 marks end of dictionary 
lit:
	defw	$+2			; s1 <-- (ip)
	ld	h,b
	ld	l,c
	ldw	hl,(hl)			; hl <-- (ip) = literal
	inc	bc			;/
	inc	bc			;/ ip += 2
	jhpush				; s1 <-- hl
;
;
	defb	87h			; EXECUTE
	defc	'EXECUTE'
	defw	lit-6
exec:
	defw	$+2
	pop	hl
	jp	next1
;
;
	defb	86h			; BRANCH
	defc	'BRANCH'
	defw	exec-0ah
bran:
	defw	$+2			; ip += (ip)
bran1:
	ld	h,b
	ld	l,c			; hl <-- ip
	addw	hl,(hl)			; hl <-- ip + branch offset
	ld	c,l
	ld	b,h			; ip += branch offset
	jnext
;
;
	defb	87h			; 0BRANCH
	defc	'0BRANCH'
	defw	bran-9
zbran:
	defw	$+2
	pop	hl
	ld	a,l
	or	h
	jr	z,bran1			; branch if if s1 == 0
	inc	bc			; else skip branch offset
	inc	bc
	jnext
;
;
	defb	86h			; (LOOP)
	defc	'(LOOP)'
	defw	zbran-0ah
xloop:
	defw	$+2
	ld	hl,(rpp)		; (hl) --> index = r1
	incw	(hl)			;/ index += 1
	ldw	de,(hl)			;/ de <-- new index
	inc	hl			;/
	inc	hl			;/ hl --> limit(lb)
	ld	a,e
	sub	(hl)
	ld	a,d
	inc	hl			; hl --> limit(hb)
	sbc	a,(hl)			; index < limit?
	jp	m,bran1			; yes, loop again
	inc	hl			; no, done
	ld	(rpp),hl		; discard r1 & r2
	inc	bc
	inc	bc			; skip branch offset
	jnext
;
;
	defb	87h			; (+LOOP)
	defc	'(+LOOP)'
	defw	xloop-9
xploo:
	defw	$+2
	pop	de			; de <-- increment
	ld	hl,(rpp)		; hl --> index
	ld	a,(hl)			; index += increment
	add	a,e
	ld	(hl),a
	ld	e,a
	inc	hl
	ld	a,(hl)
	adc	a,d
	ld	(hl),a
	inc	hl			; (hl) --> limit
	inc	d
	dec	d
	ld	d,a			; de <-- new index
	jp	m,xloo2			; if incr > 0
	ld	a,e
	sub	(hl)			; then a <-- index - limit
	ld	a,d
	inc	hl
	sbc	a,(hl)
	jp	xloo3

xloo2:
	ld	a,(hl)			; else  a <-- limit - index
	sub	e
	inc	hl
	ld	a,(hl)
	sbc	a,d
;					; if a < 0
xloo3:
	jp	m,bran1			; then loop again
	inc	hl			; else done
	ld	(rpp),hl		; discard r1 & r2
	inc	bc			; skip branch offset
	inc	bc
	jnext
;
;
	defb	84h			;  (DO)
	defc	'(DO)'
	defw	xploo-0ah
xdo:
	defw	$+2
	pop	de			;  de <-- initial index
	ld	hl,(rpp)		;  hl <-- rp
	dec	hl
	dec	hl
	pop	(hl)			;/ r2 <-- limit
	dec	hl
	dec	hl
	ldw	(hl),de			;/ r1 <-- initial index
	ld	(rpp),hl		;  rp -= 4
	jnext
;
;
	defb	81h			; I
	defc	'I'
	defw	xdo-7
ido:
	defw	$+2
	ld	hl,(rpp)
	push	(hl)			;/ s1 <-- r1, r1 unchanged
	jnext
;
;
	defb	85h			; DIGIT
	defc	'DIGIT'
	defw	ido-4
digit:
	defw	$+2
	pop	hl			; l <-- s1.lb = base value
	pop	de			; e <-- s2.lb = chr to be converted
	ld	a,e			; a <-- chr
	sub	'0'			; >= 0?
	jr	c,digi2			;/ < 0 is invalid
	cp	0ah			; > 9?
	jr	c,digi1			;/ no, test base value
	sub	07h			; gap between '9' & 'A', nw 'A'=0ah
	cp	0ah			; >= 'A'?
	jr	c,digi2			;/ chrs btwn '9' & 'A' are invalid
digi1:
	cp	l			; < base value?
	jr	nc,digi2		;/ no, invalid
	ld	e,a			; s2 <-- de = converted digit
	ld	hl,0001h		; s1 <-- true
	jp	dpush
;
digi2:
	ld	l,h			; hl <-- false
	jhpush				; s1 <-- false
;
;
	defb	86h			; (FIND) (2-1)FAILURE
	defc	'(FIND)'		;        (2-3)SUCCESS
	defw	digit-8
pfind:
	defw	$+2
	pop	de			; de <-- nfa
pfin1:
	pop	hl			; hl <-- string addr
	push	hl			; save for next iteration
	ld	a,(de)
	xor	(hl)			; filter differences
	and	3fh			; mask msb & precedence bit
	jr	nz,pfin4		; lengths differ
pfin2:
	inc	hl			; hl --> next string chr
	inc	de			; de --> next name field chr
	ld	a,(de)
	xor	(hl)			; filter differences
	add	a,a			; shift msbit into carry
	jr	nz,pfin3		; no match
	jr	nc,pfin2		; match so far, loop agn
	ld	hl,0005h		; string matches
	add	hl,de			; (sp) <-- pfa
	ex	(sp),hl
pfin6:
	dec	de			; de --> nfa
	ld	a,(de)
	or	a			; msb=1? =length byte
	jp	p,pfin6			; no, try next chr
	ld	e,a			; e <-- length byte
	ld	d,00h
	ld	hl,0001h		; hl <-- true
	jp	dpush			; name field found, return
;
; above name field not a match, try next one
;
pfin3:
	jr	c,pfin5			; carry=end of name field
pfin4:
	inc	de			; find name field end
	ld	a,(de)
	or	a			; msb=1?
	jp	p,pfin4			; no, loop
pfin5:
	inc	de			; de <-- lfa
	ex	de,hl
	ldw	de,(hl)			;/ de <-- lfa
	ld	a,d
	or	e			; end of dictionary (lfa = 0)?
	jr	nz,pfin1		; no, try previous definition
	pop	hl			; drop string address
	ld	hl,0			; hl <-- false
	jhpush				; no match found, return
;
;
	defb	87h			; ENCLOSE
	defc	'ENCLOSE'
	defw	pfind-9
encl:
	defw	$+2
	pop	de			; de <-- s1 = delimiter chr
	pop	hl			; hl <-- s2 = addr of text to scan
	push	hl			; s4 <-- addr
	ld	a,e
	ld	d,a			; d <-- delim chr
	ld	e,-1			; init chr offset counter
	dec	hl			; hl <-- addr - 1
encl1:
	inc	hl			; skip over leading delim chrs
	inc	e
	cp	(hl)			; delim chr?
	jr	z,encl1			; yes, loop
	ld	d,0
	push	de			; s3 <-- e = offset to 1st non delim
	ld	d,a			; d <-- delim chr
	ld	a,(hl)
	and	a			; 1st non-delim=null?
	jr	nz,encl2		; no
	ld	d,0			; yes
	inc	e
	push	de			; s2 <-- offset to byte following null
	dec	e
	push	de			; s1 <-- offset to null
	jnext
;
encl2:
	ld	a,d			; A <-- delim chr
	inc	hl			; hl <-- next chr's address
	inc	e			; e <-- offset to next chr
	cp	(hl)			; delim chr?
	jr	z,encl4			; yes
	ld	a,(hl)
	and	a			; null?
	jr	nz,encl2		; no, continue scan
encl3:
	ld	d,0
	push	de			; s2 <-- offset to null
	push	de			; s1 <-- offset to null
	jnext
;
encl4:
	ld	d,0
	push	de			; s2 <-- offset to byte following text
	inc	e
	push	de			; s1 <-- offset 2 bytes aft end of word
	jnext
;
;
	defb	84h			; EMIT
	defc	'EMIT'
	defw	encl-0ah
emit:
	defw	docol
	defw	pemit
	defw	one,outt
	defw	pstor,semis
;
;
	defb	83h			; KEY
	defc	'KEY'
	defw	emit-7
key:
	defw	$+2
	jp	pkey
;
;
	defb	89h			; ?TERMINAL
	defc	'?TERMINAL'
	defw	key-6
qterm:
	defw	$+2
	ld	hl,0
	jp	pqter
;
;
	defb	82h			; CR
	defc	'CR'
	defw	qterm-0ch
cr:
	defw	$+2
	jp	pcr
;
;
	defb	85h			; CMOVE
	defc	'CMOVE'
	defw	cr-5
cmove:
	defw	$+2
	exx				;/ save ip
	pop	bc			;  bc <-- s1 = # of chrs
	pop	de			;  de <-- s2 = dest addr
	pop	hl			;/ hl <-- s3 = source addr
	ld	a,b
	or	c			;  bc=0?
	jr	z,cmove1		;  yes, nothing to move
	ldir				;/ xfer string
cmove1:
	exx				;/ restore ip
	jnext
;
;
	defb	86h			;/   -CMOVE    ( from to count --- )
	defc	'-CMOVE'
	defw	cmove-8
bcmov:
	defw	$+2
	exx				; save ip
	pop	bc			; bc <-- count
	pop	de			; de <-- destination
	pop	hl			; hl <-- source
	ld	a,b
	or	c			; bc =0?
	jr	z,bcmov1		; yes, nothing to move
	add	hl,bc
	dec	hl			; hl --> hi end of source block
	ex	de,hl
	add	hl,bc
	dec	hl
	ex	de,hl			; de --> hi end of dest. block
	lddr				; (de) <-- (hl), --hl,bc until bc=0
bcmov1:
	exx				; restore ip
	jnext
;
;
	defb	82h			; U*   16*16 unsigned multiply
	defc	'U*'			;      with 32 bit result
	defw	bcmov-9
ustar:
	defw	$+2
	pop	de			; de <-- multiplier
	pop	hl			; hl <-- multiplicant
	multuw	hl,de			;/
	ex	de,hl			;/ de <-- product.lw, hl <-- product.hw
	jp	dpush			; s2,s1 <-- product.lw,hw
;
;
	defb	82h			; U/   ( ud u1 -- urem uq )
	defc	'U/'
	defw	ustar-5
uslas:
	defw	$+2
	exx				;/ save ip
	pop	bc			; bc <-- divisor
	pop	hl			; hl <-- dividend.hw
	pop	de			; de <-- dividend.lw
	cpw	hl,bc			;/ dividend.hw >= divisor?
	jr	c,usla1			; no, go ahead
	ld	hl,0ffffh		; yes, overflow
	ld	d,h
	ld	e,l			;/ set rem & quot to max
	jr	usla2
usla1:
	ex	de,hl			;/ de,hl <-- dividend.hw,lw
	divuw	dehl,bc			;/ de <-- remainder, hl <-- quotient
usla2:
	push	de			;/ s2 <-- remainder
	push	hl			;/ s1 <-- quotient
	exx				;/ restore ip
	jnext
;
;
	defb	83h			; AND
	defc	'AND'
	defw	uslas-5
andd:
	defw	$+2			; s1 <-- s1 AND s2
	pop	de
	pop	hl
	ld	a,e
	and	l
	ld	l,a
	ld	a,d
	and	h
	ld	h,a
	jhpush
;
;
	defb	82h			; OR
	defc	'OR'
	defw	andd-6
orr:
	defw	$+2			; s1 <-- s1 OR s2
	pop	de
	pop	hl
	ld	a,e
	or	l
	ld	l,a
	ld	a,d
	or	h
	ld	h,a
	jhpush
;
;
	defb	83h			; XOR
	defc	'XOR'
	defw	orr-5
xorr:
	defw	$+2			; s1 <-- s1 XOR s2
	pop	de
	pop	hl
	ld	a,e
	xor	l
	ld	l,a
	ld	a,d
	xor	h
	ld	h,a
	jhpush
;
;
	defb	83h			; SP@
	defc	'SP@'
	defw	xorr-6
spat:
	defw	$+2
	ld	hl,0
	add	hl,sp			; hl <-- sp
	jhpush				; s1 <-- sp
;
;
	defb	83h			; SP!
	defc	'SP!'
	defw	spat-6
spsto:
	defw	$+2			; sp <-- s0  (user variable)
	ld	hl,(up)			; hl <-- user variables base address
	ld	de,6
	add	hl,de			; hl --> s0
	ldw	sp,(hl)			;/ sp <-- s0
	jnext
;
;
	defb	83h			; RP@
	defc	'RP@'
	defw	spsto-6
rpat:
	defw	$+2
	ld	hl,(rpp)
	jhpush				; s1 <-- rp
;
;
	defb	83h			; RP!
	defc	'RP!'
	defw	rpat-6
rpsto:
	defw	$+2			; rp <-- r0 (user variable)
	ld	hl,(up)			; hl <-- user variables base address
	ld	de,0008h
	add	hl,de			; hl --> r0
	ldw	hl,(hl)			;/ hl <-- r0
	ld	(rpp),hl		;/ rp <-- r0
	jnext
;
;
	defb	82h			; ;S
	defc	';S'
	defw	rpsto-6
semis:
	defw	$+2			; ip <-- r1 
	ld	hl,(rpp)
	ldw	bc,(hl)			;/ bc <-- r1
	inc	hl
	inc	hl
	ld	(rpp),hl		; rp += 2
	jnext
;
;
	defb	85h			; LEAVE
	defc	'LEAVE'
	defw	semis-5
leave:
	defw	$+2			; limit <-- index
	ld	hl,(rpp)
	ldw	de,(hl)			;/ de <-- r1 (= index)
	inc	hl
	inc	hl
	ldw	(hl),de			;/ r2 (= limit) <-- index
	jnext
;
;
	defb	82h			; >R
	defc	'>R'
	defw	leave-8
tor:
	defw	$+2
	ld	hl,(rpp)
	dec	hl
	dec	hl
	pop	(hl)			;/ r1 <-- s1
	ld	(rpp),hl		;  rp -= 2
	jnext
;
;
	defb	82h			; R>
	defc	'R>'
	defw	tor-5
fromr:
	defw	$+2
	ld	hl,(rpp)
	push	(hl)			;/ s1 <-- r1
	inc	hl
	inc	hl
	ld	(rpp),hl		; rp += 2
	jnext
;
;
	defb	81h			; R
	defc	'R'
	defw	fromr-5
rr:
	defw	ido+2
;
;
	defb	82h			; 0=
	defc	'0='
	defw	rr-4
zequ:
	defw	$+2
	pop	de
	ld	hl,0
	cpw	hl,de			;/
	jr	nz,zequ1
	inc	l			; hl <-- true
zequ1:
	jhpush
;
;
	defb	83h			;/ 0<>
	defc	'0<>'
	defw	zequ-5
znequ:
	defw	$+2
	pop	de
	ld	hl,0
	cpw	hl,de			;/
	jr	z,znequ1
	inc	l			; hl <-- true
znequ1:
	jhpush
;
;
	defb	82h			; 0<
	defc	'0<'
	defw	znequ-6
zless:
	defw	$+2
	pop	af			;/ a <-- s1.hb
	rla				;/ carry <-- bit 7
	ld	hl,0			;  hl <-- false
	rl	l			;/ bit 0 <-- carry
	jhpush
;
;
	defb	82h			;/ 0>
	defc	'0>'
	defw	zless-5
zgt:
	defw	$+2
	pop	de
	ld	hl,0
	cpw	hl,de			;/
	jp	p,zgt1			;/ <= 0
	jp	pe,zgt1			;/ 8000h special case
	inc	l			;/ hl <-- true
zgt1:
	jhpush
;
;
	defb	81h		;+
	defc	'+'
	defw	zgt-5
plus:
	defw	$+2
	pop	de
	pop	hl
	add	hl,de
	jhpush
;
;
	defb	82h			; D+ ( d1l d1h d2l d2h -- d3l d3h)
	defc	'D+'
	defw	plus-4
dplus:
	defw	$+2
	exx				;/ save ip
	pop	bc			;  bc <-- d2.hw
	pop	hl			;  hl <-- d2.lw
	pop	af			;d af <-- d1.hw
	pop	de			;  de <-- d1.lw
	push	af			;/ s1 <-- d1.hw
	add	hl,de			;  hl <-- d2.lw + d1.lw (= d3.lw)
	ex	de,hl			;  de <-- d3.lw
	pop	hl			;  hl <-- d1.hw
	adc	hl,bc			;/ hl <-- d1.hw + d2.hw +carry (=d3.hw)
	push	de			;  s2 <-- d3.lw
	push	hl			;/ s1 <-- d3.hw
	exx				;/ restore ip
	jnext
;
;
	defb	85h			; MINUS
	defc	'MINUS'
	defw	dplus-5
minus:
	defw	$+2
	pop	hl			;/
	neg	hl			;/
	jhpush
;
;
	defb	86h			; DMINUS
	defc	'DMINUS'
	defw	minus-8
dminu:
	defw	$+2
	exx				;/ save ip
	pop	de			;/ de <-- d1.hw
	pop	bc			;/ bc <-- d1.lw
	ld	hl,0			;/
	subw	hl,bc			;/
	push	hl			; s2 <-- d2.lw
	ld	hl,0			;/
	sbc	hl,de			;/
	push	hl			; s1 <-- d2.hw
	exx				;/
	jnext
;
;
	defb	84h			; OVER
	defc	'OVER'
	defw	dminu-9
over:
	defw	$+2
	ldw	hl,(sp+2)		;/
	jhpush				;/
;
;
	defb	84h			; DROP
	defc	'DROP'
	defw	over-7
drop:
	defw	$+2
	inc	sp
	inc	sp			;/ faster on z280 than dummy pop
	jnext
;
;
	defb	84h			; SWAP
	defc	'SWAP'
	defw	drop-7
swap:
	defw	$+2
	pop	hl
	ex	(sp),hl
	jhpush
;
;
	defb	83h			; DUP
	defc	'DUP'
	defw	swap-7
dup:
	defw	$+2
	ldw	hl,(sp+0)		;/
	jhpush
;
;
	defb	84h			;/ TUCK     ( n1 n2 --- n2 n1 n2)
	defc	'TUCK'
	defw	dup-6
tuck:
	defw	$+2
	pop	hl			;/ hl <-- s1
	pop	de			;/ de <-- s2
	push	hl			;/ s3 <-- hl
	jp	dpush
;
;
	defb	83h			;/ NIP      ( n1 n2 --- n2)
	defc	'NIP'
	defw	tuck-7
nip:
	defw	$+2
	pop	hl			; hl <-- s1
	ldw	(sp+0),hl		;/ s1 <-- hl
	jnext
;
;
	defb	84h			;/ -ROT     ( n1 n2 n3 --- n3 n1 n2)
	defc	'-ROT'
	defw	nip-6
mrot:
	defw	$+2
	pop	hl
	pop	de
	ex	(sp),hl
	ex	de,hl
	jp	dpush
;
;
	defb	85h			;/ CSWAP   ( n1 --- n1, bytes swapped)
	defc	'CSWAP'
	defw	mrot-7
cswap:
	defw	$+2
	pop	hl
	ex	h,l			;/
	jhpush
;
;
	defb	84h			;/ PICK   ( nn...n0 k --- nn..n0 nk)
	defc	'PICK'
	defw	cswap-8
pick:
	defw	$+2
	pop	hl			; hl <-- depth
	add	hl,hl			; adjust to word size
	add	hl,sp			; offset into stack
	push	(hl)			;/
	jnext
;
;
	defb	84h			; 2DUP
	defc	'2DUP'
	defw	pick-7
tdup:
	defw	$+2
	pop	hl
	pop	de
	push	de
	push	hl
	jp	dpush
;
;
	defb	82h			; +!
	defc	'+!'
	defw	tdup-7
pstor:
	defw	$+2
	pop	hl			; hl --> variable
	pop	de			; de <-- number
	ld	a,(hl)
	add	a,e
	ld	(hl),a
	inc	hl
	ld	a,(hl)
	adc	a,d
	ld	(hl),a			; (hl) += number
	jnext
;
;
	defb	86h			; TOGGLE
	defc	'TOGGLE'
	defw	pstor-5
toggl:
	defw	$+2
	pop	de			; e <-- bit pattern
	pop	hl			; hl --> address
	ld	a,(hl)
	xor	e
	ld	(hl),a
	jnext
;
;
	defb	81h			; @
	defc	'@'
	defw	toggl-9
at:
	defw	$+2
	pop	hl
	push	(hl)			;/
	jnext
;
;
	defb	82h			; C@
	defc	'C@'
	defw	at-4
cat:
	defw	$+2
	pop	hl
	ld	l,(hl)
	ld	h,0
	jhpush
;
;
	defb	82h			; 2@
	defc	'2@'
	defw	cat-5
tat:
	defw	$+2
	pop	hl			;  hl --> address
	ldw	de,(hl)			;/ de <-- d.hw
	inc	hl
	inc	hl			;  hl --> d.lw
	push	(hl)			;/ s2 <-- d.lw
	push	de			;/ s1 <-- d.hw
	jnext
;
;
	defb	81h			; !
	defc	'!'
	defw	tat-5
store:
	defw	$+2
	pop	hl			; hl --> address
	pop	(hl)			;/
	jnext
;
;
	defb	82h			; C!
	defc	'C!'
	defw	store-4
cstor:
	defw	$+2
	pop	hl			; hl --> address
	pop	de			; e <-- char
	ld	(hl),e
	jnext
;
;
	defb	82h			; 2!
	defc	'2!'
	defw	cstor-5
tstor:
	defw	$+2
	pop	hl			; hl --> address
	pop	(hl)			;/ store d.hw
	inc	hl
	inc	hl
	pop	(hl)			;/ store d.lw
	jnext
;
;
	defb	0c1h			; :
	defc	':'
	defw	tstor-5
colon:
	defw	docol
	defw	qexec
	defw	scsp
	defw	curr
	defw	at
	defw	cont
	defw	store
	defw	creat
	defw	rbrac
	defw	pscod
docol:
	ld	hl,(rpp)
	dec	hl
	dec	hl
	ldw	(hl),bc			;/ save return address
	ld	(rpp),hl
	inc	de
	ld	c,e
	ld	b,d
	jnext
;
;
	defb	0c1h			; ;
	defc	';'
	defw	colon-4
semi:
	defw	docol
	defw	qcsp
	defw	comp
	defw	semis
	defw	smudg
	defw	lbrac
	defw	semis
;
;
	defb	84h			; NOOP
	defc	'NOOP'
	defw	semi-4
noop:
	defw	docol
	defw	semis
;
;
	defb	88h			; CONSTANT
	defc	'CONSTANT'
	defw	noop-7
con:
	defw	docol
	defw	creat
	defw	smudg
	defw	comma
	defw	pscod
docon:
	inc	de
	ex	de,hl
	push	(hl)			;/
	jnext
;
;
	defb	88h			; VARIABLE
	defc	'VARIABLE'
	defw	con-0bh
var:
	defw	docol
	defw	con
	defw	pscod
dovar:
	inc	de
	push	de
	jnext
;
;
	defb	84h			; USER
	defc	'USER'
	defw	var-0bh
user:
	defw	docol
	defw	con
	defw	pscod
douse:
	inc	de
	ex	de,hl
	ld	l,(hl)			;/
	ld	h,0			;/
	addw	hl,(up)			;/
	jhpush
;
;
	defb	81h			; 0
	defc	'0'
	defw	user-7
zero:
	defw	$+2			;/
	push	0000h			;/
	jnext
;
;
	defb	81h			; 1
	defc	'1'
	defw	zero-4
one:
	defw	$+2			;/
	push	0001h			;/
	jnext
;
;
	defb	81h			; 2
	defc	'2'
	defw	one-4
two:
	defw	$+2			;/
	push	0002h			;/
	jnext
;
;
	defb	81h			; 3
	defc	'3'
	defw	two-4
three:
	defw	$+2			;/
	push	0003h			;/
	jnext
;
;
	defb	82h			; BL
	defc	'BL'
	defw	three-4
bl:
	defw	docon
	defw	20h
;
;
	defb	83h			; C/L
	defc	'C/L'
	defw	bl-5
csll:
	defw	docon
	defw	64
;
;
	defb	85h			; FIRST
	defc	'FIRST'
	defw	csll-6
first:
	defw	docon
	defw	0			;/ set by CLD
;
;
	defb	85h			; LIMIT
	defc	'LIMIT'
	defw	first-8
limit:
	defw	docon
	defw	0			;/ set by CLD
;
;
	defb	85h			; B/BUF
	defc	'B/BUF'
	defw	limit-8
bbuf:
	defw	docon
	defw	kbbuf
;
;
	defb	85h			; B/SCR
	defc	'B/SCR'
	defw	bbuf-8
bscr:
	defw	docon
	defw	400h/kbbuf
;
;
	defb	87h			; +ORIGIN
	defc	'+ORIGIN'
	defw	bscr-8
porig:
	defw	docol
	defw	lit
	defw	orig
	defw	plus
	defw	semis
;
;	USER VARIABLES
;
	defb	82h			; S0
	defc	'S0'
	defw	porig-0ah
szero:
	defw	douse
	defw	6
;
;
	defb	82h			; R0
	defc	'R0'
	defw	szero-5
rzero:
	defw	douse
	defw	8
;
;
	defb	83h			; TIB
	defc	'TIB'
	defw	rzero-5
tib:
	defw	douse
	defb	0ah
;
;
	defb	85h			; WIDTH
	defc	'WIDTH'
	defw	tib-6
width:
	defw	douse
	defb	0ch
;
;
	defb	87h			; WARNING
	defc	'WARNING'
	defw	width-8
warn:
	defw	douse
	defb	0eh
;
;
	defb	85h			; FENCE
	defc	'FENCE'
	defw	warn-0ah
fence:
	defw	douse
	defb	10h
;
;
	defb	82h			; DP
	defc	'DP'
	defw	fence-8
dp:
	defw	douse
	defb	12h
;
;
	defb	88h			; VOC-LINK
	defc	'VOC-LINK'
	defw	dp-5
vocl:
	defw	douse
	defw	14h
;
;
	defb	83h			; BLK
	defc	'BLK'
	defw	vocl-0bh
blk:
	defw	douse
	defb	16h
;
;
	defb	82h			; IN
	defc	'IN'
	defw	blk-6
inn:
	defw	douse
	defb	18h
;
;
	defb	83h			; OUT
	defc	'OUT'
	defw	inn-5
outt:
	defw	douse
	defb	1ah
;
;
	defb	83h			; SCR
	defc	'SCR'
	defw	outt-6
scr:
	defw	douse
	defb	1ch
;
;
	defb	86h			; OFFSET
	defc	'OFFSET'
	defw	scr-6
ofset:
	defw	douse
	defb	1eh
;
;
	defb	87h			; CONTEXT
	defc	'CONTEXT'
	defw	ofset-9
cont:
	defw	douse
	defb	20h
;
;
	defb	87h			; CURRENT
	defc	'CURRENT'
	defw	cont-0ah
curr:
	defw	douse
	defb	22h
;
;
	defb	85h			; STATE
	defc	'STATE'
	defw	curr-0ah
state:
	defw	douse
	defb	24h
;
;
	defb	84h			; BASE
	defc	'BASE'
	defw	state-8
base:
	defw	douse
	defb	26h
;
;
	defb	83h			; DPL
	defc	'DPL'
	defw	base-7
dpl:
	defw	douse
	defb	28h
;
;
	defb	83h			; FLD
	defc	'FLD'
	defw	dpl-6
fld:
	defw	douse
	defb	2ah
;
;
	defb	83h			; CSP
	defc	'CSP'
	defw	fld-6
cspp:
	defw	douse
	defb	2ch
;

	defb	82h			; R#
	defc	'R#'
	defw	cspp-6
rnum:
	defw	douse
	defb	2eh
;

	defb	83h			; HLD
	defc	'HLD'
	defw	rnum-5
hld:
	defw	douse
	defw	30h
;
;	END OF USER VARIABLES
;
	defb	82h			; 1+
	defc	'1+'
	defw	hld-6
onep:
	defw	$+2			;/
	pop	hl			;/
	inc	hl			;/
	jhpush				;/
;
;
	defb	82h			; 2+
	defc	'2+'
	defw	onep-5
twop:
	defw	$+2			;/
	pop	hl			;/
	inc	hl			;/
	inc	hl			;/
	jhpush				;/
;
;
	defb	82h			;/ 1-
	defc	'1-'			;/
	defw	twop-5			;/
onemin:
	defw	$+2			;/
	pop	hl			;/
	dec	hl			;/
	jhpush				;/
;
;
	defb	82h			;/ 2-
	defc	'2-'			;/
	defw	onemin-5		;/
twomin:
	defw	$+2			;/
	pop	hl			;/
	dec	hl			;/
	dec	hl			;/
	jhpush				;/
;
;
	defb	82h			;/ 2*
	defc	'2*'			;/
	defw	twomin-5		;/
twosta:
	defw	$+2			;/
	pop	hl			;/
	add	hl,hl			;/ asl hl
	jhpush				;/
;
;
	defb	82h			;/ 2/
	defc	'2/'			;/
	defw	twosta-5		;/
twosla:
	defw	$+2			;/
	pop	hl			;/
	bit	7,h			;/ negative?
	jr	z,twosl1		;/ no
	inc	hl			;/ yes, add 1
twosl1:
	sra	h			;/
	rr	l			;/ asr hl
	jhpush				;/
;
;
	defb	84h			; HERE
	defc	'HERE'
	defw	twosla-5
here:
	defw	docol
	defw	dp
	defw	at
	defw	semis
;
;
	defb	85h			; ALLOT
	defc	'ALLOT'
	defw	here-7
allot:
	defw	docol
	defw	dp
	defw	pstor
	defw	semis
;
;
	defb	81h			; ,
	defc	','
	defw	allot-8
comma:
	defw	docol
	defw	here
	defw	store
	defw	two
	defw	allot
	defw	semis
;

	defb	82h			; C,
	defc	'C,'
	defw	comma-4
ccomm:
	defw	docol
	defw	here
	defw	cstor
	defw	one
	defw	allot
	defw	semis
;
;
	defb	81h			; -
	defc	'-'
	defw	ccomm-5
subb:
	defw	$+2
	pop	de
	pop	hl
	subw	hl,de			;/
	jhpush
;
;
	defb	81h			; =
	defc	'='
	defw	subb-4
equal:
	defw	$+2			;/
	pop	de			;/
	pop	hl			;/
	subw	hl,de			;/
	ld	hl,0			;  hl <-- false
	jr	nz,equal1
	inc	l			;/ hl <-- true
equal1:
	jhpush
;
;
	defb	81h			;  <
	defc	'<'
	defw	equal-4
less:
	defw	$+2
	pop	de
	pop	hl			; hl de <
	ld	a,d
	xor	h			; one operand negative?
	jp	m,less1			; yes, determine which
	subw	hl,de			;/
less1:
	bit	7,h			;/ h negative?
	ld	hl,0			; hl <-- false
	jr	z,less2
	inc	l			;/ hl <-- true
less2:
	jhpush
;
;
	defb	82h			; U<
	defc	'U<'
	defw	less-4
uless:
	defw	$+2
	pop	de
	pop	hl			;/ hl de U<
	subw	hl,de			;/
	ld	hl,0			; hl <-- false
	rl	l			;/ bit 0 <-- carry
uless1:
	jhpush
;
;
	defb	81h			; >
	defc	'>'
	defw	uless-5
great:
	defw	$+2
	pop	hl			;/
	pop	de			;/ hl de >    (= de hl < )
	ld	a,d
	xor	h			; one operand negative?
	jp	m,great1		; yes, determine which
	subw	hl,de			;/
great1:
	bit	7,h			;/ h negative?
	ld	hl,0			; hl <-- false
	jr	z,great2
	inc	l			;/ hl <-- true
great2:
	jhpush
;
;
	defb	83h			; ROT     ( n1 n2 n3 --- n2 n3 n1)
	defc	'ROT'
	defw	great-4
rot:
	defw	$+2
	pop	de			; de <-- n3
	pop	hl			; hl <-- n2
	ex	(sp),hl			; s1 <-- n2, hl <-- n1
	jp	dpush			; s2 <-- n3, s3 <-- n1
;
;
	defb	85h			; SPACE
	defc	'SPACE'
	defw	rot-6
space:
	defw	docol
	defw	bl
	defw	emit
	defw	semis
;
;
	defb	84h			; -DUP
	defc	'-DUP'
	defw	space-8
ddup:
	defw	$+2			;/
	ldw	hl,(sp+0)		;/
	ld	a,h			;/
	or	l			;/ hl = 0?
	jr	z,ddup1			;/ yes, don't dup
	push	hl			;/
ddup1:
	jnext
;
;
	defb	88h			; TRAVERSE
	defc	'TRAVERSE'
	defw	ddup-7
trav:
	defw	docol
	defw	swap
trav1:
	defw	over			; begin
	defw	plus
	defw	lit
	defw	7fh
	defw	over
	defw	cat
	defw	less
	defw	zbran			; until
	defw	trav1-$
	defw	swap
	defw	drop
	defw	semis
;
;
	defb	86h			; LATEST
	defc	'LATEST'
	defw	trav-0bh
lates:
	defw	docol
	defw	curr
	defw	at
	defw	at
	defw	semis
;
;
	defb	83h			; LFA
	defc	'LFA'
	defw	lates-9
lfa:
	defw	$+2
	pop	hl			;/ hl <-- pfa
	subw	hl,4			;/
	jhpush				;/ s1 <-- lfa
;
;
	defb	83h			; CFA
	defc	'CFA'
	defw	lfa-6
cfa:
	defw	docol
	defw	twomin			;/
	defw	semis
;
;
	defb	83h			; NFA
	defc	'NFA'
	defw	cfa-6
nfa:
	defw	docol
	defw	lit
	defw	5
	defw	subb
	defw	lit
	defw	-1
	defw	trav
	defw	semis
;
;
	defb	83h			; PFA
	defc	'PFA'
	defw	nfa-6
pfa:
	defw	docol
	defw	one
	defw	trav
	defw	lit
	defw	5
	defw	plus
	defw	semis
;
;
	defb	84h			; !CSP
	defc	'!CSP'
	defw	pfa-6
scsp:
	defw	docol
	defw	spat
	defw	cspp
	defw	store
	defw	semis
;
;
	defb	86h			; ?ERROR
	defc	'?ERROR'
	defw	scsp-7
qerr:
	defw	docol
	defw	swap
	defw	zbran			; if
	defw	qerr1-$
	defw	error
	defw	bran			; else
	defw	qerr2-$
qerr1:
	defw	drop			; endif
qerr2:
	defw	semis
;
;
	defb	85h			; ?COMP
	defc	'?COMP'
	defw	qerr-9
qcomp:
	defw	docol
	defw	state
	defw	at
	defw	zequ
	defw	lit
	defw	11h
	defw	qerr
	defw	semis
;
;
	defb	85h			; ?EXEC
	defc	'?EXEC'
	defw	qcomp-8
qexec:
	defw	docol
	defw	state
	defw	at
	defw	lit
	defw	12h
	defw	qerr
	defw	semis
;
;
	defb	86h			; ?PAIRS
	defc	'?PAIRS'
	defw	qexec-8
qpair:
	defw	docol
	defw	subb
	defw	lit
	defw	13h
	defw	qerr
	defw	semis
;
;
	defb	84h			; ?CSP
	defc	'?CSP'
	defw	qpair-9
qcsp:
	defw	docol
	defw	spat
	defw	cspp
	defw	at
	defw	subb
	defw	lit
	defw	14h
	defw	qerr
	defw	semis
;
;
	defb	88h			; ?LOADING
	defc	'?LOADING'
	defw	qcsp-7
qload:
	defw	docol
	defw	blk
	defw	at
	defw	zequ
	defw	lit
	defw	16h
	defw	qerr
	defw	semis
;
;
	defb	87h			; COMPILE
	defc	'COMPILE'
	defw	qload-0bh
comp:
	defw	docol
	defw	qcomp
	defw	fromr
	defw	dup
	defw	twop
	defw	tor
	defw	at
	defw	comma
	defw	semis
;
;
	defb	0c1h			; [
	defc	'['
	defw	comp-0ah
lbrac:
	defw	docol
	defw	zero
	defw	state
	defw	store
	defw	semis
;
;
	defb	81h			; ]
	defc	']'
	defw	lbrac-4
rbrac:
	defw	docol
	defw	lit,0c0h
	defw	state,store
	defw	semis
;
;
	defb	86h			; SMUDGE
	defc	'SMUDGE'
	defw	rbrac-4
smudg:
	defw	docol
	defw	lates
	defw	lit
	defw	20h
	defw	toggl
	defw	semis
;
;
	defb	83h			; HEX
	defc	'HEX'
	defw	smudg-9
hex:
	defw	docol
	defw	lit
	defw	10h
	defw	base
	defw	store
	defw	semis
;
;
	defb	87h			; DECIMAL
	defc	'DECIMAL'
	defw	hex-6
dec:
	defw	docol
	defw	lit
	defw	0ah
	defw	base
	defw	store
	defw	semis
;
;
	defb	87h			; (;CODE)
	defc	'(;CODE)'
	defw	dec-0ah
pscod:
	defw	docol
	defw	fromr
	defw	lates
	defw	pfa
	defw	cfa
	defw	store
	defw	semis
;
;
	defb	0c5h			; ;CODE
	defc	';CODE'
	defw	pscod-0ah
semic:
	defw	docol
	defw	qcsp
	defw	comp
	defw	pscod
	defw	lbrac
semi1:
	defw	noop			; assembler
	defw	semis
;
;
	defb	87h			; <BUILDS
	defc	'<BUILDS'
	defw	semic-8
build:
	defw	docol
	defw	zero
	defw	con
	defw	semis
;
;
	defb	85h			; DOES>
	defc	'DOES>'
	defw	build-0ah
does:
	defw	docol
	defw	fromr
	defw	lates
	defw	pfa
	defw	store
	defw	pscod
dodoe:
	ld	hl,(rpp)
	dec	hl
	dec	hl
	ldw	(hl),bc			;/
	ld	(rpp),hl
	inc	de
	ex	de,hl
	ldw	bc,(hl)			;/
	inc	hl
	inc	hl
	jhpush
;
;
	defb	85h			; COUNT
	defc	'COUNT'
	defw	does-8
count:
	defw	docol
	defw	dup
	defw	onep
	defw	swap
	defw	cat
	defw	semis
;
;
	defb	84h			; TYPE
	defc	'TYPE'
	defw	count-8
type:
	defw	docol
	defw	ddup
	defw	zbran			; if
	defw	type1-$
	defw	over
	defw	plus
	defw	swap
	defw	xdo			; do
type2:
	defw	ido
	defw	cat
	defw	emit
	defw	xloop			; loop
	defw	type2-$
	defw	bran			; else
	defw	type3-$
type1:
	defw	drop			; endif
type3:
	defw	semis
;
;
	defb	89h			; -TRAILING
	defc	'-TRAILING'
	defw	type-7
dtrai:
	defw	docol
	defw	dup
	defw	zero
	defw	xdo			; do
dtra1:
	defw	tdup			;/
	defw	plus
	defw	onemin			;/
	defw	cat
	defw	bl
	defw	subb
	defw	zbran			; if
	defw	dtra2-$
	defw	leave
	defw	bran			; else
	defw	dtra3-$
dtra2:
	defw	onemin			;/
dtra3:
	defw	xloop			; loop
	defw	dtra1-$
	defw	semis
;
;
	defb	84h			; (.")
	defc	'(.")'
	defw	dtrai-0ch
pdotq:
	defw	docol
	defw	rr
	defw	count
	defw	dup
	defw	onep
	defw	fromr
	defw	plus
	defw	tor
	defw	type
	defw	semis
;
;
	defb	0c2h			; ."
	defc	'."'
	defw	pdotq-7
dotq:
	defw	docol
	defw	lit
	defw	22h
	defw	state
	defw	at
	defw	zbran			; if
	defw	dotq1-$
	defw	comp
	defw	pdotq
	defw	word
	defw	here
	defw	cat
	defw	onep
	defw	allot
	defw	bran			; else
	defw	dotq2-$
dotq1:
	defw	word
	defw	here
	defw	count
	defw	type			; endif
dotq2:
	defw	semis
;
;
	defb	86h			; EXPECT
	defc	'EXPECT'
	defw	dotq-5
expec:
	defw	docol
	defw	over
	defw	plus
	defw	over
	defw	xdo			; do
expe1:
	defw	key
	defw	dup
	defw	lit
	defw	0eh
	defw	porig
	defw	at
	defw	equal
	defw	zbran			; if
	defw	expe2-$
	defw	drop
	defw	dup
	defw	ido
	defw	equal
	defw	dup
	defw	fromr
	defw	twomin			;/
	defw	plus
	defw	tor
	defw	zbran			; if
	defw	expe6-$
	defw	lit
	defw	bell
	defw	bran			; else
	defw	expe7-$
expe6:
	defw	lit
	defw	bsout			; endif
expe7:
	defw	bran			; else
	defw	expe3-$
expe2:
	defw	dup
	defw	lit
	defw	acr			;/
	defw	equal
	defw	zbran			; if
	defw	expe4-$
	defw	leave
	defw	drop
	defw	bl
	defw	zero
	defw	bran			; else
	defw	expe5-$
expe4:
	defw	dup			; endif
expe5:
	defw	ido
	defw	cstor
	defw	zero
	defw	ido
	defw	onep
	defw	store			; endif
expe3:
	defw	emit
	defw	xloop			; loop
	defw	expe1-$
	defw	drop
	defw	semis
;
;
	defb	85h			; QUERY
	defc	'QUERY'
	defw	expec-9
query:
	defw	docol
	defw	tib
	defw	at
	defw	lit
	defw	50h
	defw	expec
	defw	zero
	defw	inn
	defw	store
	defw	semis
;
;
	defb	0c1h			; NULL
	defb	80h
	defw	query-8
null:
	defw	docol
	defw	blk
	defw	at
	defw	zbran			; if
	defw	null1-$
	defw	one
	defw	blk
	defw	pstor
	defw	zero
	defw	inn
	defw	store
	defw	blk
	defw	at
	defw	bscr
	defw	onemin			;/
	defw	andd
	defw	zequ
	defw	zbran			; if
	defw	null2-$
	defw	qexec
	defw	fromr
	defw	drop			; endif
null2:
	defw	bran			; else
	defw	null3-$
null1:
	defw	fromr
	defw	drop			; endif
null3:
	defw	semis
;
	defb	84h			; FILL
	defc	'FILL'
	defw	null-4
fill:
	defw	$+2
	exx				;/ save ip
	pop	de			;/ e <-- byte
	pop	bc			;  bc <-- quantity
	pop	hl			;/ hl <-- address
fill1:
	ld	a,b
	or	c			;  qty == 0?
	jr	z,fill2			;  yes, nothing (more) to fill
	ld	(hl),e			;/ (hl) <-- byte
	inc	hl			;  inc pointer
	dec	bc			;  dec counter
	jp	fill1			;/
fill2:
	exx				;/ restore ip
	jnext
;
;
	defb	85h			; ERASE
	defc	'ERASE'
	defw	fill-7
erasee:
	defw	docol
	defw	zero
	defw	fill
	defw	semis
;
;
	defb	86h			; BLANKS
	defc	'BLANKS'
	defw	erasee-8
blank:
	defw	docol
	defw	bl
	defw	fill
	defw	semis
;
;
	defb	84h			; HOLD
	defc	'HOLD'
	defw	blank-9
hold:
	defw	docol
	defw	lit
	defw	-1
	defw	hld
	defw	pstor
	defw	hld
	defw	at
	defw	cstor
	defw	semis
;
;
	defb	83h			; PAD
	defc	'PAD'
	defw	hold-7
pad:
	defw	docol
	defw	here
	defw	lit
	defw	44h
	defw	plus
	defw	semis
;
;
	defb	84h			; WORD
	defc	'WORD'
	defw	pad-6
word:
	defw	docol
	defw	blk
	defw	at
	defw	zbran			; if
	defw	word1-$
	defw	blk
	defw	at
	defw	block
	defw	bran			; else
	defw	word2-$
word1:
	defw	tib
	defw	at			; endif
word2:
	defw	inn
	defw	at
	defw	plus
	defw	swap
	defw	encl
	defw	here
	defw	lit
	defw	22h
	defw	blank
	defw	inn
	defw	pstor
	defw	over
	defw	subb
	defw	tor
	defw	rr
	defw	here
	defw	cstor
	defw	plus
	defw	here
	defw	onep
	defw	fromr
	defw	cmove
	defw	semis
;
;
	defb	88h			; (NUMBER)
	defc	'(NUMBER)'
	defw	word-7
pnumb:
	defw	docol
pnum1:
	defw	onep			; begin
	defw	dup
	defw	tor
	defw	cat
	defw	base
	defw	at
	defw	digit
	defw	zbran			; while
	defw	pnum2-$
	defw	swap
	defw	base
	defw	at
	defw	ustar
	defw	drop
	defw	rot
	defw	base
	defw	at
	defw	ustar
	defw	dplus
	defw	dpl
	defw	at
	defw	onep
	defw	zbran			; if
	defw	pnum3-$
	defw	one
	defw	dpl
	defw	pstor			; endif
pnum3:
	defw	fromr
	defw	bran			; repeat
	defw	pnum1-$
pnum2:
	defw	fromr
	defw	semis
;
;
	defb	86h			; NUMBER
	defc	'NUMBER'
	defw	pnumb-0bh
numb:
	defw	docol
	defw	zero
	defw	zero
	defw	rot
	defw	dup
	defw	onep
	defw	cat
	defw	lit
	defw	2dh
	defw	equal
	defw	dup
	defw	tor
	defw	plus
	defw	lit
	defw	-1
numb1:
	defw	dpl			; begin
	defw	store
	defw	pnumb
	defw	dup
	defw	cat
	defw	bl
	defw	subb
	defw	zbran			; while
	defw	numb2-$
	defw	dup
	defw	cat
	defw	lit
	defw	2eh
	defw	subb
	defw	zero
	defw	qerr
	defw	zero
	defw	bran			; repeat
	defw	numb1-$
numb2:
	defw	drop
	defw	fromr
	defw	zbran			; if
	defw	numb3-$
	defw	dminu			; endif
numb3:
	defw	semis
;
;
	defb	85h			; -FIND (0-3) SUCCESS
	defc	'-FIND'			;       (0-1) FAILURE
	defw	numb-9
dfind:
	defw	docol
	defw	bl
	defw	word
	defw	here
	defw	cont
	defw	at
	defw	at
	defw	pfind
	defw	dup
	defw	zequ
	defw	zbran			; if
	defw	dfin1-$
	defw	drop
	defw	here
	defw	lates
	defw	pfind			; endif
dfin1:
	defw	semis
;
;
	defb	87h			; (ABORT)
	defc	'(ABORT)'
	defw	dfind-8
pabor:
	defw	docol
	defw	abort
	defw	semis
;
	defb	85h			; ERROR
	defc	'ERROR'
	defw	pabor-0ah
error:
	defw	docol
	defw	warn
	defw	at
	defw	zless
	defw	zbran			; if
	defw	erro1-$
	defw	pabor			; endif
erro1:
	defw	here
	defw	count
	defw	type
	defw	pdotq
	defb	2
	db	'? '
	defw	mess
	defw	spsto
;	CHANGE FROM fig MODEL
;	defw	inn,at,blk,at
	defw	blk,at
	defw	ddup
	defw	zbran,erro2-$		; if
	defw	inn,at
	defw	swap			; endif
erro2:
	defw	quit
;
;
	defb	83h			; ID.
	defc	'ID.'
	defw	error-8
iddot:
	defw	docol
	defw	pad
	defw	lit
	defw	20h
	defw	blank			;/
	defw	dup
	defw	pfa
	defw	lfa
	defw	over
	defw	subb
	defw	dup			;/ change frm MODEL
	defw	tor			;/ to suppress BIT 7
	defw	pad
	defw	swap
	defw	cmove
	defw	pad
	defw	fromr			;/ for terminals
	defw	pad			;/ with an 8 bit
	defw	plus			;/ ASCII character set.
	defw	onemin			;/
	defw	dup			;/
	defw	at			;/
	defw	lit			;/
	defw	7fh			;/
	defw	andd			;/
	defw	swap			;/
	defw	store			;/
	defw	count
	defw	lit
	defw	1fh			;  WIDTH
	defw	andd
	defw	type
	defw	space
	defw	semis
;
	defb	86h			; CREATE
	defc	'CREATE'
	defw	iddot-6
creat:
	defw	docol
	defw	dfind
	defw	zbran			; if
	defw	crea1-$
	defw	drop
	defw	nfa
	defw	iddot
	defw	lit
	defw	4
	defw	mess
	defw	space			; endif
crea1:
	defw	here
	defw	dup
	defw	cat
	defw	width
	defw	at
	defw	min
	defw	onep
	defw	allot
	defw	dup
	defw	lit
	defw	0a0h
	defw	toggl
	defw	here
	defw	onemin
	defw	lit
	defw	80h
	defw	toggl
	defw	lates
	defw	comma
	defw	curr
	defw	at
	defw	store
	defw	here
	defw	twop
	defw	comma
	defw	semis
;
;
	defb	0c9h			; [COMPILE]
	defc	'[COMPILE]'
	defw	creat-9
bcomp:
	defw	docol
	defw	dfind
	defw	zequ
	defw	zero
	defw	qerr
	defw	drop
	defw	cfa
	defw	comma
	defw	semis
;
;
	defb	0c7h			; LITERAL
	defc	'LITERAL'
	defw	bcomp-0ch
liter:
	defw	docol
	defw	state
	defw	at
	defw	zbran			; if
	defw	lite1-$
	defw	comp
	defw	lit
	defw	comma			; endif
lite1:
	defw	semis
;
;
	defb	0c8h			; DLITERAL
	defc	'DLITERAL'
	defw	liter-0ah
dlite:
	defw	docol
	defw	state
	defw	at
	defw	zbran			; if
	defw	dlit1-$
	defw	swap
	defw	liter
	defw	liter			; endif
dlit1:
	defw	semis
;
;
	defb	86h			; ?STACK
	defc	'?STACK'
	defw	dlite-0bh
qstac:
	defw	docol
	defw	spat
	defw	szero
	defw	at
	defw	swap
	defw	uless
	defw	one
	defw	qerr
	defw	spat
	defw	here
	defw	lit
	defw	80h
	defw	plus
	defw	uless
	defw	lit
	defw	7
	defw	qerr
	defw	semis
;
;
	defb	89h			; INTERPRET
	defc	'INTERPRET'
	defw	qstac-9
inter:
	defw	docol
inte1:
	defw	dfind			; begin
	defw	zbran			; if
	defw	inte2-$
	defw	state
	defw	at
	defw	less
	defw	zbran			; if
	defw	inte3-$
	defw	cfa
	defw	comma
	defw	bran			; else
	defw	inte4-$
inte3:
	defw	cfa
	defw	exec			; endif
inte4:
	defw	qstac
	defw	bran			; else
	defw	inte5-$
inte2:
	defw	here
	defw	numb
	defw	dpl
	defw	at
	defw	onep
	defw	zbran			; if
	defw	inte6-$
	defw	dlite
	defw	bran			; else
	defw	inte7-$
inte6:
	defw	drop
	defw	liter			; endif
inte7:
	defw	qstac			; endif
inte5:
	defw	bran			; again
	defw	inte1-$
;
;
	defb	89h			; IMMEDIATE
	defc	'IMMEDIATE'
	defw	inter-0ch
immed:
	defw	docol
	defw	lates
	defw	lit
	defw	40h
	defw	toggl
	defw	semis
;
;
	defb	8ah			; VOCABULARY
	defc	'VOCABULARY'
	defw	immed-0ch
vocab:
	defw	docol
	defw	build
	defw	lit
	defw	0a081h
	defw	comma
	defw	curr
	defw	at
	defw	cfa
	defw	comma
	defw	here
	defw	vocl
	defw	at
	defw	comma
	defw	vocl
	defw	store
	defw	does
dovoc:
	defw	twop
	defw	cont
	defw	store
	defw	semis
;
;
	defb	0c5h			; FORTH
	defc	'FORTH'
	defw	vocab-0dh
forth:
	defw	dodoe
	defw	dovoc
	defw	0a081h
	defw	task-7			; cold start value only
;					  changed aech time a def is appended
;					  to the FORTH vocabulary
	defw	0			; end of vocabulary list
;
;
	defb	8bh			; DEFINITIONS
	defc	'DEFINITIONS'
	defw	forth-8
defin:
	defw	docol
	defw	cont
	defw	at
	defw	curr
	defw	store
	defw	semis
;
;
	defb	0c1h			; (
	defc	'('
	defw	defin-0eh
paren:
	defw	docol
	defw	lit
	defw	29h
	defw	word
	defw	semis
;
;
	defb	84h			; QUIT
	defc	'QUIT'
	defw	paren-4
quit:
	defw	docol
	defw	zero
	defw	blk
	defw	store
	defw	lbrac
quit1:
	defw	rpsto			; begin
	defw	cr
	defw	query
	defw	inter
	defw	state
	defw	at
	defw	zequ
	defw	zbran			; if
	defw	quit2-$
	defw	pdotq
	defb	2
	db	'ok'			; endif
quit2:
	defw	bran			; again
	defw	quit1-$
;
;
	defb	85h			; ABORT
	defc	'ABORT'
	defw	quit-7
abort:
	defw	docol
	defw	spsto
	defw	dec
	defw	qstac
	defw	cr
	defw	dotcpu
	defw	pdotq
	defb	0eh			; count of chrs to follow
	db	'fig-FORTH '
	defb	figrel+30h,adot,figrev+30h,usrver
	defw	forth
	defw	defin
	defw	quit
;
;
wrm:	ld	bc,wrm1
	jnext
wrm1:	defw	warm
;
;
	defb	84h			; WARM
	defc	'WARM'
	defw	abort-8
warm:
	defw	docol
	defw	mtbuf
	defw	abort
;
;
cld:
	ld	hl,(bdoss+1)		;/
	ld	l,0			;/ hl <-- fbase
	ld	(limit+2),hl		;/ set limit
	ld	de,bufsiz		;/ de <-- total disc buffer size
	subw	hl,de			;/ hl <-- addr. of 1st disc buffer
	ld	(first+2),hl		;/ set FIRST
	ld	(use+2),hl		;/ set USE
	ld	(prev+2),hl		;/ set PREV
	ld	(buf1),hl		;/
	ld	de,us			;/ de <-- user variable space
	subw	hl,de			;/ hl <-- initr0
	ld	(upinit),hl		;/
	ld	(r0init),hl		;/
	ld	(up),hl			;/
	ld	(rpp),hl		;/
	ld	de,rts			;/ de <-- rtn stack & term. buf space
	subw	hl,de			;/ hl <-- inits0
	ld	(s0init),hl		;/
	ld	(tibini),hl		;/
	ld	sp,hl			;/
	ld	bc,cld1
	ld	ix,next			; pointer to next
	ld	iy,hpush		; pointer to hpush
	jnext
;
;
cld1:	defw	cold
;
	defb	84h			; COLD
	defc	'COLD'
	defw	warm-7
cold:
	defw	docol
	defw	mtbuf
	defw	one,recadr		; AvdH
	defw	store
	defw	lit,buf1
	defw	at			;/
	defw	use,store
	defw	lit,buf1
	defw	at			;/
	defw	prev,store
	defw	drzer
	defw	zero			;/
	defw	lit,eprint
	defw	cstor			;/
;
	defw	lit
	defw	orig+12h
	defw	lit
	defw	up
	defw	at
	defw	lit
	defw	6
	defw	plus
	defw	lit
	defw	10h
	defw	cmove
	defw	lit
	defw	orig+0ch
	defw	at
	defw	lit
	defw	forth+6
	defw	store
	defw	fcb			;/A
	defw	lit,opnfil		;/A open mass storage
	defw	bdos			;/A
	defw	lit,0ffh		;/A
	defw	equal			;/A file present?
	defw	zbran,cld2-$		;/A
	defw	zero			;/A
	defw	warn,store		;/A
	defw	cr,pdotq		;/A
	defb	7			;/A
	db	'No file'		;/A
cld2:
	defw	abort
;
;
	defb	84h			; S->D
	defc	'S->D'
	defw	cold-7
stod:	defw	$+2
	pop	hl			;/
	exts	hl			;/ de <-- h(7)
	ex	de,hl			;/
	jp	dpush			; ( n1 -- d1L d1H)
;
;
	defb	82h			; +-
	defc	'+-'
	defw	STOD-7
pm:
	defw	docol
	defw	zless
	defw	zbran			; if
	defw	pm1-$
	defw	minus			; endif
pm1:
	defw	semis
;
;
	defb	83h			; D+-
	defc	'D+-'
	defw	pm-5
dpm:
	defw	docol
	defw	zless
	defw	zbran			; if
	defw	dpm1-$
	defw	dminu			; endif
dpm1:
	defw	semis
;
;
	defb	83h			; ABS
	defc	'ABS'
	defw	dpm-6
abs:
	defw	docol
	defw	dup
	defw	pm
	defw	semis
;
;
	defb	84h			; DABS
	defc	'DABS'
	defw	abs-6
dabs:
	defw	docol
	defw	dup
	defw	dpm
	defw	semis
;
;
	defb	83h			; MIN
	defc	'MIN'
	defw	dabs-7
min:
	defw	docol
	defw	tdup
	defw	great
	defw	zbran			; if
	defw	min1-$
	defw	swap			; endif
min1:
	defw	drop
	defw	semis
;
;
	defb	83h			; MAX
	defc	'MAX'
	defw	min-6
max:	defw	docol
	defw	tdup
	defw	less
	defw	zbran			; if
	defw	max1-$
	defw	swap			; endif
max1:
	defw	drop
	defw	semis
;
;
	defb	82h			; M*   ( n1 n2 --- d)
	defc	'M*'
	defw	max-6
mstar:
	defw	$+2			;/
	pop	de			; de <-- multiplicator
	pop	hl			; hl <-- multiplicant
	multw	hl,de			;/ dehl <-- hl * de
	ex	de,hl			;/
	jp	dpush			;/ ( n1 n2 --- d1l d1h)
;
;
	defb	82h			;/ M/   ( d n1 --- nrem nquot)
	defc	'M/'
	defw	mstar-5
mslas:
	defw	$+2			; ( d n1 --- n2 n3)
	exx				; save ip
	pop	hl			; divisor
	ld	a,h
	and	80h			; filter sign
	jr	z,mslas1		; positive
	neg	hl			; make positive
mslas1:
	ld	b,h
	ld	c,l			; bc <-- divisor
	pop	hl			; dividend.hw
	pop	de			; dividend.lw
	bit	7,h			; negative?
	jr	z,mslas2		; no
	inc	a			; dividend sign flag
	push	hl
	ld	hl,0
	subw	hl,de			; neg dividend.lw
	pop	de			; dividend.hw
	push	hl
	ld	hl,0
	sbc	hl,de			; neg dividend.hw
	pop	de			; dividend.lw
mslas2:
	cpw	hl,bc			; dividend.hw >= divisor
	jr	c,mslas3		; no overflow, continue
	ld	hl,0ffffh
	ld	d,h
	ld	e,l			; set rem & quot to max.
	jr	mslas5
;
mslas3:
	ex	de,hl			; dehl <-- dividend.hw,lw
	divuw	dehl,bc			; de <-- remainder, hl <-- quotient
	ex	de,hl			; hl <-- remainder
	bit	0,a			; was dividend negative
	jr	z,mslas4		; no
	neg	hl			;/ yes, negate remainder
mslas4:
	ex	de,hl			; hl <-- quotient
	or	a
	jr	z,mslas5		; neither operand negative
	cp	81h			; both operands negative?
	jr	z,mslas5		; yes, quotient stays positive
	neg	hl			;/ no, negate quotient
mslas5:
	push	de			; remainder
	push	hl			; quotient
	exx				; restore ip
	jnext
;
;
	defb	81h			; *   ( n1 n2 --- nproduct)
	defc	'*'
	defw	mslas-5
star:
	defw	$+2
	pop	de
	pop	hl
	multw	hl,de			;/ dehl <-- product
	jhpush
;
;
	defb	84h			; /MOD   ( n1 n2 --- nrem nquot)
	defc	'/MOD'
	defw	star-4
slmod:
	defw	$+2
	exx				;/ save ip
	pop	bc			;/ divisor
	pop	hl			;  dividend
	ld	a,b
	or	c			;/ div by 0?
	jr	nz,slmod1		;/ no, continue
	ld	de,0ffffh
	ld	h,d
	ld	l,e			;/ set remainder & quotient to max.
	jr	slmod3
slmod1:
	cpw	hl,8000h		;/ special case -32768 -1 /
	jr	nz,slmod2		;/ continue
	ld	a,b
	cp	0ffh
	jr	nz,slmod2
	cp	c			;/ lo byte also 0ffh?
	jr	nz,slmod2		;/ no, go & divide
	ld	de,0			;/ remainder
	jr	slmod3			;/ exit with dividend unchanged
slmod2:
	exts	hl			;/ de <-- dividend.hw
	divw	dehl,bc			;/ de <-- remainder, hl <-- quotient
slmod3:
	push	de
	push	hl
	exx				;/ restore ip
	jnext
;
;
	defb	81h			; /
	defc	'/'
	defw	slmod-7
slash:
	defw	$+2
	exx				;/ save ip
	pop	bc			;/ divisor
	pop	hl			;  dividend
	ld	a,b
	or	c			;/ division by 0?
	jr	nz,slash1		;/ no, continue
	ld	hl,0ffffh		;/ set quotient to max.
	jr	slash3
slash1:
	cpw	hl,8000h		;/ special case -32768 -1 /
	jr	nz,slash2		;/ dividend not -32768
	ld	a,b
	cp	0ffh
	jr	nz,slash2		;/ divisor not -1
	cp	c
	jr	z,slash3		;/ return with dividend unchanged
slash2:
	exts	hl			;/ de <-- dividend.hw
	divw	dehl,bc			;/ hl <-- quotient
slash3:
	push	hl			;/ quotient
	exx				;/ restore ip
	jnext
;
;
	defb	83h			;/ MOD
	defc	'MOD'
	defw	slash-4
modd:
	defw	$+2
	exx				; save ip
	pop	bc			; divisor
	pop	hl			;  dividend
	ld	a,b
	or	c			; division by 0?
	jr	nz,modd1		; no, continue
	ld	de,0ffffh		; set remainder to max
	jr	modd3
modd1:
	cpw	hl,8000h		;/ special case -32768 -1 /
	jr	nz,modd2		; dividend not -32768
	ld	a,b
	cp	0ffh
	jr	nz,modd2		; divisor not -1
	cp	c
	jr	nz,modd2		; go & divide
	ld	de,0			; remainder
	jr	modd3
modd2:
	exts	hl			; de <-- dividend.hw
	divw	dehl,bc			; de <-- remainder
modd3:
	push	de			; remainder
	exx				; restore ip
	jnext
;
;
	defb	85h			;/ */MOD
	defc	'*/MOD'
	defw	modd-6
ssmod:
	defw	$+2
	exx				; save ip
	pop	hl			; divisor
	ld	a,h
	and	80h			; filter sign
	jr	z,ssmod1		; positive
	neg	hl			; make positive
ssmod1:
	ld	b,h
	ld	c,l			; bc <-- divisor
	pop	hl			; multipicator
	pop	de			; multiplicant
	ex	af,af' 			; save sign flag
	multw	hl,de			; dehl <-- product (= dividend)
	ex	af,af' 			; restore sign flag
	ex	de,hl			; de <-- dividend.lw
	bit	7,h			; dividend negative?
	jr	z,ssmod2		; no
	inc	a			; dividend sign flag
	push	hl
	ld	hl,0
	subw	hl,de			; neg dividend.lw
	pop	de			; dividend.hw
	push	hl
	ld	hl,0
	sbc	hl,de			; neg dividend.hw
	pop	de			; dividend.lw
ssmod2:
	cpw	hl,bc			; dividend.hw >= divisor?
	jr	c,ssmod3		; no overflow, continue
	ld	hl,0ffffh
	ld	d,h
	ld	e,l			; set rem & quot to max
	jr	ssmod5
;
ssmod3:
	ex	de,hl			; dehl <-- dividend.hw,lw
	divuw	dehl,bc			; de <-- remainder, hl <-- quotient
	ex	de,hl			; hl <-- remainder
	bit	0,a			; was dividend negative?
	jr	z,ssmod4		; no
	neg	hl			; yes, negate remainder
ssmod4:
	ex	de,hl			; hl <-- quotient
	or	a
	jr	z,ssmod5		; neither operand negative
	cp	81h			; both operands negative?
	jr	z,ssmod5		; yes, quotient stays positive
	neg	hl			; no, negate quotient
ssmod5:
	push	de			; remainder
	push	hl			; quotient
	exx				; restore ip
	jnext
;
;
	defb	82h			; */
	defc	'*/'
	defw	ssmod-8
ssla:
	defw	$+2			;/
	exx				; save ip
	pop	hl			; divisor
	ld	a,h
	and	80h			; filter sign
	jr	z,ssla1			; positive
	neg	hl			; make positive
ssla1:
	ld	b,h
	ld	c,l			; bc <-- divisor
	pop	hl			; multipicator
	pop	de			; multiplicant
	ex	af,af' 			; save sign flag
	multw	hl,de			; dehl <-- product (= dividend)
	ex	af,af' 			; restore sign flag
	ex	de,hl			; de <-- dividend.lw
	bit	7,h			; dividend negative?
	jr	z,ssla2			; no
	inc	a			; dividend sign flag
	push	hl
	ld	hl,0
	subw	hl,de			; neg dividend.lw
	pop	de			; dividend.hw
	push	hl
	ld	hl,0
	sbc	hl,de			; neg dividend.hw
	pop	de			; dividend.lw
ssla2:
	cpw	hl,bc			; dividend.hw >= divisor?
	jr	c,ssla3			; no overflow, continue
	ld	hl,0ffffh		; set quotient to max
	jr	ssla4
;
ssla3:
	ex	de,hl			; dehl <-- dividend.hw,lw
	divuw	dehl,bc			; de <-- remainder, hl <-- quotient
	or	a
	jr	z,ssla4			; neither operand negative
	cp	81h			; both operands negative?
	jr	z,ssla4			; yes, quotient stays positive
	neg	hl			; no, negate quotient
ssla4:
	push	hl			; quotient
	exx				; restore ip
	jnext
;
;
	defb	85h			; M/MOD
	defc	'M/MOD'
	defw	ssla-5
msmod:
	defw	docol
	defw	tor
	defw	zero
	defw	rr
	defw	uslas
	defw	fromr
	defw	swap
	defw	tor
	defw	uslas
	defw	fromr
	defw	semis
;
;
;	Block moved down 2 pages
;
	defb	86h			; (LINE)
	defc	'(LINE)'
	defw	msmod-8
pline:
	defw	docol
	defw	tor
	defw	lit
	defw	40h
	defw	bbuf
	defw	ssmod
	defw	fromr
	defw	bscr
	defw	star
	defw	plus
	defw	block
	defw	plus
	defw	lit
	defw	40h
	defw	semis
;
;
	defb	85h			; .LINE
	defc	'.LINE'
	defw	pline-9
dline:
	defw	docol
	defw	pline
	defw	dtrai
	defw	type
	defw	semis
;
;
	defb	87h			; MESSAGE
	defc	'MESSAGE'
	defw	dline-8
mess:
	defw	docol
	defw	warn
	defw	at
	defw	zbran			; if
	defw	mess1-$
	defw	ddup
	defw	zbran			; if
	defw	mess2-$
	defw	lit
	defw	4			; 1st message screen
	defw	ofset
	defw	at
	defw	bscr
	defw	slash
	defw	subb
	defw	dline
	defw	space			; endif
mess2:
	defw	bran			; else
	defw	mess3-$
mess1:
	defw	pdotq
	defb	6
	db	'MSG # '
	defw	dot			; endif
mess3:	defw	semis
;
;
	defb	82h			; P@
	defc	'P@'
	defw	mess-0ah
ptat:
	defw	$+2
	exx				;d save registers
	pop	bc			;d bc <-- port#
	in	l,(c)			;d l <-- data byte
	ld	h,0
	push	hl
	exx				;d restore registers
	jnext
;
;
	defb	82h			; P!
	defc	'P!'
	defw	ptat-5
ptsto:
	defw	$+2
	exx				;d save registers
	pop	bc			;d c <-- port#
	pop	hl			;d L <-- date byte
	out	(c),l
	exx				;d restore registers
	jnext
;
;
	page
include	DISCIO.Z80
	page
include	CONPRTIO.Z80
	page
;
	defb	0c1h			; ' (tick)
	defb	0a7h
	defw	arrow-6
tick:
	defw	docol
	defw	dfind
	defw	zequ
	defw	zero
	defw	qerr
	defw	drop
	defw	liter
	defw	semis
;
;
	defb	86h			; FORGET
	defc	'FORGET'
	defw	tick-4
forg:
	defw	docol
	defw	curr
	defw	at
	defw	cont
	defw	at
	defw	subb
	defw	lit
	defw	18h
	defw	qerr
	defw	tick
	defw	dup
	defw	fence
	defw	at
	defw	uless			;/ FORGET >8000h nw o.k.
	defw	lit
	defw	15h
	defw	qerr
	defw	dup
	defw	nfa
	defw	dp
	defw	store
	defw	lfa
	defw	at
	defw	cont
	defw	at
	defw	store
	defw	semis
;
;
	defb	84h			; BACK
	defc	'BACK'
	defw	forg-9
back:
	defw	docol
	defw	here
	defw	subb
	defw	comma
	defw	semis
;
;
	defb	0c5h			; BEGIN
	defc	'BEGIN'
	defw	back-7
begin:
	defw	docol
	defw	qcomp
	defw	here
	defw	one
	defw	semis
;
;
	defb	0c5h			; ENDIF
	defc	'ENDIF'
	defw	begin-8
endiff:
	defw	docol
	defw	qcomp
	defw	two
	defw	qpair
	defw	here
	defw	over
	defw	subb
	defw	swap
	defw	store
	defw	semis
;
;
	defb	0c4h			; THEN
	defc	'THEN'
	defw	endiff-8
then:	defw	docol
	defw	endiff
	defw	semis
;
;
	defb	0c2h			; DO
	defc	'DO'
	defw	then-7
do:
	defw	docol
	defw	comp
	defw	xdo
	defw	here
	defw	three
	defw	semis
;
;
	defb	0c4h			; LOOP
	defc	'LOOP'
	defw	do-5
loop:
	defw	docol
	defw	three
	defw	qpair
	defw	comp
	defw	xloop
	defw	back
	defw	semis
;
;
	defb	0c5h			; +LOOP
	defc	'+LOOP'
	defw	loop-7
ploop:
	defw	docol
	defw	three
	defw	qpair
	defw	comp
	defw	xploo
	defw	back
	defw	semis
;
;
	defb	0c5h			; UNTIL
	defc	'UNTIL'
	defw	ploop-8
until:
	defw	docol
	defw	one
	defw	qpair
	defw	comp
	defw	zbran
	defw	back
	defw	semis
;
;
	defb	0c3h			; END
	defc	'END'
	defw	until-8
endd:
	defw	docol
	defw	until
	defw	semis
;
;
	defb	0c5h			; AGAIN
	defc	'AGAIN'
	defw	endd-6
again:
	defw	docol
	defw	one
	defw	qpair
	defw	comp
	defw	bran
	defw	back
	defw	semis
;
;
	defb	0c6h			; REPEAT
	defc	'REPEAT'
	defw	again-8
repea:
	defw	docol
	defw	tor
	defw	tor
	defw	again
	defw	fromr
	defw	fromr
	defw	twomin			;/
	defw	endiff
	defw	semis
;
;
	defb	0c2h			; IF
	defc	'IF'
	defw	repea-9
iff:
	defw	docol
	defw	comp
	defw	zbran
	defw	here
	defw	zero
	defw	comma
	defw	two
	defw	semis
;
;
	defb	0c4h			; ELSE
	defc	'ELSE'
	defw	iff-5
elsee:
	defw	docol
	defw	two
	defw	qpair
	defw	comp
	defw	bran
	defw	here
	defw	zero
	defw	comma
	defw	swap
	defw	two
	defw	endiff
	defw	two
	defw	semis
;
;
	defb	0c5h			; WHILE
	defc	'WHILE'
	defw	elsee-7
while:
	defw	docol
	defw	iff
	defw	twop
	defw	semis
;
;
	defb	86h			; SPACES
	defc	'SPACES'
	defw	while-8
spacs:
	defw	docol
	defw	zero
	defw	max
	defw	ddup
	defw	zbran			; if
	defw	spax1-$
	defw	zero
	defw	xdo			; do
spax2:
	defw	space
	defw	xloop			; loop endif
	defw	spax2-$
spax1:
	defw	semis
;
;
	defb	82h			; <#
	defc	'<#'
	defw	spacs-9
bdigs:
	defw	docol
	defw	pad
	defw	hld
	defw	store
	defw	semis
;
;
	defb	82h			; #>
	defc	'#>'
	defw	bdigs-5
edigs:
	defw	docol
	defw	drop
	defw	drop
	defw	hld
	defw	at
	defw	pad
	defw	over
	defw	subb
	defw	semis
;
;
	defb	84h			; SIGN
	defc	'SIGN'
	defw	edigs-5
sign:
	defw	docol
	defw	rot
	defw	zless
	defw	zbran			; if
	defw	sign1-$
	defw	lit
	defw	2dh
	defw	hold			; endif
sign1:
	defw	semis
;
;
	defb	81h			; #
	defc	'#'
	defw	sign-7
dig:
	defw	docol
	defw	base
	defw	at
	defw	msmod
	defw	rot
	defw	lit
	defw	9
	defw	over
	defw	less
	defw	zbran			; if
	defw	dig1-$
	defw	lit
	defw	7
	defw	plus			; endif
dig1:	defw	lit
	defw	30h
	defw	plus
	defw	hold
	defw	semis
;
;
	defb	82h			; #S
	defc	'#S'
	defw	dig-4
digs:
	defw	docol
digs1:
	defw	dig			; begin
	defw	tdup			;/
	defw	orr
	defw	zequ
	defw	zbran			; until
	defw	digs1-$
	defw	semis
;
;
	defb	83h			; D.R
	defc	'D.R'
	defw	digs-5
ddotr:
	defw	docol
	defw	tor
	defw	swap
	defw	over
	defw	dabs
	defw	bdigs
	defw	digs
	defw	sign
	defw	edigs
	defw	fromr
	defw	over
	defw	subb
	defw	spacs
	defw	type
	defw	semis
;
;
	defb	82h			; .R
	defc	'.R'
	defw	ddotr-6
dotr:
	defw	docol
	defw	tor
	defw	stod
	defw	fromr
	defw	ddotr
	defw	semis
;
;
	defb	82h			; D.
	defc	'D.'
	defw	dotr-5
ddot:
	defw	docol
	defw	zero
	defw	ddotr
	defw	space
	defw	semis
;
;
	defb	81h			; .
	defc	'.'
	defw	ddot-5
dot:
	defw	docol
	defw	stod
	defw	ddot
	defw	semis
;
;
	defb	81h			; ?
	defc	'?'
	defw	dot-4
ques:
	defw	docol
	defw	at
	defw	dot
	defw	semis
;
;
	defb	82h			; U.
	defc	'U.'
	defw	ques-4
udot:	defw	docol
	defw	zero
	defw	ddot
	defw	semis
;

	defb	85h			; VLIST
	defc	'VLIST'
	defw	udot-5
vlist:
	defw	docol
	defw	lit
	defw	80h
	defw	outt
	defw	store
	defw	cont
	defw	at
	defw	at
vlis1:
	defw	outt			; begin
	defw	at
	defw	csll
	defw	great
	defw	zbran			; if
	defw	vlis2-$
	defw	cr
	defw	zero
	defw	outt
	defw	store			; endif
vlis2:
	defw	dup
	defw	iddot
	defw	space
	defw	space
	defw	pfa
	defw	lfa
	defw	at
	defw	dup
	defw	zequ
	defw	qterm
	defw	orr
	defw	zbran			; until
	defw	vlis1-$
	defw	drop
	defw	semis
;
;
	defb	83h			; BYE
	defc	'BYE'
	defw	vlist-8
bye:
	defw	docol			;/A
	defw	flush			;/A
	defw	fcb,lit			;/E
	defw	10h,bdos		;/E close file
	defw	drop			;/E discard directory code
	defw	zero,zero		;/A
	defw	bdos			;/A return to CP/M
	defw	semis			;/A won't get this far, just for pretty
;
;
	defb	84h			; LIST
	defc	'LIST'
	defw	bye-6
list:
	defw	docol,dec
	defw	cr,dup
	defw	scr,store
	defw	pdotq
	defb	6
	db	'SCR # '
	defw	dot
	defw	lit,10h
	defw	zero,xdo
list1:
	defw	cr,ido
	defw	three			;/ was lit,3
	defw	dotr,space
	defw	ido,scr
	defw	at,dline
	defw	qterm
	defw	zbran,list2-$		; if
	defw	leave
list2:
	defw	xloop,list1-$		; endif
	defw	cr
	defw	semis
;
;
	defb	85H		;INDEX
	defc	'INDEX'
	defw	list-7
index:
	defw	docol
	defw	lit,ff
	defw	emit
	defw	cr
	defw	onep,swap
	defw	xdo
inde1:
	defw	cr,ido
	defw	three			;/ was lit,3
	defw	dotr,space
	defw	zero,ido
	defw	dline,qterm
	defw	zbran,inde2-$		; if
	defw	leave			; endif
inde2:
	defw	xloop,inde1-$
	defw	semis
;
;
	defb	85h			; TRIAD
	defc	'TRIAD'
	defw	index-8
triad:
	defw	docol
	defw	lit,ff
	defw	emit
	defw	three			;/ was lit,3
	defw	slash
	defw	three			;/ was lit,3
	defw	star
	defw	three			;/ was lit,3
	defw	over,plus
	defw	swap,xdo
tria1:
	defw	cr,ido
	defw	list
	defw	qterm
	defw	zbran,tria2-$		; if
	defw	leave
tria2:
	defw	xloop,tria1-$		; endif
	defw	cr
	defw	lit,15
	defw	mess,cr
	defw	semis
;
;
	defb	84h			; .CPU
	defc	'.CPU'
	defw	triad-8
dotcpu:
	defw	docol
	defw	base,at
	defw	lit,36
	defw	base,store
	defw	lit,22h
	defw	porig,tat
	defw	ddot
	defw	base,store
	defw	semis
;
;
	defb	86h			; setclk
	defc	'setclk'
	defw	dotcpu-7
setclk:
	defw	$+2
	exx				; save ip
	ld	c,iopreg
	ldctl	hl,(c)			; l <-- current i/o page
	ld	a,l
	ex	af,af' 			; save i/o page
	ld	l,0feh
	ldctl	(c),hl			; select i/o page 0feh
	xor	a
	out	(cntrl0),a		; disable c/t 0
	out	(cntrl1),a		; disable c/t 1
	out	(config1),a
	ld	hl,0ffffh
	ld	a,10h
	out	(config0),a		; cascade c/t 0 - c/t 1
	ld	c,tcon0
	outw	(c),hl			; load c/t 0 time constant
	ld	c,tcon1
	outw	(c),hl			; load c/t 1 time constatnt
	ld	a,80h
	out	(config1),a		; continous mode
	ld	a,0e0h
	out	(cntrl1),a		; start 32bit counter
	ex	af,af' 			; std. accu
	ld	l,a			; l <-- previous i/o page
	ld	c,iopreg
	ldctl	(c),hl			; restore i/o page
	exx				; restore ip
	jnext
;
;
	defb	86h			; getclk
	defc	'getclk'
	defw	setclk-9
getclk:
	defw	$+2
	exx				; save ip
	ld	c,iopreg
	ldctl	hl,(c)			; l <-- current i/o page
	ld	a,l
	ex	af,af' 			; save current i/o page
	ld	l,0feh
	ldctl	(c),hl			; select i/o page 0feh
	ld	a,80h
	out	(cntrl1),a		; halt 32bit counter
	ld	c,count1
	inw	hl,(c)
	ld	d,h
	ld	e,l			; de <-- count1
	ld	c,count0
	inw	hl,(c)			; hl <-- count0
	ld	c,0
	ld	a,c			; a <-- 0
	sub	l			; 0 - l
	ld	l,a			; l <-- neg(l)
	ld	a,c			; a <-- 0
	sbc	a,h
	ld	h,a			; h <-- neg(h)
	ld	a,c			; a <-- 0
	sbc	a,e
	ld	e,a			; e <-- neg(e)
	ld	a,c			; a <-- 0
	sbc	a,d
	ld	d,a			; d <-- neg(d), dehl <-- neg(dehl)
	divuw	dehl,25000		; scale to 1/100 secs
	push	hl			; result
	ex	af,af' 			; std. accu
	ld	l,a			; l <-- previous i/o page
	ld	c,iopreg
	ldctl	(c),hl			; restore i/o page
	exx				; restore ip
	jnext
;
;
	defb	84h			; TASK
	defc	'TASK'
	defw	getclk-9
;	defw	dotcpu-7
task:
	defw	docol
	defw	semis
;
;
initdp:
	defw	0
;
	end	orig
                                                                                                                                 Г‰ Гuav            ЃЃф  ц      Хе`iн&нлйѓLIФ  A`iн&эй‡EXECUTЕ9UбГ4†BRANCИId`iЭнЖMDЭй‡0BRANCИYyб}ґ(жЭй†(LOOP©mЌ*(Эн##{–z#ћъd#"(Эй‡(+LOOP©‚ІС*(~ѓw_#~Љw#WъН{–z#ћГТ~“#~љъd#"(Эй„(DO©¦жС*(++ЭБ++н"(ЭйЃЙЭэ*(ЭЕЭй…DIGIФчбС{Ц08ю
8Цю
8
Ѕ0_! Г,lэй†(FIND©7Сбе®ж? #®‡ 0ч! г·тN_ ! Г,8·т_лнzі Лб!  эй‡ENCLOSЕ,Сбе{Wя+#ѕ(ы ХW~§  ХХЭйz#ѕ(
~§ ц ХХЭй ХХЭй„EMIФsЧ\?PПѓKEЩіОГъ‰?TERMINAМЖЯ!  Го‚CТСмГ'…CMOVЕещЩБСбx±(н°ЩЭй†-CMOVЕпЩБСбx±(	+л	+лнёЩЭй‚UЄ+СбнУлГ,‚UЇ$:ЩБбСнЗ8!яяT]лнЛХеЩЭйѓANД3YСб{Ґoz¤gэй‚OТQjСб{µozґgэйѓXOТc|Сб{­oz¬gэйѓSPАtЋ!  9эйѓSPЎ†њ*& н6ЭйѓRPА”Ї*(эйѓRPЎ§ј*& н&"(Эй‚;УґС*(н##"(Эй…LEAVЕКз*(н##нЭй‚>ТЭщ*(++ЭБ"(Эй‚Rѕт*(ЭЕ##"(ЭйЃТэ‚0Ѕ%С!  нЧ ,эйѓ0<ѕ8С!  нЧ(,эй‚0ј0Jс!  Лэй‚0ѕCZС!  нЧтgкg,эйЃ«SoСбэй‚D«i{ЩБбсСхлбнJХеЩЭй…MINUУt•бнLэй†DMINUУ‹ҐЩСБ!  нОе!  нRеЩЭй„OVEТљАн эй„DROР·П33Эй„SWAРЖЬбгэйѓDUРУин  эй„TUCЛачбСеГ,ѓNIРобн  Эй„-ROФэбСглГ,…CSWAР&бнпэй„PICЛ4б)9ЭЕЭй„2DUР+DбСХеГ,‚+Ў;RбС~ѓw#~ЉwЭй†TOGGLЕKhСб~«wЭйЃА]uбЭЕЭй‚CАoЃбn& эй‚2АzЋбн##ЭЕХЭйЃЎ‡ћбЭБЭй‚CЎЄбСsЭй‚2ЎЈ¶бЭБ##ЭБЭйБєЇЧџ	Z	nsaњ{$
x
*(++н"(KBЭйБ»їЧЙ	 
П9

П„NOOРжЧП€CONSTANФшЧ{9
"x
лЭЕЭй€VARIABLЕЧx
ХЭй„USEТЧx
лn& ЭнЦ&эйЃ°3Rэх  ЭйЃ±L^эх ЭйЃІXjэх ЭйЃіdvэх Эй‚BМp  ѓC/М|@ …FIRSФ…  …LIMIФЏ  …B/BUЖ›Ђ …B/SCТ§ ‡+ORIGIОіЧ? mП‚S°ї@ ‚R°У@ ѓTIВЬ@
…WIDTИе@‡WARNINЗо@…FENCЕщ@‚DР@€VOC-LINЛ@ ѓBLЛ@‚IО(@ѓOUФ1@ѓSCТ9@†OFFSEФB@‡CONTEXФK@ ‡CURRENФW@"…STATЕd@$„BASЕq@&ѓDPМ|@(ѓFLД†@*ѓCSРЏ@,‚RЈ@.ѓHLДЎ@0 ‚1«©єб#эй‚2«іЕб##эй‚1­ѕСб+эй‚2­КЬб++эй‚2ЄХиб)эй‚2ЇбубЛ|(#Л,Лэй„HERЕмЧsП…ALLOФяЧPПЃ¬ЧњhП‚C¬ЧЁ\ПЃ­.EСбнЮэйЃЅ?QСбнЮ!   ,эйЃјKcСбz¬ъlнЮЛ|!  (,эй‚Uј]}СбнЮ!  ЛэйЃѕvЋбСz¬ъ—нЮЛ|!  (,эйѓROФ€©СбгГ,…SPACЕЎЧЃєП„-DUРЇИн  |µ(еЭй€TRAVERSЕїЧЪѕm? ѕawряЪНП†LATESФУЧnssПѓLFБъ	бэню эйѓCFБ	ЧЪПѓNFБ	Ч? C?яяЮПѓPFБ)	Ч\Ю? mП„!CSР?	ЧЊћњП†?ERROТS	ЧЪw щb НП…?COMРd	Чys#? m	П…?EXEГ	Чys? m	П†?PAIRУ—	ЧC? m	П„?CSР­	ЧЊћsC? m	П€?LOADINЗВ	Ч.s#? m	П‡COMPILЕЫ	Ч‡	
жГчs"ПБЫц	ЧPyњПЃЭ
Ч?А yњП†SMUDGЕ 
Ч	?  fПѓHEШ0
Ч? ѓњП‡DECIMAМE
Ч?
 ѓњП‡( ;CODE©W
Ч
	E	#	њПЕ;CODЕn
ЧЙ	 
x

яП‡<BUILDУ†
ЧPП…DOESѕњ
Ч
	E	њx
*(++н"(лн##эй…COUNФ®
ЧжёЪП„TYPЕФ
ЧЖw ѕmЪдыє‹шяb НП‰-TRAILINЗи
ЧжPдBmПЃCw еb П‹жяП„(."©ЧЬ
жё
mчп
ПВ.ўCЧ?" ysw  
JЛёb
 ЛЬ
п
П†EXPECФ^ЧѕmѕдМж? ЙsOw( НжыOж
Ъmчw
 ? b ? b( ж? Ow еНЃPb жыЁPыёњє‹ћяНП…QUERЩЌЧлs?P –P6њПБЂЧ.sw( \.PP6њ.s»ПW#w џ	
Нb 
НП„FILМ$gЩСБбx±(s#ГkЩЭй…ERASЕ^ЧPeП†BLANKУxЧЃeП„HOLД€Ч?яяЇPЇsЁПѓPAД™Ч?D mП„WORДІЧ.sw .s&b лs6smЪ}?" ‘6PѕCчЁmё
чП€(NUMBER©ДЧёжчѓsw, Ъѓs)Н§ѓs)yЊsёw \ЊP
bЖя
П†NUMBEТЧPP§жё?- Oжчm?яяЊњжЃCw ж?. CPm	PbЬяН
w ЈП…-FINД^ЧЃЛass5ж#w
 Н	5П‡(ABORT©·ЧRП…ERROТбЧsHw лЬ
п
J? ­љ.sЖw 6sЪ%ѓID®сЧё?  ‘жE		ѕCжчёЪчё
ёmПжs? WЪњЬ
? Wп
·П†CREATЕ(Чїw Н/	.? ­·жцs›ёж?  fП?Ђ f	"nsњГ"ПЙ[COMPILEЭrЧї#Pm	Н#	"ПЗLITERAМЕЧysw  
?"ПИDLITERAМгЧysw ЪннП†?STACЛяЧЊШsЪ{\m	Њ?Ђ m{? m	П‰INTERPREФЧїw ysaw
 #	"b #	S%b gЊsёw 
b Нн%bВя‰IMMEDIATЕIЧ	?@ fПЉVOCABULARЩ—Ч¦
?Ѓ "ns#	"$s"$њ¶
ГaњПЕFORTИЇВ
ЬЃ v  ‹DEFINITIONУдЧasnњПБЁцЧ?) ЛП„QUIФЧP.њ
єкUys#w Jokbзя…ABORФЧљa
%кЪJfig-FORTH 1.1aм%zЭйѓ„WARНJЧҐR* . "ҐЂнЮ"™"%"0"*@ нЮ"""&"( нЮ""щМЭ!.э!-ЭйХ„COLД|ЧҐ\њ?*s#њ?*s.њ№P?™Ё??&s? m? ч?s?тњ? ѓ?я Ow PњкJNo fileR„S->ДОNбнlлГ,‚+­EЧHw “ПѓD+­UЧHw ЈПѓABУfЧжZП„DABУxЧжlПѓMIО†ЧBЊw ЪНПѓMAШ•ЧBaw ЪНП‚MЄ«ИСбнТлГ,‚MЇБЧЩб|жЂ(нLDMбСЛ|(<е!  нЮСе!  нRСнЗ8!яяT]лнЛлЛG(нLл·(юЃ(нLХеЩЭйЃЄР!СбнТэй„/MOД0ЩБбx± яяbkэнч Ђ xюя №   нlнКХеЩЭйЃЇ'aЩБбx± !яяэнч Ђ xюя №(нlнКеЩЭйѓMOД[ЊЩБбx± яяэнч Ђ xюя №   нlнКХЩЭй…*/MOД„ѕЩб|жЂ(нLDMбСнТлЛ|(<е!  нЮСе!  нRСнЗ8!яяT]лнЛлЛG(нLл·(юЃ(нLХеЩЭй‚*ЇґЩб|жЂ(нLDMбСнТлЛ|(<е!  нЮСе!  нRСнЗ8!яялнЛ·(юЃ(нLеЩЭй…M/MOДЧчP8
Ъч8
П†(LINE©LЧч?@ Їј
»m&m?@ П….LINЕjЧsп
П‡MESSAGЕ‘Чsw Жw ? Ts»_C™·b JMSG # ЋП‚PАЈзЩБнh& еЩЭй‚PЎашЩБбнiЩЭйѓFCВс\ „RECЈ Ч?! mПѓUSЕ
/  „PREЦ/  …#BUFЖ'  ЉDISK-ERROТ2/  „+BUЖ>Ч?„ mжЈOw Н—ж.sCП†UPDATЕOЧ.ss? Ђh.sњПЌEMPTY-BUFFERУvЧ—ЈѕCЂПѓDR°•ЧPTњПѓDR±іЧ?@TњП†BUFFEТГЧ#sжчVwья#њsHw Гs?яWPЈњ.њ
ГП…BLOCЛХЧTsmч.sжsCжmw2 V#w НЮж\ЈЪжsCжm#wШяж.њ
НГП„BDOУ…ЩБСЭеэеЩЕЩН ЩБэбЭбo& эйѓR/Ч|ЧчњPГЁ? ѓН?" 
CЪѓKњП…FLUSИќЧ:ёPдPЮН‹шяП†EXTENДПЧЇ‘? Pёѕ\ЈKswряЪѕmЪдыPЈ‹ця? ѓН? ѓНП„LOAДнЧ.sч6sчP6њ».њU
6њ
.њПГ--ѕDЧж	P6њ».sѕЉC.PП ЕХеЭеэеЩЕЩН ЩБЩэбЭббСБЙЕяНљБЙЕяНљ·(ъю >ЛїБЙЕХНљСБЙЕНљБЙНС:™·ДЫЙНІ!  ·(,эйНјю_ 	!™ ~оwk& эйС{ю 
НС НСНгЭйНг
НгЭйБ§wЧї#Pm	НнП†FORGEФ3ЧnsasC? m	7жs{? m	ж/	њ	sasњП„BACЛGЧC"ПЕBEGIО†Ч‡	\ПЕENDIЖ—Ч‡	h¶	ѕCЪњПДTHEО©Ч±ПВDПЕЧ 
дtПДLOOРТЧt¶	 
‹ЌПЕ+LOOРгЧt¶	 
°ЌПЕUNTIМшЧ\¶	 
wЌПГENДЧПЕAGAIО$Ч\¶	 
bЌПЖREPEAФ0Ччч8

Ъ±ПВIЖFЧ 
wP"hПДELSЕaЧh¶	 
bP"Ъh±hПЕWHILЕvЧfГП†SPACEУ—ЧP±Жw Pд·‹ьяП‚<Ј§ЧёЇњП‚#ѕИЧННЇsёѕCП„SIGОЧЧ§Hw ?-  ПЃЈоЧѓsT§?	 ѕaw ? m?0 m П‚#УЧBh#wцяПѓD.Т1ЧчЪѕЌН6хЬ
ѕC°п
П‚.ТFЧчL
LП‚D®jЧPL·ПЃ®{ЧLЂПЃїЉЧsЋП‚U®–ЧPЂП…VLISФўЧ?Ђ ?њass?s‹Њw
 кP?њж.··E		sж#ЭhwФяНПѓBYЕЇЧЧ? ѓНPPѓП„LISФщЧa
кжHњJSCR # Ћ? Pдкыto·ыHs™Эw е‹дякП…INDEШЧ? єкёЪдкыto·Pы™Эw е‹жяП…TRIAД]Ч? єt_ttѕmЪдкыЭw е‹ряк? ­кП„.CPХ“Чѓs?$ ѓњ?" ЙЊЂѓњП†setclлУЩнf}.юнnЇУбУйУи!яя>Уавнїкнї>ЂУи>аУйoнnЩЭй†getclлш@Щнf}.юнn>ЂУйлн·T]гн· y•oyњgy›_yљWэныЁaеoнnЩЭй„TASЛ5ЧП                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :2001000000C3891000C375100101610E761B080000000000000000001F000000811B811BDA
:20012000F40F180000F6000000000000D5E56069ED260303ED16EB13E9834C49D4000041FB
:20014000016069ED260303FDE987455845435554C539015501E1C33401864252414E43C89F
:20016000490164016069DDEDC64D44DDE987304252414E43C859017901E17DB428E6030341
:20018000DDE986284C4F4F50A96D018D012A2801DD03ED1623237B967A239EFA64012322A0
:2001A00028010303DDE987282B4C4F4F50A98201B201D12A28017E83775F237E8A77231483
:2001C0001557FACD017B967A239EC3D2017E93237E9AFA6401232228010303DDE984284434
:2001E0004FA9A601E601D12A28012B2BDDC12B2BED1E222801DDE981C9DD01FD012A280176
:20020000DDC5DDE98544494749D4F7010E02E1D17BD6303814FE0A3806D607FE0A380ABD4F
:2002200030075F210100C32C016CFDE9862846494E44A904023702D1E1E51AAEE63F201F4A
:2002400023131AAE87201630F721050019E31B1AB7F24E025F1600210100C32C0138061394
:200260001AB7F25F0213EBED167AB320CBE1210000FDE987454E434C4F53C52C027F02D1C9
:20028000E1E57B571EFF2B231CBE28FB1600D5577EA7200816001CD51DD5DDE97A231CBE99
:2002A000280A7EA720F61600D5D5DDE91600D51CD5DDE984454D49D47302D70510175C069C
:2002C0003F075005CF03834B45D9B302CE02C3FA16893F5445524D494E41CCC602DF0221FF
:2002E0000000C3EE168243D2D102EC02C3271785434D4F56C5E502F902D9C1D1E178B128E0
:2003000002EDB0D9DDE9862D434D4F56C5EF021103D9C1D1E178B12808092BEB092BEBED1D
:20032000B8D9DDE98255AA06032B03D1E1EDD3EBC32C018255AF24033A03D9C1E1D1EDC777
:20034000380721FFFF545D1803EBEDCBD5E5D9DDE983414EC433035903D1E17BA56F7AA4B0
:2003600067FDE9824FD251036A03D1E17BB56F7AB467FDE983584FD263037C03D1E17BAD45
:200380006F7AAC67FDE9835350C074038E0321000039FDE9835350A186039C032A260111FC
:2003A000060019ED36DDE9835250C09403AF032A2801FDE9835250A1A703BC032A2601113D
:2003C000080019ED26222801DDE9823BD3B403D1032A2801ED062323222801DDE9854C450A
:2003E0004156C5CA03E7032A2801ED162323ED1EDDE9823ED2DD03F9032A28012B2BDDC1C8
:20040000222801DDE98252BEF2030C042A2801DDC52323222801DDE981D20504FD018230DC
:20042000BD18042504D1210000EDD720012CFDE983303CBE1E043804D1210000EDD72801E7
:200440002CFDE98230BC30044A04F117210000CB15FDE98230BE43045A04D1210000EDD7E0
:20046000F26704EA67042CFDE981AB53046F04D1E119FDE98244AB69047B04D9C1E1F1D177
:20048000F519EBE1ED4AD5E5D9DDE9854D494E55D374049504E1ED4CFDE986444D494E554D
:2004A000D38B04A504D9D1C1210000EDCEE5210000ED52E5D9DDE9844F5645D29A04C0047F
:2004C000ED040200FDE98444524FD0B704CF043333DDE984535741D0C604DC04E1E3FDE9BD
:2004E000834455D0D304E804ED040000FDE984545543CBE004F704E1D1E5C32C01834E49BB
:20050000D0EE040505E1ED050000DDE9842D524FD4FD041505E1D1E3EBC32C018543535753
:2005200041D00C052605E1EDEFFDE984504943CB1C053405E12939DDC5DDE984324455D07C
:200540002B054405E1D1D5E5C32C01822BA13B055205E1D17E8377237E8A77DDE986544F26
:2005600047474CC54B056805D1E17EAB77DDE981C05D057505E1DDC5DDE98243C06F058127
:2005800005E16E2600FDE98232C07A058E05E1ED162323DDC5D5DDE981A187059E05E1DDFF
:2005A000C1DDE98243A19805AA05E1D173DDE98232A1A305B605E1DDC12323DDC1DDE9C175
:2005C000BAAF05D7059F095A096E07730561079C057B0E240A780A2A28012B2BED0E2228A9
:2005E00001134B42DDE9C1BBBF05D705C909000ACF03390A160ACF03844E4F4FD0E605D793
:2006000005CF0388434F4E5354414ED4F805D7057B0E390A2208780A13EBDDC5DDE98856FC
:2006200041524941424CC50306D7050E06780A13D5DDE984555345D21E06D7050E06780A48
:2006400013EB6E2600DDEDD62601FDE981B033065206FDF50000DDE981B14C065E06FDF507
:200660000100DDE981B258066A06FDF50200DDE981B364067606FDF50300DDE98242CC7023
:20068000061806200083432FCC7C06180640008546495253D4850618060000854C494D498F
:2006A000D48F061806000085422F4255C69B061806800085422F5343D2A706180608008769
:2006C0002B4F52494749CEB306D7053F0100016D04CF038253B0BF06400606008252B0D3A1
:2006E0000640060800835449C2DC0640060A8557494454C8E50640060C875741524E494E7A
:20070000C7EE0640060E8546454E43C5F9064006108244D0060740061288564F432D4C49E2
:200720004ECB11074006140083424CCB19074006168249CE2807400618834F55D43107403D
:20074000061A835343D2390740061C864F46465345D4420740061E87434F4E544558D44BFB
:20076000074006208743555252454ED457074006228553544154C564074006248442415367
:20078000C57107400626834450CC7C0740062883464CC4860740062A834353D08F07400641
:2007A0002C8252A3980740062E83484CC4A107400630008231ABA907BA07E123FDE982321D
:2007C000ABB307C507E12323FDE98231ADBE07D107E12BFDE98232ADCA07DC07E12B2BFDA3
:2007E000E98232AAD507E807E129FDE98232AFE107F307E1CB7C280123CB2CCB1DFDE984F5
:20080000484552C5EC07D70516077305CF0385414C4C4FD4FF07D70516075005CF0381AC2A
:200820000E08D70506089C0568061608CF038243AC1E08D7050608A8055C061608CF0381B8
:20084000AD2E084508D1E1EDDEFDE981BD3F085108D1E1EDDE21000020012CFDE981BC4BCE
:20086000086308D1E17AACFA6C08EDDECB7C21000028012CFDE98255BC5D087D08D1E1ED35
:20088000DE210000CB15FDE981BE76088E08E1D17AACFA9708EDDECB7C21000028012CFD4A
:2008A000E983524FD48808A908D1E1E3C32C018553504143C5A108D7058106BA02CF038402
:2008C0002D4455D0AF08C808ED0400007CB52801E5DDE98854524156455253C5BF08D705EE
:2008E000DA04BE046D043F017F00BE047F0561087701F0FFDA04CD04CF03864C4154455392
:20090000D4D308D7056E0773057305CF03834C46C1FA081509E1FDEDFE0400FDE983434660
:20092000C10D09D705DA07CF03834E46C11D09D7053F01050043083F01FFFFDE08CF03836E
:200940005046C12909D7055C06DE083F0105006D04CF0384214353D03F09D7058C039E07FF
:200960009C05CF03863F4552524FD25309D705DA0477010800F90D62010400CD04CF03850A
:200980003F434F4DD06409D7057907730523043F0111006D09CF03853F455845C37F09D7A0
:2009A00005790773053F0112006D09CF03863F50414952D39709D70543083F0113006D094C
:2009C000CF03843F4353D0AD09D7058C039E07730543083F0114006D09CF03883F4C4F4154
:2009E00044494EC7C209D7052E07730523043F0116006D09CF0387434F4D50494CC5DB0948
:200A0000D70587090A04E604C307F70373052208CF03C1DBF609D705500679079C05CF037A
:200A200081DD120AD7053F01C00079079C05CF0386534D554447C5200AD70503093F012030
:200A4000006605CF03834845D8300AD7053F01100083079C05CF0387444543494D41CC45D3
:200A60000AD7053F010A0083079C05CF038728203B434F4445A9570AD7050A0403094509D6
:200A800023099C05CF03C53B434F44C56E0AD705C909000A780A160AFF05CF03873C42551A
:200AA000494C44D3860AD70550060E06CF0385444F4553BE9C0AD7050A04030945099C05E9
:200AC000780A2A28012B2BED0E22280113EBED062323FDE985434F554ED4AE0AD705E6047C
:200AE000B807DA047F05CF0384545950C5D40AD705C60877011800BE046D04DA04E401FBB4
:200B0000017F05BA028B01F8FF62010400CD04CF03892D545241494C494EC7E80AD705E6C3
:200B2000045006E40142056D04CF077F058106430877010800E50362010400CF078B01E67B
:200B4000FFCF0384282E22A9110BD7051C04DC0AE604B8070A046D04F703EF0ACF03C22E44
:200B6000A2430BD7053F0122007907730577011400000A4A0BCB0C06087F05B807160862BC
:200B8000010A00CB0C0608DC0AEF0ACF03864558504543D45E0BD705BE046D04BE04E401C6
:200BA000CC02E6043F010E00C90673054F0877012800CD04E604FB014F08E6040A04DA070A
:200BC0006D04F70377010A003F010700620106003F01080062012800E6043F010D004F0817
:200BE00077010E00E503CD048106500662010400E604FB01A8055006FB01B8079C05BA0271
:200C00008B019EFFCD04CF038551554552D98D0BD705EB0673053F015000960B50063607CC
:200C20009C05CF03C180080CD7052E077305770128005C062E075005500636079C052E076E
:200C40007305BB06CF0757032304770108009F090A04CD04620106000A04CD04CF03844619
:200C6000494CCC240C670CD9D1C1E178B1280673230BC36B0CD9DDE98545524153C55E0C74
:200C8000D7055006650CCF0386424C414E4BD3780CD7058106650CCF0384484F4CC4880C35
:200CA000D7053F01FFFFAF075005AF077305A805CF03835041C4990CD70506083F01440077
:200CC0006D04CF0384574F52C4B20CD7052E07730577010C002E077305261562010600EB8A
:200CE000067305360773056D04DA047D0206083F012200910C36075005BE044308F7031C31
:200D0000040608A8056D040608B8070A04F702CF0388284E554D424552A9C40CD705B80770
:200D2000E604F7037F05830773050C0277012C00DA04830773052903CD04A7088307730509
:200D4000290379048C077305B807770108005C068C0750050A046201C6FF0A04CF03864E6C
:200D6000554D4245D2110DD70550065006A708E604B8077F053F012D004F08E604F7036DE1
:200D8000043F01FFFF8C079C051C0DE6047F058106430877011600E6047F053F012E0043C7
:200DA0000850066D0950066201DCFFCD040A0477010400A304CF03852D46494EC45E0DD762
:200DC000058106CB0C06086107730573053502E604230477010A00CD04060803093502CF8F
:200DE00003872841424F5254A9B70DD7055210CF03854552524FD2E10DD705030773054829
:200E00000477010400EB0D0608DC0AEF0A4A0B023F20AD139A032E077305C608770108005F
:200E200036077305DA042510834944AEF10DD705B80C3F012000910CE60445091309BE047B
:200E40004308E604F703B80CDA04F702B80C0A04B80C6D04CF07E60473053F017F00570370
:200E6000DA049C05DC0A3F011F005703EF0AB708CF03864352454154C5280ED705BF0D77BB
:200E8000011000CD042F092E0E3F010400AD13B7080608E6047F05F60673059B11B80716C8
:200EA00008E6043F01A00066050608CF073F0180006605030922086E0773059C050608C351
:200EC000072208CF03C95B434F4D50494C45DD720ED705BF0D230450066D09CD04230922CB
:200EE00008CF03C74C4954455241CCC50ED7057907730577010800000A3F012208CF03C88F
:200F0000444C4954455241CCE30ED7057907730577010800DA04ED0EED0ECF03863F5354A9
:200F20004143CBFF0ED7058C03D8067305DA047B085C066D098C0306083F0180006D047B12
:200F4000083F0107006D09CF0389494E544552505245D41C0FD705BF0D77011E00790773D8
:200F600005610877010A00230922086201060023095301250F62011C000608670D8C077307
:200F800005B807770108000A0F62010600CD04ED0E250F6201C2FF89494D4D454449415494
:200FA000C5490FD70503093F0140006605CF038A564F434142554C4152D9970FD705A60A3B
:200FC0003F0181A022086E07730523092208060824077305220824079C05B60AC3076107AA
:200FE0009C05CF03C5464F5254C8AF0FC20ADC0F81A0761B00008B444546494E4954494F69
:201000004ED3E40FD705610773056E079C05CF03C1A8F60FD7053F012900CB0CCF038451E7
:201020005549D41010D70550062E079C05160ABA03EA02100C550F7907730523047701072F
:20104000004A0B026F6B6201E7FF8541424F52D41E10D7059A03610A250FEA02DA1A4A0B1E
:201060000E6669672D464F52544820312E3161EC0F04102510017A10DDE9831084574152D5
:20108000CD4A10D705A51452102A06002E0022A506118010EDDE22990622251422301422F7
:2010A0002A01114000EDDE221001221401222601222801110004EDDE221201221601F901A3
:2010C000CC10DD212E01FD212D01DDE9D51084434F4CC47C10D705A5145C0611149C053F62
:2010E000012A01730523149C053F012A0173052E149C05B91450063F019916A8053F01129D
:20110000013F01260173053F0106006D043F011000F7023F010C0173053F01F20F9C050642
:20112000143F010F0083153F01FF004F0877011400500603079C05EA024A0B074E6F206606
:20114000696C65521084532D3EC4CE104E11E1ED6CEBC32C01822BAD4511D705480477014B
:2011600004009304CF0383442BAD5511D705480477010400A304CF03834142D36611D705B4
:20118000E6045A11CF0384444142D37811D705E6046C11CF03834D49CE8611D70542058C3F
:2011A0000877010400DA04CD04CF03834D41D89511D7054205610877010400DA04CD04CF15
:2011C00003824DAAAB11C811D1E1EDD2EBC32C01824DAFC111D711D9E17CE6802802ED4C7B
:2011E000444DE1D1CB7C280F3CE5210000EDDED1E5210000ED52D1EDC7380721FFFF545D77
:201200001814EBEDCBEBCB472802ED4CEBB72806FE812802ED4CD5E5D9DDE981AAD0112167
:2012200012D1E1EDD2FDE9842F4D4FC41B123012D9C1E178B1200711FFFF626B1818FDED02
:20124000F70080200D78FEFF2008B920051100001804ED6CEDCAD5E5D9DDE981AF2712610F
:2012600012D9C1E178B1200521FFFF1813FDEDF70080200878FEFF2003B92804ED6CEDCA33
:20128000E5D9DDE9834D4FC45B128C12D9C1E178B1200511FFFF1818FDEDF70080200D78CE
:2012A000FEFF2008B920051100001804ED6CEDCAD5D9DDE9852A2F4D4FC48412BE12D9E11C
:2012C0007CE6802802ED4C444DE1D108EDD208EBCB7C280F3CE5210000EDDED1E52100006A
:2012E000ED52D1EDC7380721FFFF545D1814EBEDCBEBCB472802ED4CEBB72806FE81280273
:20130000ED4CD5E5D9DDE9822AAFB4120E13D9E17CE6802802ED4C444DE1D108EDD208EBFD
:20132000CB7C280F3CE5210000EDDED1E5210000ED52D1EDC7380521FFFF180CEBEDCBB7AD
:201340002806FE812802ED4CE5D9DDE9854D2F4D4FC40713D705F70350061C0438030A04E9
:20136000DA04F70338030A04CF0386284C494E45A94C13D705F7033F014000AF06BC120AB9
:2013800004BB061F126D0426156D043F014000CF03852E4C494EC56A13D70573131D0BEF97
:2013A0000ACF03874D4553534147C59113D7050307730577011E00C608770114003F01040F
:2013C0000054077305BB065F1243089913B70862010D004A0B064D53472023208E19CF03C4
:2013E0008250C0A313E713D9C1ED682600E5D9DDE98250A1E013F813D9C1E1ED69D9DDE931
:20140000834643C2F11318065C0084524543A30014D70506143F0121006D04CF03835553A6
:20142000C50A142F06000084505245D61D142F0600008523425546C62714180620008A445B
:2014400049534B2D4552524FD232142F060000842B4255C63E14D7053F0184006D04E6049A
:20146000A3064F0877010600CD049706E6042E1473054308CF03865550444154C54F14D7BC
:20148000052E14730573053F01008068032E1473059C05CF038D454D5054592D4255464651
:2014A0004552D37614D7059706A306BE044308800CCF03834452B09514D705500654079C10
:2014C00005CF03834452B1B314D7053F01400654079C05CF03864255464645D2C314D70501
:2014E00023147305E604F70356147701FCFF23149C051C0473054804770114001C04C3074A
:201500001C0473053F01FF7F57035006A3151C049C051C042E149C050A04C307CF038542D8
:201520004C4F43CBD514D705540773056D04F7032E147305E60473051C044308E6046D041D
:20154000770132005614230477011200CD041C04DE14E6041C045C06A315DA07E60473057C
:201560001C044308E6046D0423047701D8FFE6042E149C050A04CD04C307CF038442444F8E
:20158000D31E158515D9C1D1DDE5FDE5D9C5D9CD0500D9C1FDE1DDE16F2600FDE983522F9E
:2015A000D77C15D705F70311149C0550061114C307A8053F011A008315CD043F0122000A06
:2015C0000443080614DA0483154B149C05CF0385464C5553C89D15D7053A14B8075006E4FE
:2015E000015006DE14CD048B01F8FFCF0386455854454EC4CF15D7050608AF06910C3F014E
:2016000008001F125006B8070608BE045C06A3154B1473057701F0FFDA04BE046D04DA0465
:20162000E4010608FB015006A3158B01F6FF06143F0110008315CD0406143F010F00831558
:20164000CD04CF03844C4F41C4ED15D7052E077305F70336077305F703500636079C05BBA0
:20166000061F122E079C05550F0A0436079C050A042E079C05CF03C32D2DBE4416D705E660
:2016800009500636079C05BB062E077305BE048A1243082E075005CF0300C5D5E5DDE5FD5C
:2016A000E5D9C5D9CD0500D9C1D9FDE1DDE1E1D1C1C9C50E061EFFCD9A16C1C9C50E061EBD
:2016C000FFCD9A16B728FAFE7F20023E08CBBFC1C9C5D50E06CD9A16D1C1C9C50E05CD9AF7
:2016E00016C1C9CDD1163A9916B7C4DB16C9CDB216210000B728012CFDE9CDBC16FE105FC4
:2017000020092199161E207EEE01776B2600FDE91217D17BFE08200ACDD1161E20CDD116EC
:201720001E08CDE316DDE91E0DCDE3161E0ACDE316DDE9C1A77716D705BF0D230450066DCB
:2017400009CD04ED0ECF0386464F524745D43317D7056E0773056107730543083F0118007F
:201760006D093717E6040E0773057B083F0115006D09E6042F0916079C0513097305610704
:2017800073059C05CF0384424143CB4717D705060843082208CF03C542454749CE8617D79C
:2017A00005870906085C06CF03C5454E4449C69717D70587096806B6090608BE044308DA6B
:2017C000049C05CF03C4544845CEA917D705B117CF03C244CFC517D705000AE401060874EB
:2017E00006CF03C44C4F4FD0D217D7057406B609000A8B018D17CF03C52B4C4F4FD0E317E5
:20180000D7057406B609000AB0018D17CF03C5554E5449CCF817D7055C06B609000A770123
:201820008D17CF03C3454EC40E18D7051618CF03C541474149CE2418D7055C06B609000A2E
:2018400062018D17CF03C65245504541D43018D705F703F70338180A040A04DA07B117CFAC
:2018600003C249C64618D705000A77010608500622086806CF03C4454C53C56118D70568E0
:2018800006B609000A6201060850062208DA046806B1176806CF03C55748494CC57618D711
:2018A000056618C307CF03865350414345D39718D7055006B111C60877010C005006E40114
:2018C000B7088B01FCFFCF03823CA3A718D705B80CAF079C05CF038223BEC818D705CD0417
:2018E000CD04AF077305B80CBE044308CF0384534947CED718D705A7084804770108003F8C
:20190000012D00A00CCF0381A3EE18D705830773055413A7083F010900BE04610877010809
:20192000003F0107006D043F0130006D04A00CCF038223D30719D7050B194205680323041F
:201940007701F6FFCF0383442ED23119D705F703DA04BE048D11CD183619F518DC180A04E0
:20196000BE044308B018EF0ACF03822ED24619D705F7034C110A044C19CF038244AE6A1977
:20198000D70550064C19B708CF0381AE7B19D7054C118019CF0381BF8A19D70573058E19DA
:2019A000CF038255AE9619D70550068019CF0385564C4953D4A219D7053F0180003F079CB4
:2019C000056107730573053F0773058B068C0877010A00EA0250063F079C05E6042E0EB73F
:2019E00008B708450913097305E6042304DD0268037701D4FFCD04CF03834259C5AF19D773
:201A000005D71506143F0110008315CD04500650068315CF03844C4953D4F919D705610A53
:201A2000EA02E60448079C054A0B065343522023208E193F0110005006E401EA02FB0174AC
:201A4000066F19B708FB01480773059913DD0277010400E5038B01E4FFEA02CF0385494E3E
:201A60004445D8151AD7053F010C00BA02EA02B807DA04E401EA02FB0174066F19B708508B
:201A800006FB019913DD0277010400E5038B01E6FFCF038554524941C45D1AD7053F010CFA
:201AA00000BA0274065F1274061F127406BE046D04DA04E401EA02FB011C1ADD02770104EB
:201AC00000E5038B01F0FFEA023F010F00AD13EA02CF03842E4350D5931AD7058307730545
:201AE0003F01240083079C053F012200C9068C05801983079C05CF0386736574636CEBD3A0
:201B00001A031BD90E08ED667D082EFEED6EAFD3E1D3E9D3E821FFFF3E10D3E00EE2EDBFA9
:201B20000EEAEDBF3E80D3E83EE0D3E9086F0E08ED6ED9DDE986676574636CEBF81A401B3A
:201B4000D90E08ED667D082EFEED6E3E80D3E90EEBEDB7545D0EE3EDB70E0079956F799C3A
:201B600067799B5F799A57FDEDFBA861E5086F0E08ED6ED9DDE984544153CB351BD705CF95
:031B80000300005F
:00010001FE
8B708450913097305E6042304DD	title	<Z280 fig-FORTH 1.1 a>		
	subttl	Adaptive version		
;
;
; Modified from Z80 fig-FORTH 1.1h by EHR 880830
; Modified frm FIG document keyed by Dennis L. Wilson 800907
; Converted frm "8080 FIG-FORTH VERSION A0 15SEP79"
;
; fig-FORTH release 1.1 for the 8080 processor.
;
; ALL PUBLICATIONS OF THE FORTH INTEREST GROUP
; ARE PUBLIC DOMAIN. THEY MAY BE FURTHER
; DISTRIBUTED BY THE INCLUSION OF THIS CREDIT NOTICE:
;
; This publication has been made available by the
;	Forth Interest Group
;	P.O.Box 1105
;	San Carlos, CA 94070
;	U.S.A.
;
; Implementation on 8080 by:
;	John Cassady
;	339 15th Street
;	Oakland, CA 94612
;	U.S.A
;	on 790528
; Modified by:
;	Kim Harris
; Acknowledgements:
;	George Flammer
;	Robt. D. Villwock
; ----------------------------------------------------------------------
; Z80 Version for Cromemco CDOS & Digital Research CP/M by:
;	Dennis Lee Wilson c/o
;	Aristotelian Logicians
;	2631 East Pinchot Avenue
;	Phoenix, AZ 85016
;	U.S.A.
; ----------------------------------------------------------------------
; The 2 byte Z80 code for Jump Relative (JR) has been substituted for
; the 3 byte Jump (JP) wherever practical. The port I/O words P@ & P!
; have been made ROMable by use of Z80 instructions.
; ----------------------------------------------------------------------
; Further modifications (marked ;/) by:
;	Edmund Ramm
;	P.O.Box 38
;	2358 Kaltenkirchen
;	Fed. Rep. of Germany	840418
;
; 850419	changed * (star)
; 850507	added   0<>, 0>, TUCK, NIP, -ROT, CSWAP, PICK
; 850511	added	-CMOVE
;
; -----------------------------------------------------------------------------
; Disc I/O has been modified a la Albert van der Horst (HCCH) to employ
; CP/M 2.x's random access feature.
; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------
;
; Z280 specifics
;
;
iopreg		equ	08h		; i/o page register
;
config0		equ	0e0h		; c/t 0 configuration register
cntrl0		equ	0e1h		; c/t 0 command/status register
tcon0		equ	0e2h		; c/t 0 time constatnt register
count0		equ	0e3h		; c/t 0 count-time register
config1		equ	0e8h		; c/t 1 configuration register
cntrl1		equ	0e9h		; c/t 1 command/status register
tcon1		equ	0eah		; c/t 1 time constant register
count1		equ	0ebh		; c/t 1 count-time register
;
; -----------------------------------------------------------------------------
;
;	Release & Version numbers
;
figrel		equ	1		;FIG RELEASE #
figrev		equ	1		;FIG REVISION #
usrver		equ	61h		;USER VERSION # a by EHR
;
;Console & printer drivers are in external source named
;CONPRTIO.FTH & disc drivers in DISCIO.FTH. It has 4 screen
;buffers & end of memory is set to FBASE from locn. 0007H.
	page					
;	ASCII characters used
;
abl		equ	20h		;BLANK
acr		equ	0dh		;CR
adot		equ	2eh		;.
bell		equ	07h		;^G
bsin		equ	08h		;backspace chr = ^H
bsout		equ	08h		
dle		equ	10h		;^P
lf		equ	0ah		;^J
ff		equ	0ch		;^L
;
;	Memory allocation
;
bdoss		equ	0005h		;/ system entry
nscr		equ	4		;  # of 1024 byte screens
kbbuf		equ	128		;  bytes/disc buffer
us		equ	40h		;  user variables space
rts		equ	400h		;  Return Stack & term buff space
co		equ	kbbuf+4		;  Disc buff + 2 header + 2 tail
nbuf		equ	nscr*400h/kbbuf	;  # of buffers
bufsiz		equ	co*nbuf		;/ total disc buffer size
	page					
	aseg					
	;.z280					
	; PRE280 V1.12  11-Feb-91  Copyright (c) 1988-91 by A.Zinser (fifi@hiss.han.de)
	.Z80
;
	org	0100h				
;
orig:					
	nop					
	jp	cld			; vector to cold start
	nop				
	jp	wrm			; vector to warm start
	defb	figrel			; fig release #
	defb	figrev			; fig revision #
	defb	usrver			; user version #
	defb	0eh			; implementation attributes
;
;
;
;	0eh = 0000:1110
;	      ---------
; B +ORIGIN   ...W:IEBA
;
; W: 0=above sufficient
;    1=other differences exist
; I: Interpreter is	0=pre-
;			1=post incrementing
; E: Addr must be even: 0 yes
;			1 no
; B: High byte @	0=low addr.
;			1=high addr.
; A: CPU Addr.		0=BYTE
;			1=WORD
;
;
;
	defw	task-7			;  topmost word in FORTH vocabulary
	defw	bsin			;  backspace chr
upinit:	defw	0			;/ init (up)
;
; * Following used by COLD; must be in same order as user variables *
;
s0init:	defw	0			;/ init (s0)
r0init:	defw	0			;/ init (r0)
tibini:	defw	0			;/ init (TIB)
	defw	1fh			;  init (WIDTH)
	defw	0			;  init (WARNING)
	defw	initdp			;  init (FENCE)
	defw	initdp			;  init (dp)
	defw	forth+8			;  init (VOC-LINK)
;
; *  END DATA USED BY COLD *
;
	defw	0018h,0f600h		; Z280 CPU name (hw,lw)
					; (32 bit base 36 integer)
	page				
;	REGISTERS
;
;	FORTH	Z80	FORTH PRESERVATION RULES
;	-----	---	-----------------------
;	IP	BC	should be preserved
;			accross FORTH words.
;	W	DE	sometimes output from
;			NEXT, may be altered
;			b4 JP'ing to NEXT,
;			input only when 
;			"DPUSH" called.
;	SP	SP	should be used only as
;			Data Stack accross
;			FORTH words, may be
;			used within FORTH
;			words if restored
;			b4 "NEXT"
;		HL	Never output frm NEXT
;			input only when
;			"HPUSH" called
;
;
up:	defw	0			;/ user area ptr
rpp:	defw	0			;/ return stack ptr
buf1:	defw	0			;/ address of 1st disc buffer
;
;
;	COMMENT CONVENTIONS:
;
;	==	means "is equal to"
;	<--	means assignment
;	#NAME	=     value of name
;	NAME    =     contents @ name
;	(NAME)  =     contents of cell addressed by name
;	cfa	=     code field address
;	lfa	=     link field address
;	nfa	=     name field address
;	pfa	=     parameter field address
;	s1	=     1st word of parameter stack
;	s2	=     2nd -"-  of    -"-     -"-
;	r1	=     1st -"-  of return stack
;	r2	=     2nd -"-  of  -"-    -"-
; ( above Stack posn. valid b4 & after execution of any word, not during)
;
;	lsb	=     least significant bit
;	msb	=     most  significant bit
;	lb	=     low  byte
;	hb	=     high byte
;	lw	=     low  word
;	hw	=     high word
; (May be used as suffix to above names)
	page				
;	FORTH ADDRESS INTERPRETER
;	POST INCREMENTING VERSION
;
;
;
dpush:					
	push	de			
hpush:					
	push	hl			; iy points here
next:					
	ld	h,b			;/ w <-- (ip)    ix points here
	ld	l,c			;/
	;ldw	hl,(hl)			;/ (hl) --> cfa
	DEFB	0EDh,26h
	inc	bc			
	inc	bc			;/ ip += 2
next1:					
	;ldw	de,(hl)			;/ pc <-- (w)
	DEFB	0EDh,16h
	ex	de,hl			
	inc	de			
	jp	(hl)			; note: de <-- cfa + 1
;
;
jnext	macro				
	jp	(ix)			
	endm				
;
jhpush	macro				
	jp	(iy)			
	endm				
;
	page				
;	FORTH DICTIONARY
;	DICTIONARY FORMAT:
;
;				BYTE
;	ADDRESS NAME		CONTENTS
;	------- ----		--------
;						(MSB=1
;						(P=PRECEDENCE BIT
;						(S=SMUDGE BIT
;	NFA	NAME FIELD	1PS<LEN>	<NAME LENGTH
;				0<1CHAR>	MSB=0, NAME'S 1st CHAR
;				0<2CHAR>
;				  ...
;				1<LCHAR>	MSB=1, NAME'S LAST CHAR
;	LFA	LINK FIELD	<LINKLB>	=PREVIOUS WORD'S NFA
;				<LINKHB>
;LABEL:	CFA	CODE FIELD	<CODELB>	=ADDR CPU CODE
;				<CODEHB>
;	PFA	PARAMETER	<1PARAM>	1st PARAMETER BYTE
;		FIELD		<2PARAM>
;				  ...
;
;
;
dp0:					
	defb	83h			; LIT
	defc	'LIT'			
	defw	0			; lfa == 0 marks end of dictionary 
lit:					
	defw	$+2			; s1 <-- (ip)
	ld	h,b			
	ld	l,c			
	;ldw	hl,(hl)			; hl <-- (ip) = literal
	DEFB	0EDh,26h
	inc	bc			;/
	inc	bc			;/ ip += 2
	jhpush				; s1 <-- hl
;
;
	defb	87h			; EXECUTE
	defc	'EXECUTE'		
	defw	lit-6			
exec:					
	defw	$+2			
	pop	hl			
	jp	next1			
;
;
	defb	86h			; BRANCH
	defc	'BRANCH'		
	defw	exec-0ah		
bran:					
	defw	$+2			; ip += (ip)
bran1:					
	ld	h,b			
	ld	l,c			; hl <-- ip
	;addw	hl,(hl)			; hl <-- ip + branch offset
	DEFB	0DDH
	DEFB	0EDH,0C6h
	ld	c,l			
	ld	b,h			; ip += branch offset
	jnext				
;
;
	defb	87h			; 0BRANCH
	defc	'0BRANCH'		
	defw	bran-9			
zbran:					
	defw	$+2			
	pop	hl			
	ld	a,l			
	or	h			
	jr	z,bran1			; branch if if s1 == 0
	inc	bc			; else skip branch offset
	inc	bc			
	jnext				
;
;
	defb	86h			; (LOOP)
	defc	'(LOOP)'		
	defw	zbran-0ah		
xloop:					
	defw	$+2			
	ld	hl,(rpp)		; (hl) --> index = r1
	;incw	(hl)			;/ index += 1
	DEFB	0DDH
	inc	BC
	;ldw	de,(hl)			;/ de <-- new index
	DEFB	0EDh,16h
	inc	hl			;/
	inc	hl			;/ hl --> limit(lb)
	ld	a,e			
	sub	(hl)			
	ld	a,d			
	inc	hl			; hl --> limit(hb)
	sbc	a,(hl)			; index < limit?
	jp	m,bran1			; yes, loop again
	inc	hl			; no, done
	ld	(rpp),hl		; discard r1 & r2
	inc	bc			
	inc	bc			; skip branch offset
	jnext				
;
;
	defb	87h			; (+LOOP)
	defc	'(+LOOP)'		
	defw	xloop-9			
xploo:					
	defw	$+2			
	pop	de			; de <-- increment
	ld	hl,(rpp)		; hl --> index
	ld	a,(hl)			; index += increment
	add	a,e			
	ld	(hl),a			
	ld	e,a			
	inc	hl			
	ld	a,(hl)			
	adc	a,d			
	ld	(hl),a			
	inc	hl			; (hl) --> limit
	inc	d			
	dec	d			
	ld	d,a			; de <-- new index
	jp	m,xloo2			; if incr > 0
	ld	a,e			
	sub	(hl)			; then a <-- index - limit
	ld	a,d			
	inc	hl			
	sbc	a,(hl)			
	jp	xloo3			

xloo2:					
	ld	a,(hl)			; else  a <-- limit - index
	sub	e			
	inc	hl			
	ld	a,(hl)			
	sbc	a,d			
;					; if a < 0
xloo3:					
	jp	m,bran1			; then loop again
	inc	hl			; else done
	ld	(rpp),hl		; discard r1 & r2
	inc	bc			; skip branch offset
	inc	bc			
	jnext				
;
;
	defb	84h			;  (DO)
	defc	'(DO)'			
	defw	xploo-0ah		
xdo:					
	defw	$+2			
	pop	de			;  de <-- initial index
	ld	hl,(rpp)		;  hl <-- rp
	dec	hl			
	dec	hl			
	;pop	(hl)			;/ r2 <-- limit
	DEFB	0DDH
	pop	BC
	dec	hl			
	dec	hl			
	;ldw	(hl),de			;/ r1 <-- initial index
	DEFB	0EDh,1Eh
	ld	(rpp),hl		;  rp -= 4
	jnext				
;
;
	defb	81h			; I
	defc	'I'			
	defw	xdo-7			
ido:					
	defw	$+2			
	ld	hl,(rpp)		
	;push	(hl)			;/ s1 <-- r1, r1 unchanged
	DEFB	0DDH
	push	BC
	jnext				
;
;
	defb	85h			; DIGIT
	defc	'DIGIT'			
	defw	ido-4			
digit:					
	defw	$+2			
	pop	hl			; l <-- s1.lb = base value
	pop	de			; e <-- s2.lb = chr to be converted
	ld	a,e			; a <-- chr
	sub	'0'			; >= 0?
	jr	c,digi2			;/ < 0 is invalid
	cp	0ah			; > 9?
	jr	c,digi1			;/ no, test base value
	sub	07h			; gap between '9' & 'A', nw 'A'=0ah
	cp	0ah			; >= 'A'?
	jr	c,digi2			;/ chrs btwn '9' & 'A' are invalid
digi1:					
	cp	l			; < base value?
	jr	nc,digi2		;/ no, invalid
	ld	e,a			; s2 <-- de = converted digit
	ld	hl,0001h		; s1 <-- true
	jp	dpush			
;
digi2:					
	ld	l,h			; hl <-- false
	jhpush				; s1 <-- false
;
;
	defb	86h			; (FIND) (2-1)FAILURE
	defc	'(FIND)'		;        (2-3)SUCCESS
	defw	digit-8			
pfind:					
	defw	$+2			
	pop	de			; de <-- nfa
pfin1:					
	pop	hl			; hl <-- string addr
	push	hl			; save for next iteration
	ld	a,(de)			
	xor	(hl)			; filter differences
	and	3fh			; mask msb & precedence bit
	jr	nz,pfin4		; lengths differ
pfin2:					
	inc	hl			; hl --> next string chr
	inc	de			; de --> next name field chr
	ld	a,(de)			
	xor	(hl)			; filter differences
	add	a,a			; shift msbit into carry
	jr	nz,pfin3		; no match
	jr	nc,pfin2		; match so far, loop agn
	ld	hl,0005h		; string matches
	add	hl,de			; (sp) <-- pfa
	ex	(sp),hl			
pfin6:					
	dec	de			; de --> nfa
	ld	a,(de)			
	or	a			; msb=1? =length byte
	jp	p,pfin6			; no, try next chr
	ld	e,a			; e <-- length byte
	ld	d,00h			
	ld	hl,0001h		; hl <-- true
	jp	dpush			; name field found, return
;
; above name field not a match, try next one
;
pfin3:					
	jr	c,pfin5			; carry=end of name field
pfin4:					
	inc	de			; find name field end
	ld	a,(de)			
	or	a			; msb=1?
	jp	p,pfin4			; no, loop
pfin5:					
	inc	de			; de <-- lfa
	ex	de,hl			
	;ldw	de,(hl)			;/ de <-- lfa
	DEFB	0EDh,16h
	ld	a,d			
	or	e			; end of dictionary (lfa = 0)?
	jr	nz,pfin1		; no, try previous definition
	pop	hl			; drop string address
	ld	hl,0			; hl <-- false
	jhpush				; no match found, return
;
;
	defb	87h			; ENCLOSE
	defc	'ENCLOSE'		
	defw	pfind-9			
encl:					
	defw	$+2			
	pop	de			; de <-- s1 = delimiter chr
	pop	hl			; hl <-- s2 = addr of text to scan
	push	hl			; s4 <-- addr
	ld	a,e			
	ld	d,a			; d <-- delim chr
	ld	e,-1			; init chr offset counter
	dec	hl			; hl <-- addr - 1
encl1:					
	inc	hl			; skip over leading delim chrs
	inc	e			
	cp	(hl)			; delim chr?
	jr	z,encl1			; yes, loop
	ld	d,0			
	push	de			; s3 <-- e = offset to 1st non delim
	ld	d,a			; d <-- delim chr
	ld	a,(hl)			
	and	a			; 1st non-delim=null?
	jr	nz,encl2		; no
	ld	d,0			; yes
	inc	e			
	push	de			; s2 <-- offset to byte following null
	dec	e			
	push	de			; s1 <-- offset to null
	jnext				
;
encl2:					
	ld	a,d			; A <-- delim chr
	inc	hl			; hl <-- next chr's address
	inc	e			; e <-- offset to next chr
	cp	(hl)			; delim chr?
	jr	z,encl4			; yes
	ld	a,(hl)			
	and	a			; null?
	jr	nz,encl2		; no, continue scan
encl3:					
	ld	d,0			
	push	de			; s2 <-- offset to null
	push	de			; s1 <-- offset to null
	jnext				
;
encl4:					
	ld	d,0			
	push	de			; s2 <-- offset to byte following text
	inc	e			
	push	de			; s1 <-- offset 2 bytes aft end of word
	jnext				
;
;
	defb	84h			; EMIT
	defc	'EMIT'			
	defw	encl-0ah		
emit:					
	defw	docol			
	defw	pemit			
	defw	one,outt		
	defw	pstor,semis		
;
;
	defb	83h			; KEY
	defc	'KEY'			
	defw	emit-7			
key:					
	defw	$+2			
	jp	pkey			
;
;
	defb	89h			; ?TERMINAL
	defc	'?TERMINAL'		
	defw	key-6			
qterm:					
	defw	$+2			
	ld	hl,0			
	jp	pqter			
;
;
	defb	82h			; CR
	defc	'CR'			
	defw	qterm-0ch		
cr:					
	defw	$+2			
	jp	pcr			
;
;
	defb	85h			; CMOVE
	defc	'CMOVE'			
	defw	cr-5			
cmove:					
	defw	$+2			
	exx				;/ save ip
	pop	bc			;  bc <-- s1 = # of chrs
	pop	de			;  de <-- s2 = dest addr
	pop	hl			;/ hl <-- s3 = source addr
	ld	a,b			
	or	c			;  bc=0?
	jr	z,cmove1		;  yes, nothing to move
	ldir				;/ xfer string
cmove1:					
	exx				;/ restore ip
	jnext				
;
;
	defb	86h			;/   -CMOVE    ( from to count --- )
	defc	'-CMOVE'		
	defw	cmove-8			
bcmov:					
	defw	$+2			
	exx				; save ip
	pop	bc			; bc <-- count
	pop	de			; de <-- destination
	pop	hl			; hl <-- source
	ld	a,b			
	or	c			; bc =0?
	jr	z,bcmov1		; yes, nothing to move
	add	hl,bc			
	dec	hl			; hl --> hi end of source block
	ex	de,hl			
	add	hl,bc			
	dec	hl			
	ex	de,hl			; de --> hi end of dest. block
	lddr				; (de) <-- (hl), --hl,bc until bc=0
bcmov1:					
	exx				; restore ip
	jnext				
;
;
	defb	82h			; U*   16*16 unsigned multiply
	defc	'U*'			;      with 32 bit result
	defw	bcmov-9			
ustar:					
	defw	$+2			
	pop	de			; de <-- multiplier
	pop	hl			; hl <-- multiplicant
	;multuw	hl,de			;/
	DEFB	0EDH,0D3h
	ex	de,hl			;/ de <-- product.lw, hl <-- product.hw
	jp	dpush			; s2,s1 <-- product.lw,hw
;
;
	defb	82h			; U/   ( ud u1 -- urem uq )
	defc	'U/'			
	defw	ustar-5			
uslas:					
	defw	$+2			
	exx				;/ save ip
	pop	bc			; bc <-- divisor
	pop	hl			; hl <-- dividend.hw
	pop	de			; de <-- dividend.lw
	;cpw	hl,bc			;/ dividend.hw >= divisor?
	DEFB	0EDH,0C7h
	jr	c,usla1			; no, go ahead
	ld	hl,0ffffh		; yes, overflow
	ld	d,h			
	ld	e,l			;/ set rem & quot to max
	jr	usla2			
usla1:					
	ex	de,hl			;/ de,hl <-- dividend.hw,lw
	;divuw	dehl,bc			;/ de <-- remainder, hl <-- quotient
	DEFB	0EDH,0CBh
usla2:					
	push	de			;/ s2 <-- remainder
	push	hl			;/ s1 <-- quotient
	exx				;/ restore ip
	jnext				
;
;
	defb	83h			; AND
	defc	'AND'			
	defw	uslas-5			
andd:					
	defw	$+2			; s1 <-- s1 AND s2
	pop	de			
	pop	hl			
	ld	a,e			
	and	l			
	ld	l,a			
	ld	a,d			
	and	h			
	ld	h,a			
	jhpush				
;
;
	defb	82h			; OR
	defc	'OR'			
	defw	andd-6			
orr:					
	defw	$+2			; s1 <-- s1 OR s2
	pop	de			
	pop	hl			
	ld	a,e			
	or	l			
	ld	l,a			
	ld	a,d			
	or	h			
	ld	h,a			
	jhpush				
;
;
	defb	83h			; XOR
	defc	'XOR'			
	defw	orr-5			
xorr:					
	defw	$+2			; s1 <-- s1 XOR s2
	pop	de			
	pop	hl			
	ld	a,e			
	xor	l			
	ld	l,a			
	ld	a,d			
	xor	h			
	ld	h,a			
	jhpush				
;
;
	defb	83h			; SP@
	defc	'SP@'			
	defw	xorr-6			
spat:					
	defw	$+2			
	ld	hl,0			
	add	hl,sp			; hl <-- sp
	jhpush				; s1 <-- sp
;
;
	defb	83h			; SP!
	defc	'SP!'			
	defw	spat-6			
spsto:					
	defw	$+2			; sp <-- s0  (user variable)
	ld	hl,(up)			; hl <-- user variables base address
	ld	de,6			
	add	hl,de			; hl --> s0
	;ldw	sp,(hl)			;/ sp <-- s0
	DEFB	0EDh,36h
	jnext				
;
;
	defb	83h			; RP@
	defc	'RP@'			
	defw	spsto-6			
rpat:					
	defw	$+2			
	ld	hl,(rpp)		
	jhpush				; s1 <-- rp
;
;
	defb	83h			; RP!
	defc	'RP!'			
	defw	rpat-6			
rpsto:					
	defw	$+2			; rp <-- r0 (user variable)
	ld	hl,(up)			; hl <-- user variables base address
	ld	de,0008h		
	add	hl,de			; hl --> r0
	;ldw	hl,(hl)			;/ hl <-- r0
	DEFB	0EDh,26h
	ld	(rpp),hl		;/ rp <-- r0
	jnext				
;
;
	defb	82h			; ;S
	defc	';S' 
	defw	rpsto-6 
semis:					
	defw	$+2			; ip <-- r1 
	ld	hl,(rpp)		
	;ldw	bc,(hl)			;/ bc <-- r1
	DEFB	0EDh,06h
	inc	hl			
	inc	hl			
	ld	(rpp),hl		; rp += 2
	jnext				
;
;
	defb	85h			; LEAVE
	defc	'LEAVE'			
	defw	semis-5			
leave:					
	defw	$+2			; limit <-- index
	ld	hl,(rpp)		
	;ldw	de,(hl)			;/ de <-- r1 (= index)
	DEFB	0EDh,16h
	inc	hl			
	inc	hl			
	;ldw	(hl),de			;/ r2 (= limit) <-- index
	DEFB	0EDh,1Eh
	jnext				
;
;
	defb	82h			; >R
	defc	'>R'			
	defw	leave-8			
tor:					
	defw	$+2			
	ld	hl,(rpp)		
	dec	hl			
	dec	hl			
	;pop	(hl)			;/ r1 <-- s1
	DEFB	0DDH
	pop	BC
	ld	(rpp),hl		;  rp -= 2
	jnext				
;
;
	defb	82h			; R>
	defc	'R>'			
	defw	tor-5			
fromr:					
	defw	$+2			
	ld	hl,(rpp)		
	;push	(hl)			;/ s1 <-- r1
	DEFB	0DDH
	push	BC
	inc	hl			
	inc	hl			
	ld	(rpp),hl		; rp += 2
	jnext				
;
;
	defb	81h			; R
	defc	'R'			
	defw	fromr-5			
rr:					
	defw	ido+2			
;
;
	defb	82h			; 0=
	defc	'0='			
	defw	rr-4			
zequ:					
	defw	$+2			
	pop	de			
	ld	hl,0			
	;cpw	hl,de			;/
	DEFB	0EDH,0D7h
	jr	nz,zequ1		
	inc	l			; hl <-- true
zequ1:					
	jhpush				
;
;
	defb	83h			;/ 0<>
	defc	'0<>'			
	defw	zequ-5			
znequ:					
	defw	$+2			
	pop	de			
	ld	hl,0			
	;cpw	hl,de			;/
	DEFB	0EDH,0D7h
	jr	z,znequ1		
	inc	l			; hl <-- true
znequ1:					
	jhpush				
;
;
	defb	82h			; 0<
	defc	'0<'			
	defw	znequ-6			
zless:					
	defw	$+2			
	pop	af			;/ a <-- s1.hb
	rla				;/ carry <-- bit 7
	ld	hl,0			;  hl <-- false
	rl	l			;/ bit 0 <-- carry
	jhpush				
;
;
	defb	82h			;/ 0>
	defc	'0>'			
	defw	zless-5			
zgt:					
	defw	$+2			
	pop	de			
	ld	hl,0			
	;cpw	hl,de			;/
	DEFB	0EDH,0D7h
	jp	p,zgt1			;/ <= 0
	jp	pe,zgt1			;/ 8000h special case
	inc	l			;/ hl <-- true
zgt1:					
	jhpush				
;
;
	defb	81h		;+
	defc	'+'		
	defw	zgt-5		
plus:					
	defw	$+2		
	pop	de		
	pop	hl		
	add	hl,de		
	jhpush			
;
;
	defb	82h			; D+ ( d1l d1h d2l d2h -- d3l d3h)
	defc	'D+'			
	defw	plus-4			
dplus:					
	defw	$+2			
	exx				;/ save ip
	pop	bc			;  bc <-- d2.hw
	pop	hl			;  hl <-- d2.lw
	pop	af			;d af <-- d1.hw
	pop	de			;  de <-- d1.lw
	push	af			;/ s1 <-- d1.hw
	add	hl,de			;  hl <-- d2.lw + d1.lw (= d3.lw)
	ex	de,hl			;  de <-- d3.lw
	pop	hl			;  hl <-- d1.hw
	adc	hl,bc			;/ hl <-- d1.hw + d2.hw +carry (=d3.hw)
	push	de			;  s2 <-- d3.lw
	push	hl			;/ s1 <-- d3.hw
	exx				;/ restore ip
	jnext				
;
;
	defb	85h			; MINUS
	defc	'MINUS'			
	defw	dplus-5			
minus:					
	defw	$+2			
	pop	hl			;/
	;neg	hl			;/
	DEFB	0EDH,4Ch
	jhpush				
;
;
	defb	86h			; DMINUS
	defc	'DMINUS'		
	defw	minus-8			
dminu:					
	defw	$+2			
	exx				;/ save ip
	pop	de			;/ de <-- d1.hw
	pop	bc			;/ bc <-- d1.lw
	ld	hl,0			;/
	;subw	hl,bc			;/
	DEFB	0EDH,0CEh
	push	hl			; s2 <-- d2.lw
	ld	hl,0			;/
	sbc	hl,de			;/
	push	hl			; s1 <-- d2.hw
	exx				;/
	jnext				
;
;
	defb	84h			; OVER
	defc	'OVER'			
	defw	dminu-9			
over:					
	defw	$+2			
	;ldw	hl,(sp+2)		;/
	DEFB	0EDh,04h
	DEFW	+2
	jhpush				;/
;
;
	defb	84h			; DROP
	defc	'DROP'			
	defw	over-7			
drop:					
	defw	$+2			
	inc	sp			
	inc	sp			;/ faster on z280 than dummy pop
	jnext				
;
;
	defb	84h			; SWAP
	defc	'SWAP'			
	defw	drop-7			
swap:					
	defw	$+2			
	pop	hl			
	ex	(sp),hl			
	jhpush				
;
;
	defb	83h			; DUP
	defc	'DUP'			
	defw	swap-7			
dup:					
	defw	$+2			
	;ldw	hl,(sp+0)		;/
	DEFB	0EDh,04h
	DEFW	+0
	jhpush				
;
;
	defb	84h			;/ TUCK     ( n1 n2 --- n2 n1 n2)
	defc	'TUCK'			
	defw	dup-6			
tuck:					
	defw	$+2			
	pop	hl			;/ hl <-- s1
	pop	de			;/ de <-- s2
	push	hl			;/ s3 <-- hl
	jp	dpush			
;
;
	defb	83h			;/ NIP      ( n1 n2 --- n2)
	defc	'NIP'			
	defw	tuck-7			
nip:					
	defw	$+2			
	pop	hl			; hl <-- s1
	;ldw	(sp+0),hl		;/ s1 <-- hl
	DEFB	0EDh,05h
	DEFW	+0
	jnext				
;
;
	defb	84h			;/ -ROT     ( n1 n2 n3 --- n3 n1 n2)
	defc	'-ROT'			
	defw	nip-6			
mrot:					
	defw	$+2			
	pop	hl			
	pop	de			
	ex	(sp),hl			
	ex	de,hl			
	jp	dpush			
;
;
	defb	85h			;/ CSWAP   ( n1 --- n1, bytes swapped)
	defc	'CSWAP'			
	defw	mrot-7			
cswap:					
	defw	$+2			
	pop	hl			
	;ex	h,l			;/
	DEFB	0EDH,0EFh
	jhpush				
;
;
	defb	84h			;/ PICK   ( nn...n0 k --- nn..n0 nk)
	defc	'PICK'			
	defw	cswap-8			
pick:					
	defw	$+2			
	pop	hl			; hl <-- depth
	add	hl,hl			; adjust to word size
	add	hl,sp			; offset into stack
	;push	(hl)			;/
	DEFB	0DDH
	push	BC
	jnext				
;
;
	defb	84h			; 2DUP
	defc	'2DUP'			
	defw	pick-7			
tdup:					
	defw	$+2			
	pop	hl			
	pop	de			
	push	de			
	push	hl			
	jp	dpush			
;
;
	defb	82h			; +!
	defc	'+!'			
	defw	tdup-7			
pstor:					
	defw	$+2			
	pop	hl			; hl --> variable
	pop	de			; de <-- number
	ld	a,(hl)			
	add	a,e			
	ld	(hl),a			
	inc	hl			
	ld	a,(hl)			
	adc	a,d			
	ld	(hl),a			; (hl) += number
	jnext				
;
;
	defb	86h			; TOGGLE
	defc	'TOGGLE'		
	defw	pstor-5			
toggl:					
	defw	$+2			
	pop	de			; e <-- bit pattern
	pop	hl			; hl --> address
	ld	a,(hl)			
	xor	e			
	ld	(hl),a			
	jnext				
;
;
	defb	81h			; @
	defc	'@'			
	defw	toggl-9			
at:					
	defw	$+2			
	pop	hl			
	;push	(hl)			;/
	DEFB	0DDH
	push	BC
	jnext				
;
;
	defb	82h			; C@
	defc	'C@'			
	defw	at-4			
cat:					
	defw	$+2			
	pop	hl			
	ld	l,(hl)			
	ld	h,0			
	jhpush				
;
;
	defb	82h			; 2@
	defc	'2@'			
	defw	cat-5			
tat:					
	defw	$+2			
	pop	hl			;  hl --> address
	;ldw	de,(hl)			;/ de <-- d.hw
	DEFB	0EDh,16h
	inc	hl			
	inc	hl			;  hl --> d.lw
	;push	(hl)			;/ s2 <-- d.lw
	DEFB	0DDH
	push	BC
	push	de			;/ s1 <-- d.hw
	jnext				
;
;
	defb	81h			; !
	defc	'!'			
	defw	tat-5			
store:					
	defw	$+2			
	pop	hl			; hl --> address
	;pop	(hl)			;/
	DEFB	0DDH
	pop	BC
	jnext				
;
;
	defb	82h			; C!
	defc	'C!'			
	defw	store-4			
cstor:					
	defw	$+2			
	pop	hl			; hl --> address
	pop	de			; e <-- char
	ld	(hl),e			
	jnext				
;
;
	defb	82h			; 2!
	defc	'2!'			
	defw	cstor-5			
tstor:					
	defw	$+2			
	pop	hl			; hl --> address
	;pop	(hl)			;/ store d.hw
	DEFB	0DDH
	pop	BC
	inc	hl			
	inc	hl			
	;pop	(hl)			;/ store d.lw
	DEFB	0DDH
	pop	BC
	jnext				
;
;
	defb	0c1h			; :
	defc	':'			
	defw	tstor-5			
colon:					
	defw	docol			
	defw	qexec			
	defw	scsp			
	defw	curr			
	defw	at			
	defw	cont			
	defw	store			
	defw	creat			
	defw	rbrac			
	defw	pscod			
docol:					
	ld	hl,(rpp)		
	dec	hl			
	dec	hl			
	;ldw	(hl),bc			;/ save return address
	DEFB	0EDh,0Eh
	ld	(rpp),hl		
	inc	de			
	ld	c,e			
	ld	b,d			
	jnext				
;
;
	defb	0c1h			; ;
	defc	';' 
	defw	colon-4 
semi:					
	defw	docol 
	defw	qcsp 
	defw	comp 
	defw	semis 
	defw	smudg 
	defw	lbrac 
	defw	semis 
;
;
	defb	84h			; NOOP
	defc	'NOOP'			
	defw	semi-4			
noop:					
	defw	docol			
	defw	semis			
;
;
	defb	88h			; CONSTANT
	defc	'CONSTANT'		
	defw	noop-7			
con:					
	defw	docol			
	defw	creat			
	defw	smudg			
	defw	comma			
	defw	pscod			
docon:					
	inc	de			
	ex	de,hl			
	;push	(hl)			;/
	DEFB	0DDH
	push	BC
	jnext				
;
;
	defb	88h			; VARIABLE
	defc	'VARIABLE'		
	defw	con-0bh			
var:					
	defw	docol			
	defw	con			
	defw	pscod			
dovar:					
	inc	de			
	push	de			
	jnext				
;
;
	defb	84h			; USER
	defc	'USER'			
	defw	var-0bh			
user:					
	defw	docol			
	defw	con			
	defw	pscod			
douse:					
	inc	de			
	ex	de,hl			
	ld	l,(hl)			;/
	ld	h,0			;/
	;addw	hl,(up)			;/
	DEFB	0DDH
	DEFB	0EDH,0D6h
	DEFW	UP
	jhpush				
;
;
	defb	81h			; 0
	defc	'0'			
	defw	user-7			
zero:					
	defw	$+2			;/
	;push	0000h			;/
	DEFB	0FDH
	push	AF
	DEFW	0000H                                   
	jnext				
;
;
	defb	81h			; 1
	defc	'1'			
	defw	zero-4			
one:					
	defw	$+2			;/
	;push	0001h			;/
	DEFB	0FDH
	push	AF
	DEFW	0001H                                   
	jnext				
;
;
	defb	81h			; 2
	defc	'2'			
	defw	one-4			
two:					
	defw	$+2			;/
	;push	0002h			;/
	DEFB	0FDH
	push	AF
	DEFW	0002H                                   
	jnext				
;
;
	defb	81h			; 3
	defc	'3'			
	defw	two-4			
three:					
	defw	$+2			;/
	;push	0003h			;/
	DEFB	0FDH
	push	AF
	DEFW	0003H                                   
	jnext				
;
;
	defb	82h			; BL
	defc	'BL'			
	defw	three-4			
bl:					
	defw	docon			
	defw	20h			
;
;
	defb	83h			; C/L
	defc	'C/L'			
	defw	bl-5			
csll:					
	defw	docon			
	defw	64			
;
;
	defb	85h			; FIRST
	defc	'FIRST'			
	defw	csll-6			
first:					
	defw	docon			
	defw	0			;/ set by CLD
;
;
	defb	85h			; LIMIT
	defc	'LIMIT'			
	defw	first-8			
limit:					
	defw	docon			
	defw	0			;/ set by CLD
;
;
	defb	85h			; B/BUF
	defc	'B/BUF'			
	defw	limit-8			
bbuf:					
	defw	docon			
	defw	kbbuf			
;
;
	defb	85h			; B/SCR
	defc	'B/SCR'			
	defw	bbuf-8			
bscr:					
	defw	docon			
	defw	400h/kbbuf		
;
;
	defb	87h			; +ORIGIN
	defc	'+ORIGIN'		
	defw	bscr-8			
porig:					
	defw	docol			
	defw	lit			
	defw	orig			
	defw	plus			
	defw	semis			
;
;	USER VARIABLES
;
	defb	82h			; S0
	defc	'S0'			
	defw	porig-0ah		
szero:					
	defw	douse			
	defw	6			
;
;
	defb	82h			; R0
	defc	'R0'			
	defw	szero-5			
rzero:					
	defw	douse			
	defw	8			
;
;
	defb	83h			; TIB
	defc	'TIB'			
	defw	rzero-5			
tib:					
	defw	douse			
	defb	0ah			
;
;
	defb	85h			; WIDTH
	defc	'WIDTH'			
	defw	tib-6			
width:					
	defw	douse			
	defb	0ch			
;
;
	defb	87h			; WARNING
	defc	'WARNING'		
	defw	width-8			
warn:					
	defw	douse			
	defb	0eh			
;
;
	defb	85h			; FENCE
	defc	'FENCE'			
	defw	warn-0ah		
fence:					
	defw	douse			
	defb	10h			
;
;
	defb	82h			; DP
	defc	'DP'			
	defw	fence-8			
dp:					
	defw	douse			
	defb	12h			
;
;
	defb	88h			; VOC-LINK
	defc	'VOC-LINK'		
	defw	dp-5			
vocl:					
	defw	douse			
	defw	14h			
;
;
	defb	83h			; BLK
	defc	'BLK'			
	defw	vocl-0bh		
blk:					
	defw	douse			
	defb	16h			
;
;
	defb	82h			; IN
	defc	'IN'			
	defw	blk-6			
inn:					
	defw	douse			
	defb	18h			
;
;
	defb	83h			; OUT
	defc	'OUT'			
	defw	inn-5			
outt:					
	defw	douse			
	defb	1ah			
;
;
	defb	83h			; SCR
	defc	'SCR'			
	defw	outt-6			
scr:					
	defw	douse			
	defb	1ch			
;
;
	defb	86h			; OFFSET
	defc	'OFFSET'		
	defw	scr-6			
ofset:					
	defw	douse			
	defb	1eh			
;
;
	defb	87h			; CONTEXT
	defc	'CONTEXT'		
	defw	ofset-9			
cont:					
	defw	douse			
	defb	20h			
;
;
	defb	87h			; CURRENT
	defc	'CURRENT'		
	defw	cont-0ah		
curr:					
	defw	douse			
	defb	22h			
;
;
	defb	85h			; STATE
	defc	'STATE'			
	defw	curr-0ah		
state:					
	defw	douse			
	defb	24h			
;
;
	defb	84h			; BASE
	defc	'BASE'			
	defw	state-8			
base:					
	defw	douse			
	defb	26h			
;
;
	defb	83h			; DPL
	defc	'DPL'			
	defw	base-7			
dpl:					
	defw	douse			
	defb	28h			
;
;
	defb	83h			; FLD
	defc	'FLD'			
	defw	dpl-6			
fld:					
	defw	douse			
	defb	2ah			
;
;
	defb	83h			; CSP
	defc	'CSP'			
	defw	fld-6			
cspp:					
	defw	douse			
	defb	2ch			
;

	defb	82h			; R#
	defc	'R#'			
	defw	cspp-6			
rnum:					
	defw	douse			
	defb	2eh			
;

	defb	83h			; HLD
	defc	'HLD'			
	defw	rnum-5			
hld:					
	defw	douse			
	defw	30h			
;
;	END OF USER VARIABLES
;
	defb	82h			; 1+
	defc	'1+'			
	defw	hld-6			
onep:					
	defw	$+2			;/
	pop	hl			;/
	inc	hl			;/
	jhpush				;/
;
;
	defb	82h			; 2+
	defc	'2+'			
	defw	onep-5			
twop:					
	defw	$+2			;/
	pop	hl			;/
	inc	hl			;/
	inc	hl			;/
	jhpush				;/
;
;
	defb	82h			;/ 1-
	defc	'1-'			;/
	defw	twop-5			;/
onemin:					
	defw	$+2			;/
	pop	hl			;/
	dec	hl			;/
	jhpush				;/
;
;
	defb	82h			;/ 2-
	defc	'2-'			;/
	defw	onemin-5		;/
twomin:					
	defw	$+2			;/
	pop	hl			;/
	dec	hl			;/
	dec	hl			;/
	jhpush				;/
;
;
	defb	82h			;/ 2*
	defc	'2*'			;/
	defw	twomin-5		;/
twosta:					
	defw	$+2			;/
	pop	hl			;/
	add	hl,hl			;/ asl hl
	jhpush				;/
;
;
	defb	82h			;/ 2/
	defc	'2/'			;/
	defw	twosta-5		;/
twosla:					
	defw	$+2			;/
	pop	hl			;/
	bit	7,h			;/ negative?
	jr	z,twosl1		;/ no
	inc	hl			;/ yes, add 1
twosl1:					
	sra	h			;/
	rr	l			;/ asr hl
	jhpush				;/
;
;
	defb	84h			; HERE
	defc	'HERE'			
	defw	twosla-5		
here:					
	defw	docol			
	defw	dp			
	defw	at			
	defw	semis			
;
;
	defb	85h			; ALLOT
	defc	'ALLOT'			
	defw	here-7			
allot:					
	defw	docol			
	defw	dp			
	defw	pstor			
	defw	semis			
;
;
	defb	81h			; ,
	defc	','			
	defw	allot-8			
comma:					
	defw	docol			
	defw	here			
	defw	store			
	defw	two			
	defw	allot			
	defw	semis			
;

	defb	82h			; C,
	defc	'C,'			
	defw	comma-4			
ccomm:					
	defw	docol			
	defw	here			
	defw	cstor			
	defw	one			
	defw	allot			
	defw	semis			
;
;
	defb	81h			; -
	defc	'-'			
	defw	ccomm-5			
subb:					
	defw	$+2			
	pop	de			
	pop	hl			
	;subw	hl,de			;/
	DEFB	0EDH,0DEh
	jhpush				
;
;
	defb	81h			; =
	defc	'='			
	defw	subb-4			
equal:					
	defw	$+2			;/
	pop	de			;/
	pop	hl			;/
	;subw	hl,de			;/
	DEFB	0EDH,0DEh
	ld	hl,0			;  hl <-- false
	jr	nz,equal1		
	inc	l			;/ hl <-- true
equal1:					
	jhpush				
;
;
	defb	81h			;  <
	defc	'<'			
	defw	equal-4			
less:					
	defw	$+2			
	pop	de			
	pop	hl			; hl de <
	ld	a,d			
	xor	h			; one operand negative?
	jp	m,less1			; yes, determine which
	;subw	hl,de			;/
	DEFB	0EDH,0DEh
less1:					
	bit	7,h			;/ h negative?
	ld	hl,0			; hl <-- false
	jr	z,less2			
	inc	l			;/ hl <-- true
less2:					
	jhpush				
;
;
	defb	82h			; U<
	defc	'U<'			
	defw	less-4			
uless:					
	defw	$+2			
	pop	de			
	pop	hl			;/ hl de U<
	;subw	hl,de			;/
	DEFB	0EDH,0DEh
	ld	hl,0			; hl <-- false
	rl	l			;/ bit 0 <-- carry
uless1:					
	jhpush				
;
;
	defb	81h			; >
	defc	'>'			
	defw	uless-5			
great:					
	defw	$+2			
	pop	hl			;/
	pop	de			;/ hl de >    (= de hl < )
	ld	a,d			
	xor	h			; one operand negative?
	jp	m,great1		; yes, determine which
	;subw	hl,de			;/
	DEFB	0EDH,0DEh
great1:					
	bit	7,h			;/ h negative?
	ld	hl,0			; hl <-- false
	jr	z,great2		
	inc	l			;/ hl <-- true
great2:					
	jhpush				
;
;
	defb	83h			; ROT     ( n1 n2 n3 --- n2 n3 n1)
	defc	'ROT'			
	defw	great-4			
rot:					
	defw	$+2			
	pop	de			; de <-- n3
	pop	hl			; hl <-- n2
	ex	(sp),hl			; s1 <-- n2, hl <-- n1
	jp	dpush			; s2 <-- n3, s3 <-- n1
;
;
	defb	85h			; SPACE
	defc	'SPACE'			
	defw	rot-6			
space:					
	defw	docol			
	defw	bl			
	defw	emit			
	defw	semis			
;
;
	defb	84h			; -DUP
	defc	'-DUP'			
	defw	space-8			
ddup:					
	defw	$+2			;/
	;ldw	hl,(sp+0)		;/
	DEFB	0EDh,04h
	DEFW	+0
	ld	a,h			;/
	or	l			;/ hl = 0?
	jr	z,ddup1			;/ yes, don't dup
	push	hl			;/
ddup1:					
	jnext				
;
;
	defb	88h			; TRAVERSE
	defc	'TRAVERSE'		
	defw	ddup-7			
trav:					
	defw	docol			
	defw	swap			
trav1:					
	defw	over			; begin
	defw	plus			
	defw	lit			
	defw	7fh			
	defw	over			
	defw	cat			
	defw	less			
	defw	zbran			; until
	defw	trav1-$			
	defw	swap			
	defw	drop			
	defw	semis			
;
;
	defb	86h			; LATEST
	defc	'LATEST'		
	defw	trav-0bh		
lates:					
	defw	docol			
	defw	curr			
	defw	at			
	defw	at			
	defw	semis			
;
;
	defb	83h			; LFA
	defc	'LFA'			
	defw	lates-9			
lfa:					
	defw	$+2			
	pop	hl			;/ hl <-- pfa
	;subw	hl,4			;/
	DEFB	0FDH
	DEFB	0EDH,0FEh
	DEFW	4                                       
	jhpush				;/ s1 <-- lfa
;
;
	defb	83h			; CFA
	defc	'CFA'			
	defw	lfa-6			
cfa:					
	defw	docol			
	defw	twomin			;/
	defw	semis			
;
;
	defb	83h			; NFA
	defc	'NFA'			
	defw	cfa-6			
nfa:					
	defw	docol			
	defw	lit			
	defw	5			
	defw	subb			
	defw	lit			
	defw	-1			
	defw	trav			
	defw	semis			
;
;
	defb	83h			; PFA
	defc	'PFA'			
	defw	nfa-6			
pfa:					
	defw	docol			
	defw	one			
	defw	trav			
	defw	lit			
	defw	5			
	defw	plus			
	defw	semis			
;
;
	defb	84h			; !CSP
	defc	'!CSP'			
	defw	pfa-6			
scsp:					
	defw	docol			
	defw	spat			
	defw	cspp			
	defw	store			
	defw	semis			
;
;
	defb	86h			; ?ERROR
	defc	'?ERROR'		
	defw	scsp-7			
qerr:					
	defw	docol			
	defw	swap			
	defw	zbran			; if
	defw	qerr1-$			
	defw	error			
	defw	bran			; else
	defw	qerr2-$			
qerr1:					
	defw	drop			; endif
qerr2:					
	defw	semis			
;
;
	defb	85h			; ?COMP
	defc	'?COMP'			
	defw	qerr-9			
qcomp:					
	defw	docol			
	defw	state			
	defw	at			
	defw	zequ			
	defw	lit			
	defw	11h			
	defw	qerr			
	defw	semis			
;
;
	defb	85h			; ?EXEC
	defc	'?EXEC'			
	defw	qcomp-8			
qexec:					
	defw	docol			
	defw	state			
	defw	at			
	defw	lit			
	defw	12h			
	defw	qerr			
	defw	semis			
;
;
	defb	86h			; ?PAIRS
	defc	'?PAIRS'		
	defw	qexec-8			
qpair:					
	defw	docol			
	defw	subb			
	defw	lit			
	defw	13h			
	defw	qerr			
	defw	semis			
;
;
	defb	84h			; ?CSP
	defc	'?CSP'			
	defw	qpair-9			
qcsp:					
	defw	docol			
	defw	spat			
	defw	cspp			
	defw	at			
	defw	subb			
	defw	lit			
	defw	14h			
	defw	qerr			
	defw	semis			
;
;
	defb	88h			; ?LOADING
	defc	'?LOADING'		
	defw	qcsp-7			
qload:					
	defw	docol			
	defw	blk			
	defw	at			
	defw	zequ			
	defw	lit			
	defw	16h			
	defw	qerr			
	defw	semis			
;
;
	defb	87h			; COMPILE
	defc	'COMPILE'		
	defw	qload-0bh		
comp:					
	defw	docol			
	defw	qcomp			
	defw	fromr			
	defw	dup			
	defw	twop			
	defw	tor			
	defw	at			
	defw	comma			
	defw	semis			
;
;
	defb	0c1h			; [
	defc	'['			
	defw	comp-0ah		
lbrac:					
	defw	docol			
	defw	zero			
	defw	state			
	defw	store			
	defw	semis			
;
;
	defb	81h			; ]
	defc	']'			
	defw	lbrac-4			
rbrac:					
	defw	docol			
	defw	lit,0c0h		
	defw	state,store		
	defw	semis			
;
;
	defb	86h			; SMUDGE
	defc	'SMUDGE'		
	defw	rbrac-4			
smudg:					
	defw	docol			
	defw	lates			
	defw	lit			
	defw	20h			
	defw	toggl			
	defw	semis			
;
;
	defb	83h			; HEX
	defc	'HEX'			
	defw	smudg-9			
hex:					
	defw	docol			
	defw	lit			
	defw	10h			
	defw	base			
	defw	store			
	defw	semis			
;
;
	defb	87h			; DECIMAL
	defc	'DECIMAL'		
	defw	hex-6			
dec:					
	defw	docol			
	defw	lit			
	defw	0ah			
	defw	base			
	defw	store			
	defw	semis			
;
;
	defb	87h			; (;CODE)
	defc	'(;CODE)' 
	defw	dec-0ah 
pscod:					
	defw	docol 
	defw	fromr 
	defw	lates 
	defw	pfa 
	defw	cfa 
	defw	store 
	defw	semis 
;
;
	defb	0c5h			; ;CODE
	defc	';CODE' 
	defw	pscod-0ah 
semic:					
	defw	docol 
	defw	qcsp 
	defw	comp 
	defw	pscod 
	defw	lbrac 
semi1:					
	defw	noop			; assembler
	defw	semis			
;
;
	defb	87h			; <BUILDS
	defc	'<BUILDS'		
	defw	semic-8			
build:					
	defw	docol			
	defw	zero			
	defw	con			
	defw	semis			
;
;
	defb	85h			; DOES>
	defc	'DOES>'			
	defw	build-0ah		
does:					
	defw	docol			
	defw	fromr			
	defw	lates			
	defw	pfa			
	defw	store			
	defw	pscod			
dodoe:					
	ld	hl,(rpp)		
	dec	hl			
	dec	hl			
	;ldw	(hl),bc			;/
	DEFB	0EDh,0Eh
	ld	(rpp),hl		
	inc	de			
	ex	de,hl			
	;ldw	bc,(hl)			;/
	DEFB	0EDh,06h
	inc	hl			
	inc	hl			
	jhpush				
;
;
	defb	85h			; COUNT
	defc	'COUNT'			
	defw	does-8			
count:					
	defw	docol			
	defw	dup			
	defw	onep			
	defw	swap			
	defw	cat			
	defw	semis			
;
;
	defb	84h			; TYPE
	defc	'TYPE'			
	defw	count-8			
type:					
	defw	docol			
	defw	ddup			
	defw	zbran			; if
	defw	type1-$			
	defw	over			
	defw	plus			
	defw	swap			
	defw	xdo			; do
type2:					
	defw	ido			
	defw	cat			
	defw	emit			
	defw	xloop			; loop
	defw	type2-$			
	defw	bran			; else
	defw	type3-$			
type1:					
	defw	drop			; endif
type3:					
	defw	semis			
;
;
	defb	89h			; -TRAILING
	defc	'-TRAILING'		
	defw	type-7			
dtrai:					
	defw	docol			
	defw	dup			
	defw	zero			
	defw	xdo			; do
dtra1:					
	defw	tdup			;/
	defw	plus			
	defw	onemin			;/
	defw	cat			
	defw	bl			
	defw	subb			
	defw	zbran			; if
	defw	dtra2-$			
	defw	leave			
	defw	bran			; else
	defw	dtra3-$			
dtra2:					
	defw	onemin			;/
dtra3:					
	defw	xloop			; loop
	defw	dtra1-$			
	defw	semis			
;
;
	defb	84h			; (.")
	defc	'(.")'			
	defw	dtrai-0ch		
pdotq:					
	defw	docol			
	defw	rr			
	defw	count			
	defw	dup			
	defw	onep			
	defw	fromr			
	defw	plus			
	defw	tor			
	defw	type			
	defw	semis			
;
;
	defb	0c2h			; ."
	defc	'."'			
	defw	pdotq-7			
dotq:					
	defw	docol			
	defw	lit			
	defw	22h			
	defw	state			
	defw	at			
	defw	zbran			; if
	defw	dotq1-$			
	defw	comp			
	defw	pdotq			
	defw	word			
	defw	here			
	defw	cat			
	defw	onep			
	defw	allot			
	defw	bran			; else
	defw	dotq2-$			
dotq1:					
	defw	word			
	defw	here			
	defw	count			
	defw	type			; endif
dotq2:					
	defw	semis			
;
;
	defb	86h			; EXPECT
	defc	'EXPECT'		
	defw	dotq-5			
expec:					
	defw	docol			
	defw	over			
	defw	plus			
	defw	over			
	defw	xdo			; do
expe1:					
	defw	key			
	defw	dup			
	defw	lit			
	defw	0eh			
	defw	porig			
	defw	at			
	defw	equal			
	defw	zbran			; if
	defw	expe2-$			
	defw	drop			
	defw	dup			
	defw	ido			
	defw	equal			
	defw	dup			
	defw	fromr			
	defw	twomin			;/
	defw	plus			
	defw	tor			
	defw	zbran			; if
	defw	expe6-$			
	defw	lit			
	defw	bell			
	defw	bran			; else
	defw	expe7-$			
expe6:					
	defw	lit			
	defw	bsout			; endif
expe7:					
	defw	bran			; else
	defw	expe3-$			
expe2:					
	defw	dup			
	defw	lit			
	defw	acr			;/
	defw	equal			
	defw	zbran			; if
	defw	expe4-$			
	defw	leave			
	defw	drop			
	defw	bl			
	defw	zero			
	defw	bran			; else
	defw	expe5-$			
expe4:					
	defw	dup			; endif
expe5:					
	defw	ido			
	defw	cstor			
	defw	zero			
	defw	ido			
	defw	onep			
	defw	store			; endif
expe3:					
	defw	emit			
	defw	xloop			; loop
	defw	expe1-$			
	defw	drop			
	defw	semis			
;
;
	defb	85h			; QUERY
	defc	'QUERY'			
	defw	expec-9			
query:					
	defw	docol			
	defw	tib			
	defw	at			
	defw	lit			
	defw	50h			
	defw	expec			
	defw	zero			
	defw	inn			
	defw	store			
	defw	semis			
;
;
	defb	0c1h			; NULL
	defb	80h			
	defw	query-8			
null:					
	defw	docol			
	defw	blk			
	defw	at			
	defw	zbran			; if
	defw	null1-$			
	defw	one			
	defw	blk			
	defw	pstor			
	defw	zero			
	defw	inn			
	defw	store			
	defw	blk			
	defw	at			
	defw	bscr			
	defw	onemin			;/
	defw	andd			
	defw	zequ			
	defw	zbran			; if
	defw	null2-$			
	defw	qexec			
	defw	fromr			
	defw	drop			; endif
null2:					
	defw	bran			; else
	defw	null3-$			
null1:					
	defw	fromr			
	defw	drop			; endif
null3:					
	defw	semis			
;
	defb	84h			; FILL
	defc	'FILL'			
	defw	null-4			
fill:					
	defw	$+2			
	exx				;/ save ip
	pop	de			;/ e <-- byte
	pop	bc			;  bc <-- quantity
	pop	hl			;/ hl <-- address
fill1:					
	ld	a,b			
	or	c			;  qty == 0?
	jr	z,fill2			;  yes, nothing (more) to fill
	ld	(hl),e			;/ (hl) <-- byte
	inc	hl			;  inc pointer
	dec	bc			;  dec counter
	jp	fill1			;/
fill2:					
	exx				;/ restore ip
	jnext				
;
;
	defb	85h			; ERASE
	defc	'ERASE'			
	defw	fill-7			
erasee:					
	defw	docol			
	defw	zero			
	defw	fill			
	defw	semis			
;
;
	defb	86h			; BLANKS
	defc	'BLANKS'		
	defw	erasee-8		
blank:					
	defw	docol			
	defw	bl			
	defw	fill			
	defw	semis			
;
;
	defb	84h			; HOLD
	defc	'HOLD'			
	defw	blank-9			
hold:					
	defw	docol			
	defw	lit			
	defw	-1			
	defw	hld			
	defw	pstor			
	defw	hld			
	defw	at			
	defw	cstor			
	defw	semis			
;
;
	defb	83h			; PAD
	defc	'PAD'			
	defw	hold-7			
pad:					
	defw	docol			
	defw	here			
	defw	lit			
	defw	44h			
	defw	plus			
	defw	semis			
;
;
	defb	84h			; WORD
	defc	'WORD'			
	defw	pad-6			
word:					
	defw	docol			
	defw	blk			
	defw	at			
	defw	zbran			; if
	defw	word1-$			
	defw	blk			
	defw	at			
	defw	block			
	defw	bran			; else
	defw	word2-$			
word1:					
	defw	tib			
	defw	at			; endif
word2:					
	defw	inn			
	defw	at			
	defw	plus			
	defw	swap			
	defw	encl			
	defw	here			
	defw	lit			
	defw	22h			
	defw	blank			
	defw	inn			
	defw	pstor			
	defw	over			
	defw	subb			
	defw	tor			
	defw	rr			
	defw	here			
	defw	cstor			
	defw	plus			
	defw	here			
	defw	onep			
	defw	fromr			
	defw	cmove			
	defw	semis			
;
;
	defb	88h			; (NUMBER)
	defc	'(NUMBER)'		
	defw	word-7			
pnumb:					
	defw	docol			
pnum1:					
	defw	onep			; begin
	defw	dup			
	defw	tor			
	defw	cat			
	defw	base			
	defw	at			
	defw	digit			
	defw	zbran			; while
	defw	pnum2-$			
	defw	swap			
	defw	base			
	defw	at			
	defw	ustar			
	defw	drop			
	defw	rot			
	defw	base			
	defw	at			
	defw	ustar			
	defw	dplus			
	defw	dpl			
	defw	at			
	defw	onep			
	defw	zbran			; if
	defw	pnum3-$			
	defw	one			
	defw	dpl			
	defw	pstor			; endif
pnum3:					
	defw	fromr			
	defw	bran			; repeat
	defw	pnum1-$			
pnum2:					
	defw	fromr			
	defw	semis			
;
;
	defb	86h			; NUMBER
	defc	'NUMBER'		
	defw	pnumb-0bh		
numb:					
	defw	docol			
	defw	zero			
	defw	zero			
	defw	rot			
	defw	dup			
	defw	onep			
	defw	cat			
	defw	lit			
	defw	2dh			
	defw	equal			
	defw	dup			
	defw	tor			
	defw	plus			
	defw	lit			
	defw	-1			
numb1:					
	defw	dpl			; begin
	defw	store			
	defw	pnumb			
	defw	dup			
	defw	cat			
	defw	bl			
	defw	subb			
	defw	zbran			; while
	defw	numb2-$			
	defw	dup			
	defw	cat			
	defw	lit			
	defw	2eh			
	defw	subb			
	defw	zero			
	defw	qerr			
	defw	zero			
	defw	bran			; repeat
	defw	numb1-$			
numb2:					
	defw	drop			
	defw	fromr			
	defw	zbran			; if
	defw	numb3-$			
	defw	dminu			; endif
numb3:					
	defw	semis			
;
;
	defb	85h			; -FIND (0-3) SUCCESS
	defc	'-FIND'			;       (0-1) FAILURE
	defw	numb-9			
dfind:					
	defw	docol			
	defw	bl			
	defw	word			
	defw	here			
	defw	cont			
	defw	at			
	defw	at			
	defw	pfind			
	defw	dup			
	defw	zequ			
	defw	zbran			; if
	defw	dfin1-$			
	defw	drop			
	defw	here			
	defw	lates			
	defw	pfind			; endif
dfin1:					
	defw	semis			
;
;
	defb	87h			; (ABORT)
	defc	'(ABORT)'		
	defw	dfind-8			
pabor:					
	defw	docol			
	defw	abort			
	defw	semis			
;
	defb	85h			; ERROR
	defc	'ERROR'			
	defw	pabor-0ah		
error:					
	defw	docol			
	defw	warn			
	defw	at			
	defw	zless			
	defw	zbran			; if
	defw	erro1-$			
	defw	pabor			; endif
erro1:					
	defw	here			
	defw	count			
	defw	type			
	defw	pdotq			
	defb	2			
	db	'? '			
	defw	mess			
	defw	spsto			
;	CHANGE FROM fig MODEL
;	defw	inn,at,blk,at
	defw	blk,at			
	defw	ddup			
	defw	zbran,erro2-$		; if
	defw	inn,at			
	defw	swap			; endif
erro2:					
	defw	quit			
;
;
	defb	83h			; ID.
	defc	'ID.'			
	defw	error-8			
iddot:					
	defw	docol			
	defw	pad			
	defw	lit			
	defw	20h			
	defw	blank			;/
	defw	dup			
	defw	pfa			
	defw	lfa			
	defw	over			
	defw	subb			
	defw	dup			;/ change frm MODEL
	defw	tor			;/ to suppress BIT 7
	defw	pad			
	defw	swap			
	defw	cmove			
	defw	pad			
	defw	fromr			;/ for terminals
	defw	pad			;/ with an 8 bit
	defw	plus			;/ ASCII character set.
	defw	onemin			;/
	defw	dup			;/
	defw	at			;/
	defw	lit			;/
	defw	7fh			;/
	defw	andd			;/
	defw	swap			;/
	defw	store			;/
	defw	count			
	defw	lit			
	defw	1fh			;  WIDTH
	defw	andd			
	defw	type			
	defw	space			
	defw	semis			
;
	defb	86h			; CREATE
	defc	'CREATE'		
	defw	iddot-6			
creat:					
	defw	docol			
	defw	dfind			
	defw	zbran			; if
	defw	crea1-$			
	defw	drop			
	defw	nfa			
	defw	iddot			
	defw	lit			
	defw	4			
	defw	mess			
	defw	space			; endif
crea1:					
	defw	here			
	defw	dup			
	defw	cat			
	defw	width			
	defw	at			
	defw	min			
	defw	onep			
	defw	allot			
	defw	dup			
	defw	lit			
	defw	0a0h			
	defw	toggl			
	defw	here			
	defw	onemin			
	defw	lit			
	defw	80h			
	defw	toggl			
	defw	lates			
	defw	comma			
	defw	curr			
	defw	at			
	defw	store			
	defw	here			
	defw	twop			
	defw	comma			
	defw	semis			
;
;
	defb	0c9h			; [COMPILE]
	defc	'[COMPILE]'		
	defw	creat-9			
bcomp:					
	defw	docol			
	defw	dfind			
	defw	zequ			
	defw	zero			
	defw	qerr			
	defw	drop			
	defw	cfa			
	defw	comma			
	defw	semis			
;
;
	defb	0c7h			; LITERAL
	defc	'LITERAL'		
	defw	bcomp-0ch		
liter:					
	defw	docol			
	defw	state			
	defw	at			
	defw	zbran			; if
	defw	lite1-$			
	defw	comp			
	defw	lit			
	defw	comma			; endif
lite1:					
	defw	semis			
;
;
	defb	0c8h			; DLITERAL
	defc	'DLITERAL'		
	defw	liter-0ah		
dlite:					
	defw	docol			
	defw	state			
	defw	at			
	defw	zbran			; if
	defw	dlit1-$			
	defw	swap			
	defw	liter			
	defw	liter			; endif
dlit1:					
	defw	semis			
;
;
	defb	86h			; ?STACK
	defc	'?STACK'		
	defw	dlite-0bh		
qstac:					
	defw	docol			
	defw	spat			
	defw	szero			
	defw	at			
	defw	swap			
	defw	uless			
	defw	one			
	defw	qerr			
	defw	spat			
	defw	here			
	defw	lit			
	defw	80h			
	defw	plus			
	defw	uless			
	defw	lit			
	defw	7			
	defw	qerr			
	defw	semis			
;
;
	defb	89h			; INTERPRET
	defc	'INTERPRET'		
	defw	qstac-9			
inter:					
	defw	docol			
inte1:					
	defw	dfind			; begin
	defw	zbran			; if
	defw	inte2-$			
	defw	state			
	defw	at			
	defw	less			
	defw	zbran			; if
	defw	inte3-$			
	defw	cfa			
	defw	comma			
	defw	bran			; else
	defw	inte4-$			
inte3:					
	defw	cfa			
	defw	exec			; endif
inte4:					
	defw	qstac			
	defw	bran			; else
	defw	inte5-$			
inte2:					
	defw	here			
	defw	numb			
	defw	dpl			
	defw	at			
	defw	onep			
	defw	zbran			; if
	defw	inte6-$			
	defw	dlite			
	defw	bran			; else
	defw	inte7-$			
inte6:					
	defw	drop			
	defw	liter			; endif
inte7:					
	defw	qstac			; endif
inte5:					
	defw	bran			; again
	defw	inte1-$			
;
;
	defb	89h			; IMMEDIATE
	defc	'IMMEDIATE'		
	defw	inter-0ch		
immed:					
	defw	docol			
	defw	lates			
	defw	lit			
	defw	40h			
	defw	toggl			
	defw	semis			
;
;
	defb	8ah			; VOCABULARY
	defc	'VOCABULARY'		
	defw	immed-0ch		
vocab:					
	defw	docol			
	defw	build			
	defw	lit			
	defw	0a081h			
	defw	comma			
	defw	curr			
	defw	at			
	defw	cfa			
	defw	comma			
	defw	here			
	defw	vocl			
	defw	at			
	defw	comma			
	defw	vocl			
	defw	store			
	defw	does			
dovoc:					
	defw	twop			
	defw	cont			
	defw	store			
	defw	semis			
;
;
	defb	0c5h			; FORTH
	defc	'FORTH'			
	defw	vocab-0dh		
forth:					
	defw	dodoe			
	defw	dovoc			
	defw	0a081h			
	defw	task-7			; cold start value only
;					  changed aech time a def is appended
;					  to the FORTH vocabulary
	defw	0			; end of vocabulary list
;
;
	defb	8bh			; DEFINITIONS
	defc	'DEFINITIONS'		
	defw	forth-8			
defin:					
	defw	docol			
	defw	cont			
	defw	at			
	defw	curr			
	defw	store			
	defw	semis			
;
;
	defb	0c1h			; (
	defc	'('			
	defw	defin-0eh		
paren:					
	defw	docol			
	defw	lit			
	defw	29h			
	defw	word			
	defw	semis			
;
;
	defb	84h			; QUIT
	defc	'QUIT'			
	defw	paren-4			
quit:					
	defw	docol			
	defw	zero			
	defw	blk			
	defw	store			
	defw	lbrac			
quit1:					
	defw	rpsto			; begin
	defw	cr			
	defw	query			
	defw	inter			
	defw	state			
	defw	at			
	defw	zequ			
	defw	zbran			; if
	defw	quit2-$			
	defw	pdotq			
	defb	2			
	db	'ok'			; endif
quit2:					
	defw	bran			; again
	defw	quit1-$			
;
;
	defb	85h			; ABORT
	defc	'ABORT'			
	defw	quit-7			
abort:					
	defw	docol			
	defw	spsto			
	defw	dec			
	defw	qstac			
	defw	cr			
	defw	dotcpu			
	defw	pdotq			
	defb	0eh			; count of chrs to follow
	db	'fig-FORTH '		
	defb	figrel+30h,adot,figrev+30h,usrver 
	defw	forth			
	defw	defin			
	defw	quit			
;
;
wrm:	ld	bc,wrm1			
	jnext				
wrm1:	defw	warm			
;
;
	defb	84h			; WARM
	defc	'WARM'			
	defw	abort-8			
warm:					
	defw	docol			
	defw	mtbuf			
	defw	abort			
;
;
cld:					
	ld	hl,(bdoss+1)		;/
	ld	l,0			;/ hl <-- fbase
	ld	(limit+2),hl		;/ set limit
	ld	de,bufsiz		;/ de <-- total disc buffer size
	;subw	hl,de			;/ hl <-- addr. of 1st disc buffer
	DEFB	0EDH,0DEh
	ld	(first+2),hl		;/ set FIRST
	ld	(use+2),hl		;/ set USE
	ld	(prev+2),hl		;/ set PREV
	ld	(buf1),hl		;/
	ld	de,us			;/ de <-- user variable space
	;subw	hl,de			;/ hl <-- initr0
	DEFB	0EDH,0DEh
	ld	(upinit),hl		;/
	ld	(r0init),hl		;/
	ld	(up),hl			;/
	ld	(rpp),hl		;/
	ld	de,rts			;/ de <-- rtn stack & term. buf space
	;subw	hl,de			;/ hl <-- inits0
	DEFB	0EDH,0DEh
	ld	(s0init),hl		;/
	ld	(tibini),hl		;/
	ld	sp,hl			;/
	ld	bc,cld1			
	ld	ix,next			; pointer to next
	ld	iy,hpush		; pointer to hpush
	jnext				
;
;
cld1:	defw	cold			
;
	defb	84h			; COLD
	defc	'COLD'			
	defw	warm-7			
cold:					
	defw	docol			
	defw	mtbuf			
	defw	one,recadr		; AvdH
	defw	store			
	defw	lit,buf1		
	defw	at			;/
	defw	use,store		
	defw	lit,buf1		
	defw	at			;/
	defw	prev,store		
	defw	drzer			
	defw	zero			;/
	defw	lit,eprint		
	defw	cstor			;/
;
	defw	lit			
	defw	orig+12h		
	defw	lit			
	defw	up			
	defw	at			
	defw	lit			
	defw	6			
	defw	plus			
	defw	lit			
	defw	10h			
	defw	cmove			
	defw	lit			
	defw	orig+0ch		
	defw	at			
	defw	lit			
	defw	forth+6			
	defw	store			
	defw	fcb			;/A
	defw	lit,opnfil		;/A open mass storage
	defw	bdos			;/A
	defw	lit,0ffh		;/A
	defw	equal			;/A file present?
	defw	zbran,cld2-$		;/A
	defw	zero			;/A
	defw	warn,store		;/A
	defw	cr,pdotq		;/A
	defb	7			;/A
	db	'No file'		;/A
cld2:					
	defw	abort			
;
;
	defb	84h			; S->D
	defc	'S->D'			
	defw	cold-7			
stod:	defw	$+2			
	pop	hl			;/
	;exts	hl			;/ de <-- h(7)
	DEFB	0EDH,6Ch
	ex	de,hl			;/
	jp	dpush			; ( n1 -- d1L d1H)
;
;
	defb	82h			; +-
	defc	'+-'			
	defw	STOD-7			
pm:					
	defw	docol			
	defw	zless			
	defw	zbran			; if
	defw	pm1-$			
	defw	minus			; endif
pm1:					
	defw	semis			
;
;
	defb	83h			; D+-
	defc	'D+-'			
	defw	pm-5			
dpm:					
	defw	docol			
	defw	zless			
	defw	zbran			; if
	defw	dpm1-$			
	defw	dminu			; endif
dpm1:					
	defw	semis			
;
;
	defb	83h			; ABS
	defc	'ABS'			
	defw	dpm-6			
abs:					
	defw	docol			
	defw	dup			
	defw	pm			
	defw	semis			
;
;
	defb	84h			; DABS
	defc	'DABS'			
	defw	abs-6			
dabs:					
	defw	docol			
	defw	dup			
	defw	dpm			
	defw	semis			
;
;
	defb	83h			; MIN
	defc	'MIN'			
	defw	dabs-7			
min:					
	defw	docol			
	defw	tdup			
	defw	great			
	defw	zbran			; if
	defw	min1-$			
	defw	swap			; endif
min1:					
	defw	drop			
	defw	semis			
;
;
	defb	83h			; MAX
	defc	'MAX'			
	defw	min-6			
max:	defw	docol			
	defw	tdup			
	defw	less			
	defw	zbran			; if
	defw	max1-$			
	defw	swap			; endif
max1:					
	defw	drop			
	defw	semis			
;
;
	defb	82h			; M*   ( n1 n2 --- d)
	defc	'M*'			
	defw	max-6			
mstar:					
	defw	$+2			;/
	pop	de			; de <-- multiplicator
	pop	hl			; hl <-- multiplicant
	;multw	hl,de			;/ dehl <-- hl * de
	DEFB	0EDH,0D2h
	ex	de,hl			;/
	jp	dpush			;/ ( n1 n2 --- d1l d1h)
;
;
	defb	82h			;/ M/   ( d n1 --- nrem nquot)
	defc	'M/'			
	defw	mstar-5			
mslas:					
	defw	$+2			; ( d n1 --- n2 n3)
	exx				; save ip
	pop	hl			; divisor
	ld	a,h			
	and	80h			; filter sign
	jr	z,mslas1		; positive
	;neg	hl			; make positive
	DEFB	0EDH,4Ch
mslas1:					
	ld	b,h			
	ld	c,l			; bc <-- divisor
	pop	hl			; dividend.hw
	pop	de			; dividend.lw
	bit	7,h			; negative?
	jr	z,mslas2		; no
	inc	a			; dividend sign flag
	push	hl			
	ld	hl,0			
	;subw	hl,de			; neg dividend.lw
	DEFB	0EDH,0DEh
	pop	de			; dividend.hw
	push	hl			
	ld	hl,0			
	sbc	hl,de			; neg dividend.hw
	pop	de			; dividend.lw
mslas2:					
	;cpw	hl,bc			; dividend.hw >= divisor
	DEFB	0EDH,0C7h
	jr	c,mslas3		; no overflow, continue
	ld	hl,0ffffh		
	ld	d,h			
	ld	e,l			; set rem & quot to max.
	jr	mslas5			
;
mslas3:					
	ex	de,hl			; dehl <-- dividend.hw,lw
	;divuw	dehl,bc			; de <-- remainder, hl <-- quotient
	DEFB	0EDH,0CBh
	ex	de,hl			; hl <-- remainder
	bit	0,a			; was dividend negative
	jr	z,mslas4		; no
	;neg	hl			;/ yes, negate remainder
	DEFB	0EDH,4Ch
mslas4:					
	ex	de,hl			; hl <-- quotient
	or	a			
	jr	z,mslas5		; neither operand negative
	cp	81h			; both operands negative?
	jr	z,mslas5		; yes, quotient stays positive
	;neg	hl			;/ no, negate quotient
	DEFB	0EDH,4Ch
mslas5:					
	push	de			; remainder
	push	hl			; quotient
	exx				; restore ip
	jnext				
;
;
	defb	81h			; *   ( n1 n2 --- nproduct)
	defc	'*'			
	defw	mslas-5			
star:					
	defw	$+2			
	pop	de			
	pop	hl			
	;multw	hl,de			;/ dehl <-- product
	DEFB	0EDH,0D2h
	jhpush				
;
;
	defb	84h			; /MOD   ( n1 n2 --- nrem nquot)
	defc	'/MOD'			
	defw	star-4			
slmod:					
	defw	$+2			
	exx				;/ save ip
	pop	bc			;/ divisor
	pop	hl			;  dividend
	ld	a,b			
	or	c			;/ div by 0?
	jr	nz,slmod1		;/ no, continue
	ld	de,0ffffh		
	ld	h,d			
	ld	l,e			;/ set remainder & quotient to max.
	jr	slmod3			
slmod1:					
	;cpw	hl,8000h		;/ special case -32768 -1 /
	DEFB	0FDH
	DEFB	0EDH,0F7h
	DEFW	8000H                                   
	jr	nz,slmod2		;/ continue
	ld	a,b			
	cp	0ffh			
	jr	nz,slmod2		
	cp	c			;/ lo byte also 0ffh?
	jr	nz,slmod2		;/ no, go & divide
	ld	de,0			;/ remainder
	jr	slmod3			;/ exit with dividend unchanged
slmod2:					
	;exts	hl			;/ de <-- dividend.hw
	DEFB	0EDH,6Ch
	;divw	dehl,bc			;/ de <-- remainder, hl <-- quotient
	DEFB	0EDH,0CAh
slmod3:					
	push	de			
	push	hl			
	exx				;/ restore ip
	jnext				
;
;
	defb	81h			; /
	defc	'/'			
	defw	slmod-7			
slash:					
	defw	$+2			
	exx				;/ save ip
	pop	bc			;/ divisor
	pop	hl			;  dividend
	ld	a,b			
	or	c			;/ division by 0?
	jr	nz,slash1		;/ no, continue
	ld	hl,0ffffh		;/ set quotient to max.
	jr	slash3			
slash1:					
	;cpw	hl,8000h		;/ special case -32768 -1 /
	DEFB	0FDH
	DEFB	0EDH,0F7h
	DEFW	8000H                                   
	jr	nz,slash2		;/ dividend not -32768
	ld	a,b			
	cp	0ffh			
	jr	nz,slash2		;/ divisor not -1
	cp	c			
	jr	z,slash3		;/ return with dividend unchanged
slash2:					
	;exts	hl			;/ de <-- dividend.hw
	DEFB	0EDH,6Ch
	;divw	dehl,bc			;/ hl <-- quotient
	DEFB	0EDH,0CAh
slash3:					
	push	hl			;/ quotient
	exx				;/ restore ip
	jnext				
;
;
	defb	83h			;/ MOD
	defc	'MOD'			
	defw	slash-4			
modd:					
	defw	$+2			
	exx				; save ip
	pop	bc			; divisor
	pop	hl			;  dividend
	ld	a,b			
	or	c			; division by 0?
	jr	nz,modd1		; no, continue
	ld	de,0ffffh		; set remainder to max
	jr	modd3			
modd1:					
	;cpw	hl,8000h		;/ special case -32768 -1 /
	DEFB	0FDH
	DEFB	0EDH,0F7h
	DEFW	8000H                                   
	jr	nz,modd2		; dividend not -32768
	ld	a,b			
	cp	0ffh			
	jr	nz,modd2		; divisor not -1
	cp	c			
	jr	nz,modd2		; go & divide
	ld	de,0			; remainder
	jr	modd3			
modd2:					
	;exts	hl			; de <-- dividend.hw
	DEFB	0EDH,6Ch
	;divw	dehl,bc			; de <-- remainder
	DEFB	0EDH,0CAh
modd3:					
	push	de			; remainder
	exx				; restore ip
	jnext				
;
;
	defb	85h			;/ */MOD
	defc	'*/MOD'			
	defw	modd-6			
ssmod:					
	defw	$+2			
	exx				; save ip
	pop	hl			; divisor
	ld	a,h			
	and	80h			; filter sign
	jr	z,ssmod1		; positive
	;neg	hl			; make positive
	DEFB	0EDH,4Ch
ssmod1:					
	ld	b,h			
	ld	c,l			; bc <-- divisor
	pop	hl			; multipicator
	pop	de			; multiplicant
	ex	af,af' 			; save sign flag 
	;multw	hl,de			; dehl <-- product (= dividend)
	DEFB	0EDH,0D2h
	ex	af,af' 			; restore sign flag 
	ex	de,hl			; de <-- dividend.lw
	bit	7,h			; dividend negative?
	jr	z,ssmod2		; no
	inc	a			; dividend sign flag
	push	hl			
	ld	hl,0			
	;subw	hl,de			; neg dividend.lw
	DEFB	0EDH,0DEh
	pop	de			; dividend.hw
	push	hl			
	ld	hl,0			
	sbc	hl,de			; neg dividend.hw
	pop	de			; dividend.lw
ssmod2:					
	;cpw	hl,bc			; dividend.hw >= divisor?
	DEFB	0EDH,0C7h
	jr	c,ssmod3		; no overflow, continue
	ld	hl,0ffffh		
	ld	d,h			
	ld	e,l			; set rem & quot to max
	jr	ssmod5			
;
ssmod3:					
	ex	de,hl			; dehl <-- dividend.hw,lw
	;divuw	dehl,bc			; de <-- remainder, hl <-- quotient
	DEFB	0EDH,0CBh
	ex	de,hl			; hl <-- remainder
	bit	0,a			; was dividend negative?
	jr	z,ssmod4		; no
	;neg	hl			; yes, negate remainder
	DEFB	0EDH,4Ch
ssmod4:					
	ex	de,hl			; hl <-- quotient
	or	a			
	jr	z,ssmod5		; neither operand negative
	cp	81h			; both operands negative?
	jr	z,ssmod5		; yes, quotient stays positive
	;neg	hl			; no, negate quotient
	DEFB	0EDH,4Ch
ssmod5:					
	push	de			; remainder
	push	hl			; quotient
	exx				; restore ip
	jnext				
;
;
	defb	82h			; */
	defc	'*/'			
	defw	ssmod-8			
ssla:					
	defw	$+2			;/
	exx				; save ip
	pop	hl			; divisor
	ld	a,h			
	and	80h			; filter sign
	jr	z,ssla1			; positive
	;neg	hl			; make positive
	DEFB	0EDH,4Ch
ssla1:					
	ld	b,h			
	ld	c,l			; bc <-- divisor
	pop	hl			; multipicator
	pop	de			; multiplicant
	ex	af,af' 			; save sign flag 
	;multw	hl,de			; dehl <-- product (= dividend)
	DEFB	0EDH,0D2h
	ex	af,af' 			; restore sign flag 
	ex	de,hl			; de <-- dividend.lw
	bit	7,h			; dividend negative?
	jr	z,ssla2			; no
	inc	a			; dividend sign flag
	push	hl			
	ld	hl,0			
	;subw	hl,de			; neg dividend.lw
	DEFB	0EDH,0DEh
	pop	de			; dividend.hw
	push	hl			
	ld	hl,0			
	sbc	hl,de			; neg dividend.hw
	pop	de			; dividend.lw
ssla2:					
	;cpw	hl,bc			; dividend.hw >= divisor?
	DEFB	0EDH,0C7h
	jr	c,ssla3			; no overflow, continue
	ld	hl,0ffffh		; set quotient to max
	jr	ssla4			
;
ssla3:					
	ex	de,hl			; dehl <-- dividend.hw,lw
	;divuw	dehl,bc			; de <-- remainder, hl <-- quotient
	DEFB	0EDH,0CBh
	or	a			
	jr	z,ssla4			; neither operand negative
	cp	81h			; both operands negative?
	jr	z,ssla4			; yes, quotient stays positive
	;neg	hl			; no, negate quotient
	DEFB	0EDH,4Ch
ssla4:					
	push	hl			; quotient
	exx				; restore ip
	jnext				
;
;
	defb	85h			; M/MOD
	defc	'M/MOD'			
	defw	ssla-5			
msmod:					
	defw	docol			
	defw	tor			
	defw	zero			
	defw	rr			
	defw	uslas			
	defw	fromr			
	defw	swap			
	defw	tor			
	defw	uslas			
	defw	fromr			
	defw	semis			
;
;
;	Block moved down 2 pages
;
	defb	86h			; (LINE)
	defc	'(LINE)'		
	defw	msmod-8			
pline:					
	defw	docol			
	defw	tor			
	defw	lit			
	defw	40h			
	defw	bbuf			
	defw	ssmod			
	defw	fromr			
	defw	bscr			
	defw	star			
	defw	plus			
	defw	block			
	defw	plus			
	defw	lit			
	defw	40h			
	defw	semis			
;
;
	defb	85h			; .LINE
	defc	'.LINE'			
	defw	pline-9			
dline:					
	defw	docol			
	defw	pline			
	defw	dtrai			
	defw	type			
	defw	semis			
;
;
	defb	87h			; MESSAGE
	defc	'MESSAGE'		
	defw	dline-8			
mess:					
	defw	docol			
	defw	warn			
	defw	at			
	defw	zbran			; if
	defw	mess1-$			
	defw	ddup			
	defw	zbran			; if
	defw	mess2-$			
	defw	lit			
	defw	4			; 1st message screen
	defw	ofset			
	defw	at			
	defw	bscr			
	defw	slash			
	defw	subb			
	defw	dline			
	defw	space			; endif
mess2:					
	defw	bran			; else
	defw	mess3-$			
mess1:					
	defw	pdotq			
	defb	6			
	db	'MSG # '		
	defw	dot			; endif
mess3:	defw	semis			
;
;
	defb	82h			; P@
	defc	'P@'			
	defw	mess-0ah		
ptat:					
	defw	$+2			
	exx				;d save registers
	pop	bc			;d bc <-- port#
	in	l,(c)			;d l <-- data byte
	ld	h,0			
	push	hl			
	exx				;d restore registers
	jnext				
;
;
	defb	82h			; P!
	defc	'P!'			
	defw	ptat-5			
ptsto:					
	defw	$+2			
	exx				;d save registers
	pop	bc			;d c <-- port#
	pop	hl			;d L <-- date byte
	out	(c),l			
	exx				;d restore registers
	jnext				
;
;
	page				
include	DISCIO.Z80			
	page				
include	CONPRTIO.Z80			
	page				
;
	defb	0c1h			; ' (tick)
	defb	0a7h			
	defw	arrow-6			
tick:					
	defw	docol			
	defw	dfind			
	defw	zequ			
	defw	zero			
	defw	qerr			
	defw	drop			
	defw	liter			
	defw	semis			
;
;
	defb	86h			; FORGET
	defc	'FORGET'		
	defw	tick-4			
forg:					
	defw	docol			
	defw	curr			
	defw	at			
	defw	cont			
	defw	at			
	defw	subb			
	defw	lit			
	defw	18h			
	defw	qerr			
	defw	tick			
	defw	dup			
	defw	fence			
	defw	at			
	defw	uless			;/ FORGET >8000h nw o.k.
	defw	lit			
	defw	15h			
	defw	qerr			
	defw	dup			
	defw	nfa			
	defw	dp			
	defw	store			
	defw	lfa			
	defw	at			
	defw	cont			
	defw	at			
	defw	store			
	defw	semis			
;
;
	defb	84h			; BACK
	defc	'BACK'			
	defw	forg-9			
back:					
	defw	docol			
	defw	here			
	defw	subb			
	defw	comma			
	defw	semis			
;
;
	defb	0c5h			; BEGIN
	defc	'BEGIN'			
	defw	back-7			
begin:					
	defw	docol			
	defw	qcomp			
	defw	here			
	defw	one			
	defw	semis			
;
;
	defb	0c5h			; ENDIF
	defc	'ENDIF'			
	defw	begin-8			
endiff:					
	defw	docol			
	defw	qcomp			
	defw	two			
	defw	qpair			
	defw	here			
	defw	over			
	defw	subb			
	defw	swap			
	defw	store			
	defw	semis			
;
;
	defb	0c4h			; THEN
	defc	'THEN'			
	defw	endiff-8		
then:	defw	docol			
	defw	endiff			
	defw	semis			
;
;
	defb	0c2h			; DO
	defc	'DO'			
	defw	then-7			
do:					
	defw	docol			
	defw	comp			
	defw	xdo			
	defw	here			
	defw	three			
	defw	semis			
;
;
	defb	0c4h			; LOOP
	defc	'LOOP'			
	defw	do-5			
loop:					
	defw	docol			
	defw	three			
	defw	qpair			
	defw	comp			
	defw	xloop			
	defw	back			
	defw	semis			
;
;
	defb	0c5h			; +LOOP
	defc	'+LOOP'			
	defw	loop-7			
ploop:					
	defw	docol			
	defw	three			
	defw	qpair			
	defw	comp			
	defw	xploo			
	defw	back			
	defw	semis			
;
;
	defb	0c5h			; UNTIL
	defc	'UNTIL'			
	defw	ploop-8			
until:					
	defw	docol			
	defw	one			
	defw	qpair			
	defw	comp			
	defw	zbran			
	defw	back			
	defw	semis			
;
;
	defb	0c3h			; END
	defc	'END'			
	defw	until-8			
endd:					
	defw	docol			
	defw	until			
	defw	semis			
;
;
	defb	0c5h			; AGAIN
	defc	'AGAIN'			
	defw	endd-6			
again:					
	defw	docol			
	defw	one			
	defw	qpair			
	defw	comp			
	defw	bran			
	defw	back			
	defw	semis			
;
;
	defb	0c6h			; REPEAT
	defc	'REPEAT'		
	defw	again-8			
repea:					
	defw	docol			
	defw	tor			
	defw	tor			
	defw	again			
	defw	fromr			
	defw	fromr			
	defw	twomin			;/
	defw	endiff			
	defw	semis			
;
;
	defb	0c2h			; IF
	defc	'IF'			
	defw	repea-9			
iff:					
	defw	docol			
	defw	comp			
	defw	zbran			
	defw	here			
	defw	zero			
	defw	comma			
	defw	two			
	defw	semis			
;
;
	defb	0c4h			; ELSE
	defc	'ELSE'			
	defw	iff-5			
elsee:					
	defw	docol			
	defw	two			
	defw	qpair			
	defw	comp			
	defw	bran			
	defw	here			
	defw	zero			
	defw	comma			
	defw	swap			
	defw	two			
	defw	endiff			
	defw	two			
	defw	semis			
;
;
	defb	0c5h			; WHILE
	defc	'WHILE'			
	defw	elsee-7			
while:					
	defw	docol			
	defw	iff			
	defw	twop			
	defw	semis			
;
;
	defb	86h			; SPACES
	defc	'SPACES'		
	defw	while-8			
spacs:					
	defw	docol			
	defw	zero			
	defw	max			
	defw	ddup			
	defw	zbran			; if
	defw	spax1-$			
	defw	zero			
	defw	xdo			; do
spax2:					
	defw	space			
	defw	xloop			; loop endif
	defw	spax2-$			
spax1:					
	defw	semis			
;
;
	defb	82h			; <#
	defc	'<#'			
	defw	spacs-9			
bdigs:					
	defw	docol			
	defw	pad			
	defw	hld			
	defw	store			
	defw	semis			
;
;
	defb	82h			; #>
	defc	'#>'			
	defw	bdigs-5			
edigs:					
	defw	docol			
	defw	drop			
	defw	drop			
	defw	hld			
	defw	at			
	defw	pad			
	defw	over			
	defw	subb			
	defw	semis			
;
;
	defb	84h			; SIGN
	defc	'SIGN'			
	defw	edigs-5			
sign:					
	defw	docol			
	defw	rot			
	defw	zless			
	defw	zbran			; if
	defw	sign1-$			
	defw	lit			
	defw	2dh			
	defw	hold			; endif
sign1:					
	defw	semis			
;
;
	defb	81h			; #
	defc	'#'			
	defw	sign-7			
dig:					
	defw	docol			
	defw	base			
	defw	at			
	defw	msmod			
	defw	rot			
	defw	lit			
	defw	9			
	defw	over			
	defw	less			
	defw	zbran			; if
	defw	dig1-$			
	defw	lit			
	defw	7			
	defw	plus			; endif
dig1:	defw	lit			
	defw	30h			
	defw	plus			
	defw	hold			
	defw	semis			
;
;
	defb	82h			; #S
	defc	'#S'			
	defw	dig-4			
digs:					
	defw	docol			
digs1:					
	defw	dig			; begin
	defw	tdup			;/
	defw	orr			
	defw	zequ			
	defw	zbran			; until
	defw	digs1-$			
	defw	semis			
;
;
	defb	83h			; D.R
	defc	'D.R'			
	defw	digs-5			
ddotr:					
	defw	docol			
	defw	tor			
	defw	swap			
	defw	over			
	defw	dabs			
	defw	bdigs			
	defw	digs			
	defw	sign			
	defw	edigs			
	defw	fromr			
	defw	over			
	defw	subb			
	defw	spacs			
	defw	type			
	defw	semis			
;
;
	defb	82h			; .R
	defc	'.R'			
	defw	ddotr-6			
dotr:					
	defw	docol			
	defw	tor			
	defw	stod			
	defw	fromr			
	defw	ddotr			
	defw	semis			
;
;
	defb	82h			; D.
	defc	'D.'			
	defw	dotr-5			
ddot:					
	defw	docol			
	defw	zero			
	defw	ddotr			
	defw	space			
	defw	semis			
;
;
	defb	81h			; .
	defc	'.'			
	defw	ddot-5			
dot:					
	defw	docol			
	defw	stod			
	defw	ddot			
	defw	semis			
;
;
	defb	81h			; ?
	defc	'?'			
	defw	dot-4			
ques:					
	defw	docol			
	defw	at			
	defw	dot			
	defw	semis			
;
;
	defb	82h			; U.
	defc	'U.'			
	defw	ques-4			
udot:	defw	docol			
	defw	zero			
	defw	ddot			
	defw	semis			
;

	defb	85h			; VLIST
	defc	'VLIST'			
	defw	udot-5			
vlist:					
	defw	docol			
	defw	lit			
	defw	80h			
	defw	outt			
	defw	store			
	defw	cont			
	defw	at			
	defw	at			
vlis1:					
	defw	outt			; begin
	defw	at			
	defw	csll			
	defw	great			
	defw	zbran			; if
	defw	vlis2-$			
	defw	cr			
	defw	zero			
	defw	outt			
	defw	store			; endif
vlis2:					
	defw	dup			
	defw	iddot			
	defw	space			
	defw	space			
	defw	pfa			
	defw	lfa			
	defw	at			
	defw	dup			
	defw	zequ			
	defw	qterm			
	defw	orr			
	defw	zbran			; until
	defw	vlis1-$			
	defw	drop			
	defw	semis			
;
;
	defb	83h			; BYE
	defc	'BYE'			
	defw	vlist-8			
bye:					
	defw	docol			;/A
	defw	flush			;/A
	defw	fcb,lit			;/E
	defw	10h,bdos		;/E close file
	defw	drop			;/E discard directory code
	defw	zero,zero		;/A
	defw	bdos			;/A return to CP/M
	defw	semis			;/A won't get this far, just for pretty
;
;
	defb	84h			; LIST
	defc	'LIST'			
	defw	bye-6			
list:					
	defw	docol,dec		
	defw	cr,dup			
	defw	scr,store		
	defw	pdotq			
	defb	6			
	db	'SCR # '		
	defw	dot			
	defw	lit,10h			
	defw	zero,xdo		
list1:					
	defw	cr,ido			
	defw	three			;/ was lit,3
	defw	dotr,space		
	defw	ido,scr			
	defw	at,dline		
	defw	qterm			
	defw	zbran,list2-$		; if
	defw	leave			
list2:					
	defw	xloop,list1-$		; endif
	defw	cr			
	defw	semis			
;
;
	defb	85H		;INDEX
	defc	'INDEX'		
	defw	list-7		
index:					
	defw	docol		
	defw	lit,ff		
	defw	emit		
	defw	cr		
	defw	onep,swap	
	defw	xdo		
inde1:					
	defw	cr,ido		
	defw	three			;/ was lit,3
	defw	dotr,space		
	defw	zero,ido		
	defw	dline,qterm		
	defw	zbran,inde2-$		; if
	defw	leave			; endif
inde2:					
	defw	xloop,inde1-$		
	defw	semis			
;
;
	defb	85h			; TRIAD
	defc	'TRIAD'			
	defw	index-8			
triad:					
	defw	docol			
	defw	lit,ff			
	defw	emit			
	defw	three			;/ was lit,3
	defw	slash			
	defw	three			;/ was lit,3
	defw	star			
	defw	three			;/ was lit,3
	defw	over,plus		
	defw	swap,xdo		
tria1:					
	defw	cr,ido			
	defw	list			
	defw	qterm			
	defw	zbran,tria2-$		; if
	defw	leave			
tria2:					
	defw	xloop,tria1-$		; endif
	defw	cr			
	defw	lit,15			
	defw	mess,cr			
	defw	semis			
;
;
	defb	84h			; .CPU
	defc	'.CPU'			
	defw	triad-8			
dotcpu:					
	defw	docol			
	defw	base,at			
	defw	lit,36			
	defw	base,store		
	defw	lit,22h			
	defw	porig,tat		
	defw	ddot			
	defw	base,store		
	defw	semis			
;
;
	defb	86h			; setclk
	defc	'setclk'		
	defw	dotcpu-7		
setclk:					
	defw	$+2			
	exx				; save ip
	ld	c,iopreg		
	;ldctl	hl,(c)			; l <-- current i/o page
	DEFB	0EDh,66h
	ld	a,l			
	ex	af,af' 			; save i/o page 
	ld	l,0feh			
	;ldctl	(c),hl			; select i/o page 0feh
	DEFB	0EDh,6Eh
	xor	a			
	out	(cntrl0),a		; disable c/t 0
	out	(cntrl1),a		; disable c/t 1
	out	(config1),a		
	ld	hl,0ffffh		
	ld	a,10h			
	out	(config0),a		; cascade c/t 0 - c/t 1
	ld	c,tcon0			
	;outw	(c),hl			; load c/t 0 time constant
	DEFB	0EDH,0BFh
	ld	c,tcon1			
	;outw	(c),hl			; load c/t 1 time constatnt
	DEFB	0EDH,0BFh
	ld	a,80h			
	out	(config1),a		; continous mode
	ld	a,0e0h			
	out	(cntrl1),a		; start 32bit counter
	ex	af,af' 			; std. accu 
	ld	l,a			; l <-- previous i/o page
	ld	c,iopreg		
	;ldctl	(c),hl			; restore i/o page
	DEFB	0EDh,6Eh
	exx				; restore ip
	jnext				
;
;
	defb	86h			; getclk
	defc	'getclk'		
	defw	setclk-9		
getclk:					
	defw	$+2			
	exx				; save ip
	ld	c,iopreg		
	;ldctl	hl,(c)			; l <-- current i/o page
	DEFB	0EDh,66h
	ld	a,l			
	ex	af,af' 			; save current i/o page 
	ld	l,0feh			
	;ldctl	(c),hl			; select i/o page 0feh
	DEFB	0EDh,6Eh
	ld	a,80h			
	out	(cntrl1),a		; halt 32bit counter
	ld	c,count1		
	;inw	hl,(c)			
	DEFB	0EDH,0B7h
	ld	d,h			
	ld	e,l			; de <-- count1
	ld	c,count0		
	;inw	hl,(c)			; hl <-- count0
	DEFB	0EDH,0B7h
	ld	c,0			
	ld	a,c			; a <-- 0
	sub	l			; 0 - l
	ld	l,a			; l <-- neg(l)
	ld	a,c			; a <-- 0
	sbc	a,h			
	ld	h,a			; h <-- neg(h)
	ld	a,c			; a <-- 0
	sbc	a,e			
	ld	e,a			; e <-- neg(e)
	ld	a,c			; a <-- 0
	sbc	a,d			
	ld	d,a			; d <-- neg(d), dehl <-- neg(dehl)
	;divuw	dehl,25000		; scale to 1/100 secs
	DEFB	0FDH
	DEFB	0EDH,0FBh
	DEFW	25000                                   
	push	hl			; result
	ex	af,af' 			; std. accu 
	ld	l,a			; l <-- previous i/o page
	ld	c,iopreg		
	;ldctl	(c),hl			; restore i/o page
	DEFB	0EDh,6Eh
	exx				; restore ip
	jnext				
;
;
	defb	84h			; TASK
	defc	'TASK'			
	defw	getclk-9		
;	defw	dotcpu-7
task:					
	defw	docol			
	defw	semis			
;
;
initdp:					
	defw	0			
;
	end	orig			
defw	getclk-9		
;	defw	dotcpu-7
task:					
	defw	docol		                                                                                                                                                                                                                                                                 Г‰ Гuav            ЃЃф  ц      Хе`iн&нлйѓLIФ  A`iн&эй‡EXECUTЕ9UбГ4†BRANCИId`iЭнЖMDЭй‡0BRANCИYyб}ґ(жЭй†(LOOP©mЌ*(Эн##{–z#ћъd#"(Эй‡(+LOOP©‚ІС*(~ѓw_#~Љw#WъН{–z#ћГТ~“#~љъd#"(Эй„(DO©¦жС*(++ЭБ++н"(ЭйЃЙЭэ*(ЭЕЭй…DIGIФчбС{Ц08ю
8Цю
8
Ѕ0_! Г,lэй†(FIND©7Сбе®ж? #®‡ 0ч! г·тN_ ! Г,8·т_лнzі Лб!  эй‡ENCLOSЕ,Сбе{Wя+#ѕ(ы ХW~§  ХХЭйz#ѕ(
~§ ц ХХЭй ХХЭй„EMIФsШ]@QРѓKEЩіОГъ‰?TERMINAМЖЯ!  Го‚CТСмГ'…CMOVЕещЩБСбx±(н°ЩЭй†-CMOVЕпЩБСбx±(	+л	+лнёЩЭй‚UЄ+СбнУлГ,‚UЇ$:ЩБбСнЗ8!яяT]лнЛХеЩЭйѓANД3YСб{Ґoz¤gэй‚OТQjСб{µozґgэйѓXOТc|Сб{­oz¬gэйѓSPАtЋ!  9эйѓSPЎ†њ*& н&щЭйѓRPА”°*(эйѓRPЎЁЅ*& н&"(Эй‚;УµТ*(н##"(Эй…LEAVЕЛи*(н##нЭй‚>ТЮъ*(++ЭБ"(Эй‚Rѕу*(ЭЕ##"(ЭйЃТэ‚0Ѕ&С!  нЧ ,эйѓ0<ѕ9С!  нЧ(,эй‚0ј1Kс!  Лэй‚0ѕD[С!  нЧтhкh,эйЃ«TpСбэй‚D«j|ЩБбсСхлбнJХеЩЭй…MINUУu–бнLэй†DMINUУЊ¦ЩСБ!  нОе!  нRеЩЭй„OVEТ›Бн эй„DROРёР33Эй„SWAРЗЭбгэйѓDUРФйн  эй„TUCЛбшбСеГ,ѓNIРпбн  Эй„-ROФюбСглГ,…CSWAР'бнпэй„PICЛ5б)9ЭЕЭй„2DUР,EбСХеГ,‚+Ў<SбС~ѓw#~ЉwЭй†TOGGLЕLiСб~«wЭйЃА^vбЭЕЭй‚CАp‚бn& эй‚2А{Џбн##ЭЕХЭйЃЎ€џбЭБЭй‚CЎ™«бСsЭй‚2Ў¤·бЭБ##ЭБЭйБє°Ш 	[	otbќ{%
x
*(++н"(KBЭйБ»АШК	
Р:

Р„NOOРзШР€CONSTANФщШ{:
#x
лЭЕЭй€VARIABLЕШx
ХЭй„USEТШx
лn& ЭнЦ&эйЃ°4Sэх  ЭйЃ±M_эх ЭйЃІYkэх ЭйЃіewэх Эй‚BМq  ѓC/М}@ …FIRSФ†  …LIMIФђ  …B/BUЖњЂ …B/SCТЁ ‡+ORIGIОґШ? nР‚S°АA ‚R°ФA ѓTIВЭA
…WIDTИжA‡WARNINЗпA…FENCЕъA‚DРA€VOC-LINЛA ѓBLЛA‚IО)AѓOUФ2AѓSCТ:A†OFFSEФCA‡CONTEXФLA ‡CURRENФXA"…STATЕeA$„BASЕrA&ѓDPМ}A(ѓFLД‡A*ѓCSРђA,‚RЈ™A.ѓHLДўA0 ‚1«Є»б#эй‚2«ґЖб##эй‚1­їТб+эй‚2­ЛЭб++эй‚2ЄЦйб)эй‚2ЇвфбЛ|(#Л,Лэй„HERЕнШtР…ALLOФ ШQРЃ¬ШќiР‚C¬Ш©]РЃ­/FСбнЮэйЃЅ@RСбнЮ!   ,эйЃјLdСбz¬ъmнЮЛ|!  (,эй‚Uј^~СбнЮ!  ЛэйЃѕwЏбСz¬ънЮЛ|!  (,эйѓROФ‰ЄСбгГ,…SPACЕўШ‚єР„-DUР°Йн  |µ(еЭй€TRAVERSЕАШЫїn? їЂbwряЫОР†LATESФФШottРѓLFБы	бэню эйѓCFБ	ШЫРѓNFБ	Ш? D?яяЯРѓPFБ*	Ш]Я? nР„!CSР@	ШЊџќР†?ERROТT	ШЫw щb ОР…?COMРe	Шzt$? n	Р…?EXEГЂ	Шzt? n	Р†?PAIRУ	ШD? n	Р„?CSР®	ШЊџtD? n	Р€?LOADINЗГ	Ш/t$? n	Р‡COMPILЕЬ	Ш€	зДшt#РБЫч	ШQzќРЃЭ
Ш?А zќР†SMUDGЕ!
Ш	?  gРѓHEШ1
Ш? „ќР‡DECIMAМF
Ш?
 „ќР‡(;CODE©X
Ш	F	$	ќРЕ;CODЕn
ШК	
x

 Р‡<BUILDУ†
ШQР…DOESѕњ
Ш	F	ќx
*(++н"(лн##эй…COUNФ®
Шз№ЫЂР„TYPЕФ
ШЗw їnЫдыЂє‹шяb ОР‰-TRAILINЗи
ШзQдCnРЂ‚Dw жb Р‹жяР„(."©ШЬ
з№nшп
РВ.ўCШ?" ztw 
JЛЂ№b
 ЛЬ
п
Р†EXPECФ^ШїnїдМз? КtPw( ОзыPзЫnшw
 ? b ? b( з? Pw жО‚Qb зы©Qы№ќє‹ћяОР…QUERЩЌШмt?P –Q7ќРБЂШ/tw( ]/QQ7ќ/tјРW$w  	Оb ОР„FILМ$gЩСБбx±(s#ГkЩЭй…ERASЕ^ШQeР†BLANKУxШ‚eР„HOLД€Ш?яя°Q°t©РѓPAД™Ш?D nР„WORДІШ/tw /t&b мt7tnЫ}?" ‘7QїDш©n№чР€(NUMBER©ДШ№зшЂ„tw, Ы„t)ОЁ„t)zЌt№w ]ЌQbЖяР†NUMBEТШQQЁз№Ђ?- Pзшn?яяЌќзЂ‚Dw зЂ?. DQn	QbЬяОw ¤Р…-FINД^Ш‚Лbtt5з$w
 О	5Р‡(ABORT©·ШRР…ERROТбШtIw лЬ
п
J? ­љ/tЗw 7tЫ%ѓID®сШё?  ‘зF		їDзшёЫчёёnРзt? WЫќЬ
? Wп
ёР†CREATЕ(Шїw О0	.? ­ёзЂчt›№з?  gР?Ђ g	#otќД#РЙ[COMPILEЭrШї$Qn	О$	#РЗLITERAМЕШztw 
?#РИDLITERAМгШztw ЫннР†?STACЛяШЊЩtЫ|]n	Њ?Ђ n|? n	Р‰INTERPREФШїw ztbw
 $	#b $	S%b gЌt№w 
b Он%bВя‰IMMEDIATЕIШ	?@ gРЉVOCABULARЩ—Ш¦
?Ѓ #ot$	#%t#%ќ¶
ДbќРЕFORTИЇВ
ЬЃ v  ‹DEFINITIONУдШbtoќРБЁцШ?) ЛР„QUIФШQ/ќ
»кUzt$w Jokbзя…ABORФШљb
%кЪJfig-FORTH 1.1aм%zЭйѓ„WARНJШҐR* . "¦ЂнЮ"љ"%"0"*@ нЮ"""&"( нЮ""щМЭ!.э!-ЭйХ„COLД|ШҐ]ќ?*t#ќ?*t.ќ№Q?™©??&t? n? ч?t?тќ? ѓ?я Pw QќкJNo fileR„S->ДОNбнlлГ,‚+­EШIw ”РѓD+­UШIw ¤РѓABУfШзZР„DABУxШзlРѓMIО†ШCЌw ЫОРѓMAШ•ШCbw ЫОР‚MЄ«ИСбнТлГ,‚MЇБЧЩб|жЂ(нLDMбСЛ|(<е!  нЮСе!  нRСнЗ8!яяT]лнЛлЛG(нLл·(юЃ(нLХеЩЭйЃЄР!СбнТэй„/MOД0ЩБбx± яяbkэнч Ђ xюя №   нlнКХеЩЭйЃЇ'aЩБбx± !яяэнч Ђ xюя №(нlнКеЩЭйѓMOД[ЊЩБбx± яяэнч Ђ xюя №   нlнКХЩЭй…*/MOД„ѕЩб|жЂ(нLDMбСнТлЛ|(<е!  нЮСе!  нRСнЗ8!яяT]лнЛлЛG(нLл·(юЃ(нLХеЩЭй‚*ЇґЩб|жЂ(нLDMбСнТлЛ|(<е!  нЮСе!  нRСнЗ8!яялнЛ·(юЃ(нLеЩЭй…M/MOДШшQ8Ыш8Р†(LINE©LШш?@ °јјn&n?@ Р….LINЕjШsп
Р‡MESSAGЕ‘Шtw Зw ? Utј_D™ёb JMSG # ЋР‚PАЈзЩБнh& еЩЭй‚PЎашЩБбнiЩЭйѓFCВс\ „RECЈ Ш?! nРѓUSЕ
0  „PREЦ0  …#BUFЖ'  ЉDISK-ERROТ20  „+BUЖ>Ш?„ nз¤Pw Оз.tDР†UPDATЕOШ.tt? Ђh.tќРЌEMPTY-BUFFERУvШ¤їDЂРѓDR°•ШQUќРѓDR±іШ?@UќР†BUFFEТГШ#tзшVwья#ќtIw Дt?яWQЈќ.ќДР…BLOCЛХШUtnш.tзtDзnw2 V$w ОЮз]ЈЫзtDзn$wШяз.ќОДР„BDOУ…ЩБСЭеэеЩЕЩН ЩБэбЭбo& эйѓR/Ч|ШшќQД©? ѓО?" DЫѓKќР…FLUSИќШ:№QдQЮО‹шяР†EXTENДПШ°‘? Q№ї]ЈKtwряЫїnЫдыQЈ‹ця? ѓО? ѓОР„LOAДнШ/tш7tшQ7ќј/ќU7ќ/ќРГ--ѕDШз	Q7ќј/tїЉD/QР ЕХеЭеэеЩЕЩН ЩБЩэбЭббСБЙЕяНљБЙЕяНљ·(ъю >ЛїБЙЕХНљСБЙЕНљБЙНС:™·ДЫЙНІ!  ·(,эйНјю_ 	!™ ~оwk& эйС{ю 
НС НСНгЭйНг
НгЭйБ§wШї$Qn	ОнР†FORGEФ3ШotbtD? n	7зt|? n	з0	ќ	tbtќР„BACЛGШD#РЕBEGIО†Ш€	]РЕENDIЖ—Ш€	i·	їDЫќРДTHEО©Ш±РВDПЕШ
дuРДLOOРТШu·	
‹ЌРЕ+LOOРгШu·	
°ЌРЕUNTIМшШ]·	
wЌРГENДШРЕAGAIО$Ш]·	
bЌРЖREPEAФ0Шшш8Ы±РВIЖFШ
wQ#iРДELSЕaШi·	
bQ#Ыi±iРЕWHILЕvШfДР†SPACEУ—ШQ±Зw Qдё‹ьяР‚<Ј§Шё°ќР‚#ѕИШОО°tёїDР„SIGОЧШЁIw ?-  РЃЈоШ„tTЁ?	 їbw ? n?0 n Р‚#УШCh$wцяРѓD.Т1ШшЫїЌН6хЬїD°п
Р‚.ТFШшLLР‚D®jШQLёРЃ®{ШLЂРЃїЉШtЋР‚U®–ШQЂР…VLISФўШ?Ђ @ќbtt@tЊЌw
 кQ@ќз.ёёF		tз$ЭhwФяОРѓBYЕЇШЧ? ѓОQQѓР„LISФщШb
кзIќJSCR # Ћ? QдкыuoёыIt™Эw ж‹дякР…INDEШШ? єк№ЫдкыuoёQы™Эw ж‹жяР…TRIAД]Ш? єu_uuїnЫдкыЭw ж‹ряк? ­кР„.CPХ“Ш„t?$ „ќ?" КЌЂ„ќР†setclлУЩнf}.юнnЇУбУйУи!яя>Уавнїкнї>ЂУи>аУйoнnЩЭй†getclлш@Щнf}.юнn>ЂУйлн·T]гн· y•oyњgy›_yљWэныЁaеoнnЩЭй„TASЛ5ШР                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               	title	< Z280 fig-FORTH 1.1 a >
	subttl	Adaptive version
;
;
; Modified from Z80 fig-FORTH 1.1h by EHR 880830
; Modified frm FIG document keyed by Dennis L. Wilson 800907
; Converted frm "8080 FIG-FORTH VERSION A0 15SEP79"
;
; fig-FORTH release 1.1 for the 8080 processor.
;
; ALL PUBLICATIONS OF THE FORTH INTEREST GROUP
; ARE PUBLIC DOMAIN. THEY MAY BE FURTHER
; DISTRIBUTED BY THE INCLUSION OF THIS CREDIT NOTICE:
;
; This publication has been made available by the
;	Forth Interest Group
;	P.O.Box 1105
;	San Carlos, CA 94070
;	U.S.A.
;
; Implementation on 8080 by:
;	John Cassady
;	339 15th Street
;	Oakland, CA 94612
;	U.S.A
;	on 790528
; Modified by:
;	Kim Harris
; Acknowledgements:
;	George Flammer
;	Robt. D. Villwock
; ----------------------------------------------------------------------
; Z80 Version for Cromemco CDOS & Digital Research CP/M by:
;	Dennis Lee Wilson c/o
;	Aristotelian Logicians
;	2631 East Pinchot Avenue
;	Phoenix, AZ 85016
;	U.S.A.
; ----------------------------------------------------------------------
; The 2 byte Z80 code for Jump Relative (JR) has been substituted for
; the 3 byte Jump (JP) wherever practical. The port I/O words P@ & P!
; have been made ROMable by use of Z80 instructions.
; ----------------------------------------------------------------------
; Further modifications (marked ;/) by:
;	Edmund Ramm
;	P.O.Box 38
;	2358 Kaltenkirchen
;	Fed. Rep. of Germany	840418
;
; 850419	changed * (star)
; 850507	added   0<>, 0>, TUCK, NIP, -ROT, CSWAP, PICK
; 850511	added	-CMOVE
;
; -----------------------------------------------------------------------------
; Disc I/O has been modified a la Albert van der Horst (HCCH) to employ
; CP/M 2.x's random access feature.
; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------
;
; Z280 specifics
;
maclib	z280.mac
;
iopreg		equ	08h		; i/o page register
;
config0		equ	0e0h		; c/t 0 configuration register
cntrl0		equ	0e1h		; c/t 0 command/status register
tcon0		equ	0e2h		; c/t 0 time constatnt register
count0		equ	0e3h		; c/t 0 count-time register
config1		equ	0e8h		; c/t 1 configuration register
cntrl1		equ	0e9h		; c/t 1 command/status register
tcon1		equ	0eah		; c/t 1 time constant register
count1		equ	0ebh		; c/t 1 count-time register
;
; -----------------------------------------------------------------------------
;
;	Release & Version numbers
;
figrel		equ	1		;FIG RELEASE #
figrev		equ	1		;FIG REVISION #
usrver		equ	61h		;USER VERSION # a by EHR
;
;Console & printer drivers are in external source named
;CONPRTIO.FTH & disc drivers in DISCIO.FTH. It has 4 screen
;buffers & end of memory is set to FBASE from locn. 0007H.
	page
;	ASCII characters used
;
abl		equ	20h		;BLANK
acr		equ	0dh		;CR
adot		equ	2eh		;.
bell		equ	07h		;^G
bsin		equ	08h		;backspace chr = ^H
bsout		equ	08h
dle		equ	10h		;^P
lf		equ	0ah		;^J
ff		equ	0ch		;^L
;
;	Memory allocation
;
bdoss		equ	0005h		;/ system entry
nscr		equ	4		;  # of 1024 byte screens
kbbuf		equ	128		;  bytes/disc buffer
us		equ	40h		;  user variables space
rts		equ	400h		;  Return Stack & term buff space
co		equ	kbbuf+4		;  Disc buff + 2 header + 2 tail
nbuf		equ	nscr*400h/kbbuf	;  # of buffers
bufsiz		equ	co*nbuf		;/ total disc buffer size
	page
	aseg
;
	org	0100h
;
orig:
	nop
	jp	cld			; vector to cold start
	nop
	jp	wrm			; vector to warm start
	defb	figrel			; fig release #
	defb	figrev			; fig revision #
	defb	usrver			; user version #
	defb	0eh			; implementation attributes
;
;
;
;	0eh = 0000:1110
;	      ---------
; B +ORIGIN   ...W:IEBA
;
; W: 0=above sufficient
;    1=other differences exist
; I: Interpreter is	0=pre-
;			1=post incrementing
; E: Addr must be even: 0 yes
;			1 no
; B: High byte @	0=low addr.
;			1=high addr.
; A: CPU Addr.		0=BYTE
;			1=WORD
;
;
;
	defw	task-7			;  topmost word in FORTH vocabulary
	defw	bsin			;  backspace chr
upinit:	defw	0			;/ init (up)
;
; * Following used by COLD; must be in same order as user variables *
;
s0init:	defw	0			;/ init (s0)
r0init:	defw	0			;/ init (r0)
tibini:	defw	0			;/ init (TIB)
	defw	1fh			;  init (WIDTH)
	defw	0			;  init (WARNING)
	defw	initdp			;  init (FENCE)
	defw	initdp			;  init (dp)
	defw	forth+8			;  init (VOC-LINK)
;
; *  END DATA USED BY COLD *
;
	defw	0018h,0f600h		; Z280 CPU name (hw,lw)
					; (32 bit base 36 integer)
	page
;	REGISTERS
;
;	FORTH	Z80	FORTH PRESERVATION RULES
;	-----	---	-----------------------
;	IP	BC	should be preserved
;			accross FORTH words.
;	W	DE	sometimes output from
;			NEXT, may be altered
;			b4 JP'ing to NEXT,
;			input only when 
;			"DPUSH" called.
;	SP	SP	should be used only as
;			Data Stack accross
;			FORTH words, may be
;			used within FORTH
;			words if restored
;			b4 "NEXT"
;		HL	Never output frm NEXT
;			input only when
;			"HPUSH" called
;
;
up:	defw	0			;/ user area ptr
rpp:	defw	0			;/ return stack ptr
buf1:	defw	0			;/ address of 1st disc buffer
;
;
;	COMMENT CONVENTIONS:
;
;	==	means "is equal to"
;	<--	means assignment
;	#NAME	=     value of name
;	NAME    =     contents @ name
;	(NAME)  =     contents of cell addressed by name
;	cfa	=     code field address
;	lfa	=     link field address
;	nfa	=     name field address
;	pfa	=     parameter field address
;	s1	=     1st word of parameter stack
;	s2	=     2nd -"-  of    -"-     -"-
;	r1	=     1st -"-  of return stack
;	r2	=     2nd -"-  of  -"-    -"-
; ( above Stack posn. valid b4 & after execution of any word, not during)
;
;	lsb	=     least significant bit
;	msb	=     most  significant bit
;	lb	=     low  byte
;	hb	=     high byte
;	lw	=     low  word
;	hw	=     high word
; (May be used as suffix to above names)
	page
;	FORTH ADDRESS INTERPRETER
;	POST INCREMENTING VERSION
;
;
;
dpush:
	push	de
hpush:
	push	hl			; iy points here
next:
	ld	h,b			;/ w <-- (ip)    ix points here
	ld	l,c			;/
;	ldw	hl,(hl)			;/ (hl) --> cfa
	defb	0edh,26h
	inc	bc
	inc	bc			;/ ip += 2
next1:
;	ldw	de,(hl)			;/ pc <-- (w)
	defb	0edh,16h
	ex	de,hl
	inc	de
	jp	(hl)			; note: de <-- cfa + 1
;
;
jnext	macro
	jp	(ix)
	endm
;
jhpush	macro
	jp	(iy)
	endm
;
	page
;	FORTH DICTIONARY
;	DICTIONARY FORMAT:
;
;				BYTE
;	ADDRESS NAME		CONTENTS
;	------- ----		--------
;						(MSB=1
;						(P=PRECEDENCE BIT
;						(S=SMUDGE BIT
;	NFA	NAME FIELD	1PS<LEN>	<NAME LENGTH
;				0<1CHAR>	MSB=0, NAME'S 1st CHAR
;				0<2CHAR>
;				  ...
;				1<LCHAR>	MSB=1, NAME'S LAST CHAR
;	LFA	LINK FIELD	<LINKLB>	=PREVIOUS WORD'S NFA
;				<LINKHB>
;LABEL:	CFA	CODE FIELD	<CODELB>	=ADDR CPU CODE
;				<CODEHB>
;	PFA	PARAMETER	<1PARAM>	1st PARAMETER BYTE
;		FIELD		<2PARAM>
;				  ...
;
;
;
dp0:
	defb	83h			; LIT
	defc	'LIT'
	defw	0			; lfa == 0 marks end of dictionary 
lit:
	defw	$+2			; s1 <-- (ip)
	ld	h,b
	ld	l,c
	defb	0edh,26h		;/ ldw hl,(hl)   hl <-- (ip) = literal
	inc	bc			;/
	inc	bc			;/ ip += 2
	jhpush				; s1 <-- hl
;
;
	defb	87h			; EXECUTE
	defc	'EXECUTE'
	defw	lit-6
exec:
	defw	$+2
	pop	hl
	jp	next1
;
;
	defb	86h			; BRANCH
	defc	'BRANCH'
	defw	exec-0ah
bran:
	defw	$+2			; ip += (ip)
bran1:
	ld	h,b
	ld	l,c			; hl <-- ip
	defb	0ddh,0edh,0c6h	;/ addw hl,(hl)  hl <-- ip + branch offset
	ld	c,l
	ld	b,h			; ip += branch offset
	jnext
;
;
	defb	87h			; 0BRANCH
	defc	'0BRANCH'
	defw	bran-9
zbran:
	defw	$+2
	pop	hl
	ld	a,l
	or	h
	jr	z,bran1			; branch if if s1 == 0
	inc	bc			; else skip branch offset
	inc	bc
	jnext
;
;
	defb	86h			; (LOOP)
	defc	'(LOOP)'
	defw	zbran-0ah
xloop:
	defw	$+2
	ld	hl,(rpp)		; (hl) --> index = r1
;	incw	(hl)			;/ index += 1
	defb	0ddh,03h
;	ldw	de,(hl)			;/ de <-- new index
	defb	0edh,16h
	inc	hl			;/
	inc	hl			;/ hl --> limit(lb)
	ld	a,e
	sub	(hl)
	ld	a,d
	inc	hl			; hl --> limit(hb)
	sbc	a,(hl)			; index < limit?
	jp	m,bran1			; yes, loop again
	inc	hl			; no, done
	ld	(rpp),hl		; discard r1 & r2
	inc	bc
	inc	bc			; skip branch offset
	jnext
;
;
	defb	87h			; (+LOOP)
	defc	'(+LOOP)'
	defw	xloop-9
xploo:
	defw	$+2
	pop	de			; de <-- increment
	ld	hl,(rpp)		; hl --> index
	ld	a,(hl)			; index += increment
	add	a,e
	ld	(hl),a
	ld	e,a
	inc	hl
	ld	a,(hl)
	adc	a,d
	ld	(hl),a
	inc	hl			; (hl) --> limit
	inc	d
	dec	d
	ld	d,a			; de <-- new index
	jp	m,xloo2			; if incr > 0
	ld	a,e
	sub	(hl)			; then a <-- index - limit
	ld	a,d
	inc	hl
	sbc	a,(hl)
	jp	xloo3

xloo2:
	ld	a,(hl)			; else  a <-- limit - index
	sub	e
	inc	hl
	ld	a,(hl)
	sbc	a,d
;					; if a < 0
xloo3:
	jp	m,bran1			; then loop again
	inc	hl			; else done
	ld	(rpp),hl		; discard r1 & r2
	inc	bc			; skip branch offset
	inc	bc
	jnext
;
;
	defb	84h			;  (DO)
	defc	'(DO)'
	defw	xploo-0ah
xdo:
	defw	$+2
	pop	de			;  de <-- initial index
	ld	hl,(rpp)		;  hl <-- rp
	dec	hl
	dec	hl
;	pop	(hl)			;/ r2 <-- limit
	defb	0ddh,0c1h
	dec	hl
	dec	hl
;	ldw	(hl),de			;/ r1 <-- initial index
	defb	0edh,1eh
	ld	(rpp),hl		;  rp -= 4
	jnext
;
;
	defb	81h			; I
	defc	'I'
	defw	xdo-7
ido:
	defw	$+2
	ld	hl,(rpp)
;	push	(hl)			;/ s1 <-- r1, r1 unchanged
	defb	0ddh,0c5h
	jnext
;
;
	defb	85h			; DIGIT
	defc	'DIGIT'
	defw	ido-4
digit:
	defw	$+2
	pop	hl			; l <-- s1.lb = base value
	pop	de			; e <-- s2.lb = chr to be converted
	ld	a,e			; a <-- chr
	sub	'0'			; >= 0?
	jr	c,digi2			;/ < 0 is invalid
	cp	0ah			; > 9?
	jr	c,digi1			;/ no, test base value
	sub	07h			; gap between '9' & 'A', nw 'A'=0ah
	cp	0ah			; >= 'A'?
	jr	c,digi2			;/ chrs btwn '9' & 'A' are invalid
digi1:
	cp	l			; < base value?
	jr	nc,digi2		;/ no, invalid
	ld	e,a			; s2 <-- de = converted digit
	ld	hl,0001h		; s1 <-- true
	jp	dpush
;
digi2:
	ld	l,h			; hl <-- false
	jhpush				; s1 <-- false
;
;
	defb	86h			; (FIND) (2-1)FAILURE
	defc	'(FIND)'		;        (2-3)SUCCESS
	defw	digit-8
pfind:
	defw	$+2
	pop	de			; de <-- nfa
pfin1:
	pop	hl			; hl <-- string addr
	push	hl			; save for next iteration
	ld	a,(de)
	xor	(hl)			; filter differences
	and	3fh			; mask msb & precedence bit
	jr	nz,pfin4		; lengths differ
pfin2:
	inc	hl			; hl --> next string chr
	inc	de			; de --> next name field chr
	ld	a,(de)
	xor	(hl)			; filter differences
	add	a,a			; shift msbit into carry
	jr	nz,pfin3		; no match
	jr	nc,pfin2		; match so far, loop agn
	ld	hl,0005h		; string matches
	add	hl,de			; (sp) <-- pfa
	ex	(sp),hl
pfin6:
	dec	de			; de --> nfa
	ld	a,(de)
	or	a			; msb=1? =length byte
	jp	p,pfin6			; no, try next chr
	ld	e,a			; e <-- length byte
	ld	d,00h
	ld	hl,0001h		; hl <-- true
	jp	dpush			; name field found, return
;
; above name field not a match, try next one
;
pfin3:
	jr	c,pfin5			; carry=end of name field
pfin4:
	inc	de			; find name field end
	ld	a,(de)
	or	a			; msb=1?
	jp	p,pfin4			; no, loop
pfin5:
	inc	de			; de <-- lfa
	ex	de,hl
;	ldw	de,(hl)			;/ de <-- lfa
	defb	0edh,16h
	ld	a,d
	or	e			; end of dictionary (lfa = 0)?
	jr	nz,pfin1		; no, try previous definition
	pop	hl			; drop string address
	ld	hl,0			; hl <-- false
	jhpush				; no match found, return
;
;
	defb	87h			; ENCLOSE
	defc	'ENCLOSE'
	defw	pfind-9
encl:
	defw	$+2
	pop	de			; de <-- s1 = delimiter chr
	pop	hl			; hl <-- s2 = addr of text to scan
	push	hl			; s4 <-- addr
	ld	a,e
	ld	d,a			; d <-- delim chr
	ld	e,-1			; init chr offset counter
	dec	hl			; hl <-- addr - 1
encl1:
	inc	hl			; skip over leading delim chrs
	inc	e
	cp	(hl)			; delim chr?
	jr	z,encl1			; yes, loop
	ld	d,0
	push	de			; s3 <-- e = offset to 1st non delim
	ld	d,a			; d <-- delim chr
	ld	a,(hl)
	and	a			; 1st non-delim=null?
	jr	nz,encl2		; no
	ld	d,0			; yes
	inc	e
	push	de			; s2 <-- offset to byte following null
	dec	e
	push	de			; s1 <-- offset to null
	jnext
;
encl2:
	ld	a,d			; A <-- delim chr
	inc	hl			; hl <-- next chr's address
	inc	e			; e <-- offset to next chr
	cp	(hl)			; delim chr?
	jr	z,encl4			; yes
	ld	a,(hl)
	and	a			; null?
	jr	nz,encl2		; no, continue scan
encl3:
	ld	d,0
	push	de			; s2 <-- offset to null
	push	de			; s1 <-- offset to null
	jnext
;
encl4:
	ld	d,0
	push	de			; s2 <-- offset to byte following text
	inc	e
	push	de			; s1 <-- offset 2 bytes aft end of word
	jnext
;
;
	defb	84h			; EMIT
	defc	'EMIT'
	defw	encl-0ah
emit:
	defw	docol
	defw	pemit
	defw	one,outt
	defw	pstor,semis
;
;
	defb	83h			; KEY
	defc	'KEY'
	defw	emit-7
key:
	defw	$+2
	jp	pkey
;
;
	defb	89h			; ?TERMINAL
	defc	'?TERMINAL'
	defw	key-6
qterm:
	defw	$+2
	ld	hl,0
	jp	pqter
;
;
	defb	82h			; CR
	defc	'CR'
	defw	qterm-0ch
cr:
	defw	$+2
	jp	pcr
;
;
	defb	85h			; CMOVE
	defc	'CMOVE'
	defw	cr-5
cmove:
	defw	$+2
	exx				;/ save ip
	pop	bc			;  bc <-- s1 = # of chrs
	pop	de			;  de <-- s2 = dest addr
	pop	hl			;/ hl <-- s3 = source addr
	ld	a,b
	or	c			;  bc=0?
	jr	z,cmove1		;  yes, nothing to move
	ldir				;/ xfer string
cmove1:
	exx				;/ restore ip
	jnext
;
;
	defb	86h			;/   -CMOVE    ( from to count --- )
	defc	'-CMOVE'
	defw	cmove-8
bcmov:
	defw	$+2
	exx				; save ip
	pop	bc			; bc <-- count
	pop	de			; de <-- destination
	pop	hl			; hl <-- source
	ld	a,b
	or	c			; bc =0?
	jr	z,bcmov1		; yes, nothing to move
	add	hl,bc
	dec	hl			; hl --> hi end of source block
	ex	de,hl
	add	hl,bc
	dec	hl
	ex	de,hl			; de --> hi end of dest. block
	lddr				; (de) <-- (hl), --hl,bc until bc=0
bcmov1:
	exx				; restore ip
	jnext
;
;
	defb	82h			; U*   16*16 unsigned multiply
	defc	'U*'			;      with 32 bit result
	defw	bcmov-9
ustar:
	defw	$+2
	pop	de			; de <-- multiplier
	pop	hl			; hl <-- multiplicant
;	multuw	hl,de			;/
	defb	0edh,0d3h
	ex	de,hl			;/ de <-- product.lw, hl <-- product.hw
	jp	dpush			; s2,s1 <-- product.lw,hw
;
;
	defb	82h			; U/   ( ud u1 -- urem uq )
	defc	'U/'
	defw	ustar-5
uslas:
	defw	$+2
	exx				;/ save ip
	pop	bc			; bc <-- divisor
	pop	hl			; hl <-- dividend.hw
	pop	de			; de <-- dividend.lw
;	cpw	hl,bc			;/ dividend.hw >= divisor?
	defb	0edh,0c7h
	jr	c,usla1			; no, go ahead
	ld	hl,0ffffh		; yes, overflow
	ld	d,h
	ld	e,l			;/ set rem & quot to max
	jr	usla2
usla1:
	ex	de,hl			;/ de,hl <-- dividend.hw,lw
;	divuw	dehl,bc			;/ de <-- remainder, hl <-- quotient
	defb	0edh,0cbh
usla2:
	push	de			;/ s2 <-- remainder
	push	hl			;/ s1 <-- quotient
	exx				;/ restore ip
	jnext
;
;
	defb	83h			; AND
	defc	'AND'
	defw	uslas-5
andd:
	defw	$+2			; s1 <-- s1 AND s2
	pop	de
	pop	hl
	ld	a,e
	and	l
	ld	l,a
	ld	a,d
	and	h
	ld	h,a
	jhpush
;
;
	defb	82h			; OR
	defc	'OR'
	defw	andd-6
orr:
	defw	$+2			; s1 <-- s1 OR s2
	pop	de
	pop	hl
	ld	a,e
	or	l
	ld	l,a
	ld	a,d
	or	h
	ld	h,a
	jhpush
;
;
	defb	83h			; XOR
	defc	'XOR'
	defw	orr-5
xorr:
	defw	$+2			; s1 <-- s1 XOR s2
	pop	de
	pop	hl
	ld	a,e
	xor	l
	ld	l,a
	ld	a,d
	xor	h
	ld	h,a
	jhpush
;
;
	defb	83h			; SP@
	defc	'SP@'
	defw	xorr-6
spat:
	defw	$+2
	ld	hl,0
	add	hl,sp			; hl <-- sp
	jhpush				; s1 <-- sp
;
;
	defb	83h			; SP!
	defc	'SP!'
	defw	spat-6
spsto:
	defw	$+2			; sp <-- s0  (user variable)
	ld	hl,(up)			; hl <-- user variables base address
	ld	de,0006h
	add	hl,de			; hl --> s0
;	ldw	hl,(hl)			;/ hl <-- s0
	defb	0edh,26h
	ld	sp,hl			; sp <-- s0
	jnext
;
;
	defb	83h			; RP@
	defc	'RP@'
	defw	spsto-6
rpat:
	defw	$+2
	ld	hl,(rpp)
	jhpush				; s1 <-- rp
;
;
	defb	83h			; RP!
	defc	'RP!'
	defw	rpat-6
rpsto:
	defw	$+2			; rp <-- r0 (user variable)
	ld	hl,(up)			; hl <-- user variables base address
	ld	de,0008h
	add	hl,de			; hl --> r0
;	ldw	hl,(hl)			;/ hl <-- r0
	defb	0edh,26h
	ld	(rpp),hl		;/ rp <-- r0
	jnext
;
;
	defb	82h			; ;S
	defc	';S'
	defw	rpsto-6
semis:
	defw	$+2			; ip <-- r1 
	ld	hl,(rpp)
;	ldw	bc,(hl)			;/ bc <-- r1
	defb	0edh,06h
	inc	hl
	inc	hl
	ld	(rpp),hl		; rp += 2
	jnext
;
;
	defb	85h			; LEAVE
	defc	'LEAVE'
	defw	semis-5
leave:
	defw	$+2			; limit <-- index
	ld	hl,(rpp)
;	ldw	de,(hl)			;/ de <-- r1 (= index)
	defb	0edh,16h
	inc	hl
	inc	hl
;	ldw	(hl),de			;/ r2 (= limit) <-- index
	defb	0edh,1eh
	jnext
;
;
	defb	82h			; >R
	defc	'>R'
	defw	leave-8
tor:
	defw	$+2
	ld	hl,(rpp)
	dec	hl
	dec	hl
;	pop	(hl)			;/ r1 <-- s1
	defb	0ddh,0c1h
	ld	(rpp),hl		;  rp -= 2
	jnext
;
;
	defb	82h			; R>
	defc	'R>'
	defw	tor-5
fromr:
	defw	$+2
	ld	hl,(rpp)
;	push	(hl)			;/ s1 <-- r1
	defb	0ddh,0c5h
	inc	hl
	inc	hl
	ld	(rpp),hl		; rp += 2
	jnext
;
;
	defb	81h			; R
	defc	'R'
	defw	fromr-5
rr:
	defw	ido+2
;
;
	defb	82h			; 0=
	defc	'0='
	defw	rr-4
zequ:
	defw	$+2
	pop	de
	ld	hl,0
;	cpw	hl,de			;/
	defb	0edh,0d7h
	jr	nz,zequ1
	inc	l			; hl <-- true
zequ1:
	jhpush
;
;
	defb	83h			;/ 0<>
	defc	'0<>'
	defw	zequ-5
znequ:
	defw	$+2
	pop	de
	ld	hl,0
;	cpw	hl,de			;/
	defb	0edh,0d7h
	jr	z,znequ1
	inc	l			; hl <-- true
znequ1:
	jhpush
;
;
	defb	82h			; 0<
	defc	'0<'
	defw	znequ-6
zless:
	defw	$+2
	pop	af			;/ a <-- s1.hb
	rla				;/ carry <-- bit 7
	ld	hl,0			;  hl <-- false
	rl	l			;/ bit 0 <-- carry
	jhpush
;
;
	defb	82h			;/ 0>
	defc	'0>'
	defw	zless-5
zgt:
	defw	$+2
	pop	de
	ld	hl,0
;	cpw	hl,de			;/
	defb	0edh,0d7h
	jp	p,zgt1			;/ <= 0
	jp	pe,zgt1			;/ 8000h special case
	inc	l			;/ hl <-- true
zgt1:
	jhpush
;
;
	defb	81h		;+
	defc	'+'
	defw	zgt-5
plus:
	defw	$+2
	pop	de
	pop	hl
	add	hl,de
	jhpush
;
;
	defb	82h			; D+ ( d1l d1h d2l d2h -- d3l d3h)
	defc	'D+'
	defw	plus-4
dplus:
	defw	$+2
	exx				;/ save ip
	pop	bc			;  bc <-- d2.hw
	pop	hl			;  hl <-- d2.lw
	pop	af			;d af <-- d1.hw
	pop	de			;  de <-- d1.lw
	push	af			;/ s1 <-- d1.hw
	add	hl,de			;  hl <-- d2.lw + d1.lw (= d3.lw)
	ex	de,hl			;  de <-- d3.lw
	pop	hl			;  hl <-- d1.hw
	adc	hl,bc			;/ hl <-- d1.hw + d2.hw +carry (=d3.hw)
	push	de			;  s2 <-- d3.lw
	push	hl			;/ s1 <-- d3.hw
	exx				;/ restore ip
	jnext
;
;
	defb	85h			; MINUS
	defc	'MINUS'
	defw	dplus-5
minus:
	defw	$+2
	pop	hl			;/
;	neg	hl			;/
	defb	0edh,4ch
	jhpush
;
;
	defb	86h			; DMINUS
	defc	'DMINUS'
	defw	minus-8
dminu:
	defw	$+2
	exx				;/ save ip
	pop	de			;/ de <-- d1.hw
	pop	bc			;/ bc <-- d1.lw
	ld	hl,0			;/
;	subw	hl,bc			;/
	defb	0edh,0ceh
	push	hl			; s2 <-- d2.lw
	ld	hl,0			;/
	sbc	hl,de			;/
	push	hl			; s1 <-- d2.hw
	exx				;/
	jnext
;
;
	defb	84h			; OVER
	defc	'OVER'
	defw	dminu-9
over:
	defw	$+2
;	ldw	hl,(sp+2)		;/
	defb	0edh,04h,02h,00h
	jhpush				;/
;
;
	defb	84h			; DROP
	defc	'DROP'
	defw	over-7
drop:
	defw	$+2
	inc	sp
	inc	sp			;/ faster on z280 than dummy pop
	jnext
;
;
	defb	84h			; SWAP
	defc	'SWAP'
	defw	drop-7
swap:
	defw	$+2
	pop	hl
	ex	(sp),hl
	jhpush
;
;
	defb	83h			; DUP
	defc	'DUP'
	defw	swap-7
dup:
	defw	$+2
;	ldw	hl,(sp+0)		;/
	defb	0edh,04h,0,0
	jhpush
;
;
	defb	84h			;/ TUCK     ( n1 n2 --- n2 n1 n2)
	defc	'TUCK'
	defw	dup-6
tuck:
	defw	$+2
	pop	hl			;/ hl <-- s1
	pop	de			;/ de <-- s2
	push	hl			;/ s3 <-- hl
	jp	dpush
;
;
	defb	83h			;/ NIP      ( n1 n2 --- n2)
	defc	'NIP'
	defw	tuck-7
nip:
	defw	$+2
	pop	hl			; hl <-- s1
;	ldw	(sp+0),hl		;/ s1 <-- hl
	defb	0edh,05h,0,0
	jnext
;
;
	defb	84h			;/ -ROT     ( n1 n2 n3 --- n3 n1 n2)
	defc	'-ROT'
	defw	nip-6
mrot:
	defw	$+2
	pop	hl
	pop	de
	ex	(sp),hl
	ex	de,hl
	jp	dpush
;
;
	defb	85h			;/ CSWAP   ( n1 --- n1, bytes swapped)
	defc	'CSWAP'
	defw	mrot-7
cswap:
	defw	$+2
	pop	hl
;	ex	h,l			;/
	defb	0edh,0efh
	jhpush
;
;
	defb	84h			;/ PICK   ( nn...n0 k --- nn..n0 nk)
	defc	'PICK'
	defw	cswap-8
pick:
	defw	$+2
	pop	hl			; hl <-- depth
	add	hl,hl			; adjust to word size
	add	hl,sp			; offset into stack
;	push	(hl)			;/
	defb	0ddh,0c5h
	jnext
;
;
	defb	84h			; 2DUP
	defc	'2DUP'
	defw	pick-7
tdup:
	defw	$+2
	pop	hl
	pop	de
	push	de
	push	hl
	jp	dpush
;
;
	defb	82h			; +!
	defc	'+!'
	defw	tdup-7
pstor:
	defw	$+2
	pop	hl			; hl --> variable
	pop	de			; de <-- number
	ld	a,(hl)
	add	a,e
	ld	(hl),a
	inc	hl
	ld	a,(hl)
	adc	a,d
	ld	(hl),a			; (hl) += number
	jnext
;
;
	defb	86h			; TOGGLE
	defc	'TOGGLE'
	defw	pstor-5
toggl:
	defw	$+2
	pop	de			; e <-- bit pattern
	pop	hl			; hl --> address
	ld	a,(hl)
	xor	e
	ld	(hl),a
	jnext
;
;
	defb	81h			; @
	defc	'@'
	defw	toggl-9
at:
	defw	$+2
	pop	hl
;	push	(hl)			;/
	defb	0ddh,0c5h
	jnext
;
;
	defb	82h			; C@
	defc	'C@'
	defw	at-4
cat:
	defw	$+2
	pop	hl
	ld	l,(hl)
	ld	h,0
	jhpush
;
;
	defb	82h			; 2@
	defc	'2@'
	defw	cat-5
tat:
	defw	$+2
	pop	hl			;  hl --> address
;	ldw	de,(hl)			;/ de <-- d.hw
	defb	0edh,16h
	inc	hl
	inc	hl			;  hl --> d.lw
;	push	(hl)			;/ s2 <-- d.lw
	defb	0ddh,0c5h
	push	de			;/ s1 <-- d.hw
	jnext
;
;
	defb	81h			; !
	defc	'!'
	defw	tat-5
store:
	defw	$+2
	pop	hl			; hl --> address
;	pop	(hl)			;/
	defb	0ddh,0c1h
	jnext
;
;
	defb	82h			; C!
	defc	'C!'
	defw	store-4
cstor:
	defw	$+2
	pop	hl			; hl --> address
	pop	de			; e <-- char
	ld	(hl),e
	jnext
;
;
	defb	82h			; 2!
	defc	'2!'
	defw	cstor-5
tstor:
	defw	$+2
	pop	hl			; hl --> address
;	pop	(hl)			;/ store d.hw
	defb	0ddh,0c1h
	inc	hl
	inc	hl
;	pop	(hl)			;/ store d.lw
	defb	0ddh,0c1h
	jnext
;
;
	defb	0c1h			; :
	defc	':'
	defw	tstor-5
colon:
	defw	docol
	defw	qexec
	defw	scsp
	defw	curr
	defw	at
	defw	cont
	defw	store
	defw	creat
	defw	rbrac
	defw	pscod
docol:
	ld	hl,(rpp)
	dec	hl
	dec	hl
;	ldw	(hl),bc			;/ save return address
	defb	0edh,0eh
	ld	(rpp),hl
	inc	de
	ld	c,e
	ld	b,d
	jnext
;
;
	defb	0c1h			; ;
	defc	';'
	defw	colon-4
semi:
	defw	docol
	defw	qcsp
	defw	comp
	defw	semis
	defw	smudg
	defw	lbrac
	defw	semis
;
;
	defb	84h			; NOOP
	defc	'NOOP'
	defw	semi-4
noop:
	defw	docol
	defw	semis
;
;
	defb	88h			; CONSTANT
	defc	'CONSTANT'
	defw	noop-7
con:
	defw	docol
	defw	creat
	defw	smudg
	defw	comma
	defw	pscod
docon:
	inc	de
	ex	de,hl
;	push	(hl)			;/
	defb	0ddh,0c5h
	jnext
;
;
	defb	88h			; VARIABLE
	defc	'VARIABLE'
	defw	con-0bh
var:
	defw	docol
	defw	con
	defw	pscod
dovar:
	inc	de
	push	de
	jnext
;
;
	defb	84h			; USER
	defc	'USER'
	defw	var-0bh
user:
	defw	docol
	defw	con
	defw	pscod
douse:
	inc	de
	ex	de,hl
	ld	l,(hl)			;/
	ld	h,0			;/
;	addw	hl,(up)			;/
	defb	0ddh,0edh,0d6h
	defw	up
	jhpush
;
;
	defb	81h			; 0
	defc	'0'
	defw	user-7
zero:
	defw	$+2			;/
;	push	0000h			;/
	defb	0fdh,0f5h,0,0
	jnext
;
;
	defb	81h			; 1
	defc	'1'
	defw	zero-4
one:
	defw	$+2			;/
;	push	0001h			;/
	defb	0fdh,0f5h,1,0
	jnext
;
;
	defb	81h			; 2
	defc	'2'
	defw	one-4
two:
	defw	$+2			;/
;	push	0002h			;/
	defb	0fdh,0f5h,2,0
	jnext
;
;
	defb	81h			; 3
	defc	'3'
	defw	two-4
three:
	defw	$+2			;/
;	push	0003h			;/
	defb	0fdh,0f5h,3,0
	jnext
;
;
	defb	82h			; BL
	defc	'BL'
	defw	three-4
bl:
	defw	docon
	defw	20h
;
;
	defb	83h			; C/L
	defc	'C/L'
	defw	bl-5
csll:
	defw	docon
	defw	64
;
;
	defb	85h			; FIRST
	defc	'FIRST'
	defw	csll-6
first:
	defw	docon
	defw	0			;/ set by CLD
;
;
	defb	85h			; LIMIT
	defc	'LIMIT'
	defw	first-8
limit:
	defw	docon
	defw	0			;/ set by CLD
;
;
	defb	85h			; B/BUF
	defc	'B/BUF'
	defw	limit-8
bbuf:
	defw	docon
	defw	kbbuf
;
;
	defb	85h			; B/SCR
	defc	'B/SCR'
	defw	bbuf-8
bscr:
	defw	docon
	defw	400h/kbbuf
;
;
	defb	87h			; +ORIGIN
	defc	'+ORIGIN'
	defw	bscr-8
porig:
	defw	docol
	defw	lit
	defw	orig
	defw	plus
	defw	semis
;
;	USER VARIABLES
;
	defb	82h			; S0
	defc	'S0'
	defw	porig-0ah
szero:
	defw	douse
	defw	6
;
;
	defb	82h			; R0
	defc	'R0'
	defw	szero-5
rzero:
	defw	douse
	defw	8
;
;
	defb	83h			; TIB
	defc	'TIB'
	defw	rzero-5
tib:
	defw	douse
	defb	0ah
;
;
	defb	85h			; WIDTH
	defc	'WIDTH'
	defw	tib-6
width:
	defw	douse
	defb	0ch
;
;
	defb	87h			; WARNING
	defc	'WARNING'
	defw	width-8
warn:
	defw	douse
	defb	0eh
;
;
	defb	85h			; FENCE
	defc	'FENCE'
	defw	warn-0ah
fence:
	defw	douse
	defb	10h
;
;
	defb	82h			; DP
	defc	'DP'
	defw	fence-8
dp:
	defw	douse
	defb	12h
;
;
	defb	88h			; VOC-LINK
	defc	'VOC-LINK'
	defw	dp-5
vocl:
	defw	douse
	defw	14h
;
;
	defb	83h			; BLK
	defc	'BLK'
	defw	vocl-0bh
blk:
	defw	douse
	defb	16h
;
;
	defb	82h			; IN
	defc	'IN'
	defw	blk-6
inn:
	defw	douse
	defb	18h
;
;
	defb	83h			; OUT
	defc	'OUT'
	defw	inn-5
outt:
	defw	douse
	defb	1ah
;
;
	defb	83h			; SCR
	defc	'SCR'
	defw	outt-6
scr:
	defw	douse
	defb	1ch
;
;
	defb	86h			; OFFSET
	defc	'OFFSET'
	defw	scr-6
ofset:
	defw	douse
	defb	1eh
;
;
	defb	87h			; CONTEXT
	defc	'CONTEXT'
	defw	ofset-9
cont:
	defw	douse
	defb	20h
;
;
	defb	87h			; CURRENT
	defc	'CURRENT'
	defw	cont-0ah
curr:
	defw	douse
	defb	22h
;
;
	defb	85h			; STATE
	defc	'STATE'
	defw	curr-0ah
state:
	defw	douse
	defb	24h
;
;
	defb	84h			; BASE
	defc	'BASE'
	defw	state-8
base:
	defw	douse
	defb	26h
;
;
	defb	83h			; DPL
	defc	'DPL'
	defw	base-7
dpl:
	defw	douse
	defb	28h
;
;
	defb	83h			; FLD
	defc	'FLD'
	defw	dpl-6
fld:
	defw	douse
	defb	2ah
;
;
	defb	83h			; CSP
	defc	'CSP'
	defw	fld-6
cspp:
	defw	douse
	defb	2ch
;

	defb	82h			; R#
	defc	'R#'
	defw	cspp-6
rnum:
	defw	douse
	defb	2eh
;

	defb	83h			; HLD
	defc	'HLD'
	defw	rnum-5
hld:
	defw	douse
	defw	30h
;
;	END OF USER VARIABLES
;
	defb	82h			; 1+
	defc	'1+'
	defw	hld-6
onep:
	defw	$+2			;/
	pop	hl			;/
	inc	hl			;/
	jhpush				;/
;
;
	defb	82h			; 2+
	defc	'2+'
	defw	onep-5
twop:
	defw	$+2			;/
	pop	hl			;/
	inc	hl			;/
	inc	hl			;/
	jhpush				;/
;
;
	defb	82h			;/ 1-
	defc	'1-'			;/
	defw	twop-5			;/
onemin:
	defw	$+2			;/
	pop	hl			;/
	dec	hl			;/
	jhpush				;/
;
;
	defb	82h			;/ 2-
	defc	'2-'			;/
	defw	onemin-5		;/
twomin:
	defw	$+2			;/
	pop	hl			;/
	dec	hl			;/
	dec	hl			;/
	jhpush				;/
;
;
	defb	82h			;/ 2*
	defc	'2*'			;/
	defw	twomin-5		;/
twosta:
	defw	$+2			;/
	pop	hl			;/
	add	hl,hl			;/ asl hl
	jhpush				;/
;
;
	defb	82h			;/ 2/
	defc	'2/'			;/
	defw	twosta-5		;/
twosla:
	defw	$+2			;/
	pop	hl			;/
	bit	7,h			;/ negative?
	jr	z,twosl1		;/ no
	inc	hl			;/ yes, add 1
twosl1:
	sra	h			;/
	rr	l			;/ asr hl
	jhpush				;/
;
;
	defb	84h			; HERE
	defc	'HERE'
	defw	twosla-5
here:
	defw	docol
	defw	dp
	defw	at
	defw	semis
;
;
	defb	85h			; ALLOT
	defc	'ALLOT'
	defw	here-7
allot:
	defw	docol
	defw	dp
	defw	pstor
	defw	semis
;
;
	defb	81h			; ,
	defc	','
	defw	allot-8
comma:
	defw	docol
	defw	here
	defw	store
	defw	two
	defw	allot
	defw	semis
;

	defb	82h			; C,
	defc	'C,'
	defw	comma-4
ccomm:
	defw	docol
	defw	here
	defw	cstor
	defw	one
	defw	allot
	defw	semis
;
;
	defb	81h			; -
	defc	'-'
	defw	ccomm-5
subb:
	defw	$+2
	pop	de
	pop	hl
;	subw	hl,de			;/
	defb	0edh,0deh
	jhpush
;
;
	defb	81h			; =
	defc	'='
	defw	subb-4
equal:
	defw	$+2			;/
	pop	de			;/
	pop	hl			;/
;	subw	hl,de			;/
	defb	0edh,0deh
	ld	hl,0			;  hl <-- false
	jr	nz,equal1
	inc	l			;/ hl <-- true
equal1:
	jhpush
;
;
	defb	81h			;  <
	defc	'<'
	defw	equal-4
less:
	defw	$+2
	pop	de
	pop	hl			; hl de <
	ld	a,d
	xor	h			; one operand negative?
	jp	m,less1			; yes, determine which
;	subw	hl,de			;/
	defb	0edh,0deh
less1:
	bit	7,h			;/ h negative?
	ld	hl,0			; hl <-- false
	jr	z,less2
	inc	l			;/ hl <-- true
less2:
	jhpush
;
;
	defb	82h			; U<
	defc	'U<'
	defw	less-4
uless:
	defw	$+2
	pop	de
	pop	hl			;/ hl de U<
;	subw	hl,de			;/
	defb	0edh,0deh
	ld	hl,0			; hl <-- false
	rl	l			;/ bit 0 <-- carry
uless1:
	jhpush
;
;
	defb	81h			; >
	defc	'>'
	defw	uless-5
great:
	defw	$+2
	pop	hl			;/
	pop	de			;/ hl de >    (= de hl < )
	ld	a,d
	xor	h			; one operand negative?
	jp	m,great1		; yes, determine which
;	subw	hl,de			;/
	defb	0edh,0deh
great1:
	bit	7,h			;/ h negative?
	ld	hl,0			; hl <-- false
	jr	z,great2
	inc	l			;/ hl <-- true
great2:
	jhpush
;
;
	defb	83h			; ROT     ( n1 n2 n3 --- n2 n3 n1)
	defc	'ROT'
	defw	great-4
rot:
	defw	$+2
	pop	de			; de <-- n3
	pop	hl			; hl <-- n2
	ex	(sp),hl			; s1 <-- n2, hl <-- n1
	jp	dpush			; s2 <-- n3, s3 <-- n1
;
;
	defb	85h			; SPACE
	defc	'SPACE'
	defw	rot-6
space:
	defw	docol
	defw	bl
	defw	emit
	defw	semis
;
;
	defb	84h			; -DUP
	defc	'-DUP'
	defw	space-8
ddup:
	defw	$+2		;/
;	ldw	hl,(sp+0)		;/
	defb	0edh,04h,0,0
	ld	a,h			;/
	or	l			;/ hl = 0?
	jr	z,ddup1			;/ yes, don't dup
	push	hl			;/
ddup1:
	jnext
;
;
	defb	88h			; TRAVERSE
	defc	'TRAVERSE'
	defw	ddup-7
trav:
	defw	docol
	defw	swap
trav1:
	defw	over			; begin
	defw	plus
	defw	lit
	defw	7fh
	defw	over
	defw	cat
	defw	less
	defw	zbran			; until
	defw	trav1-$
	defw	swap
	defw	drop
	defw	semis
;
;
	defb	86h			; LATEST
	defc	'LATEST'
	defw	trav-0bh
lates:
	defw	docol
	defw	curr
	defw	at
	defw	at
	defw	semis
;
;
	defb	83h			; LFA
	defc	'LFA'
	defw	lates-9
lfa:
	defw	$+2
	pop	hl			;/ hl <-- pfa
;	subw	hl,4			;/
	defb	0fdh,0edh,0feh,4,0
	jhpush				;/ s1 <-- lfa
;
;
	defb	83h			; CFA
	defc	'CFA'
	defw	lfa-6
cfa:
	defw	docol
	defw	twomin			;/
	defw	semis
;
;
	defb	83h			; NFA
	defc	'NFA'
	defw	cfa-6
nfa:
	defw	docol
	defw	lit
	defw	5
	defw	subb
	defw	lit
	defw	-1
	defw	trav
	defw	semis
;
;
	defb	83h			; PFA
	defc	'PFA'
	defw	nfa-6
pfa:
	defw	docol
	defw	one
	defw	trav
	defw	lit
	defw	5
	defw	plus
	defw	semis
;
;
	defb	84h			; !CSP
	defc	'!CSP'
	defw	pfa-6
scsp:
	defw	docol
	defw	spat
	defw	cspp
	defw	store
	defw	semis
;
;
	defb	86h			; ?ERROR
	defc	'?ERROR'
	defw	scsp-7
qerr:
	defw	docol
	defw	swap
	defw	zbran			; if
	defw	qerr1-$
	defw	error
	defw	bran			; else
	defw	qerr2-$
qerr1:
	defw	drop			; endif
qerr2:
	defw	semis
;
;
	defb	85h			; ?COMP
	defc	'?COMP'
	defw	qerr-9
qcomp:
	defw	docol
	defw	state
	defw	at
	defw	zequ
	defw	lit
	defw	11h
	defw	qerr
	defw	semis
;
;
	defb	85h			; ?EXEC
	defc	'?EXEC'
	defw	qcomp-8
qexec:
	defw	docol
	defw	state
	defw	at
	defw	lit
	defw	12h
	defw	qerr
	defw	semis
;
;
	defb	86h			; ?PAIRS
	defc	'?PAIRS'
	defw	qexec-8
qpair:
	defw	docol
	defw	subb
	defw	lit
	defw	13h
	defw	qerr
	defw	semis
;
;
	defb	84h			; ?CSP
	defc	'?CSP'
	defw	qpair-9
qcsp:
	defw	docol
	defw	spat
	defw	cspp
	defw	at
	defw	subb
	defw	lit
	defw	14h
	defw	qerr
	defw	semis
;
;
	defb	88h			; ?LOADING
	defc	'?LOADING'
	defw	qcsp-7
qload:
	defw	docol
	defw	blk
	defw	at
	defw	zequ
	defw	lit
	defw	16h
	defw	qerr
	defw	semis
;
;
	defb	87h			; COMPILE
	defc	'COMPILE'
	defw	qload-0bh
comp:
	defw	docol
	defw	qcomp
	defw	fromr
	defw	dup
	defw	twop
	defw	tor
	defw	at
	defw	comma
	defw	semis
;
;
	defb	0c1h			; [
	defc	'['
	defw	comp-0ah
lbrac:
	defw	docol
	defw	zero
	defw	state
	defw	store
	defw	semis
;
;
	defb	81h			; ]
	defc	']'
	defw	lbrac-4
rbrac:
	defw	docol
	defw	lit,0c0h
	defw	state,store
	defw	semis
;
;
	defb	86h			; SMUDGE
	defc	'SMUDGE'
	defw	rbrac-4
smudg:
	defw	docol
	defw	lates
	defw	lit
	defw	20h
	defw	toggl
	defw	semis
;
;
	defb	83h			; HEX
	defc	'HEX'
	defw	smudg-9
hex:
	defw	docol
	defw	lit
	defw	10h
	defw	base
	defw	store
	defw	semis
;
;
	defb	87h			; DECIMAL
	defc	'DECIMAL'
	defw	hex-6
dec:
	defw	docol
	defw	lit
	defw	0ah
	defw	base
	defw	store
	defw	semis
;
;
	defb	87h			; (;CODE)
	defc	'(;CODE)'
	defw	dec-0ah
pscod:
	defw	docol
	defw	fromr
	defw	lates
	defw	pfa
	defw	cfa
	defw	store
	defw	semis
;
;
	defb	0c5h			; ;CODE
	defc	';CODE'
	defw	pscod-0ah
semic:
	defw	docol
	defw	qcsp
	defw	comp
	defw	pscod
	defw	lbrac
semi1:
	defw	noop			; assembler
	defw	semis
;
;
	defb	87h			; <BUILDS
	defc	'<BUILDS'
	defw	semic-8
build:
	defw	docol
	defw	zero
	defw	con
	defw	semis
;
;
	defb	85h			; DOES>
	defc	'DOES>'
	defw	build-0ah
does:
	defw	docol
	defw	fromr
	defw	lates
	defw	pfa
	defw	store
	defw	pscod
dodoe:
	ld	hl,(rpp)
	dec	hl
	dec	hl
;	ldw	(hl),bc			;/
	defb	0edh,0eh
	ld	(rpp),hl
	inc	de
	ex	de,hl
;	ldw	bc,(hl)			;/
	defb	0edh,06h
	inc	hl
	inc	hl
	jhpush
;
;
	defb	85h			; COUNT
	defc	'COUNT'
	defw	does-8
count:
	defw	docol
	defw	dup
	defw	onep
	defw	swap
	defw	cat
	defw	semis
;
;
	defb	84h			; TYPE
	defc	'TYPE'
	defw	count-8
type:
	defw	docol
	defw	ddup
	defw	zbran			; if
	defw	type1-$
	defw	over
	defw	plus
	defw	swap
	defw	xdo			; do
type2:
	defw	ido
	defw	cat
	defw	emit
	defw	xloop			; loop
	defw	type2-$
	defw	bran			; else
	defw	type3-$
type1:
	defw	drop			; endif
type3:
	defw	semis
;
;
	defb	89h			; -TRAILING
	defc	'-TRAILING'
	defw	type-7
dtrai:
	defw	docol
	defw	dup
	defw	zero
	defw	xdo			; do
dtra1:
	defw	tdup			;/
	defw	plus
	defw	onemin			;/
	defw	cat
	defw	bl
	defw	subb
	defw	zbran			; if
	defw	dtra2-$
	defw	leave
	defw	bran			; else
	defw	dtra3-$
dtra2:
	defw	onemin			;/
dtra3:
	defw	xloop			; loop
	defw	dtra1-$
	defw	semis
;
;
	defb	84h			; (.")
	defc	'(.")'
	defw	dtrai-0ch
pdotq:
	defw	docol
	defw	rr
	defw	count
	defw	dup
	defw	onep
	defw	fromr
	defw	plus
	defw	tor
	defw	type
	defw	semis
;
;
	defb	0c2h			; ."
	defc	'."'
	defw	pdotq-7
dotq:
	defw	docol
	defw	lit
	defw	22h
	defw	state
	defw	at
	defw	zbran			; if
	defw	dotq1-$
	defw	comp
	defw	pdotq
	defw	word
	defw	here
	defw	cat
	defw	onep
	defw	allot
	defw	bran			; else
	defw	dotq2-$
dotq1:
	defw	word
	defw	here
	defw	count
	defw	type			; endif
dotq2:
	defw	semis
;
;
	defb	86h			; EXPECT
	defc	'EXPECT'
	defw	dotq-5
expec:
	defw	docol
	defw	over
	defw	plus
	defw	over
	defw	xdo			; do
expe1:
	defw	key
	defw	dup
	defw	lit
	defw	0eh
	defw	porig
	defw	at
	defw	equal
	defw	zbran			; if
	defw	expe2-$
	defw	drop
	defw	dup
	defw	ido
	defw	equal
	defw	dup
	defw	fromr
	defw	twomin			;/
	defw	plus
	defw	tor
	defw	zbran			; if
	defw	expe6-$
	defw	lit
	defw	bell
	defw	bran			; else
	defw	expe7-$
expe6:
	defw	lit
	defw	bsout			; endif
expe7:
	defw	bran			; else
	defw	expe3-$
expe2:
	defw	dup
	defw	lit
	defw	acr			;/
	defw	equal
	defw	zbran			; if
	defw	expe4-$
	defw	leave
	defw	drop
	defw	bl
	defw	zero
	defw	bran			; else
	defw	expe5-$
expe4:
	defw	dup			; endif
expe5:
	defw	ido
	defw	cstor
	defw	zero
	defw	ido
	defw	onep
	defw	store			; endif
expe3:
	defw	emit
	defw	xloop			; loop
	defw	expe1-$
	defw	drop
	defw	semis
;
;
	defb	85h			; QUERY
	defc	'QUERY'
	defw	expec-9
query:
	defw	docol
	defw	tib
	defw	at
	defw	lit
	defw	50h
	defw	expec
	defw	zero
	defw	inn
	defw	store
	defw	semis
;
;
	defb	0c1h			; NULL
	defb	80h
	defw	query-8
null:
	defw	docol
	defw	blk
	defw	at
	defw	zbran			; if
	defw	null1-$
	defw	one
	defw	blk
	defw	pstor
	defw	zero
	defw	inn
	defw	store
	defw	blk
	defw	at
	defw	bscr
	defw	onemin			;/
	defw	andd
	defw	zequ
	defw	zbran			; if
	defw	null2-$
	defw	qexec
	defw	fromr
	defw	drop			; endif
null2:
	defw	bran			; else
	defw	null3-$
null1:
	defw	fromr
	defw	drop			; endif
null3:
	defw	semis
;
	defb	84h			; FILL
	defc	'FILL'
	defw	null-4
fill:
	defw	$+2
	exx				;/ save ip
	pop	de			;/ e <-- byte
	pop	bc			;  bc <-- quantity
	pop	hl			;/ hl <-- address
fill1:
	ld	a,b
	or	c			;  qty == 0?
	jr	z,fill2			;  yes, nothing (more) to fill
	ld	(hl),e			;/ (hl) <-- byte
	inc	hl			;  inc pointer
	dec	bc			;  dec counter
	jp	fill1			;/
fill2:
	exx				;/ restore ip
	jnext
;
;
	defb	85h			; ERASE
	defc	'ERASE'
	defw	fill-7
erasee:
	defw	docol
	defw	zero
	defw	fill
	defw	semis
;
;
	defb	86h			; BLANKS
	defc	'BLANKS'
	defw	erasee-8
blank:
	defw	docol
	defw	bl
	defw	fill
	defw	semis
;
;
	defb	84h			; HOLD
	defc	'HOLD'
	defw	blank-9
hold:
	defw	docol
	defw	lit
	defw	-1
	defw	hld
	defw	pstor
	defw	hld
	defw	at
	defw	cstor
	defw	semis
;
;
	defb	83h			; PAD
	defc	'PAD'
	defw	hold-7
pad:
	defw	docol
	defw	here
	defw	lit
	defw	44h
	defw	plus
	defw	semis
;
;
	defb	84h			; WORD
	defc	'WORD'
	defw	pad-6
word:
	defw	docol
	defw	blk
	defw	at
	defw	zbran			; if
	defw	word1-$
	defw	blk
	defw	at
	defw	block
	defw	bran			; else
	defw	word2-$
word1:
	defw	tib
	defw	at			; endif
word2:
	defw	inn
	defw	at
	defw	plus
	defw	swap
	defw	encl
	defw	here
	defw	lit
	defw	22h
	defw	blank
	defw	inn
	defw	pstor
	defw	over
	defw	subb
	defw	tor
	defw	rr
	defw	here
	defw	cstor
	defw	plus
	defw	here
	defw	onep
	defw	fromr
	defw	cmove
	defw	semis
;
;
	defb	88h			; (NUMBER)
	defc	'(NUMBER)'
	defw	word-7
pnumb:
	defw	docol
pnum1:
	defw	onep			; begin
	defw	dup
	defw	tor
	defw	cat
	defw	base
	defw	at
	defw	digit
	defw	zbran			; while
	defw	pnum2-$
	defw	swap
	defw	base
	defw	at
	defw	ustar
	defw	drop
	defw	rot
	defw	base
	defw	at
	defw	ustar
	defw	dplus
	defw	dpl
	defw	at
	defw	onep
	defw	zbran			; if
	defw	pnum3-$
	defw	one
	defw	dpl
	defw	pstor			; endif
pnum3:
	defw	fromr
	defw	bran			; repeat
	defw	pnum1-$
pnum2:
	defw	fromr
	defw	semis
;
;
	defb	86h			; NUMBER
	defc	'NUMBER'
	defw	pnumb-0bh
numb:
	defw	docol
	defw	zero
	defw	zero
	defw	rot
	defw	dup
	defw	onep
	defw	cat
	defw	lit
	defw	2dh
	defw	equal
	defw	dup
	defw	tor
	defw	plus
	defw	lit
	defw	-1
numb1:
	defw	dpl			; begin
	defw	store
	defw	pnumb
	defw	dup
	defw	cat
	defw	bl
	defw	subb
	defw	zbran			; while
	defw	numb2-$
	defw	dup
	defw	cat
	defw	lit
	defw	2eh
	defw	subb
	defw	zero
	defw	qerr
	defw	zero
	defw	bran			; repeat
	defw	numb1-$
numb2:
	defw	drop
	defw	fromr
	defw	zbran			; if
	defw	numb3-$
	defw	dminu			; endif
numb3:
	defw	semis
;
;
	defb	85h			; -FIND (0-3) SUCCESS
	defc	'-FIND'			;       (0-1) FAILURE
	defw	numb-9
dfind:
	defw	docol
	defw	bl
	defw	word
	defw	here
	defw	cont
	defw	at
	defw	at
	defw	pfind
	defw	dup
	defw	zequ
	defw	zbran			; if
	defw	dfin1-$
	defw	drop
	defw	here
	defw	lates
	defw	pfind			; endif
dfin1:
	defw	semis
;
;
	defb	87h			; (ABORT)
	defc	'(ABORT)'
	defw	dfind-8
pabor:
	defw	docol
	defw	abort
	defw	semis
;
	defb	85h			; ERROR
	defc	'ERROR'
	defw	pabor-0ah
error:
	defw	docol
	defw	warn
	defw	at
	defw	zless
	defw	zbran			; if
	defw	erro1-$
	defw	pabor			; endif
erro1:
	defw	here
	defw	count
	defw	type
	defw	pdotq
	defb	2
	db	'? '
	defw	mess
	defw	spsto
;	CHANGE FROM fig MODEL
;	defw	inn,at,blk,at
	defw	blk,at
	defw	ddup
	defw	zbran,erro2-$		; if
	defw	inn,at
	defw	swap			; endif
erro2:
	defw	quit
;
;
	defb	83h			; ID.
	defc	'ID.'
	defw	error-8
iddot:
	defw	docol
	defw	pad
	defw	lit
	defw	20h
	defw	blank			;/
	defw	dup
	defw	pfa
	defw	lfa
	defw	over
	defw	subb
	defw	dup			;/ change frm MODEL
	defw	tor			;/ to suppress BIT 7
	defw	pad
	defw	swap
	defw	cmove
	defw	pad
	defw	fromr			;/ for terminals
	defw	pad			;/ with an 8 bit
	defw	plus			;/ ASCCI character set.
	defw	onemin			;/
	defw	dup			;/
	defw	at			;/
	defw	lit			;/
	defw	7fh			;/
	defw	andd			;/
	defw	swap			;/
	defw	store			;/
	defw	count
	defw	lit
	defw	1fh			;  WIDTH
	defw	andd
	defw	type
	defw	space
	defw	semis
;
	defb	86h			; CREATE
	defc	'CREATE'
	defw	iddot-6
creat:
	defw	docol
	defw	dfind
	defw	zbran			; if
	defw	crea1-$
	defw	drop
	defw	nfa
	defw	iddot
	defw	lit
	defw	4
	defw	mess
	defw	space			; endif
crea1:
	defw	here
	defw	dup
	defw	cat
	defw	width
	defw	at
	defw	min
	defw	onep
	defw	allot
	defw	dup
	defw	lit
	defw	0a0h
	defw	toggl
	defw	here
	defw	onemin
	defw	lit
	defw	80h
	defw	toggl
	defw	lates
	defw	comma
	defw	curr
	defw	at
	defw	store
	defw	here
	defw	twop
	defw	comma
	defw	semis
;
;
	defb	0c9h			; [COMPILE]
	defc	'[COMPILE]'
	defw	creat-9
bcomp:
	defw	docol
	defw	dfind
	defw	zequ
	defw	zero
	defw	qerr
	defw	drop
	defw	cfa
	defw	comma
	defw	semis
;
;
	defb	0c7h			; LITERAL
	defc	'LITERAL'
	defw	bcomp-0ch
liter:
	defw	docol
	defw	state
	defw	at
	defw	zbran			; if
	defw	lite1-$
	defw	comp
	defw	lit
	defw	comma			; endif
lite1:
	defw	semis
;
;
	defb	0c8h			; DLITERAL
	defc	'DLITERAL'
	defw	liter-0ah
dlite:
	defw	docol
	defw	state
	defw	at
	defw	zbran			; if
	defw	dlit1-$
	defw	swap
	defw	liter
	defw	liter			; endif
dlit1:
	defw	semis
;
;
	defb	86h			; ?STACK
	defc	'?STACK'
	defw	dlite-0bh
qstac:
	defw	docol
	defw	spat
	defw	szero
	defw	at
	defw	swap
	defw	uless
	defw	one
	defw	qerr
	defw	spat
	defw	here
	defw	lit
	defw	80h
	defw	plus
	defw	uless
	defw	lit
	defw	7
	defw	qerr
	defw	semis
;
;
	defb	89h			; INTERPRET
	defc	'INTERPRET'
	defw	qstac-9
inter:
	defw	docol
inte1:
	defw	dfind			; begin
	defw	zbran			; if
	defw	inte2-$
	defw	state
	defw	at
	defw	less
	defw	zbran			; if
	defw	inte3-$
	defw	cfa
	defw	comma
	defw	bran			; else
	defw	inte4-$
inte3:
	defw	cfa
	defw	exec			; endif
inte4:
	defw	qstac
	defw	bran			; else
	defw	inte5-$
inte2:
	defw	here
	defw	numb
	defw	dpl
	defw	at
	defw	onep
	defw	zbran			; if
	defw	inte6-$
	defw	dlite
	defw	bran			; else
	defw	inte7-$
inte6:
	defw	drop
	defw	liter			; endif
inte7:
	defw	qstac			; endif
inte5:
	defw	bran			; again
	defw	inte1-$
;
;
	defb	89h			; IMMEDIATE
	defc	'IMMEDIATE'
	defw	inter-0ch
immed:
	defw	docol
	defw	lates
	defw	lit
	defw	40h
	defw	toggl
	defw	semis
;
;
	defb	8ah			; VOCABULARY
	defc	'VOCABULARY'
	defw	immed-0ch
vocab:
	defw	docol
	defw	build
	defw	lit
	defw	0a081h
	defw	comma
	defw	curr
	defw	at
	defw	cfa
	defw	comma
	defw	here
	defw	vocl
	defw	at
	defw	comma
	defw	vocl
	defw	store
	defw	does
dovoc:
	defw	twop
	defw	cont
	defw	store
	defw	semis
;
;
	defb	0c5h			; FORTH
	defc	'FORTH'
	defw	vocab-0dh
forth:
	defw	dodoe
	defw	dovoc
	defw	0a081h
	defw	task-7			; cold start value only
;					  changed aech time a def is appended
;					  to the FORTH vocabulary
	defw	0			; end of vocabulary list
;
;
	defb	8bh			; DEFINITIONS
	defc	'DEFINITIONS'
	defw	forth-8
defin:
	defw	docol
	defw	cont
	defw	at
	defw	curr
	defw	store
	defw	semis
;
;
	defb	0c1h			; (
	defc	'('
	defw	defin-0eh
paren:
	defw	docol
	defw	lit
	defw	29h
	defw	word
	defw	semis
;
;
	defb	84h			; QUIT
	defc	'QUIT'
	defw	paren-4
quit:
	defw	docol
	defw	zero
	defw	blk
	defw	store
	defw	lbrac
quit1:
	defw	rpsto			; begin
	defw	cr
	defw	query
	defw	inter
	defw	state
	defw	at
	defw	zequ
	defw	zbran			; if
	defw	quit2-$
	defw	pdotq
	defb	2
	db	'ok'			; endif
quit2:
	defw	bran			; again
	defw	quit1-$
;
;
	defb	85h			; ABORT
	defc	'ABORT'
	defw	quit-7
abort:
	defw	docol
	defw	spsto
	defw	dec
	defw	qstac
	defw	cr
	defw	dotcpu
	defw	pdotq
	defb	0eh			; count of chrs to follow
	db	'fig-FORTH '
	defb	figrel+30h,adot,figrev+30h,usrver
	defw	forth
	defw	defin
	defw	quit
;
;
wrm:	ld	bc,wrm1
	jnext
wrm1:	defw	warm
;
;
	defb	84h			; WARM
	defc	'WARM'
	defw	abort-8
warm:
	defw	docol
	defw	mtbuf
	defw	abort
;
;
cld:
	ld	hl,(bdoss+1)		;/
	ld	l,0			;/ hl <-- fbase
	ld	(limit+2),hl		;/ set limit
	ld	de,bufsiz		;/ de <-- total disc buffer size
;	subw	hl,de			;/ hl <-- addr. of 1st disc buffer
	defb	0edh,0deh
	ld	(first+2),hl		;/ set FIRST
	ld	(use+2),hl		;/ set USE
	ld	(prev+2),hl		;/ set PREV
	ld	(buf1),hl		;/
	ld	de,us			;/ de <-- user variable space
;	subw	hl,de			;/ hl <-- initr0
	defb	0edh,0deh
	ld	(upinit),hl		;/
	ld	(r0init),hl		;/
	ld	(up),hl			;/
	ld	(rpp),hl		;/
	ld	de,rts			;/ de <-- rtn stack & term. buf space
;	subw	hl,de			;/ hl <-- inits0
	defb	0edh,0deh
	ld	(s0init),hl		;/
	ld	(tibini),hl		;/
	ld	sp,hl			;/
	ld	bc,cld1
	ld	ix,next			; pointer to next
	ld	iy,hpush		; pointer to hpush
	jnext
;
;
cld1:	defw	cold
;
	defb	84h			; COLD
	defc	'COLD'
	defw	warm-7
cold:
	defw	docol
	defw	mtbuf
	defw	one,recadr		; AvdH
	defw	store
	defw	lit,buf1
	defw	at			;/
	defw	use,store
	defw	lit,buf1
	defw	at			;/
	defw	prev,store
	defw	drzer
	defw	zero			;/
	defw	lit,eprint
	defw	cstor			;/
;
	defw	lit
	defw	orig+12h
	defw	lit
	defw	up
	defw	at
	defw	lit
	defw	6
	defw	plus
	defw	lit
	defw	10h
	defw	cmove
	defw	lit
	defw	orig+0ch
	defw	at
	defw	lit
	defw	forth+6
	defw	store
	defw	fcb			;/A
	defw	lit,opnfil		;/A open mass storage
	defw	bdos			;/A
	defw	lit,0ffh		;/A
	defw	equal			;/A file present?
	defw	zbran,cld2-$		;/A
	defw	zero			;/A
	defw	warn,store		;/A
	defw	cr,pdotq		;/A
	defb	7			;/A
	db	'No file'		;/A
cld2:
	defw	abort
;
;
	defb	84h			; S->D
	defc	'S->D'
	defw	cold-7
stod:	defw	$+2
	pop	hl			;/
;	exts	hl			;/ de <-- h(7)
	defb	0edh,6ch
	ex	de,hl			;/
	jp	dpush			; ( n1 -- d1L d1H)
;
;
	defb	82h			; +-
	defc	'+-'
	defw	STOD-7
pm:
	defw	docol
	defw	zless
	defw	zbran			; if
	defw	pm1-$
	defw	minus			; endif
pm1:
	defw	semis
;
;
	defb	83h			; D+-
	defc	'D+-'
	defw	pm-5
dpm:
	defw	docol
	defw	zless
	defw	zbran			; if
	defw	dpm1-$
	defw	dminu			; endif
dpm1:
	defw	semis
;
;
	defb	83h			; ABS
	defc	'ABS'
	defw	dpm-6
abs:
	defw	docol
	defw	dup
	defw	pm
	defw	semis
;
;
	defb	84h			; DABS
	defc	'DABS'
	defw	abs-6
dabs:
	defw	docol
	defw	dup
	defw	dpm
	defw	semis
;
;
	defb	83h			; MIN
	defc	'MIN'
	defw	dabs-7
min:
	defw	docol
	defw	tdup
	defw	great
	defw	zbran			; if
	defw	min1-$
	defw	swap			; endif
min1:
	defw	drop
	defw	semis
;
;
	defb	83h			; MAX
	defc	'MAX'
	defw	min-6
max:	defw	docol
	defw	tdup
	defw	less
	defw	zbran			; if
	defw	max1-$
	defw	swap			; endif
max1:
	defw	drop
	defw	semis
;
;
	defb	82h			; M*   ( n1 n2 --- d)
	defc	'M*'
	defw	max-6
mstar:
	defw	$+2			;/
	pop	de			; de <-- multiplicator
	pop	hl			; hl <-- multiplicant
;	multw	hl,de			;/ dehl <-- hl * de
	defb	0edh,0d2h
	ex	de,hl			;/
	jp	dpush			;/ ( n1 n2 --- d1l d1h)
;
;
	defb	82h			;/ M/   ( d n1 --- nrem nquot)
	defc	'M/'
	defw	mstar-5
mslas:
	defw	$+2			; ( d n1 --- n2 n3)
	exx				; save ip
	pop	hl			; divisor
	ld	a,h
	and	80h			; filter sign
	jr	z,mslas1		; positive
;	neg	hl			; make positive
	defb	0edh,4ch
mslas1:
	ld	b,h
	ld	c,l			; bc <-- divisor
	pop	hl			; dividend.hw
	pop	de			; dividend.lw
	bit	7,h			; negative?
	jr	z,mslas2		; no
	inc	a			; dividend sign flag
	push	hl
	ld	hl,0
;	subw	hl,de			; neg dividend.lw
	defb	0edh,0deh
	pop	de			; dividend.hw
	push	hl
	ld	hl,0
	sbc	hl,de			; neg dividend.hw
	pop	de			; dividend.lw
mslas2:
;	cpw	hl,bc			; dividend.hw >= divisor
	defb	0edh,0c7h
	jr	c,mslas3		; no overflow, continue
	ld	hl,0ffffh
	ld	d,h
	ld	e,l			; set rem & quot to max.
	jr	mslas5
;
mslas3:
	ex	de,hl			; dehl <-- dividend.hw,lw
;	divuw	dehl,bc			; de <-- remainder, hl <-- quotient
	defb	0edh,0cbh
	ex	de,hl			; hl <-- remainder
	bit	0,a			; was dividend negative
	jr	z,mslas4		; no
;	neg	hl			; yes, negate remainder
	defb	0edh,4ch
mslas4:
	ex	de,hl			; hl <-- quotient
	or	a
	jr	z,mslas5		; neither operand negative
	cp	81h			; both operands negative?
	jr	z,mslas5		; yes, quotient stays positive
;	neg	hl			; no, negate quotient
	defb	0edh,4ch
mslas5:
	push	de			; remainder
	push	hl			; quotient
	exx				; restore ip
	jnext
;
;
	defb	81h			; *   ( n1 n2 --- nproduct)
	defc	'*'
	defw	mslas-5
star:
	defw	$+2
	pop	de
	pop	hl
;	multw	hl,de			;/ dehl <-- product
	defb	0edh,0d2h
	jhpush
;
;
	defb	84h			; /MOD   ( n1 n2 --- nrem nquot)
	defc	'/MOD'
	defw	star-4
slmod:
	defw	$+2
	exx				;/ save ip
	pop	bc			;/ divisor
	pop	hl			;  dividend
	ld	a,b
	or	c			;/ div by 0?
	jr	nz,slmod1		;/ no, continue
	ld	de,0ffffh
	ld	h,d
	ld	l,e			;/ set remainder & quotient to max.
	jr	slmod3
slmod1:
;	cpw	hl,8000h		;/ special case -32768 -1 /
	defb	0fdh,0edh,0f7h
	defw	8000h
	jr	nz,slmod2		;/ continue
	ld	a,b
	cp	0ffh
	jr	nz,slmod2
	cp	c			;/ lo byte also 0ffh?
	jr	nz,slmod2		;/ no, go & divide
	ld	de,0			;/ remainder
	jr	slmod3			;/ exit with dividend unchanged
slmod2:
;	exts	hl			;/ de <-- dividend.hw
	defb	0edh,6ch
;	divw	dehl,bc			;/ de <-- remainder, hl <-- quotient
	defb	0edh,0cah
slmod3:
	push	de
	push	hl
	exx				;/ restore ip
	jnext
;
;
	defb	81h			; /
	defc	'/'
	defw	slmod-7
slash:
	defw	$+2
	exx				;/ save ip
	pop	bc			;/ divisor
	pop	hl			;  dividend
	ld	a,b
	or	c			;/ division by 0?
	jr	nz,slash1		;/ no, continue
	ld	hl,0ffffh		;/ set quotient to max.
	jr	slash3
slash1:
;	cpw	hl,8000h		;/ special case -32768 -1 /
	defb	0fdh,0edh,0f7h
	defw	8000h
	jr	nz,slash2		;/ dividend not -32768
	ld	a,b
	cp	0ffh
	jr	nz,slash2		;/ divisor not -1
	cp	c
	jr	z,slash3		;/ return with dividend unchanged
slash2:
;	exts	hl			;/ de <-- dividend.hw
	defb	0edh,6ch
;	divw	dehl,bc			;/ hl <-- quotient
	defb	0edh,0cah
slash3:
	push	hl			;/ quotient
	exx				;/ restore ip
	jnext
;
;
	defb	83h			;/ MOD
	defc	'MOD'
	defw	slash-4
modd:
	defw	$+2
	exx				; save ip
	pop	bc			; divisor
	pop	hl			;  dividend
	ld	a,b
	or	c			; division by 0?
	jr	nz,modd1		; no, continue
	ld	de,0ffffh		; set remainder to max
	jr	modd3
modd1:
;	cpw	hl,8000h		; special case -32768 -1 /
	defb	0fdh,0edh,0f7h
	defw	8000h
	jr	nz,modd2		; dividend not -32768
	ld	a,b
	cp	0ffh
	jr	nz,modd2		; divisor not -1
	cp	c
	jr	nz,modd2		; go & divide
	ld	de,0			; remainder
	jr	modd3
modd2:
;	exts	hl			; de <-- dividend.hw
	defb	0edh,6ch
;	divw	dehl,bc			; de <-- remainder
	defb	0edh,0cah
modd3:
	push	de			; remainder
	exx				; restore ip
	jnext
;
;
	defb	85h			;/ */MOD
	defc	'*/MOD'
	defw	modd-6
ssmod:
	defw	$+2
	exx				; save ip
	pop	hl			; divisor
	ld	a,h
	and	80h			; filter sign
	jr	z,ssmod1		; positive
;	neg	hl			; make positive
	defb	0edh,4ch
ssmod1:
	ld	b,h
	ld	c,l			; bc <-- divisor
	pop	hl			; multipicator
	pop	de			; multiplicant
	ex	af,af'			; save sign flag
;	multw	hl,de			; dehl <-- product (= dividend)
	defb	0edh,0d2h
	ex	af,af'			; restore sign flag
	ex	de,hl			; de <-- dividend.lw
	bit	7,h			; dividend negative?
	jr	z,ssmod2		; no
	inc	a			; dividend sign flag
	push	hl
	ld	hl,0
;	subw	hl,de			; neg dividend.lw
	defb	0edh,0deh
	pop	de			; dividend.hw
	push	hl
	ld	hl,0
	sbc	hl,de			; neg dividend.hw
	pop	de			; dividend.lw
ssmod2:
;	cpw	hl,bc			; dividend.hw >= divisor?
	defb	0edh,0c7h
	jr	c,ssmod3		; no overflow, continue
	ld	hl,0ffffh
	ld	d,h
	ld	e,l			; set rem & quot to max
	jr	ssmod5
;
ssmod3:
	ex	de,hl			; dehl <-- dividend.hw,lw
;	divuw	dehl,bc			; de <-- remainder, hl <-- quotient
	defb	0edh,0cbh
	ex	de,hl			; hl <-- remainder
	bit	0,a			; was dividend negative?
	jr	z,ssmod4		; no
;	neg	hl			; yes, negate remainder
	defb	0edh,4ch
ssmod4:
	ex	de,hl			; hl <-- quotient
	or	a
	jr	z,ssmod5		; neither operand negative
	cp	81h			; both operands negative?
	jr	z,ssmod5		; yes, quotient stays positive
;	neg	hl			; no, negate quotient
	defb	0edh,4ch
ssmod5:
	push	de			; remainder
	push	hl			; quotient
	exx				; restore ip
	jnext
;
;
	defb	82h			; */
	defc	'*/'
	defw	ssmod-8
ssla:
	defw	$+2			;/
	exx				; save ip
	pop	hl			; divisor
	ld	a,h
	and	80h			; filter sign
	jr	z,ssla1			; positive
;	neg	hl			; make positive
	defb	0edh,4ch
ssla1:
	ld	b,h
	ld	c,l			; bc <-- divisor
	pop	hl			; multipicator
	pop	de			; multiplicant
	ex	af,af'			; save sign flag
;	multw	hl,de			; dehl <-- product (= dividend)
	defb	0edh,0d2h
	ex	af,af'			; restore sign flag
	ex	de,hl			; de <-- dividend.lw
	bit	7,h			; dividend negative?
	jr	z,ssla2			; no
	inc	a			; dividend sign flag
	push	hl
	ld	hl,0
;	subw	hl,de			; neg dividend.lw
	defb	0edh,0deh
	pop	de			; dividend.hw
	push	hl
	ld	hl,0
	sbc	hl,de			; neg dividend.hw
	pop	de			; dividend.lw
ssla2:
;	cpw	hl,bc			; dividend.hw >= divisor?
	defb	0edh,0c7h
	jr	c,ssla3			; no overflow, continue
	ld	hl,0ffffh		; set quotient to max
	jr	ssla4
;
ssla3:
	ex	de,hl			; dehl <-- dividend.hw,lw
;	divuw	dehl,bc			; de <-- remainder, hl <-- quotient
	defb	0edh,0cbh
	or	a
	jr	z,ssla4			; neither operand negative
	cp	81h			; both operands negative?
	jr	z,ssla4			; yes, quotient stays positive
;	neg	hl			; no, negate quotient
	defb	0edh,4ch
ssla4:
	push	hl			; quotient
	exx				; restore ip
	jnext
;
;
	defb	85h			; M/MOD
	defc	'M/MOD'
	defw	ssla-5
msmod:
	defw	docol
	defw	tor
	defw	zero
	defw	rr
	defw	uslas
	defw	fromr
	defw	swap
	defw	tor
	defw	uslas
	defw	fromr
	defw	semis
;
;
;	Block moved down 2 pages
;
	defb	86h			; (LINE)
	defc	'(LINE)'
	defw	msmod-8
pline:
	defw	docol
	defw	tor
	defw	lit
	defw	40h
	defw	bbuf
	defw	ssmod
	defw	fromr
	defw	bscr
	defw	star
	defw	plus
	defw	block
	defw	plus
	defw	lit
	defw	40h
	defw	semis
;
;
	defb	85h			; .LINE
	defc	'.LINE'
	defw	pline-9
dline:
	defw	docol
	defw	pline
	defw	dtrai
	defw	type
	defw	semis
;
;
	defb	87h			; MESSAGE
	defc	'MESSAGE'
	defw	dline-8
mess:
	defw	docol
	defw	warn
	defw	at
	defw	zbran			; if
	defw	mess1-$
	defw	ddup
	defw	zbran			; if
	defw	mess2-$
	defw	lit
	defw	4			; 1st message screen
	defw	ofset
	defw	at
	defw	bscr
	defw	slash
	defw	subb
	defw	dline
	defw	space			; endif
mess2:
	defw	bran			; else
	defw	mess3-$
mess1:
	defw	pdotq
	defb	6
	db	'MSG # '
	defw	dot			; endif
mess3:	defw	semis
;
;
	defb	82h			; P@
	defc	'P@'
	defw	mess-0ah
ptat:
	defw	$+2
	exx				;d save registers
	pop	bc			;d bc <-- port#
	in	l,(c)			;d l <-- data byte
	ld	h,0
	push	hl
	exx				;d restore registers
	jnext
;
;
	defb	82h			; P!
	defc	'P!'
	defw	ptat-5
ptsto:
	defw	$+2
	exx				;d save registers
	pop	bc			;d c <-- port#
	pop	hl			;d L <-- date byte
	out	(c),l
	exx				;d restore registers
	jnext
;
;
	page
include	DISCIO.FTH
	page
include	CONPRTIO.FTH
	page
;
	defb	0c1h			; ' (tick)
	defb	0a7h
	defw	arrow-6
tick:
	defw	docol
	defw	dfind
	defw	zequ
	defw	zero
	defw	qerr
	defw	drop
	defw	liter
	defw	semis
;
;
	defb	86h			; FORGET
	defc	'FORGET'
	defw	tick-4
forg:
	defw	docol
	defw	curr
	defw	at
	defw	cont
	defw	at
	defw	subb
	defw	lit
	defw	18h
	defw	qerr
	defw	tick
	defw	dup
	defw	fence
	defw	at
	defw	uless			;/ FORGET >8000h nw o.k.
	defw	lit
	defw	15h
	defw	qerr
	defw	dup
	defw	nfa
	defw	dp
	defw	store
	defw	lfa
	defw	at
	defw	cont
	defw	at
	defw	store
	defw	semis
;
;
	defb	84h			; BACK
	defc	'BACK'
	defw	forg-9
back:
	defw	docol
	defw	here
	defw	subb
	defw	comma
	defw	semis
;
;
	defb	0c5h			; BEGIN
	defc	'BEGIN'
	defw	back-7
begin:
	defw	docol
	defw	qcomp
	defw	here
	defw	one
	defw	semis
;
;
	defb	0c5h			; ENDIF
	defc	'ENDIF'
	defw	begin-8
endiff:
	defw	docol
	defw	qcomp
	defw	two
	defw	qpair
	defw	here
	defw	over
	defw	subb
	defw	swap
	defw	store
	defw	semis
;
;
	defb	0c4h			; THEN
	defc	'THEN'
	defw	endiff-8
then:	defw	docol
	defw	endiff
	defw	semis
;
;
	defb	0c2h			; DO
	defc	'DO'
	defw	then-7
do:
	defw	docol
	defw	comp
	defw	xdo
	defw	here
	defw	three
	defw	semis
;
;
	defb	0c4h			; LOOP
	defc	'LOOP'
	defw	do-5
loop:
	defw	docol
	defw	three
	defw	qpair
	defw	comp
	defw	xloop
	defw	back
	defw	semis
;
;
	defb	0c5h			; +LOOP
	defc	'+LOOP'
	defw	loop-7
ploop:
	defw	docol
	defw	three
	defw	qpair
	defw	comp
	defw	xploo
	defw	back
	defw	semis
;
;
	defb	0c5h			; UNTIL
	defc	'UNTIL'
	defw	ploop-8
until:
	defw	docol
	defw	one
	defw	qpair
	defw	comp
	defw	zbran
	defw	back
	defw	semis
;
;
	defb	0c3h			; END
	defc	'END'
	defw	until-8
endd:
	defw	docol
	defw	until
	defw	semis
;
;
	defb	0c5h			; AGAIN
	defc	'AGAIN'
	defw	endd-6
again:
	defw	docol
	defw	one
	defw	qpair
	defw	comp
	defw	bran
	defw	back
	defw	semis
;
;
	defb	0c6h			; REPEAT
	defc	'REPEAT'
	defw	again-8
repea:
	defw	docol
	defw	tor
	defw	tor
	defw	again
	defw	fromr
	defw	fromr
	defw	twomin			;/
	defw	endiff
	defw	semis
;
;
	defb	0c2h			; IF
	defc	'IF'
	defw	repea-9
iff:
	defw	docol
	defw	comp
	defw	zbran
	defw	here
	defw	zero
	defw	comma
	defw	two
	defw	semis
;
;
	defb	0c4h			; ELSE
	defc	'ELSE'
	defw	iff-5
elsee:
	defw	docol
	defw	two
	defw	qpair
	defw	comp
	defw	bran
	defw	here
	defw	zero
	defw	comma
	defw	swap
	defw	two
	defw	endiff
	defw	two
	defw	semis
;
;
	defb	0c5h			; WHILE
	defc	'WHILE'
	defw	elsee-7
while:
	defw	docol
	defw	iff
	defw	twop
	defw	semis
;
;
	defb	86h			; SPACES
	defc	'SPACES'
	defw	while-8
spacs:
	defw	docol
	defw	zero
	defw	max
	defw	ddup
	defw	zbran			; if
	defw	spax1-$
	defw	zero
	defw	xdo			; do
spax2:
	defw	space
	defw	xloop			; loop endif
	defw	spax2-$
spax1:
	defw	semis
;
;
	defb	82h			; <#
	defc	'<#'
	defw	spacs-9
bdigs:
	defw	docol
	defw	pad
	defw	hld
	defw	store
	defw	semis
;
;
	defb	82h			; #>
	defc	'#>'
	defw	bdigs-5
edigs:
	defw	docol
	defw	drop
	defw	drop
	defw	hld
	defw	at
	defw	pad
	defw	over
	defw	subb
	defw	semis
;
;
	defb	84h			; SIGN
	defc	'SIGN'
	defw	edigs-5
sign:
	defw	docol
	defw	rot
	defw	zless
	defw	zbran			; if
	defw	sign1-$
	defw	lit
	defw	2dh
	defw	hold			; endif
sign1:
	defw	semis
;
;
	defb	81h			; #
	defc	'#'
	defw	sign-7
dig:
	defw	docol
	defw	base
	defw	at
	defw	msmod
	defw	rot
	defw	lit
	defw	9
	defw	over
	defw	less
	defw	zbran			; if
	defw	dig1-$
	defw	lit
	defw	7
	defw	plus			; endif
dig1:	defw	lit
	defw	30h
	defw	plus
	defw	hold
	defw	semis
;
;
	defb	82h			; #S
	defc	'#S'
	defw	dig-4
digs:
	defw	docol
digs1:
	defw	dig			; begin
	defw	tdup			;/
	defw	orr
	defw	zequ
	defw	zbran			; until
	defw	digs1-$
	defw	semis
;
;
	defb	83h			; D.R
	defc	'D.R'
	defw	digs-5
ddotr:
	defw	docol
	defw	tor
	defw	swap
	defw	over
	defw	dabs
	defw	bdigs
	defw	digs
	defw	sign
	defw	edigs
	defw	fromr
	defw	over
	defw	subb
	defw	spacs
	defw	type
	defw	semis
;
;
	defb	82h			; .R
	defc	'.R'
	defw	ddotr-6
dotr:
	defw	docol
	defw	tor
	defw	stod
	defw	fromr
	defw	ddotr
	defw	semis
;
;
	defb	82h			; D.
	defc	'D.'
	defw	dotr-5
ddot:
	defw	docol
	defw	zero
	defw	ddotr
	defw	space
	defw	semis
;
;
	defb	81h			; .
	defc	'.'
	defw	ddot-5
dot:
	defw	docol
	defw	stod
	defw	ddot
	defw	semis
;
;
	defb	81h			; ?
	defc	'?'
	defw	dot-4
ques:
	defw	docol
	defw	at
	defw	dot
	defw	semis
;
;
	defb	82h			; U.
	defc	'U.'
	defw	ques-4
udot:	defw	docol
	defw	zero
	defw	ddot
	defw	semis
;

	defb	85h			; VLIST
	defc	'VLIST'
	defw	udot-5
vlist:
	defw	docol
	defw	lit
	defw	80h
	defw	outt
	defw	store
	defw	cont
	defw	at
	defw	at
vlis1:
	defw	outt			; begin
	defw	at
	defw	csll
	defw	great
	defw	zbran			; if
	defw	vlis2-$
	defw	cr
	defw	zero
	defw	outt
	defw	store			; endif
vlis2:
	defw	dup
	defw	iddot
	defw	space
	defw	space
	defw	pfa
	defw	lfa
	defw	at
	defw	dup
	defw	zequ
	defw	qterm
	defw	orr
	defw	zbran			; until
	defw	vlis1-$
	defw	drop
	defw	semis
;
;
	defb	83h			; BYE
	defc	'BYE'
	defw	vlist-8
bye:
	defw	docol			;/A
	defw	flush			;/A
	defw	fcb,lit			;/E
	defw	10h,bdos		;/E close file
	defw	drop			;/E discard directory code
	defw	zero,zero		;/A
	defw	bdos			;/A return to CP/M
	defw	semis			;/A won't get this far, just for pretty
;
;
	defb	84h			; LIST
	defc	'LIST'
	defw	bye-6
list:
	defw	docol,dec
	defw	cr,dup
	defw	scr,store
	defw	pdotq
	defb	6
	db	'SCR # '
	defw	dot
	defw	lit,10h
	defw	zero,xdo
list1:
	defw	cr,ido
	defw	three			;/ was lit,3
	defw	dotr,space
	defw	ido,scr
	defw	at,dline
	defw	qterm
	defw	zbran,list2-$		; if
	defw	leave
list2:
	defw	xloop,list1-$		; endif
	defw	cr
	defw	semis
;
;
	defb	85H		;INDEX
	defc	'INDEX'
	defw	list-7
index:
	defw	docol
	defw	lit,ff
	defw	emit
	defw	cr
	defw	onep,swap
	defw	xdo
inde1:
	defw	cr,ido
	defw	three			;/ was lit,3
	defw	dotr,space
	defw	zero,ido
	defw	dline,qterm
	defw	zbran,inde2-$		; if
	defw	leave			; endif
inde2:
	defw	xloop,inde1-$
	defw	semis
;
;
	defb	85h			; TRIAD
	defc	'TRIAD'
	defw	index-8
triad:
	defw	docol
	defw	lit,ff
	defw	emit
	defw	three			;/ was lit,3
	defw	slash
	defw	three			;/ was lit,3
	defw	star
	defw	three			;/ was lit,3
	defw	over,plus
	defw	swap,xdo
tria1:
	defw	cr,ido
	defw	list
	defw	qterm
	defw	zbran,tria2-$		; if
	defw	leave
tria2:
	defw	xloop,tria1-$		; endif
	defw	cr
	defw	lit,15
	defw	mess,cr
	defw	semis
;
;
	defb	84h			; .CPU
	defc	'.CPU'
	defw	triad-8
dotcpu:
	defw	docol
	defw	base,at
	defw	lit,36
	defw	base,store
	defw	lit,22h
	defw	porig,tat
	defw	ddot
	defw	base,store
	defw	semis
;
;
	defb	86h			; setclk
	defc	'setclk'
	defw	dotcpu-7
setclk:
	defw	$+2
	exx				; save ip
	ld	c,iopreg
	ldctl	hl,(c)			; l <-- current i/o page
	ld	a,l
	ex	af,af'			; save i/o page
	ld	l,0feh
	ldctl	(c),hl			; select i/o page 0feh
	xor	a
	out	(cntrl0),a		; disable c/t 0
	out	(cntrl1),a		; disable c/t 1
	out	(config1),a
	ld	hl,0ffffh
	ld	a,10h
	out	(config0),a		; cascade c/t 0 - c/t 1
	ld	c,tcon0
	outw	(c),hl			; load c/t 0 time constant
	ld	c,tcon1
	outw	(c),hl			; load c/t 1 time constatnt
	ld	a,80h
	out	(config1),a		; continous mode
	ld	a,0e0h
	out	(cntrl1),a		; start 32bit counter
	ex	af,af'			; std. accu
	ld	l,a			; l <-- previous i/o page
	ld	c,iopreg
	ldctl	(c),hl			; restore i/o page
	exx				; restore ip
	jnext
;
;
	defb	86h			; getclk
	defc	'getclk'
	defw	setclk-9
getclk:
	defw	$+2
	exx				; save ip
	ld	c,iopreg
	ldctl	hl,(c)			; l <-- current i/o page
	ld	a,l
	ex	af,af'			; save current i/o page
	ld	l,0feh
	ldctl	(c),hl			; select i/o page 0feh
	ld	a,80h
	out	(cntrl1),a		; halt 32bit counter
	ld	c,count1
	inw	hl,(c)
	ld	d,h
	ld	e,l			; de <-- count1
	ld	c,count0
	inw	hl,(c)			; hl <-- count0
	ld	c,0
	ld	a,c			; a <-- 0
	sub	l			; 0 - l
	ld	l,a			; l <-- neg(l)
	ld	a,c			; a <-- 0
	sbc	a,h
	ld	h,a			; h <-- neg(h)
	ld	a,c			; a <-- 0
	sbc	a,e
	ld	e,a			; e <-- neg(e)
	ld	a,c			; a <-- 0
	sbc	a,d
	ld	d,a			; d <-- neg(d), dehl <-- neg(dehl)
;	divuw	dehl,25000		; scale to 1/100 secs
	defb	0fdh,0edh,0fbh
	defw	25000
	push	hl			; result
	ex	af,af'			; std. accu
	ld	l,a			; l <-- previous i/o page
	ld	c,iopreg
	ldctl	(c),hl			; restore i/o page
	exx				; restore ip
	jnext
;
;
	defb	84h			; TASK
	defc	'TASK'
	defw	getclk-9
;	defw	dotcpu-7
task:
	defw	docol
	defw	semis
;
;
initdp:
	defw	0
;
	end	orig
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  1988-NOV-12

Z280 fig-FORTH using random CP/M file access
-------------------------------------------

Z280 fig-FORTH 1.1a, the first version of Z280 fig-FORTH by Edmund Ramm uses
modified Albert van der Horst random file access routines.

All system calls are done via the BDOS, so this FORTH version should run un-
der all CP/M-80 versions.

Words which have been deleted from the dictionary (most of them low level de-
finitions) are DRIVE, TRACK, SECTOR, SETIO, SETDRV, SEC/BLK & DENSITY.

A BDOS call has been introduced: BDOS   ( parm fcode --- dircode)  where parm
stands  for  the  parameter  passed to the BDOS in the DE register pair,  and
fcode is the BDOS function number.  Dircode is the directory code returned by
the BDOS. This enables you to access CP/M files using high level definitions.

BYE  is now defined  as  a high level word  which  ensures that  all  updated
screens are written back to disc.

COLD re-opens the screens file and issues a warning upon failure.

FCB  is another new word.  It leaves the address  of the current file control
block on the stack.

REC# pushes the corresponding record count address onto the stack.

EXTEND   ( n ---)  extends (sic!) the logged in screens file by n blocks,  as
long as disc space permits.  You could start by SAVE-ing a 0-size file at CCP
level and then expand it after you logged in same file at the time you invoke
280FORTH (e.g. 280FORTH B:SCREENS.FRT).

The actions of all other words remain  as defined in the fig-FORTH Installa-
tion Manual's Glossary, available from the FORTH Interest Group, PO Box 1105
San Carlos, CA 94070, USA.

Please report bugs to    Edmund  R a m m
                         P.O.Box 1338
                       D-2358 Kaltenkirchen
                         Fed. Rep of Germany
                         Tel.: (04191) 1621
	title	<Z280 fig-FORTH 1.1 a>		
	subttl	Adaptive version		
;
;
; Modified from Z80 fig-FORTH 1.1h by EHR 880830
; Modified frm FIG document keyed by Dennis L. Wilson 800907
; Converted frm "8080 FIG-FORTH VERSION A0 15SEP79"
;
; fig-FORTH release 1.1 for the 8080 processor.
;
; ALL PUBLICATIONS OF THE FORTH INTEREST GROUP
; ARE PUBLIC DOMAIN. THEY MAY BE FURTHER
; DISTRIBUTED BY THE INCLUSION OF THIS CREDIT NOTICE:
;
; This publication has been made available by the
;	Forth Interest Group
;	P.O.Box 1105
;	San Carlos, CA 94070
;	U.S.A.
;
; Implementation on 8080 by:
;	John Cassady
;	339 15th Street
;	Oakland, CA 94612
;	U.S.A
;	on 790528
; Modified by:
;	Kim Harris
; Acknowledgements:
;	George Flammer
;	Robt. D. Villwock
; ----------------------------------------------------------------------
; Z80 Version for Cromemco CDOS & Digital Research CP/M by:
;	Dennis Lee Wilson c/o
;	Aristotelian Logicians
;	2631 East Pinchot Avenue
;	Phoenix, AZ 85016
;	U.S.A.
; ----------------------------------------------------------------------
; The 2 byte Z80 code for Jump Relative (JR) has been substituted for
; the 3 byte Jump (JP) wherever practical. The port I/O words P@ & P!
; have been made ROMable by use of Z80 instructions.
; ----------------------------------------------------------------------
; Further modifications (marked ;/) by:
;	Edmund Ramm
;	P.O.Box 38
;	2358 Kaltenkirchen
;	Fed. Rep. of Germany	840418
;
; 850419	changed * (star)
; 850507	added   0<>, 0>, TUCK, NIP, -ROT, CSWAP, PICK
; 850511	added	-CMOVE
;
; -----------------------------------------------------------------------------
; Disc I/O has been modified a la Albert van der Horst (HCCH) to employ
; CP/M 2.x's random access feature.
; -----------------------------------------------------------------------------
; -----------------------------------------------------------------------------
;
; Z280 specifics
;
;
iopreg		equ	08h		; i/o page register
;
config0		equ	0e0h		; c/t 0 configuration register
cntrl0		equ	0e1h		; c/t 0 command/status register
tcon0		equ	0e2h		; c/t 0 time constatnt register
count0		equ	0e3h		; c/t 0 count-time register
config1		equ	0e8h		; c/t 1 configuration register
cntrl1		equ	0e9h		; c/t 1 command/status register
tcon1		equ	0eah		; c/t 1 time constant register
count1		equ	0ebh		; c/t 1 count-time register
;
; -----------------------------------------------------------------------------
;
;	Release & Version numbers
;
figrel		equ	1		;FIG RELEASE #
figrev		equ	1		;FIG REVISION #
usrver		equ	61h		;USER VERSION # a by EHR
;
;Console & printer drivers are in external source named
;CONPRTIO.FTH & disc drivers in DISCIO.FTH. It has 4 screen
;buffers & end of memory is set to FBASE from locn. 0007H.
	page					
;	ASCII characters used
;
abl		equ	20h		;BLANK
acr		equ	0dh		;CR
adot		equ	2eh		;.
bell		equ	07h		;^G
bsin		equ	08h		;backspace chr = ^H
bsout		equ	08h		
dle		equ	10h		;^P
lf		equ	0ah		;^J
ff		equ	0ch		;^L
;
;	Memory allocation
;
bdoss		equ	0005h		;/ system entry
nscr		equ	4		;  # of 1024 byte screens
kbbuf		equ	128		;  bytes/disc buffer
us		equ	40h		;  user variables space
rts		equ	400h		;  Return Stack & term buff space
co		equ	kbbuf+4		;  Disc buff + 2 header + 2 tail
nbuf		equ	nscr*400h/kbbuf	;  # of buffers
bufsiz		equ	co*nbuf		;/ total disc buffer size
	page					
	aseg					
	;.z280					
	; PRE280 V1.11b 20-Nov-90  Copyright (c) 1990 by A.Zinser (fifi@veeble.north.de)
	.Z80
;
	org	0100h				
;
orig:					
	nop					
	jp	cld			; vector to cold start
	nop				
	jp	wrm			; vector to warm start
	defb	figrel			; fig release #
	defb	figrev			; fig revision #
	defb	usrver			; user version #
	defb	0eh			; implementation attributes
;
;
;
;	0eh = 0000:1110
;	      ---------
; B +ORIGIN   ...W:IEBA
;
; W: 0=above sufficient
;    1=other differences exist
; I: Interpreter is	0=pre-
;			1=post incrementing
; E: Addr must be even: 0 yes
;			1 no
; B: High byte @	0=low addr.
;			1=high addr.
; A: CPU Addr.		0=BYTE
;			1=WORD
;
;
;
	defw	task-7			;  topmost word in FORTH vocabulary
	defw	bsin			;  backspace chr
upinit:	defw	0			;/ init (up)
;
; * Following used by COLD; must be in same order as user variables *
;
s0init:	defw	0			;/ init (s0)
r0init:	defw	0			;/ init (r0)
tibini:	defw	0			;/ init (TIB)
	defw	1fh			;  init (WIDTH)
	defw	0			;  init (WARNING)
	defw	initdp			;  init (FENCE)
	defw	initdp			;  init (dp)
	defw	forth+8			;  init (VOC-LINK)
;
; *  END DATA USED BY COLD *
;
	defw	0018h,0f600h		; Z280 CPU name (hw,lw)
					; (32 bit base 36 integer)
	page				
;	REGISTERS
;
;	FORTH	Z80	FORTH PRESERVATION RULES
;	-----	---	-----------------------
;	IP	BC	should be preserved
;			accross FORTH words.
;	W	DE	sometimes output from
;			NEXT, may be altered
;			b4 JP'ing to NEXT,
;			input only when 
;			"DPUSH" called.
;	SP	SP	should be used only as
;			Data Stack accross
;			FORTH words, may be
;			used within FORTH
;			words if restored
;			b4 "NEXT"
;		HL	Never output frm NEXT
;			input only when
;			"HPUSH" called
;
;
up:	defw	0			;/ user area ptr
rpp:	defw	0			;/ return stack ptr
buf1:	defw	0			;/ address of 1st disc buffer
;
;
;	COMMENT CONVENTIONS:
;
;	==	means "is equal to"
;	<--	means assignment
;	#NAME	=     value of name
;	NAME    =     contents @ name
;	(NAME)  =     contents of cell addressed by name
;	cfa	=     code field address
;	lfa	=     link field address
;	nfa	=     name field address
;	pfa	=     parameter field address
;	s1	=     1st word of parameter stack
;	s2	=     2nd -"-  of    -"-     -"-
;	r1	=     1st -"-  of return stack
;	r2	=     2nd -"-  of  -"-    -"-
; ( above Stack posn. valid b4 & after execution of any word, not during)
;
;	lsb	=     least significant bit
;	msb	=     most  significant bit
;	lb	=     low  byte
;	hb	=     high byte
;	lw	=     low  word
;	hw	=     high word
; (May be used as suffix to above names)
	page				
;	FORTH ADDRESS INTERPRETER
;	POST INCREMENTING VERSION
;
;
;
dpush:					
	push	de			
hpush:					
	push	hl			; iy points here
next:					
	ld	h,b			;/ w <-- (ip)    ix points here
	ld	l,c			;/
	;ldw	hl,(hl)			;/ (hl) --> cfa
	DEFB	0EDh,26h
	inc	bc			
	inc	bc			;/ ip += 2
next1:					
	;ldw	de,(hl)			;/ pc <-- (w)
	DEFB	0EDh,16h
	ex	de,hl			
	inc	de			
	jp	(hl)			; note: de <-- cfa + 1
;
;
jnext	macro				
	jp	(ix)			
	endm				
;
jhpush	macro				
	jp	(iy)			
	endm				
;
	page				
;	FORTH DICTIONARY
;	DICTIONARY FORMAT:
;
;				BYTE
;	ADDRESS NAME		CONTENTS
;	------- ----		--------
;						(MSB=1
;						(P=PRECEDENCE BIT
;						(S=SMUDGE BIT
;	NFA	NAME FIELD	1PS<LEN>	<NAME LENGTH
;				0<1CHAR>	MSB=0, NAME'S 1st CHAR
;				0<2CHAR>
;				  ...
;				1<LCHAR>	MSB=1, NAME'S LAST CHAR
;	LFA	LINK FIELD	<LINKLB>	=PREVIOUS WORD'S NFA
;				<LINKHB>
;LABEL:	CFA	CODE FIELD	<CODELB>	=ADDR CPU CODE
;				<CODEHB>
;	PFA	PARAMETER	<1PARAM>	1st PARAMETER BYTE
;		FIELD		<2PARAM>
;				  ...
;
;
;
dp0:					
	defb	83h			; LIT
	defc	'LIT'			
	defw	0			; lfa == 0 marks end of dictionary 
lit:					
	defw	$+2			; s1 <-- (ip)
	ld	h,b			
	ld	l,c			
	;ldw	hl,(hl)			; hl <-- (ip) = literal
	DEFB	0EDh,26h
	inc	bc			;/
	inc	bc			;/ ip += 2
	jhpush				; s1 <-- hl
;
;
	defb	87h			; EXECUTE
	defc	'EXECUTE'		
	defw	lit-6			
exec:					
	defw	$+2			
	pop	hl			
	jp	next1			
;
;
	defb	86h			; BRANCH
	defc	'BRANCH'		
	defw	exec-0ah		
bran:					
	defw	$+2			; ip += (ip)
bran1:					
	ld	h,b			
	ld	l,c			; hl <-- ip
	;addw	hl,(hl)			; hl <-- ip + branch offset
	DEFB	0DDH
	DEFB	0EDH,0C6h
	ld	c,l			
	ld	b,h			; ip += branch offset
	jnext				
;
;
	defb	87h			; 0BRANCH
	defc	'0BRANCH'		
	defw	bran-9			
zbran:					
	defw	$+2			
	pop	hl			
	ld	a,l			
	or	h			
	jr	z,bran1			; branch if if s1 == 0
	inc	bc			; else skip branch offset
	inc	bc			
	jnext				
;
;
	defb	86h			; (LOOP)
	defc	'(LOOP)'		
	defw	zbran-0ah		
xloop:					
	defw	$+2			
	ld	hl,(rpp)		; (hl) --> index = r1
	;incw	(hl)			;/ index += 1
	DEFB	0DDH
	inc	BC
	;ldw	de,(hl)			;/ de <-- new index
	DEFB	0EDh,16h
	inc	hl			;/
	inc	hl			;/ hl --> limit(lb)
	ld	a,e			
	sub	(hl)			
	ld	a,d			
	inc	hl			; hl --> limit(hb)
	sbc	a,(hl)			; index < limit?
	jp	m,bran1			; yes, loop again
	inc	hl			; no, done
	ld	(rpp),hl		; discard r1 & r2
	inc	bc			
	inc	bc			; skip branch offset
	jnext				
;
;
	defb	87h			; (+LOOP)
	defc	'(+LOOP)'		
	defw	xloop-9			
xploo:					
	defw	$+2			
	pop	de			; de <-- increment
	ld	hl,(rpp)		; hl --> index
	ld	a,(hl)			; index += increment
	add	a,e			
	ld	(hl),a			
	ld	e,a			
	inc	hl			
	ld	a,(hl)			
	adc	a,d			
	ld	(hl),a			
	inc	hl			; (hl) --> limit
	inc	d			
	dec	d			
	ld	d,a			; de <-- new index
	jp	m,xloo2			; if incr > 0
	ld	a,e			
	sub	(hl)			; then a <-- index - limit
	ld	a,d			
	inc	hl			
	sbc	a,(hl)			
	jp	xloo3			

xloo2:					
	ld	a,(hl)			; else  a <-- limit - index
	sub	e			
	inc	hl			
	ld	a,(hl)			
	sbc	a,d			
;					; if a < 0
xloo3:					
	jp	m,bran1			; then loop again
	inc	hl			; else done
	ld	(rpp),hl		; discard r1 & r2
	inc	bc			; skip branch offset
	inc	bc			
	jnext				
;
;
	defb	84h			;  (DO)
	defc	'(DO)'			
	defw	xploo-0ah		
xdo:					
	defw	$+2			
	pop	de			;  de <-- initial index
	ld	hl,(rpp)		;  hl <-- rp
	dec	hl			
	dec	hl			
	;pop	(hl)			;/ r2 <-- limit
	DEFB	0DDH
	pop	BC
	dec	hl			
	dec	hl			
	;ldw	(hl),de			;/ r1 <-- initial index
	DEFB	0EDh,1Eh
	ld	(rpp),hl		;  rp -= 4
	jnext				
;
;
	defb	81h			; I
	defc	'I'			
	defw	xdo-7			
ido:					
	defw	$+2			
	ld	hl,(rpp)		
	;push	(hl)			;/ s1 <-- r1, r1 unchanged
	DEFB	0DDH
	push	BC
	jnext				
;
;
	defb	85h			; DIGIT
	defc	'DIGIT'			
	defw	ido-4			
digit:					
	defw	$+2			
	pop	hl			; l <-- s1.lb = base value
	pop	de			; e <-- s2.lb = chr to be converted
	ld	a,e			; a <-- chr
	sub	'0'			; >= 0?
	jr	c,digi2			;/ < 0 is invalid
	cp	0ah			; > 9?
	jr	c,digi1			;/ no, test base value
	sub	07h			; gap between '9' & 'A', nw 'A'=0ah
	cp	0ah			; >= 'A'?
	jr	c,digi2			;/ chrs btwn '9' & 'A' are invalid
digi1:					
	cp	l			; < base value?
	jr	nc,digi2		;/ no, invalid
	ld	e,a			; s2 <-- de = converted digit
	ld	hl,0001h		; s1 <-- true
	jp	dpush			
;
digi2:					
	ld	l,h			; hl <-- false
	jhpush				; s1 <-- false
;
;
	defb	86h			; (FIND) (2-1)FAILURE
	defc	'(FIND)'		;        (2-3)SUCCESS
	defw	digit-8			
pfind:					
	defw	$+2			
	pop	de			; de <-- nfa
pfin1:					
	pop	hl			; hl <-- string addr
	push	hl			; save for next iteration
	ld	a,(de)			
	xor	(hl)			; filter differences
	and	3fh			; mask msb & precedence bit
	jr	nz,pfin4		; lengths differ
pfin2:					
	inc	hl			; hl --> next string chr
	inc	de			; de --> next name field chr
	ld	a,(de)			
	xor	(hl)			; filter differences
	add	a,a			; shift msbit into carry
	jr	nz,pfin3		; no match
	jr	nc,pfin2		; match so far, loop agn
	ld	hl,0005h		; string matches
	add	hl,de			; (sp) <-- pfa
	ex	(sp),hl			
pfin6:					
	dec	de			; de --> nfa
	ld	a,(de)			
	or	a			; msb=1? =length byte
	jp	p,pfin6			; no, try next chr
	ld	e,a			; e <-- length byte
	ld	d,00h			
	ld	hl,0001h		; hl <-- true
	jp	dpush			; name field found, return
;
; above name field not a match, try next one
;
pfin3:					
	jr	c,pfin5			; carry=end of name field
pfin4:					
	inc	de			; find name field end
	ld	a,(de)			
	or	a			; msb=1?
	jp	p,pfin4			; no, loop
pfin5:					
	inc	de			; de <-- lfa
	ex	de,hl			
	;ldw	de,(hl)			;/ de <-- lfa
	DEFB	0EDh,16h
	ld	a,d			
	or	e			; end of dictionary (lfa = 0)?
	jr	nz,pfin1		; no, try previous definition
	pop	hl			; drop string address
	ld	hl,0			; hl <-- false
	jhpush				; no match found, return
;
;
	defb	87h			; ENCLOSE
	defc	'ENCLOSE'		
	defw	pfind-9			
encl:					
	defw	$+2			
	pop	de			; de <-- s1 = delimiter chr
	pop	hl			; hl <-- s2 = addr of text to scan
	push	hl			; s4 <-- addr
	ld	a,e			
	ld	d,a			; d <-- delim chr
	ld	e,-1			; init chr offset counter
	dec	hl			; hl <-- addr - 1
encl1:					
	inc	hl			; skip over leading delim chrs
	inc	e			
	cp	(hl)			; delim chr?
	jr	z,encl1			; yes, loop
	ld	d,0			
	push	de			; s3 <-- e = offset to 1st non delim
	ld	d,a			; d <-- delim chr
	ld	a,(hl)			
	and	a			; 1st non-delim=null?
	jr	nz,encl2		; no
	ld	d,0			; yes
	inc	e			
	push	de			; s2 <-- offset to byte following null
	dec	e			
	push	de			; s1 <-- offset to null
	jnext				
;
encl2:					
	ld	a,d			; A <-- delim chr
	inc	hl			; hl <-- next chr's address
	inc	e			; e <-- offset to next chr
	cp	(hl)			; delim chr?
	jr	z,encl4			; yes
	ld	a,(hl)			
	and	a			; null?
	jr	nz,encl2		; no, continue scan
encl3:					
	ld	d,0			
	push	de			; s2 <-- offset to null
	push	de			; s1 <-- offset to null
	jnext				
;
encl4:					
	ld	d,0			
	push	de			; s2 <-- offset to byte following text
	inc	e			
	push	de			; s1 <-- offset 2 bytes aft end of word
	jnext				
;
;
	defb	84h			; EMIT
	defc	'EMIT'			
	defw	encl-0ah		
emit:					
	defw	docol			
	defw	pemit			
	defw	one,outt		
	defw	pstor,semis		
;
;
	defb	83h			; KEY
	defc	'KEY'			
	defw	emit-7			
key:					
	defw	$+2			
	jp	pkey			
;
;
	defb	89h			; ?TERMINAL
	defc	'?TERMINAL'		
	defw	key-6			
qterm:					
	defw	$+2			
	ld	hl,0			
	jp	pqter			
;
;
	defb	82h			; CR
	defc	'CR'			
	defw	qterm-0ch		
cr:					
	defw	$+2			
	jp	pcr			
;
;
	defb	85h			; CMOVE
	defc	'CMOVE'			
	defw	cr-5			
cmove:					
	defw	$+2			
	exx				;/ save ip
	pop	bc			;  bc <-- s1 = # of chrs
	pop	de			;  de <-- s2 = dest addr
	pop	hl			;/ hl <-- s3 = source addr
	ld	a,b			
	or	c			;  bc=0?
	jr	z,cmove1		;  yes, nothing to move
	ldir				;/ xfer string
cmove1:					
	exx				;/ restore ip
	jnext				
;
;
	defb	86h			;/   -CMOVE    ( from to count --- )
	defc	'-CMOVE'		
	defw	cmove-8			
bcmov:					
	defw	$+2			
	exx				; save ip
	pop	bc			; bc <-- count
	pop	de			; de <-- destination
	pop	hl			; hl <-- source
	ld	a,b			
	or	c			; bc =0?
	jr	z,bcmov1		; yes, nothing to move
	add	hl,bc			
	dec	hl			; hl --> hi end of source block
	ex	de,hl			
	add	hl,bc			
	dec	hl			
	ex	de,hl			; de --> hi end of dest. block
	lddr				; (de) <-- (hl), --hl,bc until bc=0
bcmov1:					
	exx				; restore ip
	jnext				
;
;
	defb	82h			; U*   16*16 unsigned multiply
	defc	'U*'			;      with 32 bit result
	defw	bcmov-9			
ustar:					
	defw	$+2			
	pop	de			; de <-- multiplier
	pop	hl			; hl <-- multiplicant
	;multuw	hl,de			;/
	DEFB	0EDH,0D3h
	ex	de,hl			;/ de <-- product.lw, hl <-- product.hw
	jp	dpush			; s2,s1 <-- product.lw,hw
;
;
	defb	82h			; U/   ( ud u1 -- urem uq )
	defc	'U/'			
	defw	ustar-5			
uslas:					
	defw	$+2			
	exx				;/ save ip
	pop	bc			; bc <-- divisor
	pop	hl			; hl <-- dividend.hw
	pop	de			; de <-- dividend.lw
	;cpw	hl,bc			;/ dividend.hw >= divisor?
	DEFB	0EDH,0C7h
	jr	c,usla1			; no, go ahead
	ld	hl,0ffffh		; yes, overflow
	ld	d,h			
	ld	e,l			;/ set rem & quot to max
	jr	usla2			
usla1:					
	ex	de,hl			;/ de,hl <-- dividend.hw,lw
	;divuw	dehl,bc			;/ de <-- remainder, hl <-- quotient
	DEFB	0EDH,0CBh
usla2:					
	push	de			;/ s2 <-- remainder
	push	hl			;/ s1 <-- quotient
	exx				;/ restore ip
	jnext				
;
;
	defb	83h			; AND
	defc	'AND'			
	defw	uslas-5			
andd:					
	defw	$+2			; s1 <-- s1 AND s2
	pop	de			
	pop	hl			
	ld	a,e			
	and	l			
	ld	l,a			
	ld	a,d			
	and	h			
	ld	h,a			
	jhpush				
;
;
	defb	82h			; OR
	defc	'OR'			
	defw	andd-6			
orr:					
	defw	$+2			; s1 <-- s1 OR s2
	pop	de			
	pop	hl			
	ld	a,e			
	or	l			
	ld	l,a			
	ld	a,d			
	or	h			
	ld	h,a			
	jhpush				
;
;
	defb	83h			; XOR
	defc	'XOR'			
	defw	orr-5			
xorr:					
	defw	$+2			; s1 <-- s1 XOR s2
	pop	de			
	pop	hl			
	ld	a,e			
	xor	l			
	ld	l,a			
	ld	a,d			
	xor	h			
	ld	h,a			
	jhpush				
;
;
	defb	83h			; SP@
	defc	'SP@'			
	defw	xorr-6			
spat:					
	defw	$+2			
	ld	hl,0			
	add	hl,sp			; hl <-- sp
	jhpush				; s1 <-- sp
;
;
	defb	83h			; SP!
	defc	'SP!'			
	defw	spat-6			
spsto:					
	defw	$+2			; sp <-- s0  (user variable)
	ld	hl,(up)			; hl <-- user variables base address
	ld	de,6			
	add	hl,de			; hl --> s0
	;ldw	sp,(hl)			;/ sp <-- s0
	DEFB	0EDh,36h
	jnext				
;
;
	defb	83h			; RP@
	defc	'RP@'			
	defw	spsto-6			
rpat:					
	defw	$+2			
	ld	hl,(rpp)		
	jhpush				; s1 <-- rp
;
;
	defb	83h			; RP!
	defc	'RP!'			
	defw	rpat-6			
rpsto:					
	defw	$+2			; rp <-- r0 (user variable)
	ld	hl,(up)			; hl <-- user variables base address
	ld	de,0008h		
	add	hl,de			; hl --> r0
	;ldw	hl,(hl)			;/ hl <-- r0
	DEFB	0EDh,26h
	ld	(rpp),hl		;/ rp <-- r0
	jnext				
;
;
	defb	82h			; ;S
	defc	';S'
	defw	rpsto-6 
semis:					
	defw	$+2			; ip <-- r1 
	ld	hl,(rpp)		
	;ldw	bc,(hl)			;/ bc <-- r1
	DEFB	0EDh,06h
	inc	hl			
	inc	hl			
	ld	(rpp),hl		; rp += 2
	jnext				
;
;
	defb	85h			; LEAVE
	defc	'LEAVE'			
	defw	semis-5			
leave:					
	defw	$+2			; limit <-- index
	ld	hl,(rpp)		
	;ldw	de,(hl)			;/ de <-- r1 (= index)
	DEFB	0EDh,16h
	inc	hl			
	inc	hl			
	;ldw	(hl),de			;/ r2 (= limit) <-- index
	DEFB	0EDh,1Eh
	jnext				
;
;
	defb	82h			; >R
	defc	'>R'			
	defw	leave-8			
tor:					
	defw	$+2			
	ld	hl,(rpp)		
	dec	hl			
	dec	hl			
	;pop	(hl)			;/ r1 <-- s1
	DEFB	0DDH
	pop	BC
	ld	(rpp),hl		;  rp -= 2
	jnext				
;
;
	defb	82h			; R>
	defc	'R>'			
	defw	tor-5			
fromr:					
	defw	$+2			
	ld	hl,(rpp)		
	;push	(hl)			;/ s1 <-- r1
	DEFB	0DDH
	push	BC
	inc	hl			
	inc	hl			
	ld	(rpp),hl		; rp += 2
	jnext				
;
;
	defb	81h			; R
	defc	'R'			
	defw	fromr-5			
rr:					
	defw	ido+2			
;
;
	defb	82h			; 0=
	defc	'0='			
	defw	rr-4			
zequ:					
	defw	$+2			
	pop	de			
	ld	hl,0			
	;cpw	hl,de			;/
	DEFB	0EDH,0D7h
	jr	nz,zequ1		
	inc	l			; hl <-- true
zequ1:					
	jhpush				
;
;
	defb	83h			;/ 0<>
	defc	'0<>'			
	defw	zequ-5			
znequ:					
	defw	$+2			
	pop	de			
	ld	hl,0			
	;cpw	hl,de			;/
	DEFB	0EDH,0D7h
	jr	z,znequ1		
	inc	l			; hl <-- true
znequ1:					
	jhpush				
;
;
	defb	82h			; 0<
	defc	'0<'			
	defw	znequ-6			
zless:					
	defw	$+2			
	pop	af			;/ a <-- s1.hb
	rla				;/ carry <-- bit 7
	ld	hl,0			;  hl <-- false
	rl	l			;/ bit 0 <-- carry
	jhpush				
;
;
	defb	82h			;/ 0>
	defc	'0>'			
	defw	zless-5			
zgt:					
	defw	$+2			
	pop	de			
	ld	hl,0			
	;cpw	hl,de			;/
	DEFB	0EDH,0D7h
	jp	p,zgt1			;/ <= 0
	jp	pe,zgt1			;/ 8000h special case
	inc	l			;/ hl <-- true
zgt1:					
	jhpush				
;
;
	defb	81h		;+
	defc	'+'		
	defw	zgt-5		
plus:					
	defw	$+2		
	pop	de		
	pop	hl		
	add	hl,de		
	jhpush			
;
;
	defb	82h			; D+ ( d1l d1h d2l d2h -- d3l d3h)
	defc	'D+'			
	defw	plus-4			
dplus:					
	defw	$+2			
	exx				;/ save ip
	pop	bc			;  bc <-- d2.hw
	pop	hl			;  hl <-- d2.lw
	pop	af			;d af <-- d1.hw
	pop	de			;  de <-- d1.lw
	push	af			;/ s1 <-- d1.hw
	add	hl,de			;  hl <-- d2.lw + d1.lw (= d3.lw)
	ex	de,hl			;  de <-- d3.lw
	pop	hl			;  hl <-- d1.hw
	adc	hl,bc			;/ hl <-- d1.hw + d2.hw +carry (=d3.hw)
	push	de			;  s2 <-- d3.lw
	push	hl			;/ s1 <-- d3.hw
	exx				;/ restore ip
	jnext				
;
;
	defb	85h			; MINUS
	defc	'MINUS'			
	defw	dplus-5			
minus:					
	defw	$+2			
	pop	hl			;/
	;neg	hl			;/
	DEFB	0EDH,4Ch
	jhpush				
;
;
	defb	86h			; DMINUS
	defc	'DMINUS'		
	defw	minus-8			
dminu:					
	defw	$+2			
	exx				;/ save ip
	pop	de			;/ de <-- d1.hw
	pop	bc			;/ bc <-- d1.lw
	ld	hl,0			;/
	;subw	hl,bc			;/
	DEFB	0EDH,0CEh
	push	hl			; s2 <-- d2.lw
	ld	hl,0			;/
	sbc	hl,de			;/
	push	hl			; s1 <-- d2.hw
	exx				;/
	jnext				
;
;
	defb	84h			; OVER
	defc	'OVER'			
	defw	dminu-9			
over:					
	defw	$+2			
	;ldw	hl,(sp+2)		;/
	DEFB	0EDh,04h
	DEFW	+2
	jhpush				;/
;
;
	defb	84h			; DROP
	defc	'DROP'			
	defw	over-7			
drop:					
	defw	$+2			
	inc	sp			
	inc	sp			;/ faster on z280 than dummy pop
	jnext				
;
;
	defb	84h			; SWAP
	defc	'SWAP'			
	defw	drop-7			
swap:					
	defw	$+2			
	pop	hl			
	ex	(sp),hl			
	jhpush				
;
;
	defb	83h			; DUP
	defc	'DUP'			
	defw	swap-7			
dup:					
	defw	$+2			
	;ldw	hl,(sp+0)		;/
	DEFB	0EDh,04h
	DEFW	+0
	jhpush				
;
;
	defb	84h			;/ TUCK     ( n1 n2 --- n2 n1 n2)
	defc	'TUCK'			
	defw	dup-6			
tuck:					
	defw	$+2			
	pop	hl			;/ hl <-- s1
	pop	de			;/ de <-- s2
	push	hl			;/ s3 <-- hl
	jp	dpush			
;
;
	defb	83h			;/ NIP      ( n1 n2 --- n2)
	defc	'NIP'			
	defw	tuck-7			
nip:					
	defw	$+2			
	pop	hl			; hl <-- s1
	;ldw	(sp+0),hl		;/ s1 <-- hl
	DEFB	0EDh,05h
	DEFW	+0
	jnext				
;
;
	defb	84h			;/ -ROT     ( n1 n2 n3 --- n3 n1 n2)
	defc	'-ROT'			
	defw	nip-6			
mrot:					
	defw	$+2			
	pop	hl			
	pop	de			
	ex	(sp),hl			
	ex	de,hl			
	jp	dpush			
;
;
	defb	85h			;/ CSWAP   ( n1 --- n1, bytes swapped)
	defc	'CSWAP'			
	defw	mrot-7			
cswap:					
	defw	$+2			
	pop	hl			
	;ex	h,l			;/
	DEFB	0EDH,0EFh
	jhpush				
;
;
	defb	84h			;/ PICK   ( nn...n0 k --- nn..n0 nk)
	defc	'PICK'			
	defw	cswap-8			
pick:					
	defw	$+2			
	pop	hl			; hl <-- depth
	add	hl,hl			; adjust to word size
	add	hl,sp			; offset into stack
	;push	(hl)			;/
	DEFB	0DDH
	push	BC
	jnext				
;
;
	defb	84h			; 2DUP
	defc	'2DUP'			
	defw	pick-7			
tdup:					
	defw	$+2			
	pop	hl			
	pop	de			
	push	de			
	push	hl			
	jp	dpush			
;
;
	defb	82h			; +!
	defc	'+!'			
	defw	tdup-7			
pstor:					
	defw	$+2			
	pop	hl			; hl --> variable
	pop	de			; de <-- number
	ld	a,(hl)			
	add	a,e			
	ld	(hl),a			
	inc	hl			
	ld	a,(hl)			
	adc	a,d			
	ld	(hl),a			; (hl) += number
	jnext				
;
;
	defb	86h			; TOGGLE
	defc	'TOGGLE'		
	defw	pstor-5			
toggl:					
	defw	$+2			
	pop	de			; e <-- bit pattern
	pop	hl			; hl --> address
	ld	a,(hl)			
	xor	e			
	ld	(hl),a			
	jnext				
;
;
	defb	81h			; @
	defc	'@'			
	defw	toggl-9			
at:					
	defw	$+2			
	pop	hl			
	;push	(hl)			;/
	DEFB	0DDH
	push	BC
	jnext				
;
;
	defb	82h			; C@
	defc	'C@'			
	defw	at-4			
cat:					
	defw	$+2			
	pop	hl			
	ld	l,(hl)			
	ld	h,0			
	jhpush				
;
;
	defb	82h			; 2@
	defc	'2@'			
	defw	cat-5			
tat:					
	defw	$+2			
	pop	hl			;  hl --> address
	;ldw	de,(hl)			;/ de <-- d.hw
	DEFB	0EDh,16h
	inc	hl			
	inc	hl			;  hl --> d.lw
	;push	(hl)			;/ s2 <-- d.lw
	DEFB	0DDH
	push	BC
	push	de			;/ s1 <-- d.hw
	jnext				
;
;
	defb	81h			; !
	defc	'!'			
	defw	tat-5			
store:					
	defw	$+2			
	pop	hl			; hl --> address
	;pop	(hl)			;/
	DEFB	0DDH
	pop	BC
	jnext				
;
;
	defb	82h			; C!
	defc	'C!'			
	defw	store-4			
cstor:					
	defw	$+2			
	pop	hl			; hl --> address
	pop	de			; e <-- char
	ld	(hl),e			
	jnext				
;
;
	defb	82h			; 2!
	defc	'2!'			
	defw	cstor-5			
tstor:					
	defw	$+2			
	pop	hl			; hl --> address
	;pop	(hl)			;/ store d.hw
	DEFB	0DDH
	pop	BC
	inc	hl			
	inc	hl			
	;pop	(hl)			;/ store d.lw
	DEFB	0DDH
	pop	BC
	jnext				
;
;
	defb	0c1h			; :
	defc	':'			
	defw	tstor-5			
colon:					
	defw	docol			
	defw	qexec			
	defw	scsp			
	defw	curr			
	defw	at			
	defw	cont			
	defw	store			
	defw	creat			
	defw	rbrac			
	defw	pscod			
docol:					
	ld	hl,(rpp)		
	dec	hl			
	dec	hl			
	;ldw	(hl),bc			;/ save return address
	DEFB	0EDh,0Eh
	ld	(rpp),hl		
	inc	de			
	ld	c,e			
	ld	b,d			
	jnext				
;
;
	defb	0c1h			; ;
	defc	';'
	defw	colon-4 
semi:					
	defw	docol 
	defw	qcsp 
	defw	comp 
	defw	semis 
	defw	smudg 
	defw	lbrac 
	defw	semis 
;
;
	defb	84h			; NOOP
	defc	'NOOP'			
	defw	semi-4			
noop:					
	defw	docol			
	defw	semis			
;
;
	defb	88h			; CONSTANT
	defc	'CONSTANT'		
	defw	noop-7			
con:					
	defw	docol			
	defw	creat			
	defw	smudg			
	defw	comma			
	defw	pscod			
docon:					
	inc	de			
	ex	de,hl			
	;push	(hl)			;/
	DEFB	0DDH
	push	BC
	jnext				
;
;
	defb	88h			; VARIABLE
	defc	'VARIABLE'		
	defw	con-0bh			
var:					
	defw	docol			
	defw	con			
	defw	pscod			
dovar:					
	inc	de			
	push	de			
	jnext				
;
;
	defb	84h			; USER
	defc	'USER'			
	defw	var-0bh			
user:					
	defw	docol			
	defw	con			
	defw	pscod			
douse:					
	inc	de			
	ex	de,hl			
	ld	l,(hl)			;/
	ld	h,0			;/
	;addw	hl,(up)			;/
	DEFB	0DDH
	DEFB	0EDH,0D6h
	DEFW	UP
	jhpush				
;
;
	defb	81h			; 0
	defc	'0'			
	defw	user-7			
zero:					
	defw	$+2			;/
	;push	0000h			;/
	DEFB	0FDH
	push	AF
	DEFW	0000H                                   
	jnext				
;
;
	defb	81h			; 1
	defc	'1'			
	defw	zero-4			
one:					
	defw	$+2			;/
	;push	0001h			;/
	DEFB	0FDH
	push	AF
	DEFW	0001H                                   
	jnext				
;
;
	defb	81h			; 2
	defc	'2'			
	defw	one-4			
two:					
	defw	$+2			;/
	;push	0002h			;/
	DEFB	0FDH
	push	AF
	DEFW	0002H                                   
	jnext				
;
;
	defb	81h			; 3
	defc	'3'			
	defw	two-4			
three:					
	defw	$+2			;/
	;push	0003h			;/
	DEFB	0FDH
	push	AF
	DEFW	0003H                                   
	jnext				
;
;
	defb	82h			; BL
	defc	'BL'			
	defw	three-4			
bl:					
	defw	docon			
	defw	20h			
;
;
	defb	83h			; C/L
	defc	'C/L'			
	defw	bl-5			
csll:					
	defw	docon			
	defw	64			
;
;
	defb	85h			; FIRST
	defc	'FIRST'			
	defw	csll-6			
first:					
	defw	docon			
	defw	0			;/ set by CLD
;
;
	defb	85h			; LIMIT
	defc	'LIMIT'			
	defw	first-8			
limit:					
	defw	docon			
	defw	0			;/ set by CLD
;
;
	defb	85h			; B/BUF
	defc	'B/BUF'			
	defw	limit-8			
bbuf:					
	defw	docon			
	defw	kbbuf			
;
;
	defb	85h			; B/SCR
	defc	'B/SCR'			
	defw	bbuf-8			
bscr:					
	defw	docon			
	defw	400h/kbbuf		
;
;
	defb	87h			; +ORIGIN
	defc	'+ORIGIN'		
	defw	bscr-8			
porig:					
	defw	docol			
	defw	lit			
	defw	orig			
	defw	plus			
	defw	semis			
;
;	USER VARIABLES
;
	defb	82h			; S0
	defc	'S0'			
	defw	porig-0ah		
szero:					
	defw	douse			
	defw	6			
;
;
	defb	82h			; R0
	defc	'R0'			
	defw	szero-5			
rzero:					
	defw	douse			
	defw	8			
;
;
	defb	83h			; TIB
	defc	'TIB'			
	defw	rzero-5			
tib:					
	defw	douse			
	defb	0ah			
;
;
	defb	85h			; WIDTH
	defc	'WIDTH'			
	defw	tib-6			
width:					
	defw	douse			
	defb	0ch			
;
;
	defb	87h			; WARNING
	defc	'WARNING'		
	defw	width-8			
warn:					
	defw	douse			
	defb	0eh			
;
;
	defb	85h			; FENCE
	defc	'FENCE'			
	defw	warn-0ah		
fence:					
	defw	douse			
	defb	10h			
;
;
	defb	82h			; DP
	defc	'DP'			
	defw	fence-8			
dp:					
	defw	douse			
	defb	12h			
;
;
	defb	88h			; VOC-LINK
	defc	'VOC-LINK'		
	defw	dp-5			
vocl:					
	defw	douse			
	defw	14h			
;
;
	defb	83h			; BLK
	defc	'BLK'			
	defw	vocl-0bh		
blk:					
	defw	douse			
	defb	16h			
;
;
	defb	82h			; IN
	defc	'IN'			
	defw	blk-6			
inn:					
	defw	douse			
	defb	18h			
;
;
	defb	83h			; OUT
	defc	'OUT'			
	defw	inn-5			
outt:					
	defw	douse			
	defb	1ah			
;
;
	defb	83h			; SCR
	defc	'SCR'			
	defw	outt-6			
scr:					
	defw	douse			
	defb	1ch			
;
;
	defb	86h			; OFFSET
	defc	'OFFSET'		
	defw	scr-6			
ofset:					
	defw	douse			
	defb	1eh			
;
;
	defb	87h			; CONTEXT
	defc	'CONTEXT'		
	defw	ofset-9			
cont:					
	defw	douse			
	defb	20h			
;
;
	defb	87h			; CURRENT
	defc	'CURRENT'		
	defw	cont-0ah		
curr:					
	defw	douse			
	defb	22h			
;
;
	defb	85h			; STATE
	defc	'STATE'			
	defw	curr-0ah		
state:					
	defw	douse			
	defb	24h			
;
;
	defb	84h			; BASE
	defc	'BASE'			
	defw	state-8			
base:					
	defw	douse			
	defb	26h			
;
;
	defb	83h			; DPL
	defc	'DPL'			
	defw	base-7			
dpl:					
	defw	douse			
	defb	28h			
;
;
	defb	83h			; FLD
	defc	'FLD'			
	defw	dpl-6			
fld:					
	defw	douse			
	defb	2ah			
;
;
	defb	83h			; CSP
	defc	'CSP'			
	defw	fld-6			
cspp:					
	defw	douse			
	defb	2ch			
;

	defb	82h			; R#
	defc	'R#'			
	defw	cspp-6			
rnum:					
	defw	douse			
	defb	2eh			
;

	defb	83h			; HLD
	defc	'HLD'			
	defw	rnum-5			
hld:					
	defw	douse			
	defw	30h			
;
;	END OF USER VARIABLES
;
	defb	82h			; 1+
	defc	'1+'			
	defw	hld-6			
onep:					
	defw	$+2			;/
	pop	hl			;/
	inc	hl			;/
	jhpush				;/
;
;
	defb	82h			; 2+
	defc	'2+'			
	defw	onep-5			
twop:					
	defw	$+2			;/
	pop	hl			;/
	inc	hl			;/
	inc	hl			;/
	jhpush				;/
;
;
	defb	82h			;/ 1-
	defc	'1-'			;/
	defw	twop-5			;/
onemin:					
	defw	$+2			;/
	pop	hl			;/
	dec	hl			;/
	jhpush				;/
;
;
	defb	82h			;/ 2-
	defc	'2-'			;/
	defw	onemin-5		;/
twomin:					
	defw	$+2			;/
	pop	hl			;/
	dec	hl			;/
	dec	hl			;/
	jhpush				;/
;
;
	defb	82h			;/ 2*
	defc	'2*'			;/
	defw	twomin-5		;/
twosta:					
	defw	$+2			;/
	pop	hl			;/
	add	hl,hl			;/ asl hl
	jhpush				;/
;
;
	defb	82h			;/ 2/
	defc	'2/'			;/
	defw	twosta-5		;/
twosla:					
	defw	$+2			;/
	pop	hl			;/
	bit	7,h			;/ negative?
	jr	z,twosl1		;/ no
	inc	hl			;/ yes, add 1
twosl1:					
	sra	h			;/
	rr	l			;/ asr hl
	jhpush				;/
;
;
	defb	84h			; HERE
	defc	'HERE'			
	defw	twosla-5		
here:					
	defw	docol			
	defw	dp			
	defw	at			
	defw	semis			
;
;
	defb	85h			; ALLOT
	defc	'ALLOT'			
	defw	here-7			
allot:					
	defw	docol			
	defw	dp			
	defw	pstor			
	defw	semis			
;
;
	defb	81h			; ,
	defc	','			
	defw	allot-8			
comma:					
	defw	docol			
	defw	here			
	defw	store			
	defw	two			
	defw	allot			
	defw	semis			
;

	defb	82h			; C,
	defc	'C,'			
	defw	comma-4			
ccomm:					
	defw	docol			
	defw	here			
	defw	cstor			
	defw	one			
	defw	allot			
	defw	semis			
;
;
	defb	81h			; -
	defc	'-'			
	defw	ccomm-5			
subb:					
	defw	$+2			
	pop	de			
	pop	hl			
	;subw	hl,de			;/
	DEFB	0EDH,0DEh
	jhpush				
;
;
	defb	81h			; =
	defc	'='			
	defw	subb-4			
equal:					
	defw	$+2			;/
	pop	de			;/
	pop	hl			;/
	;subw	hl,de			;/
	DEFB	0EDH,0DEh
	ld	hl,0			;  hl <-- false
	jr	nz,equal1		
	inc	l			;/ hl <-- true
equal1:					
	jhpush				
;
;
	defb	81h			;  <
	defc	'<'			
	defw	equal-4			
less:					
	defw	$+2			
	pop	de			
	pop	hl			; hl de <
	ld	a,d			
	xor	h			; one operand negative?
	jp	m,less1			; yes, determine which
	;subw	hl,de			;/
	DEFB	0EDH,0DEh
less1:					
	bit	7,h			;/ h negative?
	ld	hl,0			; hl <-- false
	jr	z,less2			
	inc	l			;/ hl <-- true
less2:					
	jhpush				
;
;
	defb	82h			; U<
	defc	'U<'			
	defw	less-4			
uless:					
	defw	$+2			
	pop	de			
	pop	hl			;/ hl de U<
	;subw	hl,de			;/
	DEFB	0EDH,0DEh
	ld	hl,0			; hl <-- false
	rl	l			;/ bit 0 <-- carry
uless1:					
	jhpush				
;
;
	defb	81h			; >
	defc	'>'			
	defw	uless-5			
great:					
	defw	$+2			
	pop	hl			;/
	pop	de			;/ hl de >    (= de hl < )
	ld	a,d			
	xor	h			; one operand negative?
	jp	m,great1		; yes, determine which
	;subw	hl,de			;/
	DEFB	0EDH,0DEh
great1:					
	bit	7,h			;/ h negative?
	ld	hl,0			; hl <-- false
	jr	z,great2		
	inc	l			;/ hl <-- true
great2:					
	jhpush				
;
;
	defb	83h			; ROT     ( n1 n2 n3 --- n2 n3 n1)
	defc	'ROT'			
	defw	great-4			
rot:					
	defw	$+2			
	pop	de			; de <-- n3
	pop	hl			; hl <-- n2
	ex	(sp),hl			; s1 <-- n2, hl <-- n1
	jp	dpush			; s2 <-- n3, s3 <-- n1
;
;
	defb	85h			; SPACE
	defc	'SPACE'			
	defw	rot-6			
space:					
	defw	docol			
	defw	bl			
	defw	emit			
	defw	semis			
;
;
	defb	84h			; -DUP
	defc	'-DUP'			
	defw	space-8			
ddup:					
	defw	$+2			;/
	;ldw	hl,(sp+0)		;/
	DEFB	0EDh,04h
	DEFW	+0
	ld	a,h			;/
	or	l			;/ hl = 0?
	jr	z,ddup1			;/ yes, don't dup
	push	hl			;/
ddup1:					
	jnext				
;
;
	defb	88h			; TRAVERSE
	defc	'TRAVERSE'		
	defw	ddup-7			
trav:					
	defw	docol			
	defw	swap			
trav1:					
	defw	over			; begin
	defw	plus			
	defw	lit			
	defw	7fh			
	defw	over			
	defw	cat			
	defw	less			
	defw	zbran			; until
	defw	trav1-$			
	defw	swap			
	defw	drop			
	defw	semis			
;
;
	defb	86h			; LATEST
	defc	'LATEST'		
	defw	trav-0bh		
lates:					
	defw	docol			
	defw	curr			
	defw	at			
	defw	at			
	defw	semis			
;
;
	defb	83h			; LFA
	defc	'LFA'			
	defw	lates-9			
lfa:					
	defw	$+2			
	pop	hl			;/ hl <-- pfa
	;subw	hl,4			;/
	DEFB	0FDH
	DEFB	0EDH,0FEh
	DEFW	4                                       
	jhpush				;/ s1 <-- lfa
;
;
	defb	83h			; CFA
	defc	'CFA'			
	defw	lfa-6			
cfa:					
	defw	docol			
	defw	twomin			;/
	defw	semis			
;
;
	defb	83h			; NFA
	defc	'NFA'			
	defw	cfa-6			
nfa:					
	defw	docol			
	defw	lit			
	defw	5			
	defw	subb			
	defw	lit			
	defw	-1			
	defw	trav			
	defw	semis			
;
;
	defb	83h			; PFA
	defc	'PFA'			
	defw	nfa-6			
pfa:					
	defw	docol			
	defw	one			
	defw	trav			
	defw	lit			
	defw	5			
	defw	plus			
	defw	semis			
;
;
	defb	84h			; !CSP
	defc	'!CSP'			
	defw	pfa-6			
scsp:					
	defw	docol			
	defw	spat			
	defw	cspp			
	defw	store			
	defw	semis			
;
;
	defb	86h			; ?ERROR
	defc	'?ERROR'		
	defw	scsp-7			
qerr:					
	defw	docol			
	defw	swap			
	defw	zbran			; if
	defw	qerr1-$			
	defw	error			
	defw	bran			; else
	defw	qerr2-$			
qerr1:					
	defw	drop			; endif
qerr2:					
	defw	semis			
;
;
	defb	85h			; ?COMP
	defc	'?COMP'			
	defw	qerr-9			
qcomp:					
	defw	docol			
	defw	state			
	defw	at			
	defw	zequ			
	defw	lit			
	defw	11h			
	defw	qerr			
	defw	semis			
;
;
	defb	85h			; ?EXEC
	defc	'?EXEC'			
	defw	qcomp-8			
qexec:					
	defw	docol			
	defw	state			
	defw	at			
	defw	lit			
	defw	12h			
	defw	qerr			
	defw	semis			
;
;
	defb	86h			; ?PAIRS
	defc	'?PAIRS'		
	defw	qexec-8			
qpair:					
	defw	docol			
	defw	subb			
	defw	lit			
	defw	13h			
	defw	qerr			
	defw	semis			
;
;
	defb	84h			; ?CSP
	defc	'?CSP'			
	defw	qpair-9			
qcsp:					
	defw	docol			
	defw	spat			
	defw	cspp			
	defw	at			
	defw	subb			
	defw	lit			
	defw	14h			
	defw	qerr			
	defw	semis			
;
;
	defb	88h			; ?LOADING
	defc	'?LOADING'		
	defw	qcsp-7			
qload:					
	defw	docol			
	defw	blk			
	defw	at			
	defw	zequ			
	defw	lit			
	defw	16h			
	defw	qerr			
	defw	semis			
;
;
	defb	87h			; COMPILE
	defc	'COMPILE'		
	defw	qload-0bh		
comp:					
	defw	docol			
	defw	qcomp			
	defw	fromr			
	defw	dup			
	defw	twop			
	defw	tor			
	defw	at			
	defw	comma			
	defw	semis			
;
;
	defb	0c1h			; [
	defc	'['			
	defw	comp-0ah		
lbrac:					
	defw	docol			
	defw	zero			
	defw	state			
	defw	store			
	defw	semis			
;
;
	defb	81h			; ]
	defc	']'			
	defw	lbrac-4			
rbrac:					
	defw	docol			
	defw	lit,0c0h		
	defw	state,store		
	defw	semis			
;
;
	defb	86h			; SMUDGE
	defc	'SMUDGE'		
	defw	rbrac-4			
smudg:					
	defw	docol			
	defw	lates			
	defw	lit			
	defw	20h			
	defw	toggl			
	defw	semis			
;
;
	defb	83h			; HEX
	defc	'HEX'			
	defw	smudg-9			
hex:					
	defw	docol			
	defw	lit			
	defw	10h			
	defw	base			
	defw	store			
	defw	semis			
;
;
	defb	87h			; DECIMAL
	defc	'DECIMAL'		
	defw	hex-6			
dec:					
	defw	docol			
	defw	lit			
	defw	0ah			
	defw	base			
	defw	store			
	defw	semis			
;
;
	defb	87h			; (;CODE)
	defc	'( ;CODE)'
	defw	dec-0ah 
pscod:					
	defw	docol 
	defw	fromr 
	defw	lates 
	defw	pfa 
	defw	cfa 
	defw	store 
	defw	semis 
;
;
	defb	0c5h			; ;CODE
	defc	';CODE'
	defw	pscod-0ah 
semic:					
	defw	docol 
	defw	qcsp 
	defw	comp 
	defw	pscod 
	defw	lbrac 
semi1:					
	defw	noop			; assembler
	defw	semis			
;
;
	defb	87h			; <BUILDS
	defc	'<BUILDS'		
	defw	semic-8			
build:					
	defw	docol			
	defw	zero			
	defw	con			
	defw	semis			
;
;
	defb	85h			; DOES>
	defc	'DOES>'			
	defw	build-0ah		
does:					
	defw	docol			
	defw	fromr			
	defw	lates			
	defw	pfa			
	defw	store			
	defw	pscod			
dodoe:					
	ld	hl,(rpp)		
	dec	hl			
	dec	hl			
	;ldw	(hl),bc			;/
	DEFB	0EDh,0Eh
	ld	(rpp),hl		
	inc	de			
	ex	de,hl			
	;ldw	bc,(hl)			;/
	DEFB	0EDh,06h
	inc	hl			
	inc	hl			
	jhpush				
;
;
	defb	85h			; COUNT
	defc	'COUNT'			
	defw	does-8			
count:					
	defw	docol			
	defw	dup			
	defw	onep			
	defw	swap			
	defw	cat			
	defw	semis			
;
;
	defb	84h			; TYPE
	defc	'TYPE'			
	defw	count-8			
type:					
	defw	docol			
	defw	ddup			
	defw	zbran			; if
	defw	type1-$			
	defw	over			
	defw	plus			
	defw	swap			
	defw	xdo			; do
type2:					
	defw	ido			
	defw	cat			
	defw	emit			
	defw	xloop			; loop
	defw	type2-$			
	defw	bran			; else
	defw	type3-$			
type1:					
	defw	drop			; endif
type3:					
	defw	semis			
;
;
	defb	89h			; -TRAILING
	defc	'-TRAILING'		
	defw	type-7			
dtrai:					
	defw	docol			
	defw	dup			
	defw	zero			
	defw	xdo			; do
dtra1:					
	defw	tdup			;/
	defw	plus			
	defw	onemin			;/
	defw	cat			
	defw	bl			
	defw	subb			
	defw	zbran			; if
	defw	dtra2-$			
	defw	leave			
	defw	bran			; else
	defw	dtra3-$			
dtra2:					
	defw	onemin			;/
dtra3:					
	defw	xloop			; loop
	defw	dtra1-$			
	defw	semis			
;
;
	defb	84h			; (.")
	defc	'(.")'			
	defw	dtrai-0ch		
pdotq:					
	defw	docol			
	defw	rr			
	defw	count			
	defw	dup			
	defw	onep			
	defw	fromr			
	defw	plus			
	defw	tor			
	defw	type			
	defw	semis			
;
;
	defb	0c2h			; ."
	defc	'."'			
	defw	pdotq-7			
dotq:					
	defw	docol			
	defw	lit			
	defw	22h			
	defw	state			
	defw	at			
	defw	zbran			; if
	defw	dotq1-$			
	defw	comp			
	defw	pdotq			
	defw	word			
	defw	here			
	defw	cat			
	defw	onep			
	defw	allot			
	defw	bran			; else
	defw	dotq2-$			
dotq1:					
	defw	word			
	defw	here			
	defw	count			
	defw	type			; endif
dotq2:					
	defw	semis			
;
;
	defb	86h			; EXPECT
	defc	'EXPECT'		
	defw	dotq-5			
expec:					
	defw	docol			
	defw	over			
	defw	plus			
	defw	over			
	defw	xdo			; do
expe1:					
	defw	key			
	defw	dup			
	defw	lit			
	defw	0eh			
	defw	porig			
	defw	at			
	defw	equal			
	defw	zbran			; if
	defw	expe2-$			
	defw	drop			
	defw	dup			
	defw	ido			
	defw	equal			
	defw	dup			
	defw	fromr			
	defw	twomin			;/
	defw	plus			
	defw	tor			
	defw	zbran			; if
	defw	expe6-$			
	defw	lit			
	defw	bell			
	defw	bran			; else
	defw	expe7-$			
expe6:					
	defw	lit			
	defw	bsout			; endif
expe7:					
	defw	bran			; else
	defw	expe3-$			
expe2:					
	defw	dup			
	defw	lit			
	defw	acr			;/
	defw	equal			
	defw	zbran			; if
	defw	expe4-$			
	defw	leave			
	defw	drop			
	defw	bl			
	defw	zero			
	defw	bran			; else
	defw	expe5-$			
expe4:					
	defw	dup			; endif
expe5:					
	defw	ido			
	defw	cstor			
	defw	zero			
	defw	ido			
	defw	onep			
	defw	store			; endif
expe3:					
	defw	emit			
	defw	xloop			; loop
	defw	expe1-$			
	defw	drop			
	defw	semis			
;
;
	defb	85h			; QUERY
	defc	'QUERY'			
	defw	expec-9			
query:					
	defw	docol			
	defw	tib			
	defw	at			
	defw	lit			
	defw	50h			
	defw	expec			
	defw	zero			
	defw	inn			
	defw	store			
	defw	semis			
;
;
	defb	0c1h			; NULL
	defb	80h			
	defw	query-8			
null:					
	defw	docol			
	defw	blk			
	defw	at			
	defw	zbran			; if
	defw	null1-$			
	defw	one			
	defw	blk			
	defw	pstor			
	defw	zero			
	defw	inn			
	defw	store			
	defw	blk			
	defw	at			
	defw	bscr			
	defw	onemin			;/
	defw	andd			
	defw	zequ			
	defw	zbran			; if
	defw	null2-$			
	defw	qexec			
	defw	fromr			
	defw	drop			; endif
null2:					
	defw	bran			; else
	defw	null3-$			
null1:					
	defw	fromr			
	defw	drop			; endif
null3:					
	defw	semis			
;
	defb	84h			; FILL
	defc	'FILL'			
	defw	null-4			
fill:					
	defw	$+2			
	exx				;/ save ip
	pop	de			;/ e <-- byte
	pop	bc			;  bc <-- quantity
	pop	hl			;/ hl <-- address
fill1:					
	ld	a,b			
	or	c			;  qty == 0?
	jr	z,fill2			;  yes, nothing (more) to fill
	ld	(hl),e			;/ (hl) <-- byte
	inc	hl			;  inc pointer
	dec	bc			;  dec counter
	jp	fill1			;/
fill2:					
	exx				;/ restore ip
	jnext				
;
;
	defb	85h			; ERASE
	defc	'ERASE'			
	defw	fill-7			
erasee:					
	defw	docol			
	defw	zero			
	defw	fill			
	defw	semis			
;
;
	defb	86h			; BLANKS
	defc	'BLANKS'		
	defw	erasee-8		
blank:					
	defw	docol			
	defw	bl			
	defw	fill			
	defw	semis			
;
;
	defb	84h			; HOLD
	defc	'HOLD'			
	defw	blank-9			
hold:					
	defw	docol			
	defw	lit			
	defw	-1			
	defw	hld			
	defw	pstor			
	defw	hld			
	defw	at			
	defw	cstor			
	defw	semis			
;
;
	defb	83h			; PAD
	defc	'PAD'			
	defw	hold-7			
pad:					
	defw	docol			
	defw	here			
	defw	lit			
	defw	44h			
	defw	plus			
	defw	semis			
;
;
	defb	84h			; WORD
	defc	'WORD'			
	defw	pad-6			
word:					
	defw	docol			
	defw	blk			
	defw	at			
	defw	zbran			; if
	defw	word1-$			
	defw	blk			
	defw	at			
	defw	block			
	defw	bran			; else
	defw	word2-$			
word1:					
	defw	tib			
	defw	at			; endif
word2:					
	defw	inn			
	defw	at			
	defw	plus			
	defw	swap			
	defw	encl			
	defw	here			
	defw	lit			
	defw	22h			
	defw	blank			
	defw	inn			
	defw	pstor			
	defw	over			
	defw	subb			
	defw	tor			
	defw	rr			
	defw	here			
	defw	cstor			
	defw	plus			
	defw	here			
	defw	onep			
	defw	fromr			
	defw	cmove			
	defw	semis			
;
;
	defb	88h			; (NUMBER)
	defc	'(NUMBER)'		
	defw	word-7			
pnumb:					
	defw	docol			
pnum1:					
	defw	onep			; begin
	defw	dup			
	defw	tor			
	defw	cat			
	defw	base			
	defw	at			
	defw	digit			
	defw	zbran			; while
	defw	pnum2-$			
	defw	swap			
	defw	base			
	defw	at			
	defw	ustar			
	defw	drop			
	defw	rot			
	defw	base			
	defw	at			
	defw	ustar			
	defw	dplus			
	defw	dpl			
	defw	at			
	defw	onep			
	defw	zbran			; if
	defw	pnum3-$			
	defw	one			
	defw	dpl			
	defw	pstor			; endif
pnum3:					
	defw	fromr			
	defw	bran			; repeat
	defw	pnum1-$			
pnum2:					
	defw	fromr			
	defw	semis			
;
;
	defb	86h			; NUMBER
	defc	'NUMBER'		
	defw	pnumb-0bh		
numb:					
	defw	docol			
	defw	zero			
	defw	zero			
	defw	rot			
	defw	dup			
	defw	onep			
	defw	cat			
	defw	lit			
	defw	2dh			
	defw	equal			
	defw	dup			
	defw	tor			
	defw	plus			
	defw	lit			
	defw	-1			
numb1:					
	defw	dpl			; begin
	defw	store			
	defw	pnumb			
	defw	dup			
	defw	cat			
	defw	bl			
	defw	subb			
	defw	zbran			; while
	defw	numb2-$			
	defw	dup			
	defw	cat			
	defw	lit			
	defw	2eh			
	defw	subb			
	defw	zero			
	defw	qerr			
	defw	zero			
	defw	bran			; repeat
	defw	numb1-$			
numb2:					
	defw	drop			
	defw	fromr			
	defw	zbran			; if
	defw	numb3-$			
	defw	dminu			; endif
numb3:					
	defw	semis			
;
;
	defb	85h			; -FIND (0-3) SUCCESS
	defc	'-FIND'			;       (0-1) FAILURE
	defw	numb-9			
dfind:					
	defw	docol			
	defw	bl			
	defw	word			
	defw	here			
	defw	cont			
	defw	at			
	defw	at			
	defw	pfind			
	defw	dup			
	defw	zequ			
	defw	zbran			; if
	defw	dfin1-$			
	defw	drop			
	defw	here			
	defw	lates			
	defw	pfind			; endif
dfin1:					
	defw	semis			
;
;
	defb	87h			; (ABORT)
	defc	'(ABORT)'		
	defw	dfind-8			
pabor:					
	defw	docol			
	defw	abort			
	defw	semis			
;
	defb	85h			; ERROR
	defc	'ERROR'			
	defw	pabor-0ah		
error:					
	defw	docol			
	defw	warn			
	defw	at			
	defw	zless			
	defw	zbran			; if
	defw	erro1-$			
	defw	pabor			; endif
erro1:					
	defw	here			
	defw	count			
	defw	type			
	defw	pdotq			
	defb	2			
	db	'? '			
	defw	mess			
	defw	spsto			
;	CHANGE FROM fig MODEL
;	defw	inn,at,blk,at
	defw	blk,at			
	defw	ddup			
	defw	zbran,erro2-$		; if
	defw	inn,at			
	defw	swap			; endif
erro2:					
	defw	quit			
;
;
	defb	83h			; ID.
	defc	'ID.'			
	defw	error-8			
iddot:					
	defw	docol			
	defw	pad			
	defw	lit			
	defw	20h			
	defw	blank			;/
	defw	dup			
	defw	pfa			
	defw	lfa			
	defw	over			
	defw	subb			
	defw	dup			;/ change frm MODEL
	defw	tor			;/ to suppress BIT 7
	defw	pad			
	defw	swap			
	defw	cmove			
	defw	pad			
	defw	fromr			;/ for terminals
	defw	pad			;/ with an 8 bit
	defw	plus			;/ ASCII character set.
	defw	onemin			;/
	defw	dup			;/
	defw	at			;/
	defw	lit			;/
	defw	7fh			;/
	defw	andd			;/
	defw	swap			;/
	defw	store			;/
	defw	count			
	defw	lit			
	defw	1fh			;  WIDTH
	defw	andd			
	defw	type			
	defw	space			
	defw	semis			
;
	defb	86h			; CREATE
	defc	'CREATE'		
	defw	iddot-6			
creat:					
	defw	docol			
	defw	dfind			
	defw	zbran			; if
	defw	crea1-$			
	defw	drop			
	defw	nfa			
	defw	iddot			
	defw	lit			
	defw	4			
	defw	mess			
	defw	space			; endif
crea1:					
	defw	here			
	defw	dup			
	defw	cat			
	defw	width			
	defw	at			
	defw	min			
	defw	onep			
	defw	allot			
	defw	dup			
	defw	lit			
	defw	0a0h			
	defw	toggl			
	defw	here			
	defw	onemin			
	defw	lit			
	defw	80h			
	defw	toggl			
	defw	lates			
	defw	comma			
	defw	curr			
	defw	at			
	defw	store			
	defw	here			
	defw	twop			
	defw	comma			
	defw	semis			
;
;
	defb	0c9h			; [COMPILE]
	defc	'[COMPILE]'		
	defw	creat-9			
bcomp:					
	defw	docol			
	defw	dfind			
	defw	zequ			
	defw	zero			
	defw	qerr			
	defw	drop			
	defw	cfa			
	defw	comma			
	defw	semis			
;
;
	defb	0c7h			; LITERAL
	defc	'LITERAL'		
	defw	bcomp-0ch		
liter:					
	defw	docol			
	defw	state			
	defw	at			
	defw	zbran			; if
	defw	lite1-$			
	defw	comp			
	defw	lit			
	defw	comma			; endif
lite1:					
	defw	semis			
;
;
	defb	0c8h			; DLITERAL
	defc	'DLITERAL'		
	defw	liter-0ah		
dlite:					
	defw	docol			
	defw	state			
	defw	at			
	defw	zbran			; if
	defw	dlit1-$			
	defw	swap			
	defw	liter			
	defw	liter			; endif
dlit1:					
	defw	semis			
;
;
	defb	86h			; ?STACK
	defc	'?STACK'		
	defw	dlite-0bh		
qstac:					
	defw	docol			
	defw	spat			
	defw	szero			
	defw	at			
	defw	swap			
	defw	uless			
	defw	one			
	defw	qerr			
	defw	spat			
	defw	here			
	defw	lit			
	defw	80h			
	defw	plus			
	defw	uless			
	defw	lit			
	defw	7			
	defw	qerr			
	defw	semis			
;
;
	defb	89h			; INTERPRET
	defc	'INTERPRET'		
	defw	qstac-9			
inter:					
	defw	docol			
inte1:					
	defw	dfind			; begin
	defw	zbran			; if
	defw	inte2-$			
	defw	state			
	defw	at			
	defw	less			
	defw	zbran			; if
	defw	inte3-$			
	defw	cfa			
	defw	comma			
	defw	bran			; else
	defw	inte4-$			
inte3:					
	defw	cfa			
	defw	exec			; endif
inte4:					
	defw	qstac			
	defw	bran			; else
	defw	inte5-$			
inte2:					
	defw	here			
	defw	numb			
	defw	dpl			
	defw	at			
	defw	onep			
	defw	zbran			; if
	defw	inte6-$			
	defw	dlite			
	defw	bran			; else
	defw	inte7-$			
inte6:					
	defw	drop			
	defw	liter			; endif
inte7:					
	defw	qstac			; endif
inte5:					
	defw	bran			; again
	defw	inte1-$			
;
;
	defb	89h			; IMMEDIATE
	defc	'IMMEDIATE'		
	defw	inter-0ch		
immed:					
	defw	docol			
	defw	lates			
	defw	lit			
	defw	40h			
	defw	toggl			
	defw	semis			
;
;
	defb	8ah			; VOCABULARY
	defc	'VOCABULARY'		
	defw	immed-0ch		
vocab:					
	defw	docol			
	defw	build			
	defw	lit			
	defw	0a081h			
	defw	comma			
	defw	curr			
	defw	at			
	defw	cfa			
	defw	comma			
	defw	here			
	defw	vocl			
	defw	at			
	defw	comma			
	defw	vocl			
	defw	store			
	defw	does			
dovoc:					
	defw	twop			
	defw	cont			
	defw	store			
	defw	semis			
;
;
	defb	0c5h			; FORTH
	defc	'FORTH'			
	defw	vocab-0dh		
forth:					
	defw	dodoe			
	defw	dovoc			
	defw	0a081h			
	defw	task-7			; cold start value only
;					  changed aech time a def is appended
;					  to the FORTH vocabulary
	defw	0			; end of vocabulary list
;
;
	defb	8bh			; DEFINITIONS
	defc	'DEFINITIONS'		
	defw	forth-8			
defin:					
	defw	docol			
	defw	cont			
	defw	at			
	defw	curr			
	defw	store			
	defw	semis			
;
;
	defb	0c1h			; (
	defc	'('			
	defw	defin-0eh		
paren:					
	defw	docol			
	defw	lit			
	defw	29h			
	defw	word			
	defw	semis			
;
;
	defb	84h			; QUIT
	defc	'QUIT'			
	defw	paren-4			
quit:					
	defw	docol			
	defw	zero			
	defw	blk			
	defw	store			
	defw	lbrac			
quit1:					
	defw	rpsto			; begin
	defw	cr			
	defw	query			
	defw	inter			
	defw	state			
	defw	at			
	defw	zequ			
	defw	zbran			; if
	defw	quit2-$			
	defw	pdotq			
	defb	2			
	db	'ok'			; endif
quit2:					
	defw	bran			; again
	defw	quit1-$			
;
;
	defb	85h			; ABORT
	defc	'ABORT'			
	defw	quit-7			
abort:					
	defw	docol			
	defw	spsto			
	defw	dec			
	defw	qstac			
	defw	cr			
	defw	dotcpu			
	defw	pdotq			
	defb	0eh			; count of chrs to follow
	db	'fig-FORTH '		
	defb	figrel+30h,adot,figrev+30h,usrver 
	defw	forth			
	defw	defin			
	defw	quit			
;
;
wrm:	ld	bc,wrm1			
	jnext				
wrm1:	defw	warm			
;
;
	defb	84h			; WARM
	defc	'WARM'			
	defw	abort-8			
warm:					
	defw	docol			
	defw	mtbuf			
	defw	abort			
;
;
cld:					
	ld	hl,(bdoss+1)		;/
	ld	l,0			;/ hl <-- fbase
	ld	(limit+2),hl		;/ set limit
	ld	de,bufsiz		;/ de <-- total disc buffer size
	;subw	hl,de			;/ hl <-- addr. of 1st disc buffer
	DEFB	0EDH,0DEh
	ld	(first+2),hl		;/ set FIRST
	ld	(use+2),hl		;/ set USE
	ld	(prev+2),hl		;/ set PREV
	ld	(buf1),hl		;/
	ld	de,us			;/ de <-- user variable space
	;subw	hl,de			;/ hl <-- initr0
	DEFB	0EDH,0DEh
	ld	(upinit),hl		;/
	ld	(r0init),hl		;/
	ld	(up),hl			;/
	ld	(rpp),hl		;/
	ld	de,rts			;/ de <-- rtn stack & term. buf space
	;subw	hl,de			;/ hl <-- inits0
	DEFB	0EDH,0DEh
	ld	(s0init),hl		;/
	ld	(tibini),hl		;/
	ld	sp,hl			;/
	ld	bc,cld1			
	ld	ix,next			; pointer to next
	ld	iy,hpush		; pointer to hpush
	jnext				
;
;
cld1:	defw	cold			
;
	defb	84h			; COLD
	defc	'COLD'			
	defw	warm-7			
cold:					
	defw	docol			
	defw	mtbuf			
	defw	one,recadr		; AvdH
	defw	store			
	defw	lit,buf1		
	defw	at			;/
	defw	use,store		
	defw	lit,buf1		
	defw	at			;/
	defw	prev,store		
	defw	drzer			
	defw	zero			;/
	defw	lit,eprint		
	defw	cstor			;/
;
	defw	lit			
	defw	orig+12h		
	defw	lit			
	defw	up			
	defw	at			
	defw	lit			
	defw	6			
	defw	plus			
	defw	lit			
	defw	10h			
	defw	cmove			
	defw	lit			
	defw	orig+0ch		
	defw	at			
	defw	lit			
	defw	forth+6			
	defw	store			
	defw	fcb			;/A
	defw	lit,opnfil		;/A open mass storage
	defw	bdos			;/A
	defw	lit,0ffh		;/A
	defw	equal			;/A file present?
	defw	zbran,cld2-$		;/A
	defw	zero			;/A
	defw	warn,store		;/A
	defw	cr,pdotq		;/A
	defb	7			;/A
	db	'No file'		;/A
cld2:					
	defw	abort			
;
;
	defb	84h			; S->D
	defc	'S->D'			
	defw	cold-7			
stod:	defw	$+2			
	pop	hl			;/
	;exts	hl			;/ de <-- h(7)
	DEFB	0EDH,6Ch
	ex	de,hl			;/
	jp	dpush			; ( n1 -- d1L d1H)
;
;
	defb	82h			; +-
	defc	'+-'			
	defw	STOD-7			
pm:					
	defw	docol			
	defw	zless			
	defw	zbran			; if
	defw	pm1-$			
	defw	minus			; endif
pm1:					
	defw	semis			
;
;
	defb	83h			; D+-
	defc	'D+-'			
	defw	pm-5			
dpm:					
	defw	docol			
	defw	zless			
	defw	zbran			; if
	defw	dpm1-$			
	defw	dminu			; endif
dpm1:					
	defw	semis			
;
;
	defb	83h			; ABS
	defc	'ABS'			
	defw	dpm-6			
abs:					
	defw	docol			
	defw	dup			
	defw	pm			
	defw	semis			
;
;
	defb	84h			; DABS
	defc	'DABS'			
	defw	abs-6			
dabs:					
	defw	docol			
	defw	dup			
	defw	dpm			
	defw	semis			
;
;
	defb	83h			; MIN
	defc	'MIN'			
	defw	dabs-7			
min:					
	defw	docol			
	defw	tdup			
	defw	great			
	defw	zbran			; if
	defw	min1-$			
	defw	swap			; endif
min1:					
	defw	drop			
	defw	semis			
;
;
	defb	83h			; MAX
	defc	'MAX'			
	defw	min-6			
max:	defw	docol			
	defw	tdup			
	defw	less			
	defw	zbran			; if
	defw	max1-$			
	defw	swap			; endif
max1:					
	defw	drop			
	defw	semis			
;
;
	defb	82h			; M*   ( n1 n2 --- d)
	defc	'M*'			
	defw	max-6			
mstar:					
	defw	$+2			;/
	pop	de			; de <-- multiplicator
	pop	hl			; hl <-- multiplicant
	;multw	hl,de			;/ dehl <-- hl * de
	DEFB	0EDH,0D2h
	ex	de,hl			;/
	jp	dpush			;/ ( n1 n2 --- d1l d1h)
;
;
	defb	82h			;/ M/   ( d n1 --- nrem nquot)
	defc	'M/'			
	defw	mstar-5			
mslas:					
	defw	$+2			; ( d n1 --- n2 n3)
	exx				; save ip
	pop	hl			; divisor
	ld	a,h			
	and	80h			; filter sign
	jr	z,mslas1		; positive
	;neg	hl			; make positive
	DEFB	0EDH,4Ch
mslas1:					
	ld	b,h			
	ld	c,l			; bc <-- divisor
	pop	hl			; dividend.hw
	pop	de			; dividend.lw
	bit	7,h			; negative?
	jr	z,mslas2		; no
	inc	a			; dividend sign flag
	push	hl			
	ld	hl,0			
	;subw	hl,de			; neg dividend.lw
	DEFB	0EDH,0DEh
	pop	de			; dividend.hw
	push	hl			
	ld	hl,0			
	sbc	hl,de			; neg dividend.hw
	pop	de			; dividend.lw
mslas2:					
	;cpw	hl,bc			; dividend.hw >= divisor
	DEFB	0EDH,0C7h
	jr	c,mslas3		; no overflow, continue
	ld	hl,0ffffh		
	ld	d,h			
	ld	e,l			; set rem & quot to max.
	jr	mslas5			
;
mslas3:					
	ex	de,hl			; dehl <-- dividend.hw,lw
	;divuw	dehl,bc			; de <-- remainder, hl <-- quotient
	DEFB	0EDH,0CBh
	ex	de,hl			; hl <-- remainder
	bit	0,a			; was dividend negative
	jr	z,mslas4		; no
	;neg	hl			;/ yes, negate remainder
	DEFB	0EDH,4Ch
mslas4:					
	ex	de,hl			; hl <-- quotient
	or	a			
	jr	z,mslas5		; neither operand negative
	cp	81h			; both operands negative?
	jr	z,mslas5		; yes, quotient stays positive
	;neg	hl			;/ no, negate quotient
	DEFB	0EDH,4Ch
mslas5:					
	push	de			; remainder
	push	hl			; quotient
	exx				; restore ip
	jnext				
;
;
	defb	81h			; *   ( n1 n2 --- nproduct)
	defc	'*'			
	defw	mslas-5			
star:					
	defw	$+2			
	pop	de			
	pop	hl			
	;multw	hl,de			;/ dehl <-- product
	DEFB	0EDH,0D2h
	jhpush				
;
;
	defb	84h			; /MOD   ( n1 n2 --- nrem nquot)
	defc	'/MOD'			
	defw	star-4			
slmod:					
	defw	$+2			
	exx				;/ save ip
	pop	bc			;/ divisor
	pop	hl			;  dividend
	ld	a,b			
	or	c			;/ div by 0?
	jr	nz,slmod1		;/ no, continue
	ld	de,0ffffh		
	ld	h,d			
	ld	l,e			;/ set remainder & quotient to max.
	jr	slmod3			
slmod1:					
	;cpw	hl,8000h		;/ special case -32768 -1 /
	DEFB	0FDH
	DEFB	0EDH,0F7h
	DEFW	8000H                                   
	jr	nz,slmod2		;/ continue
	ld	a,b			
	cp	0ffh			
	jr	nz,slmod2		
	cp	c			;/ lo byte also 0ffh?
	jr	nz,slmod2		;/ no, go & divide
	ld	de,0			;/ remainder
	jr	slmod3			;/ exit with dividend unchanged
slmod2:					
	;exts	hl			;/ de <-- dividend.hw
	DEFB	0EDH,6Ch
	;divw	dehl,bc			;/ de <-- remainder, hl <-- quotient
	DEFB	0EDH,0CAh
slmod3:					
	push	de			
	push	hl			
	exx				;/ restore ip
	jnext				
;
;
	defb	81h			; /
	defc	'/'			
	defw	slmod-7			
slash:					
	defw	$+2			
	exx				;/ save ip
	pop	bc			;/ divisor
	pop	hl			;  dividend
	ld	a,b			
	or	c			;/ division by 0?
	jr	nz,slash1		;/ no, continue
	ld	hl,0ffffh		;/ set quotient to max.
	jr	slash3			
slash1:					
	;cpw	hl,8000h		;/ special case -32768 -1 /
	DEFB	0FDH
	DEFB	0EDH,0F7h
	DEFW	8000H                                   
	jr	nz,slash2		;/ dividend not -32768
	ld	a,b			
	cp	0ffh			
	jr	nz,slash2		;/ divisor not -1
	cp	c			
	jr	z,slash3		;/ return with dividend unchanged
slash2:					
	;exts	hl			;/ de <-- dividend.hw
	DEFB	0EDH,6Ch
	;divw	dehl,bc			;/ hl <-- quotient
	DEFB	0EDH,0CAh
slash3:					
	push	hl			;/ quotient
	exx				;/ restore ip
	jnext				
;
;
	defb	83h			;/ MOD
	defc	'MOD'			
	defw	slash-4			
modd:					
	defw	$+2			
	exx				; save ip
	pop	bc			; divisor
	pop	hl			;  dividend
	ld	a,b			
	or	c			; division by 0?
	jr	nz,modd1		; no, continue
	ld	de,0ffffh		; set remainder to max
	jr	modd3			
modd1:					
	;cpw	hl,8000h		;/ special case -32768 -1 /
	DEFB	0FDH
	DEFB	0EDH,0F7h
	DEFW	8000H                                   
	jr	nz,modd2		; dividend not -32768
	ld	a,b			
	cp	0ffh			
	jr	nz,modd2		; divisor not -1
	cp	c			
	jr	nz,modd2		; go & divide
	ld	de,0			; remainder
	jr	modd3			
modd2:					
	;exts	hl			; de <-- dividend.hw
	DEFB	0EDH,6Ch
	;divw	dehl,bc			; de <-- remainder
	DEFB	0EDH,0CAh
modd3:					
	push	de			; remainder
	exx				; restore ip
	jnext				
;
;
	defb	85h			;/ */MOD
	defc	'*/MOD'			
	defw	modd-6			
ssmod:					
	defw	$+2			
	exx				; save ip
	pop	hl			; divisor
	ld	a,h			
	and	80h			; filter sign
	jr	z,ssmod1		; positive
	;neg	hl			; make positive
	DEFB	0EDH,4Ch
ssmod1:					
	ld	b,h			
	ld	c,l			; bc <-- divisor
	pop	hl			; multipicator
	pop	de			; multiplicant
	ex	af,af' 			 ; save sign flag
	;multw	hl,de			; dehl <-- product (= dividend)
	DEFB	0EDH,0D2h
	ex	af,af' 			 ; restore sign flag
	ex	de,hl			; de <-- dividend.lw
	bit	7,h			; dividend negative?
	jr	z,ssmod2		; no
	inc	a			; dividend sign flag
	push	hl			
	ld	hl,0			
	;subw	hl,de			; neg dividend.lw
	DEFB	0EDH,0DEh
	pop	de			; dividend.hw
	push	hl			
	ld	hl,0			
	sbc	hl,de			; neg dividend.hw
	pop	de			; dividend.lw
ssmod2:					
	;cpw	hl,bc			; dividend.hw >= divisor?
	DEFB	0EDH,0C7h
	jr	c,ssmod3		; no overflow, continue
	ld	hl,0ffffh		
	ld	d,h			
	ld	e,l			; set rem & quot to max
	jr	ssmod5			
;
ssmod3:					
	ex	de,hl			; dehl <-- dividend.hw,lw
	;divuw	dehl,bc			; de <-- remainder, hl <-- quotient
	DEFB	0EDH,0CBh
	ex	de,hl			; hl <-- remainder
	bit	0,a			; was dividend negative?
	jr	z,ssmod4		; no
	;neg	hl			; yes, negate remainder
	DEFB	0EDH,4Ch
ssmod4:					
	ex	de,hl			; hl <-- quotient
	or	a			
	jr	z,ssmod5		; neither operand negative
	cp	81h			; both operands negative?
	jr	z,ssmod5		; yes, quotient stays positive
	;neg	hl			; no, negate quotient
	DEFB	0EDH,4Ch
ssmod5:					
	push	de			; remainder
	push	hl			; quotient
	exx				; restore ip
	jnext				
;
;
	defb	82h			; */
	defc	'*/'			
	defw	ssmod-8			
ssla:					
	defw	$+2			;/
	exx				; save ip
	pop	hl			; divisor
	ld	a,h			
	and	80h			; filter sign
	jr	z,ssla1			; positive
	;neg	hl			; make positive
	DEFB	0EDH,4Ch
ssla1:					
	ld	b,h			
	ld	c,l			; bc <-- divisor
	pop	hl			; multipicator
	pop	de			; multiplicant
	ex	af,af' 			 ; save sign flag
	;multw	hl,de			; dehl <-- product (= dividend)
	DEFB	0EDH,0D2h
	ex	af,af' 			 ; restore sign flag
	ex	de,hl			; de <-- dividend.lw
	bit	7,h			; dividend negative?
	jr	z,ssla2			; no
	inc	a			; dividend sign flag
	push	hl			
	ld	hl,0			
	;subw	hl,de			; neg dividend.lw
	DEFB	0EDH,0DEh
	pop	de			; dividend.hw
	push	hl			
	ld	hl,0			
	sbc	hl,de			; neg dividend.hw
	pop	de			; dividend.lw
ssla2:					
	;cpw	hl,bc			; dividend.hw >= divisor?
	DEFB	0EDH,0C7h
	jr	c,ssla3			; no overflow, continue
	ld	hl,0ffffh		; set quotient to max
	jr	ssla4			
;
ssla3:					
	ex	de,hl			; dehl <-- dividend.hw,lw
	;divuw	dehl,bc			; de <-- remainder, hl <-- quotient
	DEFB	0EDH,0CBh
	or	a			
	jr	z,ssla4			; neither operand negative
	cp	81h			; both operands negative?
	jr	z,ssla4			; yes, quotient stays positive
	;neg	hl			; no, negate quotient
	DEFB	0EDH,4Ch
ssla4:					
	push	hl			; quotient
	exx				; restore ip
	jnext				
;
;
	defb	85h			; M/MOD
	defc	'M/MOD'			
	defw	ssla-5			
msmod:					
	defw	docol			
	defw	tor			
	defw	zero			
	defw	rr			
	defw	uslas			
	defw	fromr			
	defw	swap			
	defw	tor			
	defw	uslas			
	defw	fromr			
	defw	semis			
;
;
;	Block moved down 2 pages
;
	defb	86h			; (LINE)
	defc	'(LINE)'		
	defw	msmod-8			
pline:					
	defw	docol			
	defw	tor			
	defw	lit			
	defw	40h			
	defw	bbuf			
	defw	ssmod			
	defw	fromr			
	defw	bscr			
	defw	star			
	defw	plus			
	defw	block			
	defw	plus			
	defw	lit			
	defw	40h			
	defw	semis			
;
;
	defb	85h			; .LINE
	defc	'.LINE'			
	defw	pline-9			
dline:					
	defw	docol			
	defw	pline			
	defw	dtrai			
	defw	type			
	defw	semis			
;
;
	defb	87h			; MESSAGE
	defc	'MESSAGE'		
	defw	dline-8			
mess:					
	defw	docol			
	defw	warn			
	defw	at			
	defw	zbran			; if
	defw	mess1-$			
	defw	ddup			
	defw	zbran			; if
	defw	mess2-$			
	defw	lit			
	defw	4			; 1st message screen
	defw	ofset			
	defw	at			
	defw	bscr			
	defw	slash			
	defw	subb			
	defw	dline			
	defw	space			; endif
mess2:					
	defw	bran			; else
	defw	mess3-$			
mess1:					
	defw	pdotq			
	defb	6			
	db	'MSG # '		
	defw	dot			; endif
mess3:	defw	semis			
;
;
	defb	82h			; P@
	defc	'P@'			
	defw	mess-0ah		
ptat:					
	defw	$+2			
	exx				;d save registers
	pop	bc			;d bc <-- port#
	in	l,(c)			;d l <-- data byte
	ld	h,0			
	push	hl			
	exx				;d restore registers
	jnext				
;
;
	defb	82h			; P!
	defc	'P!'			
	defw	ptat-5			
ptsto:					
	defw	$+2			
	exx				;d save registers
	pop	bc			;d c <-- port#
	pop	hl			;d L <-- date byte
	out	(c),l			
	exx				;d restore registers
	jnext				
;
;
	page				
include	DISCIO.Z80			
	page				
include	CONPRTIO.Z80			
	page				
;
	defb	0c1h			; ' (tick)
	defb	0a7h			
	defw	arrow-6			
tick:					
	defw	docol			
	defw	dfind			
	defw	zequ			
	defw	zero			
	defw	qerr			
	defw	drop			
	defw	liter			
	defw	semis			
;
;
	defb	86h			; FORGET
	defc	'FORGET'		
	defw	tick-4			
forg:					
	defw	docol			
	defw	curr			
	defw	at			
	defw	cont			
	defw	at			
	defw	subb			
	defw	lit			
	defw	18h			
	defw	qerr			
	defw	tick			
	defw	dup			
	defw	fence			
	defw	at			
	defw	uless			;/ FORGET >8000h nw o.k.
	defw	lit			
	defw	15h			
	defw	qerr			
	defw	dup			
	defw	nfa			
	defw	dp			
	defw	store			
	defw	lfa			
	defw	at			
	defw	cont			
	defw	at			
	defw	store			
	defw	semis			
;
;
	defb	84h			; BACK
	defc	'BACK'			
	defw	forg-9			
back:					
	defw	docol			
	defw	here			
	defw	subb			
	defw	comma			
	defw	semis			
;
;
	defb	0c5h			; BEGIN
	defc	'BEGIN'			
	defw	back-7			
begin:					
	defw	docol			
	defw	qcomp			
	defw	here			
	defw	one			
	defw	semis			
;
;
	defb	0c5h			; ENDIF
	defc	'ENDIF'			
	defw	begin-8			
endiff:					
	defw	docol			
	defw	qcomp			
	defw	two			
	defw	qpair			
	defw	here			
	defw	over			
	defw	subb			
	defw	swap			
	defw	store			
	defw	semis			
;
;
	defb	0c4h			; THEN
	defc	'THEN'			
	defw	endiff-8		
then:	defw	docol			
	defw	endiff			
	defw	semis			
;
;
	defb	0c2h			; DO
	defc	'DO'			
	defw	then-7			
do:					
	defw	docol			
	defw	comp			
	defw	xdo			
	defw	here			
	defw	three			
	defw	semis			
;
;
	defb	0c4h			; LOOP
	defc	'LOOP'			
	defw	do-5			
loop:					
	defw	docol			
	defw	three			
	defw	qpair			
	defw	comp			
	defw	xloop			
	defw	back			
	defw	semis			
;
;
	defb	0c5h			; +LOOP
	defc	'+LOOP'			
	defw	loop-7			
ploop:					
	defw	docol			
	defw	three			
	defw	qpair			
	defw	comp			
	defw	xploo			
	defw	back			
	defw	semis			
;
;
	defb	0c5h			; UNTIL
	defc	'UNTIL'			
	defw	ploop-8			
until:					
	defw	docol			
	defw	one			
	defw	qpair			
	defw	comp			
	defw	zbran			
	defw	back			
	defw	semis			
;
;
	defb	0c3h			; END
	defc	'END'			
	defw	until-8			
endd:					
	defw	docol			
	defw	until			
	defw	semis			
;
;
	defb	0c5h			; AGAIN
	defc	'AGAIN'			
	defw	endd-6			
again:					
	defw	docol			
	defw	one			
	defw	qpair			
	defw	comp			
	defw	bran			
	defw	back			
	defw	semis			
;
;
	defb	0c6h			; REPEAT
	defc	'REPEAT'		
	defw	again-8			
repea:					
	defw	docol			
	defw	tor			
	defw	tor			
	defw	again			
	defw	fromr			
	defw	fromr			
	defw	twomin			;/
	defw	endiff			
	defw	semis			
;
;
	defb	0c2h			; IF
	defc	'IF'			
	defw	repea-9			
iff:					
	defw	docol			
	defw	comp			
	defw	zbran			
	defw	here			
	defw	zero			
	defw	comma			
	defw	two			
	defw	semis			
;
;
	defb	0c4h			; ELSE
	defc	'ELSE'			
	defw	iff-5			
elsee:					
	defw	docol			
	defw	two			
	defw	qpair			
	defw	comp			
	defw	bran			
	defw	here			
	defw	zero			
	defw	comma			
	defw	swap			
	defw	two			
	defw	endiff			
	defw	two			
	defw	semis			
;
;
	defb	0c5h			; WHILE
	defc	'WHILE'			
	defw	elsee-7			
while:					
	defw	docol			
	defw	iff			
	defw	twop			
	defw	semis			
;
;
	defb	86h			; SPACES
	defc	'SPACES'		
	defw	while-8			
spacs:					
	defw	docol			
	defw	zero			
	defw	max			
	defw	ddup			
	defw	zbran			; if
	defw	spax1-$			
	defw	zero			
	defw	xdo			; do
spax2:					
	defw	space			
	defw	xloop			; loop endif
	defw	spax2-$			
spax1:					
	defw	semis			
;
;
	defb	82h			; <#
	defc	'<#'			
	defw	spacs-9			
bdigs:					
	defw	docol			
	defw	pad			
	defw	hld			
	defw	store			
	defw	semis			
;
;
	defb	82h			; #>
	defc	'#>'			
	defw	bdigs-5			
edigs:					
	defw	docol			
	defw	drop			
	defw	drop			
	defw	hld			
	defw	at			
	defw	pad			
	defw	over			
	defw	subb			
	defw	semis			
;
;
	defb	84h			; SIGN
	defc	'SIGN'			
	defw	edigs-5			
sign:					
	defw	docol			
	defw	rot			
	defw	zless			
	defw	zbran			; if
	defw	sign1-$			
	defw	lit			
	defw	2dh			
	defw	hold			; endif
sign1:					
	defw	semis			
;
;
	defb	81h			; #
	defc	'#'			
	defw	sign-7			
dig:					
	defw	docol			
	defw	base			
	defw	at			
	defw	msmod			
	defw	rot			
	defw	lit			
	defw	9			
	defw	over			
	defw	less			
	defw	zbran			; if
	defw	dig1-$			
	defw	lit			
	defw	7			
	defw	plus			; endif
dig1:	defw	lit			
	defw	30h			
	defw	plus			
	defw	hold			
	defw	semis			
;
;
	defb	82h			; #S
	defc	'#S'			
	defw	dig-4			
digs:					
	defw	docol			
digs1:					
	defw	dig			; begin
	defw	tdup			;/
	defw	orr			
	defw	zequ			
	defw	zbran			; until
	defw	digs1-$			
	defw	semis			
;
;
	defb	83h			; D.R
	defc	'D.R'			
	defw	digs-5			
ddotr:					
	defw	docol			
	defw	tor			
	defw	swap			
	defw	over			
	defw	dabs			
	defw	bdigs			
	defw	digs			
	defw	sign			
	defw	edigs			
	defw	fromr			
	defw	over			
	defw	subb			
	defw	spacs			
	defw	type			
	defw	semis			
;
;
	defb	82h			; .R
	defc	'.R'			
	defw	ddotr-6			
dotr:					
	defw	docol			
	defw	tor			
	defw	stod			
	defw	fromr			
	defw	ddotr			
	defw	semis			
;
;
	defb	82h			; D.
	defc	'D.'			
	defw	dotr-5			
ddot:					
	defw	docol			
	defw	zero			
	defw	ddotr			
	defw	space			
	defw	semis			
;
;
	defb	81h			; .
	defc	'.'			
	defw	ddot-5			
dot:					
	defw	docol			
	defw	stod			
	defw	ddot			
	defw	semis			
;
;
	defb	81h			; ?
	defc	'?'			
	defw	dot-4			
ques:					
	defw	docol			
	defw	at			
	defw	dot			
	defw	semis			
;
;
	defb	82h			; U.
	defc	'U.'			
	defw	ques-4			
udot:	defw	docol			
	defw	zero			
	defw	ddot			
	defw	semis			
;

	defb	85h			; VLIST
	defc	'VLIST'			
	defw	udot-5			
vlist:					
	defw	docol			
	defw	lit			
	defw	80h			
	defw	outt			
	defw	store			
	defw	cont			
	defw	at			
	defw	at			
vlis1:					
	defw	outt			; begin
	defw	at			
	defw	csll			
	defw	great			
	defw	zbran			; if
	defw	vlis2-$			
	defw	cr			
	defw	zero			
	defw	outt			
	defw	store			; endif
vlis2:					
	defw	dup			
	defw	iddot			
	defw	space			
	defw	space			
	defw	pfa			
	defw	lfa			
	defw	at			
	defw	dup			
	defw	zequ			
	defw	qterm			
	defw	orr			
	defw	zbran			; until
	defw	vlis1-$			
	defw	drop			
	defw	semis			
;
;
	defb	83h			; BYE
	defc	'BYE'			
	defw	vlist-8			
bye:					
	defw	docol			;/A
	defw	flush			;/A
	defw	fcb,lit			;/E
	defw	10h,bdos		;/E close file
	defw	drop			;/E discard directory code
	defw	zero,zero		;/A
	defw	bdos			;/A return to CP/M
	defw	semis			;/A won't get this far, just for pretty
;
;
	defb	84h			; LIST
	defc	'LIST'			
	defw	bye-6			
list:					
	defw	docol,dec		
	defw	cr,dup			
	defw	scr,store		
	defw	pdotq			
	defb	6			
	db	'SCR # '		
	defw	dot			
	defw	lit,10h			
	defw	zero,xdo		
list1:					
	defw	cr,ido			
	defw	three			;/ was lit,3
	defw	dotr,space		
	defw	ido,scr			
	defw	at,dline		
	defw	qterm			
	defw	zbran,list2-$		; if
	defw	leave			
list2:					
	defw	xloop,list1-$		; endif
	defw	cr			
	defw	semis			
;
;
	defb	85H		;INDEX
	defc	'INDEX'		
	defw	list-7		
index:					
	defw	docol		
	defw	lit,ff		
	defw	emit		
	defw	cr		
	defw	onep,swap	
	defw	xdo		
inde1:					
	defw	cr,ido		
	defw	three			;/ was lit,3
	defw	dotr,space		
	defw	zero,ido		
	defw	dline,qterm		
	defw	zbran,inde2-$		; if
	defw	leave			; endif
inde2:					
	defw	xloop,inde1-$		
	defw	semis			
;
;
	defb	85h			; TRIAD
	defc	'TRIAD'			
	defw	index-8			
triad:					
	defw	docol			
	defw	lit,ff			
	defw	emit			
	defw	three			;/ was lit,3
	defw	slash			
	defw	three			;/ was lit,3
	defw	star			
	defw	three			;/ was lit,3
	defw	over,plus		
	defw	swap,xdo		
tria1:					
	defw	cr,ido			
	defw	list			
	defw	qterm			
	defw	zbran,tria2-$		; if
	defw	leave			
tria2:					
	defw	xloop,tria1-$		; endif
	defw	cr			
	defw	lit,15			
	defw	mess,cr			
	defw	semis			
;
;
	defb	84h			; .CPU
	defc	'.CPU'			
	defw	triad-8			
dotcpu:					
	defw	docol			
	defw	base,at			
	defw	lit,36			
	defw	base,store		
	defw	lit,22h			
	defw	porig,tat		
	defw	ddot			
	defw	base,store		
	defw	semis			
;
;
	defb	86h			; setclk
	defc	'setclk'		
	defw	dotcpu-7		
setclk:					
	defw	$+2			
	exx				; save ip
	ld	c,iopreg		
	;ldctl	hl,(c)			; l <-- current i/o page
	DEFB	0EDh,66h
	ld	a,l			
	ex	af,af' 			 ; save i/o page
	ld	l,0feh			
	;ldctl	(c),hl			; select i/o page 0feh
	DEFB	0EDh,6Eh
	xor	a			
	out	(cntrl0),a		; disable c/t 0
	out	(cntrl1),a		; disable c/t 1
	out	(config1),a		
	ld	hl,0ffffh		
	ld	a,10h			
	out	(config0),a		; cascade c/t 0 - c/t 1
	ld	c,tcon0			
	;outw	(c),hl			; load c/t 0 time constant
	DEFB	0EDH,0BFh
	ld	c,tcon1			
	;outw	(c),hl			; load c/t 1 time constatnt
	DEFB	0EDH,0BFh
	ld	a,80h			
	out	(config1),a		; continous mode
	ld	a,0e0h			
	out	(cntrl1),a		; start 32bit counter
	ex	af,af' 			 ; std. accu
	ld	l,a			; l <-- previous i/o page
	ld	c,iopreg		
	;ldctl	(c),hl			; restore i/o page
	DEFB	0EDh,6Eh
	exx				; restore ip
	jnext				
;
;
	defb	86h			; getclk
	defc	'getclk'		
	defw	setclk-9		
getclk:					
	defw	$+2			
	exx				; save ip
	ld	c,iopreg		
	;ldctl	hl,(c)			; l <-- current i/o page
	DEFB	0EDh,66h
	ld	a,l			
	ex	af,af' 			 ; save current i/o page
	ld	l,0feh			
	;ldctl	(c),hl			; select i/o page 0feh
	DEFB	0EDh,6Eh
	ld	a,80h			
	out	(cntrl1),a		; halt 32bit counter
	ld	c,count1		
	;inw	hl,(c)			
	DEFB	0EDH,0B7h
	ld	d,h			
	ld	e,l			; de <-- count1
	ld	c,count0		
	;inw	hl,(c)			; hl <-- count0
	DEFB	0EDH,0B7h
	ld	c,0			
	ld	a,c			; a <-- 0
	sub	l			; 0 - l
	ld	l,a			; l <-- neg(l)
	ld	a,c			; a <-- 0
	sbc	a,h			
	ld	h,a			; h <-- neg(h)
	ld	a,c			; a <-- 0
	sbc	a,e			
	ld	e,a			; e <-- neg(e)
	ld	a,c			; a <-- 0
	sbc	a,d			
	ld	d,a			; d <-- neg(d), dehl <-- neg(dehl)
	;divuw	dehl,25000		; scale to 1/100 secs
	DEFB	0FDH
	DEFB	0EDH,0FBh
	DEFW	25000                                   
	push	hl			; result
	ex	af,af' 			 ; std. accu
	ld	l,a			; l <-- previous i/o page
	ld	c,iopreg		
	;ldctl	(c),hl			; restore i/o page
	DEFB	0EDh,6Eh
	exx				; restore ip
	jnext				
;
;
	defb	84h			; TASK
	defc	'TASK'			
	defw	getclk-9		
;	defw	dotcpu-7
task:					
	defw	docol			
	defw	semis			
;
;
initdp:					
	defw	0			
;
	end	orig			
                                                                                                                                                                                                                                                                ; CP/M CONSOLE & PRINTER INTERFACE
;
; Last update:
;
; 850511 - Saved BC' prior to CP/M calls
; 841010 - Saved IX & IY prior to CP/M calls
; 840909 - Converted all BIOS calls to BDOS calls for compatibility
;          with CP/M 3.0
;
;
;
lstout		equ	05h		; printer output
dconio		equ	06h		; direct console I/O
;
cacr		equ	12h		; cache control register
;
rubout		equ	7fh
inpreq		equ	0ffh		; dconio input request
;
	.z280
;
eprint:	defb	0			; printer flag
					; 0=disabled, 1=enabled
;
sysent:
	push	bc
	push	de
	push	hl
	push	ix
	push	iy
	exx
	push	bc			; save ip (if used as such)
	exx
	call	bdoss			; perform function (C)
	exx
	pop	bc			; restore ip
	exx
	pop	iy
	pop	ix
	pop	hl
	pop	de
	pop	bc
	ret
;
cstat:
	push	bc
	ld	c,dconio		; direct console I/O
	ld	e,inpreq		; input request
	call	sysent			; any chr typed?
	pop	bc			; if yes, a <-- char
	ret				; else    a <-- 00h (ignore chr)
;
;
cin:
	push	bc
	ld	c,dconio		; direct console i/o
	ld	e,inpreq		; request input
cinlp:
	call	sysent			; a <-- chr (or 0 if nothing typed)
	or	a
	jr	z,cinlp			; wait for CHR to be typed
	cp	rubout
	jr	nz,cin1
	ld	a,bsout			; convert RUB to ^H
cin1:
	res	7,a			; msb <-- 0
	pop	bc
	ret
;
;
cout:
	push	bc
	push	de			; save e = chr
	ld	c,dconio		; direct console output
	call	sysent			; send e to con:
	pop	de
	pop	bc
	ret
;
;
pout:
	push	bc
	ld	c,lstout
	call	sysent			; send e to lst:
	pop	bc
	ret
;
;
cpout:
	call	cout			; send e to console
	ld	a,(eprint)
	or	a			; if eprint <> 0
	call	nz,pout			;send e to LST:
	ret
;
;
;	FORTH TO CP/M SERIAL I/O INTERFACE
;
pqter:
	call	cstat
	ld	hl,0
	or	a			; chr typed?
	jr	z,pqte1			; no
	inc	l			; yes, s1 <-- true
pqte1:
	jhpush
;
;
pkey:
	call	cin			; read chr from console
	cp	dle			; ^P?
	ld	e,a
	jr	nz,pkey1		; no
	ld	hl,eprint
	ld	e,abl			; e <-- blank
	ld	a,(hl)
	xor	01h			; toggle eprint lsb
	ld	(hl),a
pkey1:
	ld	l,e
	ld	h,0
	jhpush				; s1.lb <-- chr
;
;
pemit:
	defw	$+2			; (EMIT) orphan
	pop	de			; e <-- s1.lb = chr
	ld	a,e
	cp	bsout
	jr	nz,pemit1
	call	cout			; backspace
	ld	e,abl			; blank
	call	cout			; erase chr on con:
	ld	e,bsout			; backspace
pemit1:
	call	cpout			; send chr to con:
	jnext				; and lst: if eprint = 01h
;
;
pcr:
	ld	e,acr
	call	cpout			; output cr
	ld	e,lf
	call	cpout			; and lf
	jnext
;
;
;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ; CP/M CONSOLE & PRINTER INTERFACE
;
; Last update:
;
; 850511 - Saved BC' prior to CP/M calls
; 841010 - Saved IX & IY prior to CP/M calls
; 840909 - Converted all BIOS calls to BDOS calls for compatibility
;          with CP/M 3.0
;
;
;
lstout		equ	05h		; printer output
dconio		equ	06h		; direct console I/O
;
cacr		equ	12h		; cache control register
;
rubout		equ	7fh		
inpreq		equ	0ffh		; dconio input request
;
	;.z280					
	; PRE280 V1.11b 20-Nov-90  Copyright (c) 1990 by A.Zinser (fifi@veeble.north.de)
	.Z80
;
eprint:	defb	0			; printer flag
					; 0=disabled, 1=enabled
;
sysent:					
	push	bc				
	push	de				
	push	hl				
	push	ix				
	push	iy				
	exx					
	push	bc			; save ip (if used as such)
	exx				
	call	bdoss			; perform function (C)
	exx				
	pop	bc			; restore ip
	exx				
	pop	iy			
	pop	ix			
	pop	hl			
	pop	de			
	pop	bc			
	ret				
;
cstat:					
	push	bc			
	ld	c,dconio		; direct console I/O
	ld	e,inpreq		; input request
	call	sysent			; any chr typed?
	pop	bc			; if yes, a <-- char
	ret				; else    a <-- 00h (ignore chr)
;
;
cin:					
	push	bc			
	ld	c,dconio		; direct console i/o
	ld	e,inpreq		; request input
cinlp:					
	call	sysent			; a <-- chr (or 0 if nothing typed)
	or	a			
	jr	z,cinlp			; wait for CHR to be typed
	cp	rubout			
	jr	nz,cin1			
	ld	a,bsout			; convert RUB to ^H
cin1:					
	res	7,a			; msb <-- 0
	pop	bc			
	ret				
;
;
cout:					
	push	bc			
	push	de			; save e = chr
	ld	c,dconio		; direct console output
	call	sysent			; send e to con:
	pop	de			
	pop	bc			
	ret				
;
;
pout:					
	push	bc			
	ld	c,lstout		
	call	sysent			; send e to lst:
	pop	bc			
	ret				
;
;
cpout:					
	call	cout			; send e to console
	ld	a,(eprint)		
	or	a			; if eprint <> 0
	call	nz,pout			;send e to LST:
	ret				
;
;
;	FORTH TO CP/M SERIAL I/O INTERFACE
;
pqter:					
	call	cstat			
	ld	hl,0			
	or	a			; chr typed?
	jr	z,pqte1			; no
	inc	l			; yes, s1 <-- true
pqte1:					
	jhpush				
;
;
pkey:					
	call	cin			; read chr from console
	cp	dle			; ^P?
	ld	e,a			
	jr	nz,pkey1		; no
	ld	hl,eprint		
	ld	e,abl			; e <-- blank
	ld	a,(hl)			
	xor	01h			; toggle eprint lsb
	ld	(hl),a			
pkey1:					
	ld	l,e			
	ld	h,0			
	jhpush				; s1.lb <-- chr
;
;
pemit:					
	defw	$+2			; (EMIT) orphan
	pop	de			; e <-- s1.lb = chr
	ld	a,e			
	cp	bsout			
	jr	nz,pemit1		
	call	cout			; backspace
	ld	e,abl			; blank
	call	cout			; erase chr on con:
	ld	e,bsout			; backspace
pemit1:					
	call	cpout			; send chr to con:
	jnext				; and lst: if eprint = 01h
;
;
pcr:					
	ld	e,acr			
	call	cpout			; output cr
	ld	e,lf			
	call	cpout			; and lf
	jnext				
;
;
;
int = 01h
;
;
pcr:					
	ld	e,acr			
	call	cpout			; output cr
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ; CP/M DISC INTERFACE
;
; Last update:
;
; 881212 - EXTEND now writes blanks to screens it creates
; 860120 - EXTEND's R/W address now at HERE, was Osborne video ram
; 850511 - saved BC' in 'BDOS'
; 850227 - saved index regs. in 'BDOS'
; 840812 - added EXTEND
; 840731 - installed BDOS calls
;
;
; CP/M BDOS CALLS USED (as per Albert van der Horst, HCCH)
;
; R/W  reads or writes a sector in the file specified when invoking
; Z280 fig-FORTH (A>280FORTH d:filename.ext), using the default FCB.
; More than one disc may be accessed by temporary use of a user de-
; fined FCB.
;
;
;
deffcb		equ	005ch		; default FCB
;
;	CP/M FUNCTIONS
;
opnfil		equ	0fh		; open file
clsfil		equ	10h		; close file
setdma		equ	1ah		; set DMA address
wrtrnd		equ	22h		; write random
;
;
	.z280
;
;
;
;	FORTH variables & constants used in disc interface
;
	defb	83h			; FCB (current FCB address)
	defc	'FCB'
	defw	ptsto-5
fcb:
	defw	docon
	defw	deffcb
;
;
	defb	84h			; REC# (returns addr. of random rec.#)
	defc	'REC#'
	defw	fcb-6
recadr:
	defw	docol
	defw	fcb
	defw	lit
	defw	21h
	defw	plus
	defw	semis
;
;
	defb	83h			; USE
	defc	'USE'
	defw	recadr-7
use:
	defw	dovar
	defw	0			;/ initialised by CLD
;
;
	defb	84h			; PREV
	defc	'PREV'
	defw	use-6
prev:
	defw	dovar
	defw	0			;/ initialised by CLD
;
;
	defb	85h			; #BUFF
	defc	'#BUFF'
	defw	prev-07h
nobuf:
	defw	docon
	defw	nbuf
;
;
	defb	8ah			; DISK-ERROR
	defc	'DISK-ERROR'
	defw	nobuf-08h
dskerr:
	defw	dovar
	defw	0
;
;
;	DISC INTERFACE HIGH LEVEL ROUTINES
;
	defb	84h			; +BUF
	defc	'+BUF'
	defw	dskerr-0dh
pbuf:
	defw	docol
	defw	lit,co
	defw	plus
	defw	dup
	defw	limit
	defw	equal
	defw	zbran
	defw	pbuf1-$
	defw	drop
	defw	first
pbuf1:
	defw	dup
	defw	prev
	defw	at
	defw	subb
	defw	semis
;
;
	defb	86h			; UPDATE
	defc	'UPDATE'
	defw	pbuf-07h
updat:
	defw	docol
	defw	prev
	defw	at
	defw	at
	defw	lit
	defw	8000h
	defw	orr
	defw	prev
	defw	at
	defw	store
	defw	semis
;
;
	defb	8dh			; EMPTY-BUFFERS
	defc	'EMPTY-BUFFERS'
	defw	updat-9
mtbuf:
	defw	docol
	defw	first
	defw	limit
	defw	over
	defw	subb
	defw	erasee
	defw	semis
;
;
	defb	83h			; DR0
	defc	'DR0'
	defw	mtbuf-10h
drzer:
	defw	docol
	defw	zero
	defw	ofset
	defw	store
	defw	semis
;
;
	defb	83h			; DR1
	defc	'DR1'
	defw	drzer-6
drone:
	defw	docol
	defw	lit
	defw	1600			; Osborne DD
dron2:
	defw	ofset
	defw	store
	defw	semis
;
;
	defb	86h			; BUFFER
	defc	'BUFFER'
	defw	drone-6
buffe:
	defw	docol
	defw	use
	defw	at
	defw	dup
	defw	tor
buff1:
	defw	pbuf			; won't work if single buffer
	defw	zbran
	defw	buff1-$
	defw	use
	defw	store
	defw	rr
	defw	at
	defw	zless
	defw	zbran
	defw	buff2-$
	defw	rr
	defw	twop
	defw	rr
	defw	at
	defw	lit
	defw	7fffh
	defw	andd
	defw	zero
	defw	rslw
buff2:
	defw	rr
	defw	store
	defw	rr
	defw	prev
	defw	store
	defw	fromr
	defw	twop
	defw	semis
;
;
	defb	85h			; BLOCK
	defc	'BLOCK'
	defw	buffe-9
block:
	defw	docol
	defw	ofset
	defw	at
	defw	plus
	defw	tor
	defw	prev
	defw	at
	defw	dup
	defw	at
	defw	rr
	defw	subb
	defw	dup
	defw	plus
	defw	zbran
	defw	bloc1-$
bloc2:
	defw	pbuf
	defw	zequ
	defw	zbran
	defw	bloc3-$
	defw	drop
	defw	rr
	defw	buffe
	defw	dup
	defw	rr
	defw	one
	defw	rslw
	defw	twomin			;/
bloc3:
	defw	dup
	defw	at
	defw	rr
	defw	subb
	defw	dup
	defw	plus
	defw	zequ
	defw	zbran
	defw	bloc2-$
	defw	dup
	defw	prev
	defw	store
BLOC1:
	defw	fromr
	defw	drop
	defw	twop
	defw	semis
;
;
	defb	84h			; BDOS  (CP/M function call)
	defc	'BDOS'
	defw	block-8
bdos:
	defw	$+2
	exx				;/ save ip
	pop	bc			; c <-- s1.lb = BDOS function code
	pop	de			; de <-- s2)  = parameter
	push	ix
	push	iy
	exx
	push	bc			; some BIOS use alternate registers
	exx
	call	bdoss			; return value in a
	exx
	pop	bc			;/ bc <-- ip
	pop	iy
	pop	ix
	ld	l,a
	ld	h,00h
	jhpush				; s1 <-- hl = returned value
;
;
	defb	83h			; R/W
	defc	'R/W'
	defw	bdos-07h
rslw:
	defw	docol
	defw	tor			; store R/W flag
	defw	recadr
	defw	store
	defw	zero
	defw	recadr			; set record #
	defw	twop
	defw	cstor
	defw	lit
	defw	setdma
	defw	bdos
	defw	drop			; set DMA address
	defw	lit
	defw	wrtrnd
	defw	fromr
	defw	subb			; select READ or WRITE
	defw	fcb
	defw	swap
	defw	bdos			; do it
	defw	dskerr
	defw	store			; store return code
	defw	semis
;
;
	defb	85h			; FLUSH
	defc	'FLUSH'
	defw	rslw-6
flush:
	defw	docol
	defw	nobuf
	defw	onep
	defw	zero
	defw	xdo
flus1:
	defw	zero
	defw	buffe
	defw	drop
	defw	xloop
	defw	flus1-$
	defw	semis
;
;
	defb	86h			;/ EXTEND
	defc	'EXTEND'		;/
	defw	flush-08h		;/
extend:
	defw	docol			;/
	defw	here			;/ fill with b/buf blanks
	defw	bbuf
	defw	blank
	defw	lit			;/
	defw	0008h			;/
	defw	star			;/
	defw	zero			;/
extnd1:
	defw	onep			;/ begin
	defw	here			;/ was lit,f000h (Osborne video ram)
	defw	over			;/
	defw	one			;/
	defw	rslw			;/
	defw	dskerr			;/
	defw	at			;/
	defw	zbran			;/
	defw	extnd1-$		;/ until
	defw	swap			;/
	defw	over			;/
	defw	plus			;/
	defw	swap			;/
	defw	xdo			;/ do
extnd2:
	defw	here			;/ was lit,f000h (Osborne video ram)
	defw	ido			;/
	defw	zero			;/
	defw	rslw			;/
	defw	xloop			;/
	defw	extnd2-$		;/ loop
	defw	fcb			;/
	defw	lit			;/
	defw	clsfil			;/
	defw	bdos			;/ close file
	defw	drop			;/
	defw	fcb			;/
	defw	lit			;/
	defw	opnfil			;/
	defw	bdos			;/ & re-open
	defw	drop			;/
	defw	semis			;/
;
;
	defb	84h			; LOAD
	defc	'LOAD'
	defw	extend-09h
load:
	defw	docol
	defw	blk
	defw	at
	defw	tor
	defw	inn
	defw	at
	defw	tor
	defw	zero
	defw	inn
	defw	store
	defw	bscr
	defw	star
	defw	blk
	defw	store			; BLK <-- SCR * B/SCR
	defw	inter			; interpret from other screen
	defw	fromr
	defw	inn
	defw	store
	defw	fromr
	defw	blk
	defw	store
	defw	semis
;
;
	defb	0c3h			; -->
	defc	'-->'
	defw	load-7
arrow:
	defw	docol
	defw	qload
	defw	zero
	defw	inn
	defw	store
	defw	bscr
	defw	blk
	defw	at
	defw	over
	defw	modd
	defw	subb
	defw	blk
	defw	pstor
	defw	semis
;
;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ; CP/M DISC INTERFACE
;
; Last update:
;
; 881212 - EXTEND now writes blanks to screens it creates
; 860120 - EXTEND's R/W address now at HERE, was Osborne video ram
; 850511 - saved BC' in 'BDOS'
; 850227 - saved index regs. in 'BDOS'
; 840812 - added EXTEND
; 840731 - installed BDOS calls
;
;
; CP/M BDOS CALLS USED (as per Albert van der Horst, HCCH)
;
; R/W  reads or writes a sector in the file specified when invoking
; Z280 fig-FORTH (A>280FORTH d:filename.ext), using the default FCB.
; More than one disc may be accessed by temporary use of a user de-
; fined FCB.
;
;
;
deffcb		equ	005ch		; default FCB
;
;	CP/M FUNCTIONS
;
opnfil		equ	0fh		; open file
clsfil		equ	10h		; close file
setdma		equ	1ah		; set DMA address
wrtrnd		equ	22h		; write random
;
;
	;.z280					
	; PRE280 V1.11b 20-Nov-90  Copyright (c) 1990 by A.Zinser (fifi@veeble.north.de)
	.Z80
;
;
;
;	FORTH variables & constants used in disc interface
;
	defb	83h			; FCB (current FCB address)
	defc	'FCB'			
	defw	ptsto-5			
fcb:					
	defw	docon			
	defw	deffcb			
;
;
	defb	84h			; REC# (returns addr. of random rec.#)
	defc	'REC#'			
	defw	fcb-6			
recadr:					
	defw	docol			
	defw	fcb			
	defw	lit			
	defw	21h			
	defw	plus			
	defw	semis			
;
;
	defb	83h			; USE
	defc	'USE'			
	defw	recadr-7		
use:					
	defw	dovar			
	defw	0			;/ initialised by CLD
;
;
	defb	84h			; PREV
	defc	'PREV'			
	defw	use-6			
prev:					
	defw	dovar			
	defw	0			;/ initialised by CLD
;
;
	defb	85h			; #BUFF
	defc	'#BUFF'			
	defw	prev-07h		
nobuf:					
	defw	docon			
	defw	nbuf			
;
;
	defb	8ah			; DISK-ERROR
	defc	'DISK-ERROR'		
	defw	nobuf-08h		
dskerr:					
	defw	dovar			
	defw	0			
;
;
;	DISC INTERFACE HIGH LEVEL ROUTINES
;
	defb	84h			; +BUF
	defc	'+BUF'			
	defw	dskerr-0dh		
pbuf:					
	defw	docol			
	defw	lit,co			
	defw	plus			
	defw	dup			
	defw	limit			
	defw	equal			
	defw	zbran			
	defw	pbuf1-$			
	defw	drop			
	defw	first			
pbuf1:					
	defw	dup			
	defw	prev			
	defw	at			
	defw	subb			
	defw	semis			
;
;
	defb	86h			; UPDATE
	defc	'UPDATE'		
	defw	pbuf-07h		
updat:					
	defw	docol			
	defw	prev			
	defw	at			
	defw	at			
	defw	lit			
	defw	8000h			
	defw	orr			
	defw	prev			
	defw	at			
	defw	store			
	defw	semis			
;
;
	defb	8dh			; EMPTY-BUFFERS
	defc	'EMPTY-BUFFERS'		
	defw	updat-9			
mtbuf:					
	defw	docol			
	defw	first			
	defw	limit			
	defw	over			
	defw	subb			
	defw	erasee			
	defw	semis			
;
;
	defb	83h			; DR0
	defc	'DR0'			
	defw	mtbuf-10h		
drzer:					
	defw	docol			
	defw	zero			
	defw	ofset			
	defw	store			
	defw	semis			
;
;
	defb	83h			; DR1
	defc	'DR1'			
	defw	drzer-6			
drone:					
	defw	docol			
	defw	lit			
	defw	1600			; Osborne DD
dron2:					
	defw	ofset			
	defw	store			
	defw	semis			
;
;
	defb	86h			; BUFFER
	defc	'BUFFER'		
	defw	drone-6			
buffe:					
	defw	docol			
	defw	use			
	defw	at			
	defw	dup			
	defw	tor			
buff1:					
	defw	pbuf			; won't work if single buffer
	defw	zbran			
	defw	buff1-$			
	defw	use			
	defw	store			
	defw	rr			
	defw	at			
	defw	zless			
	defw	zbran			
	defw	buff2-$			
	defw	rr			
	defw	twop			
	defw	rr			
	defw	at			
	defw	lit			
	defw	7fffh			
	defw	andd			
	defw	zero			
	defw	rslw			
buff2:					
	defw	rr			
	defw	store			
	defw	rr			
	defw	prev			
	defw	store			
	defw	fromr			
	defw	twop			
	defw	semis			
;
;
	defb	85h			; BLOCK
	defc	'BLOCK'			
	defw	buffe-9			
block:					
	defw	docol			
	defw	ofset			
	defw	at			
	defw	plus			
	defw	tor			
	defw	prev			
	defw	at			
	defw	dup			
	defw	at			
	defw	rr			
	defw	subb			
	defw	dup			
	defw	plus			
	defw	zbran			
	defw	bloc1-$			
bloc2:					
	defw	pbuf			
	defw	zequ			
	defw	zbran			
	defw	bloc3-$			
	defw	drop			
	defw	rr			
	defw	buffe			
	defw	dup			
	defw	rr			
	defw	one			
	defw	rslw			
	defw	twomin			;/
bloc3:					
	defw	dup			
	defw	at			
	defw	rr			
	defw	subb			
	defw	dup			
	defw	plus			
	defw	zequ			
	defw	zbran			
	defw	bloc2-$			
	defw	dup			
	defw	prev			
	defw	store			
BLOC1:					
	defw	fromr			
	defw	drop			
	defw	twop			
	defw	semis			
;
;
	defb	84h			; BDOS  (CP/M function call)
	defc	'BDOS'			
	defw	block-8			
bdos:					
	defw	$+2			
	exx				;/ save ip
	pop	bc			; c <-- s1.lb = BDOS function code
	pop	de			; de <-- s2)  = parameter
	push	ix			
	push	iy			
	exx				
	push	bc			; some BIOS use alternate registers
	exx				
	call	bdoss			; return value in a
	exx				
	pop	bc			;/ bc <-- ip
	pop	iy			
	pop	ix			
	ld	l,a			
	ld	h,00h			
	jhpush				; s1 <-- hl = returned value
;
;
	defb	83h			; R/W
	defc	'R/W'			
	defw	bdos-07h		
rslw:					
	defw	docol			
	defw	tor			; store R/W flag
	defw	recadr			
	defw	store			
	defw	zero			
	defw	recadr			; set record #
	defw	twop			
	defw	cstor			
	defw	lit			
	defw	setdma			
	defw	bdos			
	defw	drop			; set DMA address
	defw	lit			
	defw	wrtrnd			
	defw	fromr			
	defw	subb			; select READ or WRITE
	defw	fcb			
	defw	swap			
	defw	bdos			; do it
	defw	dskerr			
	defw	store			; store return code
	defw	semis			
;
;
	defb	85h			; FLUSH
	defc	'FLUSH'			
	defw	rslw-6			
flush:					
	defw	docol			
	defw	nobuf			
	defw	onep			
	defw	zero			
	defw	xdo			
flus1:					
	defw	zero			
	defw	buffe			
	defw	drop			
	defw	xloop			
	defw	flus1-$			
	defw	semis			
;
;
	defb	86h			;/ EXTEND
	defc	'EXTEND'		;/
	defw	flush-08h		;/
extend:					
	defw	docol			;/
	defw	here			;/ fill with b/buf blanks
	defw	bbuf			
	defw	blank			
	defw	lit			;/
	defw	0008h			;/
	defw	star			;/
	defw	zero			;/
extnd1:					
	defw	onep			;/ begin
	defw	here			;/ was lit,f000h (Osborne video ram)
	defw	over			;/
	defw	one			;/
	defw	rslw			;/
	defw	dskerr			;/
	defw	at			;/
	defw	zbran			;/
	defw	extnd1-$		;/ until
	defw	swap			;/
	defw	over			;/
	defw	plus			;/
	defw	swap			;/
	defw	xdo			;/ do
extnd2:					
	defw	here			;/ was lit,f000h (Osborne video ram)
	defw	ido			;/
	defw	zero			;/
	defw	rslw			;/
	defw	xloop			;/
	defw	extnd2-$		;/ loop
	defw	fcb			;/
	defw	lit			;/
	defw	clsfil			;/
	defw	bdos			;/ close file
	defw	drop			;/
	defw	fcb			;/
	defw	lit			;/
	defw	opnfil			;/
	defw	bdos			;/ & re-open
	defw	drop			;/
	defw	semis			;/
;
;
	defb	84h			; LOAD
	defc	'LOAD'			
	defw	extend-09h		
load:					
	defw	docol			
	defw	blk			
	defw	at			
	defw	tor			
	defw	inn			
	defw	at			
	defw	tor			
	defw	zero			
	defw	inn			
	defw	store			
	defw	bscr			
	defw	star			
	defw	blk			
	defw	store			; BLK <-- SCR * B/SCR
	defw	inter			; interpret from other screen
	defw	fromr			
	defw	inn			
	defw	store			
	defw	fromr			
	defw	blk			
	defw	store			
	defw	semis			
;
;
	defb	0c3h			; -->
	defc	'-->'			
	defw	load-7			
arrow:					
	defw	docol			
	defw	qload			
	defw	zero			
	defw	inn			
	defw	store			
	defw	bscr			
	defw	blk			
	defw	at			
	defw	over			
	defw	modd			
	defw	subb			
	defw	blk			
	defw	pstor			
	defw	semis			
;
;
	
	defw	blk			
	defw	at			
	def                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Z80 fig-FORTH Line Editor Commands
          ----------------------------------


B         Back cursor to the beginning of the string in the PAD.

C         Spread text at cursor to insert the following string.   Characters
          pushed off the end of the line are lost.

D         n ---
          Delete the nth line and move subsequent lines 1 up.   The  deleted
          line is held in the PAD.

E         n ---
          Erase the nth line by filling it with 64 blanks.

F         Find the first occurrence of the following text string.

H         n ---
          Copy the nth line to the PAD and hold it there.

I         n ---
          Insert text from PAD into line n. Shift the original nth and sub-
          sequent lines down 1 line. The original line 15 is lost.

L         Re-list the screen being edited.

M         n ---
          Move cursor n characters.

N         Find the next occurence of the text already in the PAD.

P         n ---
          Put the following text on line n. Write over its old contents.

R         n ---
          Replace the nth line with the text stored in the PAD.

S         n ---
          Spread line n with blanks. Shift the original line n and subse-
          quent lines down 1 line. The original line 15 is lost.

T         n ---
          Type line n of the current screen and copy it to the PAD.

X         Delete the following text from the current line.

CLEAR     n ---
          Clear screen n by filling it with blanks and make it current.

COPY      n1 n2 ---
          Copy screen n1 to screen n2.

DELETE    n ---
          Delete n characters in front of the cursor. Move the text from the
          end of the line to fill up the space.  Fill with blanks at the end
          of the line.

FIND      Search the entire screen for the string stored in the PAD and move
          the cursor to the end of the string. Issue an error message if the
          search failed.

TILL      Delete all characters from the  cursor location  up to  the end of
          the following text string.

TOP       Move the cursor to the leftmost position at line 0.

TS        Type Screen. Useful for finding hidden NULL characters which would
          prematurely end compilation.  If line numbers  at  the right don't
          line up, retype the line or use E command if line is empty.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ГОГ
Г* E Хй2	Й* H йNP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)   COPYRIGHT (C) 1979, DIGITAL RESEARCH,  PIP VERS 1.5 $$$     SUB    =.:,<>_[]INPIRDPTRUR1UR2RDROUTLPTUL1PRNLSTPTPUP1UP2PUNTTYCRTUC1CONNULEOF DISK READ ERROR$DISK WRITE ERROR$VERIFY ERROR$NOT A CHARACTER SINK$READER STOPPING
$NOT A CHARACTER SOURCE$ABORTED$BAD PARAMETER$INVALID USER NUMBER$RECORD TOO LONG$INVALID DIGIT$END OF FILE, CTL-Z?$CHECKSUM ERROR$CORRECT ERROR, TYPE RETURN OR CTL-Z$INVALID FORMAT$HEX$$$$NO DIRECTORY SPACE$NO FILE$COM$START NOT FOUND$QUIT NOT FOUND$CANNOT CLOSE DESTINATION FILE$DESTINATION IS R/O, DELETE (Y/N)?$**NOT DELETED**$$$$$$$NOT FOUND$COPYING -$REQUIRES CP/M 2.0 OR NEWER FOR OPERATION.$UNRECOGNIZED DESTINATION$CANNOT WRITE$INVALID PIP FORMAT$CANNOT READ$INVALID SEPARATOR$1тЂ ЕЂМН
:МЦ Цџ2ҐНLл> Н„ТэMН9Н  Н	2А  Н 2ь1тН@:А2Б!o6 +6 +6 !¦6#6 !у6 #6ю:ҐТG*ННo	Н.!N6я:МюТ^*ьMН^Н  !K6 !6 !¤6 +6 'Н :©юВЃГ$:©юВГ:”=2KНН :©юК¤Н\:хТ·\ НоНxГА'НоНІГЫ:©ЦЖяџ!х¶ТЦН\НўНН :©юВН€НЖ'Е!Н
НЯНІГЫ:©юВ$Н:ЁюКГ$Н€НІГЫ!N6я'Н :©Цџ!х¶ТCwНЇ	!6 :©юВ^НўНc!Ё6яГ{:ЁЦџ/х>!Ё–џ/БH±Т{ђНЇ	:Ё<2ЈюВЉНПН :©ЦЖяџх:ЁЦ=ЖяџБH±Т®ќНЇ	!§6:§Тѕ:А2БН !6 :©ЦЦџх:х/БHЎТнН€Нѕ!Ё6яГ:©ЦЖяџх>
!Ё–џ/х>–џБHЎБH±Т°НЇ	:!^¶w:Ё<2¤:ЁюВ0НПГ}:ЁюВ@НEГ}:ЁЦџ!¦ТS!W6:Јю
Вz!]6:cю Вm!c6:_ю Вz!_6НlНН :©ЦЖяџх:ЁЦ,Жяџх:ЁЦЖяџБHЎБH±Т°јНЇ	:ЁЦЖяџ2§Гі:ЈюВОНEНП:Јю ВЫ Н1:Ґ2МГыv!тq!те*8йЙ!ые*6й:	Й>ъН¦>ъН¦Й  Н Й  Н Й!«q:«ж_ Н ЙН
НЙ!­p+qН.*¬л	Н Й  Н Й  Н Й!Їq*Ї& лН Й!±p+q*°лН 2®Й!іp+q*ІлН 2®Й!µp+q*ґлН 2®Й  Н 2®Й!·p+q*¶лН Й!№p+q*ёлН Й!»p+q*єлН Й!Ѕp+q*јлН 2®Й!їp+q*ѕлН Й!Гp+q*ВлН Йя  Н Й!Дq*Д& л Н Й*АMН	Й*БMН	Й!Жp+q*Ел!Н Й!Иp+q*Зл"Н Й!Кp+q*Йл$Н Й!Л6ЂЛ
Н Й  Н Й!kp+q*jлН Й>У>УЫЪЄ	Гћ	ЫжЙ!qp+qН/	*pDMН9:Н Н:M2r:N!rѕЪш	!М:rѕТс	*r& Н	NН!r4ВР	!М6 :Н”:®юяК
:НіН.ГЙ!ws+p+q+СБp+qХ:w=2wюяКN
*sе*uБ
w*s#"s*u#"uГ'
Й!  "ќ*MН^Н7	!x6 :ы!xѕЪѕ
*ќл*DMН†	НГ2yю К­
:yюК—
”НЇ	*ќ"џл*6:ы2xГ·
Ђ *ќ"ќ!x4Вd
!  "ќН/	Й!ЎНj}=2|юяВЫ
Й!  "Ў*KMН^'Н_	!z6 :|!zѕЪ1*ЎК	"}*}DMН†	'НУю К ¤НЇ	Ђ *Ў"Ў!z4Ву
:eТЙ!  "ЎЂ Н†	!z6 :|!zѕЪА'Н?	Ц Цџ2*H#"H!{6 :{ЦЂџ!¦Тў*{& Ђ 	:{ЎеН4К	Б
–Цџ2!{4ГmЂ *Ў"Ў:Ъ№µНЇ	!z4ВI'НУ2!  "ЎЙ!Ђq:Ђю Ъф!у4> !SѕТф:S!уѕТфЙ: 2Ѓ*ЈM !Э		^#VлйяЎНЋЪНИ
*ЎК	:Ђw*Ў#"ЎГГ=Г=Г=Г=Г=ВНЇ	Г*ЂMНжГ! 6ЂГqГ! 6АГqГ!   ГqГ*Ђ& лН Г! 6Г Г! 6 Г Г! 60Г Г*Ђ& лН Г! 6 ГПГ! 6ГПГ! 6ГПГ*Ђ& лН Г
.147:=FP[fqЉ• ®№ДП:Ѓ2 Й!‚q:‚ю	К"*‚MНРГn:cю В4*‚MНРГn:у2ѓ!c:ѓѕЪQ!c:ѓ–2ѓГ:!ѓ:c–w> !ѓѕТn!ѓ5 НРГY:‚юВ{!у6 Й!„q:„Ц Цџ!l¦wТ™ НГў:„Ж0OНЙ!…q:…жшOН|:…жOН|Й!†6:]ЦЦџ2l:o†'2o:nО '2n:mО '2m*mMНЈ*nMНЈ*oMНЈ:]юВ:Н НГ	НЙ*Ў}ж2‰ЂяНD"‡НИ
*‡К	е*‰лН
*‰& "ЎЙ!Љq:UТY:ЉюВYЙ:¦Т©:ЉюК©:_2‹ю К:‹юВЂ!‹6<:ф<2ф!‹ѕЪ!ф6 Н> !]ѕТ¤Нѕ!¦6 :QТМ:ЉЦЦџх:ЈЦ ЦџБHЎТМНЙ:ЉюВЩ!ф6 *ЉMН:Љю
Вн!¦6Й!Њq:ЊЦaџ/х>z!Њ–џ/БHЎТ:Њж_2Њ:ЊЙ!Ќq:ЌЦAџ/х>Z!Ќ–џ/БHЎТ8:Ќц 2Ќ:ЌЙ:¤=O>№Ъm:W!Q¶хН}	БHЎТmНюВd>ЙЧН9>Й!ђ6: 2Ћ*¤M !E		^#VлйэќНЋЪ—НO
*ќл*~2Џ*ќ#"ќГmНу2ЏГmН–	2ЏГm! 6ГаГm! 6ГаГm! 6ГаГm  Н ж2ЏГmГГГГГГГГйНЇ	Гm! 6 Г2Гm! 6Г2Гm! 6Г2Гm!ђ6   Н 2ЏГm€­¶їКХаруцщья'2:Ћ2 :TТ’:Ј2Ћ!Ј6*ЏMНE:Ћ2Ј:ђТЬ:^ТІ:§<2§Ц Цџ2ђГЅ:ЏЦ
Цџ2ђ:ђТЬН}	ТЬНюВЦ>Й НЇ	:iТл:Џж2Џ:dТъ*ЏMНоЙ:[Т	*ЏMНЙ:ЏЙ> !ъѕТ(:ъ=2ъюВ%>
Й>Й> !шѕТF!ш5+N !Н	~2‘!ч4ЙН<2‘юВT>Й> !bѕТ}*bMН­Тz!b~2ч6 !щ~6 <+wГ©> !`ѕТҐ*`MН­Тћ!`6 !ъ6>Й:‘ЙГ©:‘ЙГ(Й!’q:щ!’†wO !Н	~2“юВЩ*’& Н	:‘w>Й!‘:“ѕВк!щ4Гп!щ6 > Й:N<2N!МѕЪ>Й*N& Н	NНоЙНт2Ёю ВГЙ!–p+q!х6 !©6 +6 !Є6 :Єю ТS:ЄюВM!Ё6 НgГ8Н:N2M*ЁMН8ТpНБ!©6Й!”6 !—6 >!—ѕЪ•*—& P	6 !—4Вz!ц6 !ш6 #6 #6 !Є6 *ЁMН8ЪЪ:ЄюЪѕЙ:Ёю*ВОН‡ГСНgНт2ЁГЄ:Ёю:Вї:”ю КлЙ:ЄюВ,НЎЦA<2”O>№ТЙН*ЁMН8Т):Ёю[ВН±!N5!©6ЙГ±:ЄюК5Й!Ў6я#6 >!ўѕЪ°! 6 : <2 O>‘џ/х: !Ў†O !T	е* MНЎб–ЦџБHЎТ~ГK: юВЎ!©6Нтю[В–Н±!N5:ў2ЁЙ:ЎЖ2Ў!ў4В=Й:Ёю[ВјН±Г4:Єю ВИЙ!Є6:Ёю.ВНт2ЁOН8Ъ:ЄюЪмЙ:Ёю*ВьН‡ГяНgГХ:Ёю[ВН±!N5!©6:”ю В%:ь<2”*•6   *•	6 ЙГҐЙ!љq!›6 >
!›ѕЪd*›& I	:љѕВ]>Й!›4ВA> Й:Є<2ЄO *•	:Ёw:Ёю?В†!х6Й!њq!Ё6?!њ:ЄѕТ НgГђЙ!ќq*ќ& л*•~Й!ц6:А2БНт2Ё:ЁЦЦџх:ЁЦ]ЦџБH±Ъє:ЁЦA2ћO>№Т:Ёю ВъНт2ЁГ НЇ	Г·:ЁЦSЦџх:ЁЦQЦџБH±ТI:N<2џНт2ЁЦЦџх:ЁЦЦџБH±Ъ@Г"Нт2ЁГЌНт2ЁЦ02џO>	№Тc!џ6ГЌНт2ЁЦ02™O>	№ЪЌ*џ& НOе*™& Б	л!џsГc*ћ& P	:џw:ћюВ·>!џѕТ±НЇ	:џ2БГВНт2ЁЙ:Ёю_ВО!Ё6=Й!Ј6 >'!ЈѕЪй НE!Ј4ВФЙ!©p+q*Ёе0Н
Й!­r+s+p+q*¬~ю$К7*¬>¦*Єх>¦БH№К&> Й*Є#"Є*¬#"¬Г>ЙН2Ё:^ТRќџНЋџЙ:ЁЦЦџЙ!Ї6!њ6 Н=2µю:К™!њ6 :µюВ“HН9НюВЋ>Й!њ6 Н-Гe!µ6 Н»2ґю ВЗН=2ґюКєН-Г©:ЇТД>Й>ЙНД"·Н»2¶:ґЦ Жяџ!Ї¦Тр!ґ5Н»2іГУН¬!µ†ю К\НН-:ЇТ> Й>Й!±p+q:ЇТ,!Ї6 *°DMН9Й:®Т<!®6 НЙ:ЇТzН2ІюВW!®6ГD*њ& L	:Іw:њ<2њюOЪv*Н:ІЙ>ЙН=2№Ц0O>	№Ъ’:№Ц0Й:№ЦAO>№Т¤:Н:№ЦAЖ
ЙН}‡‡‡‡хН}БH±ЙН¬!µ†wЙН»O `iНdеН»бНVЙН[2єO>№Ъ2:єЦЦџ!X¦Ъ!»6:њ!»ѕЪ:»=O !L	NНE!»4ВьНE
НE:єюВ/ЙГЪН.*њ& L	6$LН9kН9Н.НюВXЙГЪЙЏНЇ	Й*KMН^ћ0Нэ20Е¤Н
:0ж20:1ж21ўНк'Ні'Нг:®юяВІҐНЇ	!G6 !  "ЎЙ!яя"џН7	*MН^НnН/	:a/х:БHЎТм!®6я:®юяВъёНЇ	!&6 АНэ2*э"ќЙ> !bѕТ!ДНЇ	> !`ѕТ0ФНЇ	Й!јq:јТE:24ГJ!46 *Ў}жю Кa!44НEГJННИ
*KMН^'НЃ:®юяВ‚гНЇ	¤Нк!36 'Нn:®юяКй:0Тг:fЪХН9НOНоюYКТ#Н9Н.3Нк'НіЙН.:0ж20'Н	'Ні'Е7Н
6Нк'НцЙ!яНj>яНA+л!ыsЙ!К" @яН“Ъ1!Ђ"яГ<*эл*я"яНЙК Н“еНnК	" ябНDНn"э"яНЙ:¤Ц Жяџ!Q¦2ЅТ‚Н:X!W¶Т“НЪГ¤Н:Ъ¤*ЁMНEГ“:ЅТ±НН@ЙН@:O2MНcНѕ!ѕ6#6 >!їѕЪ)*ї& P	~ю К":їЦЦџх:їЦЦџБH±х:їЦЦџБH±х:їЦЦџБH±х:їЦЦџБH±Ъ"!ѕ6 !ї4ВЙ:ѕТ_ННjЪYНO
НjТM*џ"ЎГS*я"ЎНИ
Г3Н@ГbНl*ѕMН1ЙяяџН“µЖяџЙ!  "А"ДН7	*MН^Ђ Н†	\ Н”!  "В:®ЦяЖяџАВхНЋџБHЎТД*В#"ВН§ГќН/	:®юяВе> ДН›µВб9НЇ	Н.Й*В#"А:®ж‡‡‡‡‡_ !Ђ е'Н
!'6 !36 'ЕН
:1/!a¶ТE*Д#"Д>НzµВ?CН9НIНІГЃЙН.!Ж6>!ЖѕЪ‡*Ж& '	~2Зю КЂ:Жю	Вy.Н*ЗMН!Ж4ВQЙ> !”ѕТ›:”=2ГЎ:ь2Й:цТ¬Н\> !”ѕТї:”=2KГЕ:ь2KЙ!А:БѕКСЙ!:KѕВЮН\ЙН:ЁюКнН\Й!Йp+qН€НЯЕ*ИDM!Н
НЖЙН :©ЦЦџх:ЁЦ=ЦџБHЎЪ-Н\:N2OЙл_ л…oЊgЙ_ {Ґoz¤gЙ^#Vл)е))Б	Й_ {µozґgЙ^#Vл)ВdЙ^#Vл|·g}oВnЙ_ {•ozњgЙO {‘ozgЙi`N#F‘ogЙo& •oњgЙHВ©=ВЁЙ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ( fig-FORTH string editor SCRs 7-12                      840817)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( Mass storage utility)                                                                                                         FORTH DEFINITIONS HEX                                                                                                           : EXTEND           ( n ---)                                       8 * 0 BEGIN                                                             1+ F000 OVER 1 R/W DISK-ERROR @                               UNTIL                                                     1A EMIT                                                         SWAP OVER + SWAP DO                                                                F000 I 0 R/W                                                  LOOP                                           FCB 10 BDOS DROP   ( close file)                                FCB 0F BDOS DROP   ( & re-open ) ;                            DECIMAL                                                         ;S                                                              ( FORTH HEADER) DECIMAL ;S                                      Adaptive version of Z80 fig-FORTH 1.1                           fig-FORTH model with alterations (SCRs in random access files)                                                                  Through the courtesy of the                                     FORTH Interest Group,                                           P.O.Box 1105,                                                   San Carlos,  CA 94070                                           U S A.                                                                                                                          Release 1 with compiler security & variable length names.                                                                       Z80 version by D.L. Wilson (USA) & E.H. Ramm (FRG).             Random file access by A. van der Horst (NL).                    Installed by E.H. Ramm, P.O.Box 38, D-2358 Kaltenkirchen,       Fed. Rep. of Germany, Tel.: (04191) 1621.                       ( ERROR MESSAGES)                                               empty stack                                                     dictionary full                                                 has incorrect address mode                                      isn't unique                                                                                                                    disc range?                                                     full stack                                                      disc error!                                                                                                                                                                                                                                                                                                                                                                                                                                                     Edmund Ramm, P.O.Box 1338, D-2358 Kaltenkirchen, W.Germany      ( ERROR MESSAGES SCR 2)                                         compilation only, use in definition                             execution only                                                  conditionals not paired                                         definition not finished                                         in protected dictionary                                         use only when loading                                           off current editing screen                                      declare vocabulary                                                                                                                                                                                                                                                                                                                                                                                                                                              Edmund Ramm, P.O.Box 1338, D-2358 Kaltenkirchen, W.Germany                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ( fig-FORTH EDITOR V2.0 SCR 1 of 6)                             FORTH DEFINITIONS HEX                                           : TEXT   HERE C/L 1+ BLANKS WORD HERE PAD C/L 1+ CMOVE ;        : LINE   DUP FFF0 AND 17 ?ERROR SCR @ (LINE) DROP ;             : 2DROP   DROP DROP ;                                           : 2SWAP   ROT >R ROT R> ;                                       VOCABULARY EDITOR IMMEDIATE HEX                                 : WHERE  DUP B/SCR / DUP SCR ! ." SCR # " DECIMAL .                      SWAP C/L /MOD C/L * ROT BLOCK + CR C/L TYPE CR                  HERE C@ - SPACES 5E EMIT [COMPILE] EDITOR QUIT ;       -->                                                                                                                                                                                                                                                                                                                                                                                             ( fig-FORTH EDITOR V2.0 SCR 2 of 6)                             EDITOR DEFINITIONS HEX    0 R# !                                : #LOCATE  R# @ C/L /MOD ;                                      : #LEAD    #LOCATE LINE SWAP ;                                  : #LAG     #LEAD DUP >R + C/L R> - ;                            : -MOVE    LINE C/L CMOVE UPDATE ;                              : H        LINE PAD 1+ C/L DUP PAD C! CMOVE ;                   : E        LINE C/L BLANKS UPDATE ;                             : S        DUP 1- 0E DO I LINE I 1+ -MOVE -1 +LOOP E ;          : D        DUP H 0F DUP ROT DO I 1+ LINE I -MOVE LOOP E ;       : M        R# +! CR SPACE #LEAD TYPE 5F EMIT #LAG TYPE #LOCATE             . DROP ;                                             : T        DUP C/L * R# ! H 0 M ;                               -->                                                                                                                                                                                             ( fig-FORTH EDITOR V2.0 SCR 3 of 6)                             : L     SCR @ LIST 0 M ;                                        : R     PAD 1+ SWAP -MOVE ;                                     : P     1 TEXT R ;                                              : I     DUP S R ;                                               : TOP   0 R# ! ;                                                : CLEAR SCR ! 10 0 DO FORTH I EDITOR E LOOP ;                   : COPY     ( source target --- )                                  FORTH B/SCR * SWAP B/SCR * SWAP     ( compute 1st buffers)      B/SCR 0 DO DUP I + BUFFER DROP LOOP   ( reserve buffers)        B/SCR 0 DO                                                              OVER I + BLOCK OVER I + BLOCK B/BUF CMOVE UPDATE                LOOP                                                    DROP DROP FLUSH EDITOR ;                                                                                                      -->                                                             ( fig-FORTH EDITOR V2.0 SCR 4 of 6)                             : -TEXT  SWAP -DUP IF OVER + SWAP                                        DO DUP C@ FORTH I C@ - IF 0= LEAVE ELSE 1+ THEN LOOP            ELSE DROP 0= THEN ;                                    : MATCH  >R >R 2DUP R> R> 2SWAP OVER + SWAP DO 2DUP FORTH                I -TEXT IF >R 2DROP R> - I SWAP - 0 SWAP 0 0 LEAVE THEN         LOOP 2DROP SWAP 0= SWAP ;                              : 1LINE  #LAG PAD COUNT MATCH R# +! ;                           : FIND   BEGIN 3FF R# @ < IF TOP PAD HERE C/L 1+ CMOVE 0                 ERROR ENDIF 1LINE UNTIL ;                              -->                                                                                                                                                                                                                                                                                                                                                                                             ( fig-FORTH EDITOR V2.0 SCR 5 of 6)                             : DELETE  >R #LAG + FORTH R - #LAG R MINUS R# +! #LEAD + SWAP             CMOVE R> BLANKS UPDATE ;                              : N       FIND 0 M ;                                            : F       1 TEXT N ;                                            : B       PAD C@ MINUS M ;                                      : X       1 TEXT FIND PAD C@ DELETE 0 M ;                       : TILL    #LEAD + 1 TEXT 1LINE 0= 0 ?ERROR #LEAD + SWAP -                 DELETE 0 M ;                                          -->                                                                                                                                                                                                                                                                                                                                                                                                                                                             ( fig-FORTH EDITOR V2.0 SCR 6 of 6)                             : C      1 TEXT PAD COUNT #LAG ROT OVER MIN >R FORTH R R# +!             R - >R DUP HERE R CMOVE HERE #LEAD + R> CMOVE R>                CMOVE UPDATE 0 M ;                                     : TS      10 0 DO FORTH I EDITOR T LOOP TOP ;                   FORTH DEFINITIONS DECIMAL                                       LATEST 12 +ORIGIN !                                             HERE   28 +ORIGIN !                                             HERE   30 +ORIGIN !                                             ' EDITOR 6 + 32 +ORIGIN !                                       HERE FENCE !                                                    ;S                                                                                                                                                                                                                                                                                                                              ( fig-FORTH 8080 Assembler with Z80 extensions       SCR 1 of 5)                                                                HEX VOCABULARY ASSEMBLER IMMEDIATE                              ' ASSEMBLER CFA ' ;CODE 0A + !                                  : CODE   ?EXEC CREATE [COMPILE] ASSEMBLER !CSP ; IMMEDIATE      : C;     CURRENT @ CONTEXT ! ?EXEC ?CSP SMUDGE ; IMMEDIATE      : LABEL  ?EXEC 0 VARIABLE  SMUDGE -2 ALLOT                               [COMPILE] ASSEMBLER !CSP ; IMMEDIATE                   : 8*     DUP + DUP + DUP + ;                                                                                                    ASSEMBLER DEFINITIONS                                           -->                                                                                                                                                                                                                                                                                                                             ( fig-FORTH 8080 Assembler with Z80 extensions       SCR 2 of 5)                                                                4 CONSTANT H   5 CONSTANT L   7 CONSTANT A   6 CONSTANT PSW     2 CONSTANT D   3 CONSTANT E   0 CONSTANT B   1 CONSTANT C       6 CONSTANT M   6 CONSTANT SP                                                                                                    : 1MI   <BUILDS C, DOES> C@ C, ;                                : 2MI   <BUILDS C, DOES> C@ + C, ;                              : 3MI   <BUILDS C, DOES> C@ SWAP 8* + C, ;                      : 4MI   <BUILDS C, DOES> C@ C, C, ;                             : 5MI   <BUILDS C, DOES> C@ C, , ;                              -->                                                                                                                                                                                                                                                                                                                             ( fig-FORTH 8080 Assembler with Z80 extensions       SCR 3 of 5)                                                                00 1MI NOP   76 1MI HLT   F3 1MI DI    FB 1MI EI    07 1MI RLC  0F 1MI RRC   17 1MI RAL   1F 1MI RAR   E9 1MI PCHL  F9 1MI SPHL E3 1MI XTHL  EB 1MI XCHG  27 1MI DAA   2F 1MI CMA   37 1MI STC  3F 1MI CMC   08 1MI EXAF  D9 1MI EXX   C0 1MI RNZ   C8 1MI RZ   D0 1MI RNC   D8 1MI RC    E0 1MI RPO   E8 1MI RPE   F0 1MI RP   F8 1MI RM    C9 1MI RET                                                                                                         80 2MI ADD   88 2MI ADC   90 2MI SUB   98 2MI SBB   A0 2MI ANA  A8 2MI XRA   B0 2MI ORA   B8 2MI CMP                                                                                            09 3MI DAD   C1 3MI POP   C5 3MI PUSH  02 3MI STAX  0A 3MI LDAX 04 3MI INR   05 3MI DCR   03 3MI INX   0B 3MI DCX   C7 3MI RST  -->                                                                                                                             ( fig-FORTH 8080 Assembler with Z80 extensions       SCR 4 of 5)                                                                D3 4MI OUT   DB 4MI IN    C6 4MI ADI   CE 4MI ACI   D6 4MI SUI  DE 4MI SBI   E6 4MI ANI   EE 4MI XRI   F6 4MI ORI   FE 4MI CPI                                                                  22 5MI SHLD  2A 5MI LHLD  32 5MI STA   3A 5MI LDA   C4 5MI CNZ  CC 5MI CZ    D4 5MI CNC   DC 5MI CC    E4 5MI CPO   EC 5MI CPE  F4 5MI CP    FC 5MI CM    CD 5MI CALL  C3 5MI JMP                                                                               C2 CONSTANT 0=  D2 CONSTANT CS  E2 CONSTANT PE  F2 CONSTANT 0<                                                                  : NOT   8 + ;            : MOV   8* 40 + + C, ;                 : MVI   8* 6 + C, C, ;   : LXI   8* 1+ C, , ;                   : PCIX  DD C, E9 C,  ;   : PCIY  FD C, E9 C, ;                  -->                                                                                                                             ( fig-FORTH 8080 Assembler with Z80 extensions       SCR 5 of 5)                                                                : ENDIF   2 ?PAIRS HERE SWAP ! ;                                : THEN    [COMPILE] ENDIF ;                                     : IF      C, HERE 0 , 2 ;                                       : ELSE    2 ?PAIRS C3 IF ROT SWAP ENDIF 2 ;                     : BEGIN   HERE 1 ;                                              : UNTIL   SWAP 1 ?PAIRS C, , ;                                  : AGAIN   1 ?PAIRS C3 C, , ;                                    : WHILE   IF 2+ ;                                               : REPEAT  >R >R AGAIN R> R> 2- ENDIF ;                                                                                          FORTH DEFINITIONS DECIMAL                                       ;S                                                                                                                                                                                              ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                FORGET TASK   : TASK ;                                                                                                          VOCABULARY NETWORK IMMEDIATE                                                                                                    -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)-->                                                                                                                             Red face time: a major part of the following code has been      shamelessly pinched from Robert Taylor's "SEND and RCV" which   appeared in DDJ 09/83 p.66-81.                                                                                                  The routines presented here are not to be used for commercial   purposes, but unlimited personal, non-commercial use is allowed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( SEND & RCV files using MODEM7 protocol             EHR 850420)NETWORK DEFINITIONS HEX                                                                                                         CODE CRC-16        ( u1 8b --- u2,   X^16 + X^12 + X^5 + 1)         EXX   B POP   H POP   1021 D LXI   C A MOV   8 B MVI            BEGIN                                                             A C MOV   80 ANI   H XRA   A H MOV   H DAD                      CS IF                                                                E A MOV   L XRA   A L MOV   D A MOV   H XRA   A H MOV         ENDIF                                                        C A MOV   RAL   B DCR   0=                                    UNTIL                                                           H PUSH   EXX   PCIX                                         C;                                                              DECIMAL                                                         -->                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                FORTH DEFINITIONS DECIMAL                                                                                                       : <>  = 0= ;         : 4DROP  DROP DROP DROP DROP ;                                                                             : D=  ROT = ROT ROT = AND ;   ( d1 d2 --- f)                                                                                    : EXIT  R> DROP ;                                                                                                               : RESTART                                                         ?COMP ?STACK 0 0 >R >R                                          BEGIN DUP 1 <> WHILE >R >R REPEAT 2DUP [COMPILE] AGAIN          BEGIN R> R> 2DUP 0 0 D= UNTIL 2DROP ; IMMEDIATE                                                                               -->                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                : CREATE-FCB                                                      <BUILDS HERE 165 ERASE 165 ALLOT DOES> ;     ( 37 + 128 bytes)                                                                37 CONSTANT BUFFER-OFFSET    ( fcb length, i/o buf displacement)                                                                : SET-DMA  ( addr ---)  BUFFER-OFFSET + 26 BDOS DROP ;                                                                          : ?BUFFER-ADDR   ( fcb-addr ---)  BUFFER-OFFSET + ;                                                                             CREATE-FCB XFER                          ( SEND & RCV work fcb )                                                                -->                                                                                                                                                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)( fcb-addr --- dir-code)                                        : DCONIN  255  6 BDOS ;     : DCONOUT      6 BDOS DROP ;        : OPEN-FILE   15 BDOS ;     : CLOSE-FILE  16 BDOS ;             : ERA-FILE    19 BDOS ;                                         : MAKE-FILE   22 BDOS ;                                         : GET-SIZE    35 BDOS DROP ;  ( fcb-addr ---;  r0 r1 r2  in FCB)                                                                ( fcb-addr --- 0 [error], buf-addr [success])                   : READ-RAND   DUP DUP SET-DMA 33 BDOS  ( 0 = success)                         IF ( <>0 = error) DROP 0                                        ELSE BUFFER-OFFSET + THEN ;                       : WRITE-RAND  DUP DUP SET-DMA 34 BDOS  ( 0 = success)                         IF ( <>0 = error) DROP 0                                        ELSE BUFFER-OFFSET + THEN ;                       -->                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                : GET_DRIVE    ( ^fcb[0] ^buf[0] --- ^fcb[1] ^buf[0] or ^buf[2])  2DUP DUP  1+  C@  58 =  IF  C@  64 -  SWAP  C!  2+                                      ELSE  DROP 0 SWAP C!  ENDIF             SWAP 1+ SWAP ;                                                                                                                : ?WILDCARD                       ( n1 n2 n1 c --- n1 n2 n1 c f)  DUP 42 =  OVER  63 =  OR ;                                                                                                    : BEGIN_EXTENSION                                                          ( ^fcb[n] ^buf[n] ^fcb[n] '.' --- ^fcb[9] ^buf[n+1] )  DROP DROP 1+ SWAP DROP  XFER 9 +  SWAP ;                                                                                      -->                                                                                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                : BUF_FCB_C!                                                                ( ^fcb[n] ^buf[n] ^fcb[n] c --- ^fcb[n+1] ^buf[n+1])  SWAP  C!  1+  SWAP  1+  SWAP ;                                                                                                : BADNAME                                                ( --- )  ." Invalid file name" CR  QUIT ;                                                                                              : PARSE                                  ( ^fcb[0] ^buf[0] --- )  OVER  12 BLANKS  ( space fill fcb-filename)  GET_DRIVE          BEGIN  2DUP C@ DUP  0 <>  OVER  BL <>  AND                      WHILE  ?WILDCARD IF  4DROP  BADNAME  ENDIF                        DUP  46 =  IF BEGIN_EXTENSION  ELSE  BUF_FCB_C!  ENDIF          OVER  XFER 12 + > IF  DROP DROP  BADNAME  ENDIF               REPEAT   4DROP   XFER 12 + 23 ERASE ;  -->                    ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                : FILENAME                                      ( fcb-addr --- )  BL WORD HERE 1+ PARSE ;                                                                                                       : IN-NAME                                       ( fcb-addr --- )  ." Filename: "   HERE 15 EXPECT   HERE PARSE ;                                                                                : OUT-NAME                                       ( ^fcb[0] --- )  DUP C@  -DUP IF  64 + EMIT  58 EMIT  ENDIF                      DUP 1+ 8 TYPE  46 EMIT  9 + 3 TYPE ;                                                                                          NETWORK DEFINITIONS                                             -->                                                                                                                                                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)( Harware dependent, here for Z80B-CTC & Z80B-SIO)   HEX        : ?COM   E1 P@  1 AND ;                : ?TXRDY  E1 P@  4 AND ; : WAITOUT   BEGIN  ?TXRDY  UNTIL ;                              : WAITIN    BEGIN  ?COM    UNTIL ;                              : XIN       E0 P@ ;                    : DOUT  E0 P! ;          : XOUT      1+ -DUP IF WAITOUT 1-  E0 P!  ENDIF ;               : CLEAR     ?COM IF XIN DROP ENDIF ;          ( empty rx buffer): SETSIO    00 E1 P!   18 E1 P!     ( reset SIO A)                          01 E1 P!   00 E1 P!     ( disable INT generation)               04 E1 P!   44 E1 P!     ( *16, 1 stop bit)                      03 E1 P!   C1 E1 P!     ( 8 bits RX, RXenable)                  05 E1 P!   EA E1 P! ;   ( DTR, 8 bits TX, TXen, RTS): I300      0D E8 P!   50 E8 P! ;   ( CTC 6.14MHz/16/16/Bdrate) DECIMAL                                                         -->                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                0 VARIABLE CRC       0 VARIABLE ?ECHO                           0 VARIABLE 1STRCV    0 VARIABLE 1STSEC                          0 VARIABLE ERRS     10 CONSTANT MAXERR     0 VARIABLE NAK-CT                                                                    0 VARIABLE RSEC      0 VARIABLE SSEC       0 VARIABLE XSEC                                                                      0 CONSTANT NUL      24 CONSTANT CAN        1 CONSTANT SOH       4 CONSTANT EOT       6 CONSTANT ACK       21 CONSTANT NAK                                                                       0 VARIABLE TIMER     10000 VARIABLE TIM-CT                      : LONG-TIMEOUT   30000 TIM-CT ! ;                               : SHORT-TIMEOUT  10000 TIM-CT ! ;                               -->                                                                                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                : RCV-SETUP   SETSIO I300                                         XFER FILENAME  CR  XFER OPEN-FILE  255 <>                       IF  ." File exists, delete? (Y/N) "  KEY CR                         DUP 89 <>  SWAP  121 <>  AND  IF QUIT ENDIF                     XFER ERA-FILE DROP                                          ENDIF                                                           XFER MAKE-FILE  255 =                                           IF  ." Can't create "  XFER OUT-NAME CR QUIT ENDIF              XFER OUT-NAME  ."  open."  CR                                   0 XFER 33 + !   0 RSEC !   0 XSEC !   0 NAK-CT !              ;                                                               -->                                                                                                                                                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420): TIMED-IN   TIM-CT @ TIMER !                                     BEGIN      ?COM IF XIN EXIT ENDIF   -1 TIMER +!   TIMER @ 0=    UNTIL  -1 ;                                                                                                                   : GOBBLE      BEGIN TIMED-IN -1 = UNTIL ;                                                                                       : ABEND       CR ." Aborting."   XFER CLOSE-FILE  255 =                       IF CR ." Can't close " XFER OUT-NAME  ENDIF ;                                                                     : RCVERR      GOBBLE  1 NAK-CT +!  NAK-CT @ MAXERR >                          IF   CAN XOUT  CR ." Exeeded max. errors."                           ABEND QUIT                                                 ENDIF                                                           NAK XOUT   ." NAK sent"  CR ;                     -->                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                : ?TERMABORT   0 ?TERMINAL IF DROP KEY 24 =                          IF CR ." Cancelled by Sysop"  -1 ENDIF ENDIF ;             : NOREND  CR ." EOT rcvd"  ACK XOUT XFER CLOSE-FILE  255 =           IF ." Can't close "  XFER OUT-NAME CR ENDIF ;              : RCV-SECT  0 CRC !  128 0 DO TIMED-IN DUP -1 = IF EXIT ENDIF        DUP XFER ?BUFFER-ADDR I + C!   CRC @ SWAP CRC-16 CRC !          LOOP 0 ;                                                                                                                   : ?HDR-OK  OVER  255 XOR  =  ;          ( sec# _sec# --- sec# f): NEXT-SECT  RSEC !  1STSEC @ IF  0 1STSEC !                                                  ELSE  1 XSEC +!  ENDIF 0 ;        : ?WRAP  DUP 0=  RSEC @  255 =  AND ;         ( sec# --- sec# f)-->                                                                                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                : RCV-HDR                           ( --- f;  sector # in XSEC )      TIMED-IN DUP  -1 =  IF EXIT ENDIF                               TIMED-IN DUP  -1 =  IF  SWAP DROP EXIT  ENDIF                   ?HDR-OK                                                         IF  DUP  RSEC @  >                  ( > previous sector#?)        IF    NEXT-SECT                ( ok, inc sect. counters)        ELSE  ?WRAP                              ( sector wrap?)          IF    NEXT-SECT              ( ok, inc sect. counters)          ELSE  DROP 0  ENDIF           ( previous sector again)        ENDIF                                                         ELSE  DROP -1  ENDIF ;                                    -->                                                                                                                                                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                : RCV-CRC   TIMED-IN DUP -1 = IF EXIT ENDIF           ( CRC MSB)            TIMED-IN DUP -1 = IF SWAP DROP EXIT ENDIF ( CRC LSB)            SWAP CRC @ SWAP CRC-16 SWAP CRC-16 DUP IF ( not 0)              DROP  -1 ENDIF ;                                                                                                    : SAVE-SECT  XSEC @ XFER 33 + !  XFER WRITE-RAND 0= IF CR                    ." Can't write sector."  ABEND QUIT ENDIF                       13 EMIT ." Received # " XSEC @  1+  . ;                                                                            : DISP-CHR   BASE @ >R  HEX  2 .R   R> BASE !                                ." H rcvd, not ACK"  CR  ;                         -->                                                                                                                                                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                : WTCRC                          ( --- SOH)                           BEGIN                                                              ." CRC request sent." CR   67 XOUT                              ?TERMABORT IF                                                                ABEND QUIT                                                    ENDIF                                                TIMED-IN DUP SOH =                                                         IF                                                                EXIT                                                          ELSE                                                              DROP                                                          ENDIF                                             AGAIN ;                                                   -->                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                : RCV   RCV-SETUP  WTCRC  1 1STRCV !  1 1STSEC !                  BEGIN  ?TERMABORT  IF ABEND QUIT ENDIF                                 1STRCV @  IF 0 1STRCV ! ELSE TIMED-IN ENDIF                     DUP NUL =  IF DROP RESTART ENDIF                              DUP CAN =  IF DROP CR ." Remote Cancel." ABEND QUIT ENDIF         DUP EOT =  IF DROP NOREND QUIT ENDIF                            DUP -1  =  IF DROP ." T-" RCVERR RESTART ENDIF                  DUP SOH <> IF DISP-CHR RCVERR RESTART ENDIF DROP                RCV-HDR   IF ." H-" RCVERR RESTART ENDIF                        RCV-SECT  IF ." S-" RCVERR RESTART ENDIF                        RCV-CRC   IF ." C-" RCVERR RESTART ENDIF                        SAVE-SECT  ACK XOUT  0 NAK-CT !                          AGAIN ;                                                       -->                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420): WAIT-ACK   0 ERRS !  0 NAK-CT !         ( wait for ACK or CAN)  BEGIN                                                             ?TERMABORT IF  ABEND QUIT  ENDIF                                ERRS @  MAXERR >  NAK-CT @  MAXERR >  OR                          IF  CR ." Exeeded max. errs."  CAN XOUT                           ABEND QUIT  ENDIF                                           TIMED-IN                                                        DUP  -1 = IF DROP 1 ERRS +! CR ." T-" RESTART ENDIF             DUP CAN = IF DROP CR ." Remote Cancel" ABEND QUIT ENDIF         DUP ACK = IF DROP 0 NAK-CT ! EXIT ENDIF                         DISP-CHR  1 NAK-CT +!  EXIT                                   AGAIN ;                                                                                                                       : READ-SECT  SSEC @ XFER 33 + !  XFER READ-RAND 0= ;            -->                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                : SEND-HDR    SOH XOUT  SSEC @ 1+ DUP  255 AND  DUP XOUT                      255 XOR  XOUT  13 EMIT ." Sending # "  U. ;                                                                       : SEND-SECT   0 CRC !   128 0 DO XFER ?BUFFER-ADDR I + C@ DUP                 XOUT  CRC @ SWAP CRC-16 CRC !  LOOP ;                                                                             : SEND-CRC    CRC 1+ C@ XOUT  CRC C@ XOUT ;                                                                                     : WTCRCRQ   BEGIN  ?TERMABORT IF ABEND QUIT ENDIF                             ." Awaiting CRC request" CR  TIMED-IN DUP                       CAN = IF DROP ABEND QUIT ENDIF                                  67 =                                                          UNTIL ;                                             -->                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                : END-SEND                      ( terminate xmsn & wait for ACK)  XFER CLOSE-FILE DROP                                            BEGIN   CR ." EOT sent"  EOT XOUT  WAIT-ACK                             NAK-CT @ 0=                                             UNTIL   CR ." ACK rcvd" ;                                                                                                     : SEND-SETUP   SETSIO I300  LONG-TIMEOUT                          XFER FILENAME  CR  XFER OPEN-FILE                               255 = IF ." No File" CR  QUIT ENDIF                             XFER OUT-NAME ."  open: "                                       XFER GET-SIZE  XFER 33 + @  U.  ." records" CR                  0 SSEC !  0 NAK-CT ! ;                                        -->                                                                                                                             ( SEND & RCV files using MODEM7 protocol             EHR 850420)                                                                : SEND   SEND-SETUP  SHORT-TIMEOUT GOBBLE LONG-TIMEOUT                   WTCRCRQ  SHORT-TIMEOUT                                   BEGIN   ?TERMABORT IF ABEND QUIT ENDIF                                  READ-SECT  IF END-SEND QUIT ENDIF                               SEND-HDR  SEND-SECT  SEND-CRC                                   WAIT-ACK  NAK-CT @ 0= IF 1 SSEC +! ENDIF                AGAIN ;                                                                                                                       -->                                                                                                                                                                                                                                                                                                                                                                                             ( TERM & ECHO                                        EHR 850528): (ECHO)   DUP DUP XOUT  127 AND DCONOUT  13 =         ( c --- )  IF  10 DUP XOUT DCONOUT  ENDIF ;                                                                                              : KBD->V24   DCONIN -DUP  IF  DUP  5 =                   ( --- )    IF DROP  CR ." Leaving terminal mode" CR  QUIT  ENDIF         ?ECHO @ IF (ECHO) ELSE DOUT ENDIF  ENDIF ;                                                                                    : (TERM)   SETSIO  I300  CR                              ( --- )  BEGIN  ?COM IF  XIN  ?ECHO @                                      IF  (ECHO)  ELSE  127 AND  DCONOUT  ENDIF    ENDIF              ?TXRDY IF  KBD->V24  ENDIF                                    AGAIN  ;                                                                                                                      : TERM  0 ?ECHO !  (TERM) ;         : ECHO  1 ?ECHO !  (TERM) ; FORTH DEFINITIONS DECIMAL      ;S                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ( Recursive Decompiler, FORTH DIMENSIONS IV,#2 p28)             ( Original by Robert Dudley Ackerman)                           ( Modified by Dennis Wilson)                                    FORTH DEFINITIONS DECIMAL                                       : MYSELF                                                          LATEST PFA CFA , ;   IMMEDIATE                                : MARKS                                                           0 DO 45 EMIT ( - ) 43 EMIT ( + ) LOOP ;                       0 VARIABLE INLEVEL           ( depth of nesting )               : INDENT                                                          CR INLEVEL @ -DUP IF MARKS ENDIF SPACE ;                      : INDENT+                                                         1 INLEVEL +! INDENT ;                                                                                                         -->                                                                                                                             ( Recursive Decompiler, FORTH DIMENSIONS IV,#2 p28)             : GCHK  DUP @ 2+ ' COMPILE =                                            IF   2+ DUP @ 2+ NFA ID. 2+                                     ELSE    DUP @ 2+ DUP ' LIT =                                            OVER ' BRANCH  = OR                                             OVER ' 0BRANCH = OR                                             OVER ' (LOOP)  = OR                                             SWAP ' (+LOOP) = OR                                       IF   2+ DUP @ SPACE   .  2+                                     ELSE    DUP @            2+ ' (.") =                              IF   2+ DUP COUNT TYPE  DUP C@ 1+ +                             ELSE 2+                                                         ENDIF                                                         ENDIF                                                         ENDIF    -1 INLEVEL +!   ;    ( Handle special cases)   -->                                                             ( Recursive Decompiler, FORTH DIMENSIONS IV,#2 p28)             : (GOESINTO)   ( pfa --- )                                        DUP CFA @ ' : CFA @ = OVER ' ERROR = 0= AND                     IF           ( Colon def. & NOT 'ERROR')                          INDENT DUP NFA ." : "  ID.                                      BEGIN  DUP @ DUP ' ;S  CFA =  OVER ' (;CODE) CFA = OR 0=        WHILE      ( High level & NOT end of colon definition )            2+ DUP INDENT+  NFA ID. KEY DUP 81 =          ( Q? )            IF ( Q )   SP! QUIT                                             ELSE 32 =                                 ( Space? )              IF   DROP ELSE ( Go down one level ) MYSELF ENDIF             ENDIF GCHK                                                   REPEAT  ( Show last word ) 2+ INDENT NFA ID.                  ENDIF DROP ;                                                                                                                  -->                                                             ( Recursive Decompiler, FORTH DIMENSIONS IV,#2 p28)             DECIMAL                                                         : DECODE     -FIND IF DROP 0 INLEVEL ! (GOESINTO)                                  ELSE ." Not Found"                                              ENDIF ;                                      ." DECODE  installed" CR                                        ." Use SPACE bar to show next word at same level." CR           ."     RETURN key to DECODE last word shown (except primitives)"CR  ."     type Q to Quit"                                                                                                      ;S                                                                                                                                                                                                                                                                                                                                                                                              ( Colon Word Disforther V6 EHR 840812)                          FORTH DEFINITIONS HEX                                                                                                           ' ;S                  CFA CONSTANT :SEMIS                       ' LIT                 CFA CONSTANT :LIT                         ' BRANCH              CFA CONSTANT :BRAN                        ' 0BRANCH             CFA CONSTANT :ZBRAN                       ' QUIT                CFA CONSTANT :QUIT                        ' :                   CFA @ CONSTANT :DOCOL                     ' (LOOP)              CFA CONSTANT :XLOOP                       ' (+LOOP)             CFA CONSTANT :XPLOO                       ' ABORT               CFA CONSTANT :ABORT                       ' (.")                CFA CONSTANT :PDOTQ                       ' (;CODE)             CFA CONSTANT :PSCOD                                                                                       -->                                                             ( Colon Word Disforther V6 EHR 840812)                                                                                          : TST                                                             DUP @ :LIT   = IF 2+ DUP @ U. THEN                              DUP @ :BRAN  = IF 2+ DUP @  . THEN                              DUP @ :ZBRAN = IF 2+ DUP @  . THEN                              DUP @ :XLOOP = IF 2+ DUP @  . THEN                              DUP @ :XPLOO = IF 2+ DUP @  . THEN                              DUP @ :PDOTQ = IF 2+ DUP C@ SWAP 1+ 2DUP + 2- ROT ROT           SWAP TYPE 22 EMIT SPACE THEN ;                                                                                                -->                                                                                                                                                                                                                                                                                                                             ( Colon Word Disforther V6 EHR 840812)                          DECIMAL                                                                                                                         : DEFORTH                                                         [COMPILE] '             ( get name to deforth)                  CR DUP 2- @ :DOCOL = IF      ( continue if colon defn.)         ." : " DUP NFA ID. 2 SPACES   ( type : & name)                  BEGIN DUP @ :SEMIS = IF 2-                                      ELSE DUP @ 2+ NFA ID. DUP @ :PSCOD = IF                         10 MESSAGE DROP QUIT THEN THEN TST DUP @                        :QUIT = OVER @ :ABORT = OR SWAP 2+ DUP @ :SEMIS = ROT           OR END ." ; " ELSE ." NOT COLON WORD " THEN DROP CR ;                                                                         DECIMAL                                                                                                                         ;S                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ( PCW FORTH Benchmarks - Dick Pountain 821110)                  FORTH DEFINITIONS DECIMAL                                       : magnifier  setclk 10001 1 DO SP! LOOP getclk ;                : do-loop  setclk 10001 1 DO 11 1 DO LOOP SP! LOOP getclk ;     : literal  setclk 10001 1 DO 11 1 DO 9 LOOP SP! LOOP getclk ;   0 VARIABLE V       : variable                                       setclk 10001 1 DO 11 1 DO V LOOP SP! LOOP getclk ;          : literal-store  setclk 10001 1 DO 11 1 DO 9 V ! LOOP SP!                                      LOOP getclk ;                    : variable-fetch  setclk 10001 1 DO 11 1 DO V @ LOOP SP!                                        LOOP getclk ;                   9 CONSTANT K    : constant   setclk                                  10001 1 DO 11 1 DO K LOOP SP! LOOP getclk ;                : dup  setclk 10001 1 DO 11 1 DO 9 DUP LOOP SP! LOOP getclk ;   : increment  setclk 10001 1 DO 11 1 DO 9 1+ LOOP SP! LOOP                    getclk ;             -->                           ( PCW FORTH Benchmarks - Dick Pountain 821110)                  : test>  setclk                                                          10001 1 DO 11 1 DO 9 9 > LOOP SP! LOOP getclk ;        : test<  setclk                                                          10001 1 DO 11 1 DO 9 9 < LOOP SP! LOOP getclk ;        : arithmetic   setclk                                                          10001 1 DO 9 2/ 3 * 4 + 5 - SP! LOOP  getclk ;   : while-loop   setclk                                                          10001 1 DO 1 BEGIN 1+ DUP 11 < WHILE REPEAT                     SP!     LOOP   getclk ;                          : until-loop   setclk                                                          10001 1 DO 20 BEGIN 1- DUP 11 < UNTIL                           SP!     LOOP   getclk ;                          -->                                                                                                                                                                                             ( PCW FORTH Benchmarks - Dick Pountain 821110)                  : ten ;   : nine ten ;   : eight nine ;   : seven eight ;       : six seven ;   : five six ;   : four five ;   : three four ;   : two three ;   : one two ;                                     : thread   setclk 10001 1 DO one SP! LOOP getclk ;              : .SECS   S->D <# # # 46 HOLD #S #> TYPE ."  seconds" CR ;                                                                      : PCWBMS  CR                                                      magnifier ." magnifier   " .SECS                                do-loop   ." do-loop     " .SECS                                literal   ." literal     " .SECS                                variable  ." variable    " .SECS                                literal-store   ." store       " .SECS                          variable-fetch  ." fetch       " .SECS                          constant  ." constant    " .SECS                              -->                                                             ( PCW FORTH Benchmarks - Dick Pountain 821110)                    dup         ." dup         " .SECS                              increment   ." increment   " .SECS                              test>       ." test>       " .SECS                              test<       ." test<       " .SECS                              arithmetic  ." arithmetic  " .SECS                              while-loop  ." while-loop  " .SECS                              until-loop  ." until-loop  " .SECS                              thread      ." thread      " .SECS   ;                        ;S                                                                                                                                                                                                                                                                                                                                                                                                                                                              ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее( ELAB IF1.O PIOB AS CENTRONICS PRINTER PORT)                   HEX                                                             DA CONSTANT PIOAC   D8 CONSTANT PIOAD                           DB CONSTANT PIOBC   D9 CONSTANT PIOBD                           : SETPIO   0F PIOBC P!   03 PIOBC P!                                       CF PIOAC P!   01 PIOAC P!   03 PIOAC P!                         80 PIOAD P! ;                                        : STROBE   00 PIOAD P!   80 PIOAD P! ;                          : WTBSY    BEGIN  PIOAD P@  01 AND  0=  UNTIL ;                 ;S                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              	defb	86h			; setclk
	defc	'setclk'
	defw	dotcpu-7
setclk:
	defw	$+2
	exx				; save ip
	ld	c,iopreg
	ldctl	hl,(c)			; l <-- current i/o page
	ld	a,l
	ex	af,af'			; save i/o page
	ld	l,0feh
	ldctl	(c),hl			; select i/o page 0feh
	xor	a
	out	(cntrl0),a		; disable c/t 0
	out	(cntrl1),a		; disable c/t 1
	out	(config1),a
	ld	hl,0ffffh
	ld	a,10h
	out	(config0),a		; cascade c/t 0 - c/t 1
	ld	c,tcon0
	outw	(c),hl			; load c/t 0 time constant
	ld	c,tcon1
	outw	(c),hl			; load c/t 1 time constatnt
	ld	a,80h
	out	(config1),a		; continous mode
	ld	a,0e0h
	out	(cntrl1),a		; start 32bit counter
	ex	af,af'			; std. accu
	ld	l,a			; l <-- previous i/o page
	ld	c,iopreg
	ldctl	(c),hl			; restore i/o page
	exx				; restore ip
	jnext
;
;
	defb	86h			; getclk
	defc	'getclk'
	defw	setclk-9
getclk:
	defw	$+2
	exx				; save ip
	ld	c,iopreg
	ldctl	hl,(c)			; l <-- current i/o page
	ld	a,l
	ex	af,af'			; save current i/o page
	ld	l,0feh
	ldctl	(c),hl			; select i/o page 0feh
	ld	a,80h
	out	(cntrl1),a		; halt 32bit counter
	ld	c,count1
	inw	hl,(c)
	ld	d,h
	ld	e,l			; de <-- count1
	ld	c,count0
	inw	hl,(c)			; hl <-- count0
	ld	c,0
	ld	a,c			; a <-- 0
	sub	l			; 0 - l
	ld	l,a			; l <-- neg(l)
	ld	a,c			; a <-- 0
	sbc	a,h
	ld	h,a			; h <-- neg(h)
	ld	a,c			; a <-- 0
	sbc	a,e
	ld	e,a			; e <-- neg(e)
	ld	a,c			; a <-- 0
	sbc	a,d
	ld	d,a			; d <-- neg(d), dehl <-- neg(dehl)
	divuw	dehl,25000		; scale to 1/100 secs
	push	hl			; result
	ex	af,af'			; std. accu
	ld	l,a			; l <-- previous i/o page
	ld	c,iopreg
	ldctl	(c),hl			; restore i/o page
	exx				; restore ip
	jnext
;
;
                                                                                                                                                                                                                                                                                                                                                                                                              10 0 DO                                                            DUP I + C@ B.                                                                                                  *************** fig FORTH MODEL ***********************                                                                                       FORTH INTEREST GROUP                                              P.O. BOX 1105                                                 SAN CARLOS, CA. 94070                                                                                                        RELEASE 1.1F  FOR CP/M                                          WITH COMPILER SECURITY                                                 AND                                                      VARIABLE LENGTH NAMES                                                                                                            ADAPTED TO CP/M 2.2                                     SCREENS ALLOCATED IN RANDOM ACCESS FILE                      HEX   : HOME 1A EMIT ;   0 VARIABLE I-STATE                     : A-L    SCR @ (LINE) ; ( 1/2 ADDRESS OF LINE)                  : GET-L  A-L F000 SWAP CMOVE ; ( /0 MOVE LINE TO SCREEN)        : PUT-L  A-L F000 ROT ROT CMOVE ; ( /0 MOVE LINE FR SCREEN)     : DISPATCH ( 1/0 EXECUTE CONTROL CHARACTER)                     ( ^D) DUP  4 = IF  1B EMIT  57 EMIT  DROP ELSE                  ( ^I) DUP  9 = IF  I-STATE 1 TOGGLE  DROP ELSE                  ( ^X) DUP 18 = IF  1B EMIT  45 EMIT  DROP ELSE                  ( ^Y) DUP 19 = IF  1B EMIT  52 EMIT  DROP ELSE                  ( ^Q) DUP 11 = IF  ." ABORTED"       QUIT ELSE                    EMIT THEN THEN THEN THEN THEN ;                               : EMIT1  I-STATE @ IF  1B EMIT  51 EMIT  THEN EMIT ; ( 1/0)     : XX     BEGIN  KEY DUP DUP 20 <                                             IF DISPATCH ELSE EMIT1 THEN ( ^E) 5 = UNTIL  ;     : E-L    HOME DUP GET-L XX A EMIT PUT-L UPDATE ;                : C-L    SWAP A-L DROP SWAP A-L CMOVE  ;  -->                   : GET-S   10 0 DO I A-L F000 I 80 * + SWAP CMOVE LOOP ;         : PUT-S   10 0 DO F000 I 80 * + I A-L UPDATE CMOVE LOOP ;       : CLEAN   F800 F000 DO I C@ 7F AND I C! LOOP ;                  : E-S     0 I-STATE !  HOME GET-S XX CLEAN PUT-S HOME ;         : EDIT SCR ! E-S ;                                                                                                              ( EXTENDING THE SPACE ALLOCATED )                               : LAST-SEC ( 0/1 LEAVES ONE MORE THAN THE LAST BLOCK NR)            0 BEGIN 1+ F000 OVER 1 R/W DISK-ERROR @ UNTIL               ;                                                               : EXTEND   ( 1/0 EXTENDS # BLOCKS WITH NUMBER-1 )                 8 * LAST-SEC HOME ( GET AMOUNT OF BLOCKS)                       SWAP OVER + SWAP DO F000 I 0 R/W LOOP                           FCB 10 BDOS DROP    ( CLOSE THE FILE,I.E. UPDATE DIRECTORY)     FCB 0F BDOS DROP    ( OPEN AGAIN  )                           ;                                                                       ( SCR # 3)                                              : COPY-SCREEN  ( 2/0 COPY SCREEN-2 TO SCREEN-1 )                     B/SCR * SWAP B/SCR * SWAP ( GET START BUFFER #'S)               B/SCR 0 DO DUP I + BUFFER DROP LOOP ( RESERVE BUFFERS)          B/SCR 0 DO                                                         OVER I + BLOCK                                                  OVER I + BLOCK                                                  B/BUF CMOVE UPDATE                                           LOOP                                                            DROP DROP FLUSH                                                                                                            ;                                                                                                                                                                                                                                                                                                                               ( ERROR MESSAGES   )                                            MSG # 1 : EMPTY STACK                                           MSG # 2 : DICTIONARY FULL                                       MSG # 3 : HAS INCORRECT ADDRESS MODE                            MSG # 4 : ISN'T UNIQUE                                                                                                          MSG # 6 : DISK RANGE ?                                          MSG # 7 : FULL STACK                                            MSG # 8 : DISC ERROR !                                                                                                                                                                                                                                                                                                                                                                                                                                          ( FIGFORTH CP/M 2.2 ** HOBBY COMPUTER CLUB HOLLAND **)          ( ERROR MESSAGES   )                                            MSG # 17 : COMPILATION ONLY, USE IN DEFINITION                  MSG # 18 : EXECUTION ONLY                                       MSG # 19 : CONDITIONALS NOT PAIRED                              MSG # 20 : DEFINITION NOT FINISHED                              MSG # 21 : IN PROTECTED DICTIONARY                              MSG # 22 : USE ONLY WHEN LOADING                                MSG # 23 : OFF CURRENT EDITING SCREEN                           MSG # 24 : DECLARE VOCABULARY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    (  DEBUG   SCR#6)    0 VARIABLE BASE'                          : <HEX   BASE @ BASE' ! HEX ;       ( 0/1  SWITCH TO HEX)       : HEX>   BASE' @ BASE !     ;       ( 1/0  AND BACK)            (        1/0  PRINT IN HEX REGARDLESS OF BASE)                  : H.     <HEX 0 <# # # # # #> TYPE SPACE HEX> ;                 (        1/0  IDEM FOR A SINGLE BYTE)                           : B.     <HEX 0 <# # # #> TYPE HEX> ;                           : BASE?  BASE @ H. ;                ( 0/0 TRUE VALUE OF BASE)   : ^      ( 0/0 NON DESTRUCTIVE STACK PRINT)                              CR ." S: " SP@ S0 @ ( FIND LIMITS)                              BEGIN OVER OVER = 0=                                            WHILE 2 - DUP @ H.                                              REPEAT                                                          DROP DROP                                              ;                                                                                                              -->              <HEX ( DEBUG SCR#7 )                                            :  DUMP   ( 2/0  DUMPS FROM ADDRESS-2 AMOUNT-1 BYTES)                     OVER + SWAP FFF0 AND                                            DO                                                                 CR I H. ." : "                                                  I                                                               10 0 DO                                                            DUP I + C@ B.                                                   I 2 MOD IF SPACE THEN                                        LOOP                                                            1B EMIT 67 EMIT                                                 10 0 DO DUP I + C@ EMIT LOOP                                    1B EMIT 47 EMIT                                                 DROP                                                         10 +LOOP         CR                                   ;                                                              Г3   Copyright (c) 1979, Digital Research????????????   CON:RDR:PUN:LST:DEV:VAL:USR:DSK:TTY:CRT:BAT:UC1:TTY:PTR:UR1:UR2:TTY:PTP:UP1:UP2:TTY:CRT:LPT:UL1:R/O R/W SYS DIR R/O R/W SYS DIR ** Aborted ** Active User : Active Files:       Drive Characteristics 65536:  128 Byte Record Capacity Kilobyte Drive  Capacity 32  Byte Directory Entries Checked  Directory Entries Records/ Extent Records/ Block Sectors/ Track Reserved Tracks  is  Temp R/O Disk: d:=R/O Set Indicator: d:filename.typ $R/O $R/W $SYS $DIR Disk Status  : DSK: d:DSK: User Status  : USR: Iobyte Assign:  = Bad Delimiter Invalid Assignment Bad Delimiter :  Bytes Remaining On  R/ , Space:  Invalid File Indicator ** Too Many Files ** File Not Found  Size   Recs  Bytes  Ext Acc 65536  set to  R/O Invalid Disk Assignment Wrong CP/M Version (Requires 2.0) !  9"2!TщНню ТOНТГ‹!]6:\ Ц Цџх:] Ц ЦџБHЎТrН3Г‹:\ ю КЂНГ‹Н‡
/Т‹Нє*2щЙ!"q*"& лНLЙНђ
НђЙ НђЙ!$p+q*#~ю КС*#NНђ*##"#Г·Й!&p+qН *%DMН±Й  НOЙ  НOЙ!(q*(& лНLЙ!*p+q*)лНO2'Й!,p+q*+лНO2'Й  НO2'Й  НOЙ!.p+q*-лНLЙ  НRЙ  НRЙ  НLЙ  НRЙ\ НLЙ  НR"Йя  НOЙ!/q*/& л НLЙ!1p+q*0л#НLЙН~*##N! НЅЂ Нћ"TЙ!Vq*VMНцНіЙ!Xp+q!WНГл* >WеНr#MбНІЙ!_p+q!`6 >!`ѕЪ6*`& л*^е*`& Y	СѕК/> Й!`4В	>Й*]& Ђ 	~ю ВO!]4Г9!a6 :aюТж*]& Ђ 	~2bO>№Тz*bMНлГ Нл>!b–џ/х~Ц,ЦџБH±х~Ц:ЦџБH±х~Ц*ЦџБH±х~Ц.ЦџБH±х~Ц>ЦџБH±х~Ц<ЦџБH±х~Ц=ЦџБH±ТЯ*]& Ђ 	6Гг!]4ГT!]4Й!cq*a& Y	:cw!a4Й!gr+s+p+q!h6> fНкµКr*dл*fН!is*dлНЃ"dPY!
 Нл"f> НУµЖяџ!h¦#х~“ЦџБHЎТaН«Гo!h6 :iЖ0OНђГЙ!mr+s+p+q*lTеНZлбs#r*lл НвЪ¶*lл Нвл+s#r*jN#F+q#pГЊЙ!nq!  "o"q}2uo& "s *	лsНЭЪ:nТс*sDMНЫ2u:uЪqoНs *s"sТО*oЙ№НТЙЗНТНЉO 
 НХНТ!v6 >!vѕЪQ*v& w	6 `i+4В6П)НA*Н:'юяК“:'ж‡‡‡‡‡O !П)	~2vюеКЌ:vжO !w	6Н,Г]!v6 >!vѕЪВ*v& w	~Т»*vM 
 Н!v4ВЙгНТН8ЖAOНђ:НђиН±*##N! НЅ"— *	N#F*—лН "™> НУµЦџ!—хНшµЖяџБHЎТ%	яНТГ-	*™DMНА	Н± Н·DMНА	 Н± *	N#FНА	9Н± *	^#Vл))DMНА	TН± *	~<o& Ђ НћDMНА	oН±*—DMНА	Н±*N#FНА	ЋН± *	N#FНА	ќН±Н Й!њp+qН *›DM'Н:НђН«ЙНZ"ќ!џ6 > ќНкµК
*ќ}Т
*џMНМНГ!ќНГл+s#r#4Ги	Й!ўs+p+q!¤6 !¦6 6:ў!¦ѕЪ„
!Ґ6!Ј6 >!ЈѕЪr
*¤& л* е*Ј& Y	СѕКi
!Ґ6 !¤4+4ВA
:ҐТ}
:¦Й!¦4В-
> Й!Є6 Н99Н
2§ю ВЁ
:ЄЦ ЖяџЙ!Є4:§юВ: 2©!Ё6 +6 >!§ѕЪ:§‡‡O !9	DMНi­Н±:©ж‡‡!Ё†O !Y	DMНi:ЁЖ2Ё:©жю2©Н !§4ВВ
ГF:§юВ®ІНТИНТъНТНТ)НТ!§6 >!§ѕЪ«Н :§‡‡O !9	DMНi8Н±!Ё6 >!ЁѕЪ¤Г…:ЁЖ2ЁТkГ¤ Нђ:§‡‡‡‡!Ё†O !Y	DMНiГw!§4ВCГF:§юВїН>ЙГF:§юВННЭ	ГF:§=2§‡‡‡‡2ЁН9:Yю=Кп;НТ>ЙН9*Ё& Y	DMН
=2ЁюяВIНТ>Й!©6ь:§=2§юяК8:©2©:Ё‡‡2ЁГ:©! ¦!Ё¶2 Н9:Yю ВT>Й:Yю,Кe\НТ>ЙГЊ
Й!¬p+q*«~ю:К‰*«NНђ*«#"«Гo:НђЙ!®p+q!'"±!°6 > ±НкµКь*­л*±Н{2Ї*­лНЃ"­PY!
 Нл"±> НУµЦџ!°¶+х~“ЖяџБH±Тщ!°6:ЇЖ0OНђГ kНђН ЙНQ" Н8ЖAOНђjН±ЙН·DMНЏЙmНТННЙНZ"іНl"µ!·6 > іНкµКҐ*і}Т†*·MНМНЃН±*µ}ТxOНђГ}WНђ„Н±Н!іНГл+s#r!µНГл+s#r#4ГDН Й:\ ю К№:\ =OНМЙНіН©!6 !М)6яНlТд:М)ю ВЪЙ:М)=2М)Гр:] ю ВрН&Й!  "ё}2\ !h 6?!j 6?\ Н:'юяКC:'ж‡‡‡‡‡ЖЂo& "є)!Л)6 !  "ѕ):Л)/ёѕ)хНЭџБHЎТН]!Ж)6>!Ж)ѕЪЋ*Ж)& л*є)е*Ж)& л*ј)Б
ѕКy!Ж)6Г„:Ж)ЦЦџ2Л):Ж)<2Ж)ВM*ѕ)#"ѕ)Г/:Л)Т©*ѕ)+"ѕ)Г`*ё"ѕ)#"ёН] !ёНшџ *ј)л! хНшџ/БH±ТнҐНТ!  "ѕ)! "ёН]*ѕ)є)	е*ѕ)лбs#r!Ж)6 >!Ж)ѕЪ.*Ж)& л*є)е*Ж)& л*ј)Б
w:Ж)<2Ж)В*ѕ)є)	> w#6 *ѕ)є)	w#6 *ѕ)є!)	w#6 *ѕ)є%)	w#6 *ѕ)є)	N#F*ѕ)Еє)	Бq#p*ѕ)є%)	 е*є)	~СНe е*є)	 е*	~б¦o& Ђ НћБ	е*ѕ)є%)	Бq#p!З)6 *	>яНхТТ!З)6!Ж)6>!Ж)ѕЪ=Гс:З)!Ж)†wТЧГ=*Ж)& л*є)~2И):З)юВ*Ж)&  	л*є):И)¶2И):И)ю К:*ѕ)є!)	е*ѕ)є)	лБНsГгН,Г
> ёНкµВXєНТГ\:М)юяВ“>!ёНхТd! "А)> !А)НхТd!  "А)!  "Д)*ё++л!Д)НшЪa*Д)ј)	^#Vл"ѕ)Н]*ј)"є)*Д)є)	^#Vл"ѕ)Н]!Ж)6>!Ж)ѕЪT*Ж)& л*є)~2Й)е*Ж)& л*ј)~2К)OС№Т;*Д)є)	^#Vл"В)*Д)ј)	е*Д)є)	гN#Fбq#p*Д)ј)	е*В)лбs#r*А)#"А)!Ж)6ГJ:К)!Й)ѕТJ!Ж)6:Ж)<2Ж)ВЖ *Д)"Д)Т€Гq:ТtЙНТГwН РН±!  "А)ёА)НЭТЌ*А)є)	^#Vл"ѕ)Н]Н .е*ј)DM\ б
-В°!\ 6 :Тй\ НЈ: ю КЫжН±Гж*} DM'НН«*ѕ)є%)	N#F'НН«*ѕ)є!)	N#F'НkНђН«*ѕ)є)	N#FиНН«RНђ/Нђ	 *ј)	~ТIOНђГNWНђН«Н8ЖAOНђ:Нђ
 *ј)	~2И)Тt(НђНА:И)Тѓ)Нђ*А)#"А)ГѓН&Г\!  "А)ёА)НЭТ\НдТ°НЙ*А)"ѕ)Н]Н НА*М)M !		^#Vлй	 *ј)	>Ђ¶*ј)	wГ	 *ј)	>¦*ј)	wГ
 *ј)	>Ђ¶*ј)	wГ
 *ј)	>¦*ј)	wГПбу.е*ј)DM\ б
-В+!\ 6 НuмН±:М)‡‡O !™	DMН±*А)#"А)Г™Й*ѕ)))))П)"ј)Й:m ю Вw> Й.Yn 
-В:YЦSЦџх:ZЦ ЦџБHЎТ§!6>юЙ©Н
2М)ю ВЅЋНТ>Й!Н)6>!Н)ѕЪ*Н)& л*ј)>¦2О)ю Кч:Н)ю	Вр.Нђ*О)MНђ:Н)<2Н)ВЕЙН9Н9:Yю=В/Н9хНюТ&Н©НcГ,щНТГHН©9Н
юВEНГГHНєЙГ  Г Г Н ЙЙЙi`N#FЃo€gЙл_ л…oЊgЙл_ лҐo¤gЙDM!  >х)л—)лЌ‘o|gТ	с=В†ЙDM!  >)л)лТ­	=ВҐЙ~ВіЙ^#Vл)ВЅЙ^#Vл|·g}oВЗЙ_ {•ozњgЙi`N#F‘ogЙo& •oњgЙ_ {–_z#ћWлЙя я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я я                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Г—     
Hit SPACE     ame    .Ext  Bytes  UN At     :    File(s), occupying  K of  K total capacity  directory entries and  K bytes remain on  1!`a6 н°!  9"¶!uщНчНиН”> ґН›
µКХ>!ґН¦
ТТНCНч> ІН›
µКдНjНџ*¶щЙ ГВ
.НВ
ЙНВ

ГВ
!жr+s+p+qегНЋ
8*еЙ*гЙ:] ю$  Еl ] НИ
!] 6 !й6 !з6  :зН„
8\*з& l 	~2июU :й2	:июS :й2:июF :й2:июV :й2:июP :й2
:иЦNЖяџ2й!з4™:0!4
:0!5ЙМНЋ
µЦџ!
¦0Нµ
я НІ
€Нµ
ЙН:\ ю (:\ =_ НІ
:] ю  Е?] НТ
:	0!№6?я  НІ
2№Еє] НИ
Е?\ НТ
 Е  НІ
DMРНИ
!u"б*Ч##)л*б"Я*У& #Нf
"Е*Ч#"З
!ЕНk
"Й>я!ХН¦
џ2ЛЙ\ НІ
2ё:ёюяКB:ёж‡‡‡‡‡ЖЂo& "О~юеК4*З+"З*ОDMНЮ	Т4 *О	DMН
 е*Я	Бq#p*°	"°.е*О#DM*Ялб
- щ*О е*Я	Сw*ґ#"ґ)л*бе*Ялбs#r *Я"Я  НІ
2ёГџЙ!ч6! "ъ*ґ"> !чѕТц*ч& ш)	^#Vл"п
O !		^#Vл"с:ч=2чспНЋ
Ту*п"л*с"нл*пНo
)л*б^#Vл"унлНЋ
Ъ\*л)л*бN#F*улНЖ	юя 	*л#"ла*н)л*б^#V*уDMНЖ	юя 	*н+"нЯнлНЋ
ЪY*л)л*б^#Vл"х*н)л*бе*л)л*бгN#Fбq#p*н)л*бе*хлбs#r*л#"л*н+"нГµпнНЋ
лсеНЋ
СН}
ТґслНЋ
0+:ч<2чO !ш		е*ллбs#r*ч& )	е*слбs#r*н"с<нпНЋ
0+:ч<2чO !ш		е*плбs#r*ч& )	е*нлбs#r*л"пГ†ГTЙ!  "("*ґ*НЋ
Тµ**#"*)л*бе*(#"()л*бгN#Fбq#pґ*НЋ
џх*()л*бе** )	л*б^#VбN#FНЖ	Ц ЦџБHЎТІ**#"*)л*б^#Vл"Я *Я	^#Vл",*()л*б^#Vл"Я*Я	,Н(
 е*Я	Бq#pГ/Г *("ІЙ!/p+q*.)л*б^#Vл"Я!06 >!0ѕМс!0>
ѕ8*0& л*Я>¦OНВ
:0<20 Х:/0` *Я	^#V*ЙНP
DMНЫ
KНВ
:0> *Я	N НЫ
Нм *Я	~юЂ8WНВ
Нм	 *Я	~юЂ8SНВ
НмЙ`Нµ
!;6:!;ѕ87Нµ
:/0'Нµ
:0.Нµ
!:;ѕ05Нµ
:;<2; А*І"9! "5> !9Н¦
Тћ*9л*& Н3
л"М*9л*& Н3
> Нz
µ(*М#"М*DM*МлН"М!  "1М1НЋ
Т„Нч!  "3}2;:;<2;O:№8G*3л*1е*5Б	"7І7НЋ
8>!;ѕ09Нµ
*7DMНј*9+"9*Мл*3"3Г%*1#"1Г*& л*МНP
л*5"5НїГБЙ*Х#"B"D"F*Щ"@> @Н›
µ(:@0*B+"B!@Нk
л+s#rЩ!H6   НІ
">*>~2I*F#"<*<+"<> Нz
µ(4:I2I0*D+"D:H<2HO>№0!H6 *>#">*>~2IГчНчНч*ІDMНЫ
=Нµ
*°л*ЙНP
DMНЫ
RНµ
*Bл*ЙНP
DMНЫ
XНµ
*М#"МНїНч*ЗDMНЫ
iНµ
*Dл*ЙНP
DMНЫ
ЃНµ
  НІ
ЖAOНВ
:НВ
Й.жg
ж” - сЙ>яШ>Й!№~ю?(W
жє> А# о:·А
/жЙ!  :Л· 
·(# чЙ
W
І(# фЙi`N#FЃo€gЙDM!  >х)л—)лЌ‘o|g0	с= лЙDM!  >)л)л0	= цЙ^#Vл) ьЙ^#Vл|·g}o цЙ_ {•ozњgЙO {‘ozgЙi`N#F‘ogЙo& •oњgЙ_ {–_z#ћWлЙГ 
ю ИЕOНВ
БуYГ бг
- щЙбг{- ыЙ!Ls+p+q*JеOН-2N<2M:L!Mѕ8 НВ
!M4м!M6 :N=!Mѕ8*M& O	NНВ
!M4 гЙбг> х3(НOЖ0х3}ґ сZ;с щ{ЙЕ
Ї)№8‘# цБЙ                                                                                      ЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗ  ЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	.xlist
; --------------------------------------------------------------------------- *
di	macro	m
 ifb	<m>
	db	0f3h
 else
	db	0edh,77h,m & 7fh
 endif
endm
; --------------------------------------------------------------------------- *
ei	macro	m
 ifb	<m>
	db	0fbh
 else
	db	0edh,7fh,m & 7fh
 endif
endm
; --------------------------------------------------------------------------- *
exts	macro	r
 ifidn	<r>,<a>
	dw	64edh
 exitm
 endif
 ifidn	<r>,<hl>
	dw	6cedh
 exitm
 endif
endm
; --------------------------------------------------------------------------- *
im	macro	p
 ifidn	<p>,<0>
	dw	46edh
 exitm
 endif
 ifidn	<p>,<1>
	dw	56edh
 exitm
 endif
 ifidn	<p>,<2>
	dw	5eedh
 exitm
 endif
 ifidn	<p>,<3>
	dw	4eedh
 exitm
 endif
endm
; --------------------------------------------------------------------------- *
inw	macro	d,s
ifidn	<d>,<hl>
 ifidn	<s>,<(c)>
	dw	0b7edh
 endif
endif
endm
; --------------------------------------------------------------------------- *
ldctl	macro	d,s
ifidn	<d>,<(c)>
 ifidn	<s>,<hl>
	dw	6eedh			;; ldctl   (c),hl
 exitm
 endif
 ifidn	<s>,<ix>
	db	0ddh,0edh,6eh		;; ldctl   (c),ix
 exitm
 endif
 ifidn	<s>,<iy>
	db	0fdh,0edh,6eh		;; ldctl   (c),iy
 exitm
 endif
endif
ifidn	<s>,<(c)>
 ifidn	<d>,<hl>
	dw	66edh			;; ldctl   hl,(c)
 exitm
 endif
 ifidn	<d>,<ix>
	db	0ddh,0edh,66h		;; ldctl   ix,(c)
 exitm
 endif
 ifidn	<d>,<iy>
	db	0fdh,0edh,66h		;; ldctl   iy,(c)
 exitm
 endif
endif
ifidn	<s>,<usp>
 ifidn	<d>,<hl>
	dw	87edh			;; ldctl   hl,usp
 exitm
 endif
 ifidn	<d>,<ix>
	db	0ddh,0edh,87h		;; ldctl   ix,usp
 exitm
 endif
 ifidn	<d>,<iy>
	db	0fdh,0edh,87h		;; ldctl   iy,usp
 exitm
 endif
endif
ifidn	<d>,<usp>
 ifidn	<s>,<hl>
	dw	8fedh			;; ldctl   usp,hl
 exitm
 endif
 ifidn	<s>,<ix>
	db	0ddh,0edh,8fh		;; ldctl   usp,ix
 exitm
 endif
 ifidn	<s>,<iy>
	db	0fdh,0edh,8fh		;; ldctl   usp,iy
 exitm
 endif
endif
endm

; --------------------------------------------------------------------------- *
neg	macro	r
 ifidn	<r>,<a>
	dw	44edh
 exitm
 endif
 ifidn	<r>,<hl>
	dw	4cedh
 exitm
 endif
endm
; --------------------------------------------------------------------------- *
outw	macro	d,s
ifidn	<d>,<(c)>
 ifidn	<s>,<hl>
	dw	0bfedh			;; outw (c),hl
 endif
endif
endm
; --------------------------------------------------------------------------- *
pcache	macro
	dw	65edh
endm
; --------------------------------------------------------------------------- *
retil	macro
	dw	55edh
endm
; --------------------------------------------------------------------------- *
sc	macro	n
	dw	71edh,n
endm
; --------------------------------------------------------------------------- *
	.list
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее